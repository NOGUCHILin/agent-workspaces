# A Postmortem of Three Recent Issues

出典: [Anthropic Engineering](https://www.anthropic.com/engineering/a-postmortem-of-three-recent-issues)

---

## 概要

2025年8-9月、3つのインフラバグがClaudeの応答品質を低下させた。全て解決済み。

---

## 3つのバグ

### 1. Context Window Routing Error (8/5)

Sonnet 4リクエストが1Mトークン用サーバーに誤転送。

- 当初: 0.8%のリクエストに影響
- 8/29のロードバランシング変更後: ピーク時16%に悪化
- "Sticky"ルーティングで複数メッセージに渡り持続的劣化

### 2. Output Corruption (8/25-9/2)

TPUサーバー誤設定でトークン生成エラー。

症状:
- 英語プロンプトにタイ語・中国語で応答
- コードに明らかな構文エラー

Opus、Sonnetモデルに影響。

### 3. XLA:TPU Compiler Miscompilation (8/25)

コード最適化で潜在的なコンパイラ問題が露出。

- 混合精度演算がトークン確率で不一致
- 近似top-k関数が完全に不正確な結果を返却
- 無関係な要因で挙動が予測不能に変化

---

## 根本原因と解決策

| 原因 | 対策 |
|------|------|
| 検出ギャップ | 評価ベンチマークが実世界の劣化を捕捉できず |
| プライバシー制御 | エンジニアの問題インタラクションアクセス制限 |
| 重複問題 | 複数同時バグで矛盾するユーザー報告 |

---

## 改善計画

- 強化された評価
- 継続的な本番監視
- 改善されたデバッグインフラ

全修正: 2025年9月18日デプロイ完了
