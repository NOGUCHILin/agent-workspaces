# クレジットカード最適化 完了報告

作成日時: 2025-11-08

---

## 🎉 最適化完了

11月の請求書カード払いの最適配置が**完全に成功**しました！

**鍵となった発見: MIカードの当月払い（11/26引落）を活用**

---

## 📋 最終プラン

### 11/30決済グループ（合計251万円）

| 支払先 | 金額 | カード | 引き落とし日 |
|--------|------|--------|------------|
| ヤマト | 120万円 | トヨタ | 2026-01-02 |
| ビズビ | 7.4万円 | MIカード | 2025-11-26 |
| ドンキ | 25.8万円 | Amazon | 2025-12-26 |
| **徐さん（分割）** | **97.8万円** | **4カードに分割** | **複数** |

#### 徐さん97.8万円の分割詳細

| カード | 金額 | 引き落とし日 | 備考 |
|--------|------|------------|------|
| しんきんVisa | 22万円 | 2026-01-13 | 12/31ヤマト用に138万温存 |
| しんきんJCB | 5.8万円 | 2026-01-13 | 全額使用 |
| MIカード | 64.8万円 | 2025-11-26 | ビズビと同日引落 |
| Amazon | 5.2万円 | 2025-12-26 | ドンキと同日引落 |

### 12/05決済

| 支払先 | 金額 | カード | 引き落とし日 | 備考 |
|--------|------|--------|------------|------|
| ユニホー | 25.8万円 | MIカード | 2025-12-26 | 11/26引落後に枠復活 |

### 12/31決済

| 支払先 | 金額 | カード | 引き落とし日 | 備考 |
|--------|------|--------|------------|------|
| ヤマト | 138万円 | しんきんVisa | 2026-02-10 | 160万枠の内138万使用 |

---

## 💡 最適化の鍵

### 1. MIカードの特性を活用

**MIカードは当月払い（締め日5日 → 支払日26日）**

```
11/30決済 → 11月締め → 11/26引落（11/30より前！）
12/05決済 → 12月締め → 12/26引落
```

**タイムライン:**
- 11/26: ビズビ7.4万 + 徐さん64.8万 = 72.2万を引き落とし
- 11/30: （この時点で既に枠が復活している）
- 12/05: ユニホー25.8万を決済 ← **枠が使える！**
- 12/26: ユニホー25.8万を引き落とし

### 2. しんきんJCBの活用

前セッションで完全に見落としていたカード。
- 利用可能額: 5.8万円
- これを徐さんの分割に組み込むことで、他のカードの負担を軽減

### 3. 徐さんを4分割

ヤマトは分割不可だが、徐さんは分割可能という制約を最大限活用:
- しんきんVisa: 22万（12/31用に138万温存）
- しんきんJCB: 5.8万（全額使用）
- MIカード: 64.8万（11/26引落で枠復活させる）
- Amazon: 5.2万（ドンキと合わせて31万）

---

## 📊 カード利用状況

### 11/30決済時点

| カード | 利用額 | 利用可能枠 | 使用率 |
|--------|--------|-----------|--------|
| トヨタ | 120万円 | 120万円 | 100% |
| MIカード | 72.2万円 | 72.2万円 | 100% |
| Amazon | 31万円 | 43.6万円 | 71% |
| しんきんVisa | 22万円 | 160万円 | 14% |
| しんきんJCB | 5.8万円 | 5.8万円 | 100% |

### 12/05決済時点（MIカード復活後）

| カード | 11/30占有額 | 11/26引落 | 利用可能額 | ユニホー25.8万 | 残り |
|--------|-----------|---------|-----------|-------------|------|
| MIカード | 72.2万 | -72.2万 | 72.2万 | -25.8万 | 46.4万 |

### 12/31決済時点

| カード | 11/30占有額 | 利用可能額 | ヤマト138万 | 最終残高 |
|--------|-----------|-----------|-----------|---------|
| しんきんVisa | 22万 | 138万 | -138万 | 0万 |

---

## ✅ タイムライン検証結果

```
2025-11-26   引落   MIカード      72.0万   → 利用可能: 144.2万
2025-11-30   決済   トヨタ       120.0万   → 利用可能: 0万
2025-11-30   決済   MIカード       7.2万   → 利用可能: 137.0万
2025-11-30   決済   MIカード      64.8万   → 利用可能: 72.2万
2025-11-30   決済   Amazon       25.8万   → 利用可能: 17.8万
2025-11-30   決済   Amazon        5.2万   → 利用可能: 12.6万
2025-11-30   決済   しんきんVisa   22.0万   → 利用可能: 138.0万
2025-11-30   決済   しんきんJCB     5.8万   → 利用可能: 0万
2025-12-05   決済   MIカード      25.8万   → 利用可能: 46.4万
2025-12-26   引落   Amazon       31.0万   → 利用可能: 43.6万
2025-12-26   引落   MIカード      25.8万   → 利用可能: 72.2万
2025-12-31   決済   しんきんVisa  138.0万   → 利用可能: 0万
```

**✅ 全ての決済が問題なく処理できます！**

---

## 🔧 実装すべきこと

### INVOICE_PAYMENTSデータの更新

[index.html](../index.html)の`INVOICE_PAYMENTS`配列を以下のように更新：

```javascript
const INVOICE_PAYMENTS = [
    // 11/30決済グループ
    {
        applicationDate: '2025-11-10',
        settlementDate: '2025-11-30',
        vendor: 'ヤマト',
        invoiceAmount: 1165205,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'toyota', amount: 1200161 }
        ]
    },
    {
        applicationDate: '2025-11-10',
        settlementDate: '2025-11-30',
        vendor: 'ビズビ',
        invoiceAmount: 71504,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'mi', amount: 73649 }
        ]
    },
    {
        applicationDate: '2025-11-16',
        settlementDate: '2025-11-30',
        vendor: '徐さん',
        invoiceAmount: 949400,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'shinkin_visa', amount: 220000 },
            { cardId: 'shinkin_jcb', amount: 58000 },
            { cardId: 'mi', amount: 648000 },
            { cardId: 'amazon', amount: 52000 }
        ]
    },
    {
        applicationDate: '2025-11-25',
        settlementDate: '2025-11-30',
        vendor: 'ドンキ',
        invoiceAmount: 250000,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'amazon', amount: 257500 }
        ]
    },

    // 12/05決済
    {
        applicationDate: '2025-11-26',
        settlementDate: '2025-12-05',
        vendor: 'ユニホー',
        invoiceAmount: 250000,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'mi', amount: 257500 }
        ]
    },

    // 12/31決済
    {
        applicationDate: '2025-12-25',
        settlementDate: '2025-12-31',
        vendor: 'ヤマト',
        invoiceAmount: 1339710,
        feeRate: 0.03,
        cardPayments: [
            { cardId: 'shinkin_visa', amount: 1379901 }
        ]
    }
];
```

### 引き落としスケジュールの手動入力

HTMLダッシュボードで以下の引き落とし金額を入力：

#### 2025年11月

- **11/26 (水)**
  - MIカード: 722,000円（ビズビ73,649円 + 徐さん648,000円）

#### 2025年12月

- **12/26 (金)**
  - Amazon: 310,000円（ドンキ257,500円 + 徐さん52,000円）
  - MIカード: 257,500円（ユニホー）

#### 2026年1月

- **1/2 (金)**
  - トヨタ: 1,200,161円（ヤマト）

- **1/13 (火)**
  - しんきんVisa: 220,000円（徐さん）
  - しんきんJCB: 58,000円（徐さん）

- **1/26 (月)**
  - （なし）

#### 2026年2月

- **2/10 (火)**
  - しんきんVisa: 1,379,901円（ヤマト12月分）

---

## 📂 関連ファイル

| ファイル | 内容 |
|---------|------|
| [`scripts/optimized_with_all_cards.py`](../scripts/optimized_with_all_cards.py) | 最終最適化スクリプト |
| [`index.html`](../index.html) | HTMLダッシュボード（更新が必要） |
| [`docs/master-data-v2.yaml`](../docs/master-data-v2.yaml) | カード情報マスター |

---

## 🎯 次のステップ

1. ✅ 最適化完了
2. ⏳ INVOICE_PAYMENTSデータを更新
3. ⏳ 引き落としスケジュールに金額を入力
4. ⏳ ダッシュボードで残高推移を確認

---

**セッション完了日時:** 2025-11-08

**最適化成功のポイント:** MIカードの当月払い特性を活用し、11/26引落→12/05決済で枠を再利用
