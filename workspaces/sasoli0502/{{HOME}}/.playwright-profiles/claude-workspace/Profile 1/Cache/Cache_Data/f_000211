"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[29486,99171],{10123:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(570551);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function a(e){(0,o().A)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"===r(e)&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}},24126:(e,t,n)=>{n.d(t,{c:()=>r});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"3.9 2.75 12.18 14.49",svg:(0,n(474848).jsx)("path",{d:"M12.626 2.768a.625.625 0 0 1 0 1.224l-.126.013h-.125v4.794l3.366 5.159c.893 1.369-.03 3.17-1.623 3.281l-.156.006H6.039c-1.688 0-2.703-1.873-1.78-3.287l3.366-5.157V4.005H7.5a.625.625 0 0 1 0-1.25h5zM8.875 9.173l-.102.156-1.567 2.401h5.589l-1.569-2.403-.101-.156V4.005h-2.25z"})},r=(0,n(340498).wt)("beaker",o,"default")},181348:(e,t,n)=>{n.d(t,{evaluateFormulaFromNativeViewer:()=>p});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var o=()=>n(242422),r=()=>n(675133),a=()=>n(295633),i=()=>n(732810),c=()=>n(239381),s=()=>n(416504),d=()=>n(179034),l=()=>n(519831),u=()=>n(89053),m=()=>n(862292);async function p(e,t){try{const n=await m().T.formulas.load(),p=new(i().m)(e,{table:l().Vl,id:t.collectionId});await p.load();const f=p.getSchema(),v=[];for(const i of t.formulaInputs){const l=new(a().B)(e,{table:d().ev,id:i.blockId});await l.load();const m=l.getModel(),p=f[i.propertyId];if(!m||!p||"formula"!==p.type||!p.formula2){v.push({value:[],type:"undefined",blockId:i.blockId,propertyId:i.propertyId});continue}const g=(0,s().P)(),S=r().A.getIntl(),y=n.evaluateCollectionFormula2({block:m,property:i.propertyId,formulaCode:p.formula2.code,getRecordModel:l.getRecordModel,intl:S,userTimeZone:g,depth:0,visitedProperties:new Set,resultCache:new Map,regExpCache:new Map,formatDateCache:new Map,formulaTimeoutTimestampMs:Date.now()+1e4,experimentService:o().default,collectionFeatureGates:(0,u().i)(),spaceIdCreator:e.idCreator.getSpaceIdCreatorSync(t.spaceId)});if(y){const e=(0,c().Ht)(y);v.push({value:e,type:y.type,blockId:i.blockId,propertyId:i.propertyId})}else v.push({value:[],type:"undefined",blockId:i.blockId,propertyId:i.propertyId})}return v}catch{return[]}}},362075:(e,t,n)=>{n.d(t,{AB:()=>s,BU:()=>c,Ru:()=>d,f1:()=>u,yz:()=>l});var o=()=>n(907258),r=()=>n(242422),a=()=>n(590526),i=()=>n(209199);function c(){var e;const t=(null===(e=o().default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.preferred_locale)??i().q;if("en"===(0,i().o_)(t)){return"play_audio"===r().default.getEligibleGroup({experimentId:"audio_consent_on_transcription_experiment",defaultGroup:"control"})}return!1}function s(){return(0,a().K8)((()=>c()),[])}function d(){var e;const t=o().AppStoreSidebarSpaceStore.state;return(null==t||null===(e=t.getSettingsStore())||void 0===e||null===(e=e.getKeyStore("audio_consent_on_transcription"))||void 0===e?void 0:e.getValue())??!1}function l(){const e=c();if(!e)return!1;if(!o().AppStoreSidebarSpaceViewStore.getState())return!1;const t=d(),n=function(){var e;const t=o().AppStoreSidebarSpaceViewStore.getState();return!!t&&((null===(e=t.getSettings())||void 0===e?void 0:e.audio_consent_on_transcription)??!0)}();return e&&(t||n)}function u(){return(0,a().K8)((()=>l()),[])}},424641:(e,t,n)=>{n.d(t,{Gj:()=>u,Jx:()=>l,RN:()=>S,_X:()=>y,sM:()=>h,sR:()=>v,vZ:()=>m,xy:()=>k,y6:()=>g});n(944114),n(898992),n(823215),n(354520),n(672577);var o=()=>n(906745),r=()=>n(726637),a=()=>n(295633),i=()=>n(761940),c=()=>n(651784),s=()=>n(179034),d=()=>n(615234);function l(e){return"owner"===e.accessRole||"writer"===e.accessRole}function u(e){const t=o().DateTime.fromMillis(e.startUnixTimestampMS),n=e.endUnixTimestampMS?o().DateTime.fromMillis(e.endUnixTimestampMS):void 0,r=o().DateTime.fromMillis(e.startOfWeekUnixTimestampMS),a=o().DateTime.fromMillis(e.endOfWeekUnixTimestampMS),i=t.startOf("day"),c=o().DateTime.max(r,i),s=Math.ceil(c.diff(r,"days").get("days"));let d=1;if(n){const e=n.endOf("day"),t=o().DateTime.min(a,e);d=Math.ceil(t.diff(c,"days").get("days"))}return{start:t,end:n,startOfWeek:r,endOfWeek:a,startColumn:s,columnCount:d}}function m(e){const t=(e.attendees||[]).filter((e=>!e.self&&!e.resource));return e.hasParticipants&&t.length>0&&t.every((e=>"declined"===e.responseStatus))}const p={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:15},f={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:5},v={upcomingMinsThreshold:10,startingMinsThreshold:15,startedMinsThreshold:15};function g(e){const{events:t,accounts:n,thresholds:r=p,filters:a}=e,c=t.filter((e=>{if(!(e.conferencing||null!=a&&a.includeEventsWithoutConferencing))return!1;const t=n.find((t=>t.id===e.accountId));return!(null==t||!t.email)&&(!!(0,i().Ko)(e,t.email)&&(!function(e){if("declined"===e)return!0;return!1}(e.responseStatus??"declined")&&!e.isAllDay))}));if(0===c.length)return[];const{upcomingMinsThreshold:s,startingMinsThreshold:l,startedMinsThreshold:u}=r,m=o().DateTime.now(),f=void 0!==(null==a?void 0:a.maxDaysInFuture)?a.maxDaysInFuture*d().XQ:void 0,v=void 0!==(null==a?void 0:a.maxDaysInPast)?a.maxDaysInPast*d().XQ:void 0,g=[],S=[],y=[],h=[],k=[],T=[];for(const o of c){if(o.isAllDay)continue;const e=b(o),t=m.diff(e.end,"minutes").minutes;if(void 0!==v&&t>v)continue;if(null!=a&&a.excludeEventsOnDifferentDays){if(m.setZone(e.start.zone).toISODate()!==e.start.toISODate())continue}const n=e.start.diff(m,"minutes").minutes;if(!(void 0!==f&&n>f))if(n>=0&&n<=s)g.push(o);else if(n<0){const r=-n,a=t>=0?t:void 0;r>0&&r<=l?y.push(o):r>l&&r<=u?h.push(o):e.contains(m)?S.push(o):void 0!==v&&void 0!==a&&a<=v&&k.push(o)}else T.push(o)}S.sort(((e,t)=>{const n=o().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone});return o().DateTime.fromISO(t.start.dateTime,{zone:t.start.timeZone}).diff(n).toMillis()})),k.length>1&&k.sort(((e,t)=>{const n=o().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return o().DateTime.fromISO(t.end.dateTime,{zone:t.end.timeZone}).diff(n).toMillis()}));return[...g,...y,...h,...null!=a&&a.excludeInProgressEvents?[]:S,...k,...null!=a&&a.excludeUpcomingLaterEvents?[]:T]}function S(e,t){return g({events:e,accounts:t,thresholds:p,filters:void 0})[0]}function y(e,t){return h(e,t)[0]}function h(e,t,n){return g({events:e,accounts:t,thresholds:f,filters:{excludeUpcomingLaterEvents:!0,...n}})}function b(e){const t=o().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone}),n=o().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return o().IX.fromDateTimes(t,n)}function k(e){const{spaceStore:t}=e;let n=e.fileUrl;if(!t)return;const o=(0,c().parseRoute)({url:n,isMobile:r().A.isMobile,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName,protocol:r().A.protocol,currentUrl:window.location.href}),i="page"===o.name?o.blockId:void 0;if(!i)return;const d=a().B.createChildStore(t,{table:s().ev,id:i});return d.load(),d}},533336:(e,t,n)=>{n.r(t),n.d(t,{appendTranscriptionBlockToPage:()=>E,createAndNavigateToTranscriptionBlock:()=>F,createMeetingNoteAndGetUrl:()=>W,createMeetingNoteAndGetUrlWhenReady:()=>G,createTranscriptionBlock:()=>Z,navigateToTranscriptionBlock:()=>R});n(944114),n(898992),n(354520);var o=()=>n(906745),r=()=>n(907258),a=()=>n(755531),i=()=>n(675133),c=()=>n(295633),s=()=>n(732810),d=()=>n(342641),l=()=>n(584262),u=()=>n(700500),m=()=>n(597777),p=()=>n(604995),f=()=>n(165358),v=()=>n(416504),g=()=>n(61844),S=()=>n(201980),y=()=>n(534177),h=()=>n(669548),b=()=>n(209660),k=()=>n(44729),T=()=>n(411618),I=()=>n(185544),_=()=>n(812182),A=()=>n(680977),M=()=>n(649813),D=()=>n(87017),w=()=>n(17476),x=(n(672577),()=>n(424641)),C=()=>n(488776);var B=()=>n(211716),O=()=>n(492414),U=()=>n(535960),z=()=>n(893665),j=()=>n(482813),P=()=>n(295304),N=()=>n(244828),V=()=>n(711207);const L=(0,n(69708).YK)({newPage:{id:"transcriptionCreateActions.newPage.title",defaultMessage:"Try AI Meeting Notes "},defaultLocationToastTitle:{id:"transcriptionCreateActions.defaultLocationToast.title",defaultMessage:"Keep your meeting notes organized"},defaultLocationToastMessage:{id:"transcriptionCreateActions.defaultLocationToast.message",defaultMessage:"Choose a default database so new notes are saved there automatically."},defaultLocationToastCta:{id:"transcriptionCreateActions.defaultLocationToast.cta",defaultMessage:"Set default database"}});function E(e){const{environment:t,from:n}=e;N().createAndCommit({userAction:"transcriptionCreateActions.appendTranscriptionBlock",environment:t,canUndo:!0,perform:e=>{(0,D().insertBlockAndEdit)({environment:t,createBlockItem:w().ry[u().xd.transcription],analyticsFrom:n??"quick_templates",selection:[],transaction:e})}})}function R(e){const{environment:t,origin:n,peekMode:o,blockStore:r,pageVisitSource:a,callback:i}=e,c=r.getNavigableBlockStore()??r;o?(0,z().V)({environment:t,openInNew:void 0,store:c,peekMode:o,pageVisitSource:a,resultsStore:void 0,collectionContextStore:void 0}):(0,U().u)({environment:t,store:c,visitType:B().ig.Link,pageVisitSource:a,origin:n,callback:i})}function F(e){const{environment:t,from:n,title:o,origin:r,parent:a,calendarEvent:i,peekMode:c,sharedNote:s,pageVisitSource:d=l().y8.Create,callback:u}=e;let m;if(m=Z(s?{environment:t,from:n,title:o,parent:a,calendarEvent:i,sharedNote:s}:{environment:t,from:n,title:o,parent:a,calendarEvent:i}),m)return R({environment:t,blockStore:m.pageStore,pageVisitSource:d,origin:r,peekMode:c,callback:u}),m.transcriptionBlockStore}function Z(e){var t,n;const{environment:l,from:f,title:D,parent:B,calendarEvent:O,sharedNote:U}=e,z=(0,a().S)(),E=r().default.state.sidebarSpaceViewStore;if(!z||!E)return;const{performResult:R}=N().createAndCommit({userAction:"transcriptionCreateActions.createTranscriptionBlock",environment:l,canUndo:!1,perform:e=>{var t;const n=null===(t=r().default.state.sidebarSpaceViewStore)||void 0===t||null===(t=t.getSettings())||void 0===t||null===(t=t.default_meeting_notes_location)||void 0===t?void 0:t.collection,a=function(e){const{spaceStore:t,collection:n}=e;if(!n)return;const o=s().m.createChildStore(t,n);return o.isDefined()?o.getAlive()?o.pathIsDead()?{valid:!1,reason:"invalid"}:o.canEdit()?{valid:!0,collection:n}:{valid:!1,reason:"invalid"}:{valid:!1,reason:"invalid"}:{valid:!1,reason:"not_loaded"}}({spaceStore:z,collection:n}),d=!0===(null==a?void 0:a.valid)?a.collection:void 0,g="private"===B||"none"===B||"collection"===(null==B?void 0:B.table)||!B,b=g?I().IT({environment:l,spaceStore:z,spaceViewStore:E,parent:B??d??"private",transaction:e,from:f}):c().B.createChildStore(E,B);if(!b.isType(u().xd.page))return;if(U){const t=[];for(const e of O.attendees??[])e.notionUserId&&t.push({type:"user_permission",role:"editor",user_id:e.notionUserId});t.length&&T().zP({environment:l,store:b,permissionItems:t,transaction:e})}if(g){const t=function(e,t){var n,r,a;let c,s;switch(e){case"title_with_event":let e;if(t){const{startTime:n}=V().Wm(t);e={summary:t.summary,startDateTime:n}}else e=function(){const e=(0,C().Y)().getEvents(),t=(0,C().Y)().getCurrentAccounts();if(!e||0===e.length)return;const n=e.filter((e=>!e.isAllDay&&o().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone}).toISODate()===o().DateTime.now().toISODate())),r=(0,x().y6)({events:n,accounts:t,thresholds:void 0,filters:void 0}).find((e=>{const t=e.attendees??[];return!(e.isAllDay||"accepted"!==e.responseStatus||!e.summary||t.length<1)}));if(null!=r&&r.summary&&!r.isAllDay){const e=o().DateTime.fromISO(r.start.dateTime,{zone:r.start.timeZone});return{summary:r.summary,startDateTime:e}}}();c=null!==(n=e)&&void 0!==n&&n.summary?[`${e.summary} `]:void 0,s=null===(r=e)||void 0===r?void 0:r.startDateTime;break;case"new_page":c=[i().A.getIntl().formatMessage(L.newPage)];break;default:c=void 0,s=void 0}const d=(0,v().P)();s=(null===(a=s)||void 0===a?void 0:a.setZone(d))??o().DateTime.now();const l=[c,S().wmz(S().Ww9({type:"datetime",start_date:s.toFormat(p().tr),start_time:s.toFormat(m().GE),time_zone:d,date_format:"relative"}),[[S().BQP.Bold]])].filter(y().O9);return l}(D,O),n=b.getBlockTitleStore();P().yr({environment:l,store:n,tokens:t,transaction:e,index:0})}else if(d){const t=s().m.createChildStore(z,d);if(t){const n=t.getDefaultTemplatePageStore();n&&M().TB({title:"template",environment:l,store:b,templateStore:n,isKeyboard:!1,isCreateIn:!1,transaction:e,from:f})}}const _=w().ry.transcription,A=h().w({environment:l,transaction:e,inMemoryRecordCache:z.inMemoryRecordCache,from:f,selection:[],spaceId:z.id,createBlockItem:_});return O&&(V().Ud({blockStore:A,event:O,transaction:e,environment:l}),V().bk({blockStore:A,event:O,transaction:e,environment:l})),k().Ti({childStore:A,parentStore:b,transaction:e}),{createdTranscriptionBlock:A,createdPage:b,shouldResetDefaultMeetingNotesLocation:!1===(null==a?void 0:a.valid)&&"invalid"===a.reason}}});if(!R)return;R.shouldResetDefaultMeetingNotesLocation&&function(e){const{environment:t,spaceViewStore:n}=e;N().createAndCommit({userAction:"transcriptionCreateActions.resetDefaultMeetingNotesLocation",environment:t,canUndo:!1,perform:e=>{N().applyOperation({store:n,operation:{pointer:n.pointer,path:["settings","default_meeting_notes_location"],command:"set",args:void 0},transaction:e})}})}({environment:l,spaceViewStore:E});const F=r().default.state.currentUserSettingsStore,Z=null==F||null===(t=F.getSettings())||void 0===t?void 0:t.seen_default_meeting_notes_location_toast,W=null===(n=E.getSettings())||void 0===n?void 0:n.default_meeting_notes_location,G=d().default.getData(l,{spaceId:E.getSpaceId()}),H=(0,g().Jd)(G??[]),K="trial"===(null==H?void 0:H.offer.type)&&(0,g().w5)(H.offer.campaign);if(!Z&&!W&&!K&&F){const e=i().A.getIntl();_().Iz({id:"default-meeting-notes-location-toast",title:e.formatMessage(L.defaultLocationToastTitle),message:e.formatMessage(L.defaultLocationToastMessage),presentationType:"transient",actions:{primary:{title:e.formatMessage(L.defaultLocationToastCta),onAction:()=>{_().UW("default-meeting-notes-location-toast"),b().Ow({currentTab:"ai",highlightedSetting:j().rF.DefaultMeetingNotesLocation,openedFrom:"default_meeting_notes_location_toast"})}}}}),N().createAndCommit({userAction:"transcriptionCreateActions.markDefaultLocationToastAsSeen",environment:l,canUndo:!1,perform:e=>{(0,A().m)({userSettingsStore:F,transaction:e,data:{seen_default_meeting_notes_location_toast:!0}})}})}return(0,C().Y)().update((e=>{const t=R.createdTranscriptionBlock.pointer;return e&&O?(e.events.push({...O,blockAttachments:[t,...O.blockAttachments??[]]}),e):e})),{transcriptionBlockStore:R.createdTranscriptionBlock,pageStore:R.createdPage}}function W(e){const t=Z({environment:e.environment,from:e.from,title:e.title??"new_page",parent:void 0});if(!t)return;return{pageId:t.pageStore.id,blockId:t.transcriptionBlockStore.id,spaceId:t.pageStore.getSpaceId(),blockUrl:(0,O().J8)({store:t.transcriptionBlockStore,scrollToBlockId:t.transcriptionBlockStore.id,fullyQualified:!0,pageVisitSource:e.pageVisitSource})}}async function G(e){return await async function(){await Promise.all([r().default.waitUntil((()=>{var e;return Boolean(null===(e=(0,a().S)())||void 0===e?void 0:e.isReady())})),r().default.waitUntil((()=>{var e;return Boolean(null===(e=r().default.state.sidebarSpaceViewStore)||void 0===e?void 0:e.isReady())}))]);const e=(0,a().S)(),t=r().default.state.sidebarSpaceViewStore;e&&t||f().log({level:"error",from:"transcriptionCreateActions",type:"waitForTranscriptionStoresUnexpectedUndefined"})}(),W(e)}},569243:(e,t,n)=>{n.d(t,{Pf:()=>s,QL:()=>i,Sk:()=>c});const o={1:e=>e.orange.background.accentSecondary,2:e=>e.red.background.accentSecondary,3:e=>e.red.background.accentSecondary,4:e=>e.orange.background.accentSecondary,5:e=>e.orange.background.accentSecondary,6:e=>e.orange.background.accentSecondary,7:e=>e.green.background.accentSecondary,8:e=>e.green.background.accentSecondary,9:e=>e.green.background.accentSecondary,10:e=>e.green.background.accentSecondary,11:e=>e.yellow.background.accentSecondary,12:e=>e.yellow.background.accentSecondary,13:e=>e.green.background.accentSecondary,14:e=>e.blue.background.accentSecondary,15:e=>e.blue.background.accentSecondary,16:e=>e.blue.background.accentSecondary,17:e=>e.purple.background.accentSecondary,18:e=>e.purple.background.accentSecondary,19:e=>e.gray.background.accentSecondary,20:e=>e.gray.background.accentSecondary,21:e=>e.pink.background.accentSecondary,22:e=>e.pink.background.accentSecondary,23:e=>e.purple.background.accentSecondary,24:e=>e.purple.background.accentSecondary},r={1:e=>e.purple.background.accentSecondary,2:e=>e.green.background.accentSecondary,3:e=>e.pink.background.accentSecondary,4:e=>e.red.background.accentSecondary,5:e=>e.yellow.background.accentSecondary,6:e=>e.orange.background.accentSecondary,7:e=>e.blue.background.accentSecondary,8:e=>e.gray.background.accentSecondary,9:e=>e.blue.background.accentSecondary,10:e=>e.green.background.accentSecondary,11:e=>e.red.background.accentSecondary};function a({theme:e,color:t}){if("preset"===t.type){var n,a;if("calendar"===t.colorType)return null===(n=o[t.colorId])||void 0===n?void 0:n.call(o,e);if("event"===t.colorType)return null===(a=r[t.colorId])||void 0===a?void 0:a.call(r,e)}var i;if("custom"===t.type)return null===(i=t.colorHexes)||void 0===i?void 0:i[e.mode].backgroundPrimary}function i({theme:e,calendarColor:t}){const n=t&&a({theme:e,color:t});return n||e.blue.background.accentSecondary}function c({theme:e,eventColor:t,calendarColor:n}){const o=t&&a({theme:e,color:t});return o||i({theme:e,calendarColor:n})}function s(e){const{colorType:t,color:n,colorId:o}=e;return o?{type:"preset",colorId:o,colorType:t}:n?{type:"custom",colorHexes:n}:void 0}},570551:(e,t,n)=>{function o(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}n.d(t,{A:()=>o})},606982:(e,t,n)=>{n.d(t,{A:()=>a});var o=()=>n(10123),r=()=>n(570551);function a(e,t){(0,r().A)(2,arguments);var n=(0,o().A)(e),a=(0,o().A)(t),i=n.getTime()-a.getTime();return i<0?-1:i>0?1:i}},711207:(e,t,n)=>{n.d(t,{FP:()=>y,Mh:()=>I,Ud:()=>k,Wm:()=>h,_p:()=>_,bk:()=>b,uJ:()=>T});n(944114),n(898992),n(354520),n(672577),n(581454);var o=()=>n(906745),r=()=>n(564884),a=()=>n(755531),i=()=>n(278729),c=()=>n(755125),s=()=>n(848538),d=()=>n(534177),l=()=>n(753812),u=()=>n(896628),m=()=>n(411618),p=()=>n(402528),f=()=>n(966509),v=()=>n(488776),g=()=>n(295304),S=()=>n(244828);function y(e){var t;const{environment:n,store:o}=e,r=null===(t=o.getFormat())||void 0===t?void 0:t.transcription_calendar_event;r&&S().createAndCommit({userAction:"transcriptionCalendarActions.dismissCalendarSharingSuggestion",environment:n,canUndo:!0,perform:e=>{u().zA({stores:[o],update:{transcription_calendar_event:{...r,has_dismissed_sharing:!0}},transaction:e})}})}function h(e){return{startTime:e.isAllDay?o().DateTime.fromISO(e.start.date):o().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone}),endTime:e.isAllDay?o().DateTime.fromISO(e.end.date):o().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone})}}function b(e){const{blockStore:t,event:n,transaction:o,environment:r}=e,a=t.getTitleStore();a&&(g().jQ({environment:r,store:a,transaction:o,selection:{startIndex:0,endIndex:1/0},updateSelection:!1}),n.summary&&g().yr({environment:r,store:a,index:0,tokens:[[n.summary]],transaction:o}))}function k(e){var t;const{blockStore:n,event:o,attendeeIds:r,transaction:a,environment:i}=e,{startTime:c,endTime:s}=h(o),l=r??(null===(t=o.attendees)||void 0===t?void 0:t.map((e=>e.notionUserId)).filter(d().O9))??[],m=i.currentUser.id;m&&!l.includes(m)&&l.push(m),u().zA({stores:[n],update:{transcription_calendar_event:{uid:o.uid,startTime:c.toISO(),endTime:s.toISO(),attendeeIds:l}},transaction:a})}async function T(e){const{environment:t,blockStore:n,event:d,source:l,shareWithParticipants:g}=e,y=d.isAllDay?o().DateTime.fromISO(d.start.date):o().DateTime.fromISO(d.start.dateTime,{zone:d.start.timeZone}),h=d.isAllDay?o().DateTime.fromISO(d.end.date):o().DateTime.fromISO(d.end.dateTime,{zone:d.end.timeZone}),T=_({environment:t,event:d});S().createAndCommit({userAction:"transcriptionCalendarActions.addCalendarEventToTranscriptionBlock",environment:t,canUndo:!0,perform:e=>{u().zA({stores:[n],update:{transcription_calendar_event:{uid:d.uid,startTime:y.toISO(),endTime:h.toISO(),attendeeIds:[],has_dismissed_sharing:!g}},transaction:e}),b({blockStore:n,event:d,transaction:e,environment:t})}}),(0,c().clear)({environment:t});const I=await T;if(S().createAndCommit({userAction:"transcriptionCalendarActions.addCalendarAttendeesToTranscriptionBlock",environment:t,canUndo:!0,perform:e=>{k({blockStore:n,event:d,attendeeIds:I.map((e=>e.id)),transaction:e,environment:t})}}),g){const e=n.getNavigableBlockStore();if(e){const o=I.filter((e=>e.id!==t.currentUser.id)).map((e=>({type:"existingUser",value:e})));o.length>0&&(m().eP({environment:t,store:e,inviteTargets:o,inviteRole:"editor",isOnboarding:!1,invite:{inviteOrigin:"transcription_block"}}),(0,p()._)({environment:t,transcriptionBlockStore:n}))}}(0,f().R)({environment:t,data:{type:"track",payload:{event:"transcriptionBlockCalendarEventAdded",eventId:d.uid,source:l,notionBlockId:n.id}}}),(0,r().u)({environment:t,event:{eventName:"transcription_block_calendar_event_linked",eventProperties:{block_id:n.id,calendar_event_id:d.uid,from:l,total_attendees:I.length,attendees_in_workspace:(()=>{const e=(0,a().S)();return e?I.filter((t=>i().V.createChildStore(e,(0,s().i1)({userId:t.id,spaceId:e.id})).isMember())).length:0})(),has_conferencing:Boolean(d.conferencing)}}}),(0,v().Y)().update((e=>{if(!e)return e;const t=e.events.find((e=>e.accountId===d.accountId&&e.calendarId===d.calendarId&&e.id===d.id));return t?(t.blockAttachments=[n.pointer,...t.blockAttachments??[]],e):e}))}function I(e){const{environment:t,blockStore:n}=e;S().createAndCommit({userAction:"transcriptionCalendarActions.removeCalendarEventFromTranscriptionBlock",environment:t,canUndo:!0,perform:e=>{const o=n.getTitleStore();o&&g().jQ({environment:t,store:o,transaction:e,selection:{startIndex:0,endIndex:1/0}}),u().zA({stores:[n],update:{transcription_calendar_event:void 0},transaction:e})}}),(0,c().clear)({environment:t})}async function _(e){var t;const{environment:n,event:o}=e,r=(null===(t=o.attendees)||void 0===t?void 0:t.map((e=>e.email)).filter(d().O9))??[];if(0===r.length)return[];const a=await l().callMainCellApi({eventName:"findUsers",environment:n,data:{emails:r}});return"success"!==a.type?[]:a.data.values.map((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.value})).filter(d().O9)}},738508:(e,t,n)=>{n.r(t),n.d(t,{cursorIcon:()=>a,iconDefinition:()=>r});n(296540);var o=n(474848);const r={viewBox:"0 0 20 20",fittedViewBox:"1.25 0 17.5 20",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("g",{className:"logo-light-mode",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_16020_205)",children:[(0,o.jsx)("path",{fill:"#757575",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,o.jsx)("path",{fill:"#525252",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,o.jsx)("path",{fill:"#404040",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,o.jsx)("path",{fill:"#D9D9D9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,o.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_16020_205",children:(0,o.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]}),(0,o.jsxs)("g",{className:"logo-dark-mode",children:[(0,o.jsxs)("g",{clipPath:"url(#clip0_16020_213)",children:[(0,o.jsx)("path",{fill:"#6E6E6E",d:"m9.995 9.987 8.658 4.999a.6.6 0 0 1-.226.226l-8.092 4.672a.68.68 0 0 1-.68 0l-8.092-4.672a.6.6 0 0 1-.226-.226z"}),(0,o.jsx)("path",{fill:"#4A4A4A",d:"M9.995 0v9.987l-8.658 4.999a.6.6 0 0 1-.082-.309v-9.38c0-.22.117-.424.308-.534L9.655.09a.7.7 0 0 1 .34-.09"}),(0,o.jsx)("path",{fill:"#383838",d:"M18.652 4.989a.6.6 0 0 0-.225-.226L10.334.09A.7.7 0 0 0 9.995 0v9.987l8.658 4.999a.6.6 0 0 0 .083-.309v-9.38c0-.11-.03-.216-.083-.308"}),(0,o.jsx)("path",{fill:"#C9C9C9",d:"M18.047 5.339a.29.29 0 0 1 0 .29l-7.859 13.61c-.053.093-.193.055-.193-.05v-8.97a.4.4 0 0 0-.054-.201z"}),(0,o.jsx)("path",{fill:"#fff",d:"m18.047 5.339-8.106 4.68a.4.4 0 0 0-.147-.147L2.027 5.387c-.092-.053-.054-.193.052-.193h15.717c.111 0 .202.06.25.145"})]}),(0,o.jsx)("defs",{children:(0,o.jsx)("clipPath",{id:"clip0_16020_213",children:(0,o.jsx)("path",{fill:"#fff",d:"M1.255 0h17.49v20H1.256z"})})})]})]})},a=(0,n(340498).wt)("cursor",r,"default")}}]);