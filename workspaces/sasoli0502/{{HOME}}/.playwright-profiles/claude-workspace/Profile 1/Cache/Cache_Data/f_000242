"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[10831],{98205:(e,o,t)=>{t.d(o,{DG:()=>p,Yg:()=>c,Yx:()=>m,_N:()=>u,fY:()=>f,h8:()=>h,wG:()=>d});t(944114),t(898992),t(803949);var s=()=>t(467947),n=()=>t(430896),a=()=>t(31503),i=()=>t(500993),r=()=>t(37165),l=()=>t(131448);const d="forms_add_conditional_logic_tooltip";function c({currentModule:e,nestedModules:o,includePlaceholders:t}){const s=[{currentModule:e,depth:1}],n=[];let a=0;for(;s.length>0;){const e=s.shift();if(!e)continue;const{currentModule:r,depth:l}=e;var i;if(n.push(r),l>a&&(a=l),"formQuestion"===r.type)null===(i=r.conditionalGroups)||void 0===i||i.forEach((e=>{const n=e.children??[];for(const a of n){const e=o[a];e&&("formQuestion"===e.type||t&&"placeholder"===e.type)&&s.push({currentModule:e,depth:l+1})}}))}return{formQuestionDescendants:n,maxDepth:a}}function u(e,o,t){if(!e)return;const s=(0,i().A)(e,o.getModules());if(!s)return;const a=n().c.createChildStore(o,{table:r().lo,id:s.module.formQuestionId,spaceId:o.getSpaceId()??""}).getPropertyId();if(!a)return;const l=t.getSchema()[a],d=null==l?void 0:l.type;return"select"===d||"multi_select"===d||"checkbox"===d?d:void 0}function p({mouseEntered:e,currentQuestionModule:o,modulesByArea:t,featureAvailable:s,inputFocused:n,isDragging:i,showTutorialTooltip:r}){if(void 0===t)return!1;const l=(0,a().Cg)({moduleId:null==o?void 0:o.id,modulesByArea:t}).length>=a().mh,d=(e||r)&&!l&&!n&&!i;return d}function m(e){const{formQuestionId:o,formAddConditionalLogicTooltipStore:t}=e;if(s().A.state.open||!o||!t)return!1;if("multi_select"===e.type){const s=e.optionValue;if(!s||t.state.openTooltip!==f({formQuestionId:o,optionValue:s}))return!1}else if(t.state.openTooltip!==f({formQuestionId:o}))return!1;return l().default.isVisible(d)}function f({formQuestionId:e,optionValue:o}){return o?`fqid:${e} value:${o}`:`fqid:${e}`}function h(e,o){return`${e}:${o}`}},465741:(e,o,t)=>{t.d(o,{C0:()=>T,CK:()=>I,Dx:()=>F,Fc:()=>D,Gi:()=>v,Hd:()=>W,KU:()=>L,TW:()=>q,Vm:()=>N,YA:()=>j,d0:()=>b,eb:()=>x,ls:()=>C,mY:()=>w,px:()=>R});t(16280),t(296540);var s=()=>t(590526),n=()=>t(675133),a=()=>t(792057),i=()=>t(732810),r=()=>t(197636),l=()=>t(584262),d=()=>t(31503),c=()=>t(898244),u=()=>t(713998),p=()=>t(69708),m=()=>t(284371),f=()=>t(720665),h=()=>t(390650),g=()=>t(492414),y=()=>t(761309),M=()=>t(98205),S=t(474848);const b=5e3,x=500,v=(0,p().YK)({characterLimitReached:{defaultMessage:"Character limit reached.",id:"form.characterLimitReached"},questionLimitReachedTitle:{defaultMessage:"Question limit reached",id:"form.questionLimitReached.title"},questionLimitReachedSubtitle:{defaultMessage:"Please delete a question before creating a new one.",id:"form.questionLimitReached.subtitle"},questionLimitReachedFullMessage:{defaultMessage:"Question limit reached. Please delete a question before creating a new one.",id:"form.questionLimitReached.fullMessage"}}),A=(0,p().YK)({title:{defaultMessage:"Title",id:"database.questionTypeName.title"},text:{defaultMessage:"Text",id:"database.questionTypeName.text"},number:{defaultMessage:"Number",id:"database.questionTypeName.numberTypeLabel"},url:{defaultMessage:"URL",id:"database.questionTypeName.url"},multi_select:{defaultMessage:"Multiple choice",id:"database.questionTypeName.multi_select"},person:{defaultMessage:"Person",id:"database.questionTypeName.person"},email:{defaultMessage:"Email",id:"database.questionTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.questionTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.questionTypeName.dateTypeLabel"},file:{defaultMessage:"Files & media",id:"database.questionTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.questionTypeName.checkbox"},relation:{defaultMessage:"Relation",id:"database.questionTypeName.relation"},place:{defaultMessage:"Place",id:"database.questionTypeName.place"}}),w={title:n().A.formatMessage(A.title),text:n().A.formatMessage(A.text),number:n().A.formatMessage(A.number),url:n().A.formatMessage(A.url),multi_select:n().A.formatMessage(A.multi_select),person:n().A.formatMessage(A.person),email:n().A.formatMessage(A.email),phone_number:n().A.formatMessage(A.phone_number),date:n().A.formatMessage(A.date),file:n().A.formatMessage(A.file),checkbox:n().A.formatMessage(A.checkbox),relation:n().A.formatMessage(A.relation),place:n().A.formatMessage(A.place)},_=["relation","person"];function T(e,o){return o?"closed":e?"shared_to_web":"shared_to_space"}function C(e){const{formSharingState:o,isOverBlockLimit:t,spaceName:s}=e;if(t)return(0,S.jsx)(p().sA,{id:"editorFormResponderWarning.overBlockLimit.message",defaultMessage:"You are over the block limit. No new responses can be submitted through this form."});switch(o){case"closed":return(0,S.jsx)(p().sA,{id:"editorFormResponderWarning.closed.message",defaultMessage:"This form is closed. No new responses can be submitted."});case"shared_to_web":return(0,S.jsx)(p().sA,{id:"editorFormResponderWarning.public.message",defaultMessage:"This form is public. Anyone with the link can submit a response."});case"shared_to_space":return(0,S.jsx)(p().sA,{id:"editorFormResponderWarning.internal.message",defaultMessage:"Only members at {spaceName} can fill out this form.",values:{spaceName:s}})}}function R(e,o=!1){return e.getIsFormPublic()?(0,g().Ay)({store:e,preferPublicLink:!0,pageVisitSource:l().y8.FormPublicPage}):(0,g().Ay)({store:e,openInCenterPeek:o,pageVisitSource:l().y8.FormInternalPage})}function j({collectionContextStore:e,propertyId:o,questionId:t,area:s,parentModuleId:n,layoutStore:a}){var i,r;const l=e?(0,h().sl)(e):void 0,d=null==e?void 0:e.collectionViewStore(),c=null==e?void 0:e.collectionStore(),u=null==d?void 0:d.getFormat(),p=null==u||null===(i=u.form_block_pointer)||void 0===i?void 0:i.id,m=null==e||null===(r=e.normalizedSchemaStore.state)||void 0===r||null===(r=r[o])||void 0===r?void 0:r.type;if(!c)throw new Error("Collection store is undefined");return{question_type:m,question_id:t,form_id:p,is_conditional:"form_conditional_modules"===s,parent_question_type:(0,M()._N)(n,a,c),...l??{}}}function F(e){const o=null==e?void 0:e.getFormat().form_layout_pointer;if(o)return r().K.createChildStore(e,o)}const k=new(t(29923).R)({key:"opt_out_form_content_warning",namespace:t(553737).cd,important:!1,trackingType:"preference"});function q(e){const o=k.getState(),t=void 0===o||Date.now()-o>f().nD,s="file"===e.propertyType?(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.file.message",defaultMessage:"Download file?"}):(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.url.message",defaultMessage:"Open link?"}),n=(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.description",defaultMessage:"This content was submitted anonymously. Only proceed if you trust the source."}),i="file"===e.propertyType?(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.file.confirmLabel",defaultMessage:"Download anyway"}):(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.url.confirmLabel",defaultMessage:"Open anyway"});t?a().ui({showCancel:!1,showCloseButton:!0,keepFocus:!0,mode:"wide",message:(0,S.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",fontWeight:m().Wy.medium},children:s}),description:(0,S.jsx)("div",{style:{textAlign:"center",fontSize:14},children:n}),items:[{label:i,onAccept:e.onConfirm,color:"red",buttonType:"solid"}],selectionItems:[{key:"opt_out",showBelowButtons:!0,text:(0,S.jsx)("span",{style:{fontWeight:m().Wy.regular},children:(0,S.jsx)(p().sA,{id:"collectionFormHelpers.maybeWarnAboutMaliciousContent.optOut",defaultMessage:"Donâ€™t show again for 24 hours"})}),onSelect:e=>{!0===e?k.setState(Date.now()):k.setState(void 0)}}]}):e.onConfirm()}function I(e){const{environment:o,propertyType:t,propertySchema:s,isPublicForm:n}=e;if(n&&_.includes(t)){if("person"===t)return"invalid_property_type_for_public_form";if("relation"===(null==s?void 0:s.type)){const e=(0,c().Nv)(s);if(e){const t=new(i().m)(o,e);if(t.isDefined()){if(!(0,y().qw)(t))return"related_collection_not_public"}}}}}const P=(0,p().YK)({checkboxYes:{id:"FormResponseSnapshotModal.Checkbox.Yes",defaultMessage:"Yes"},checkboxNo:{id:"FormResponseSnapshotModal.Checkbox.No",defaultMessage:"No"}});function D(e){return"true"===e?n().A.formatMessage(P.checkboxYes):n().A.formatMessage(P.checkboxNo)}function N(e){const{formQuestionStore:o,propertySchema:t}=e;return(0,s().K8)((()=>{const e=null==o?void 0:o.getModel();return!(!e||!t)&&((0,d().Fi)({formQuestionModel:e,propertySchema:t})||"select"===(null==t?void 0:t.type))}),[o,t])}function W(e){const{draftFormBlockStore:o,formQuestionStore:t,propertyId:s,propertySchema:n}=e;if(!o||!s||!n)return;if("multi_select"!==n.type&&"select"!==n.type)return;const a=o.getPropertyValue(s);if("select"===n.type)return(0,u().L3)(a,n.options??[]);const i=t.getModel();if(i&&!(0,d().Fi)({formQuestionModel:i,propertySchema:n}))return;const r=(0,u().o2)(a,n.options??[]);return 1===r.length?r[0]:void 0}function L(e){var o;const{formQuestionStore:t,propertySchema:s}=e;if(s&&(0,c().lx)(s))return(null===(o=t.getPropertyTypeSpecificConfig(s.type))||void 0===o?void 0:o.displayMode)??"list"}},857047:(e,o,t)=>{t.r(o),t.d(o,{default:()=>B});t(581454);var s=t(296540),n=()=>t(484714),a=()=>t(852507),i=()=>t(792485),r=()=>t(590526),l=()=>t(401497),d=()=>t(611648),c=()=>t(107975),u=()=>t(128933),p=()=>t(127833),m=()=>t(406094),f=()=>t(160432),h=()=>t(26697),g=()=>t(820579),y=()=>t(69708),M=()=>t(100622),S=()=>t(753812),b=()=>t(376254),x=()=>t(102946),v=()=>t(564884),A=()=>t(675133),w=()=>t(584262),_=()=>t(700500),T=()=>t(201980),C=()=>t(896628),R=()=>t(44729),j=()=>t(384944),F=()=>t(185544),k=()=>t(535960),q=()=>t(244828),I=()=>t(465741);function P({environment:e,inMemoryRecordCache:o,formSnapshotData:t,currentSpaceStore:s,currentSpaceViewStore:n,handleModalClose:a}){q().createAndCommit({environment:e,userAction:"FormResponseSnapshot.saveFormResponseAsPage",canUndo:!0,perform:i=>{const r=""!==t.formTitle?(0,T().x9d)(t.formTitle):(0,T().x9d)(A().A.formatMessage(D.defaultFormResponseTitle)),l=j().Wv({environment:e,type:_().xd.page,properties:{title:r},format:{page_icon:"/icons/drafts_gray.svg"},inMemoryRecordCache:o,transaction:i,spaceId:s.id});t.questionsAndAnswers.map((t=>{const n=""!==t.question?(0,T().x9d)(t.question):(0,T().x9d)(A().A.formatMessage(D.defaultQuestion)),a=j().Wv({environment:e,type:_().xd.subHeader,properties:{title:n},inMemoryRecordCache:o,transaction:i,spaceId:s.id});R().NI({parentStore:l,childStore:a,transaction:i});const r="checkbox"===t.questionType?(0,I().Fc)(t.answer):t.answer,d=""!==t.answer?(0,T().x9d)(r):(0,T().x9d)(A().A.formatMessage(D.defaultAnswer)),c=j().Wv({environment:e,type:_().xd.text,properties:{title:d},inMemoryRecordCache:o,transaction:i,spaceId:s.id});R().NI({parentStore:l,childStore:c,transaction:i})})),F().yM({environment:e,spaceStore:s,spaceViewStore:n,pageStore:l,isPrivate:!0,transaction:i,location:{type:"prepend"}}),C()._l({environment:e,store:l,isLocked:!0,transaction:i}),(0,v().u)({environment:e,event:{eventName:"form_response_save_page",eventProperties:{page_id:l.id}}}),a(),(0,k().u)({environment:e,store:l,pageVisitSource:w().y8.FormResponseSnapshot})}})}const D=(0,y().YK)({defaultFormResponseTitle:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultPageTitle",defaultMessage:"Your form response"},defaultAnswer:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultAnswer",defaultMessage:"(No answer)"},defaultQuestion:{id:"FormResponseSnapshotModal.saveResponseAsPage.defaultQuestion",defaultMessage:"(Untitled question)"}});var N=t(474848);const W=72,L=72;function B(){const e=(0,n().v3)(),{isPhone:o}=(0,n().Y0)(),t=(0,y().tz)(),[i,m]=(0,s.useState)(void 0),[f,h]=(0,s.useState)(!1),{open:g,formResponseId:M,secretKey:v,formSpaceId:A}=(0,r().O$)(x().A),w=(0,r().K8)((()=>e.WindowSizeStore.getSafePaddingTopCSS(24)),[e]),_=(0,l().IS)((()=>({mobilePopup:{display:"flex",flexDirection:"column",alignItems:"center",height:"100%",paddingTop:w,paddingBottom:w},desktopModal:{padding:96,height:"100%",width:"100%",display:"flex",flexDirection:"column",alignItems:"center"}})),[w]);(0,a().l)((async()=>{if(!M||!v||!A)return;const o=e.currentUser.id,t=await S().callApi({eventName:"getFormResponseSnapshot",environment:e,data:{snapshotId:M,secretKey:v,spaceId:A},userId:o});"failed"!==t.type?(m(t.data.snapshotData),h(!0)):u().D6({label:(0,N.jsx)(y().sA,{defaultMessage:"There was an error loading your form response. Please contact the form creator.",id:"FormResponseSnapshotModal.Error"})})}));const T=(0,s.useCallback)((()=>{x().A.setState({open:!1,formResponseId:void 0,secretKey:void 0,formSpaceId:void 0})}),[]);return!g||f&&!i?null:o?(0,N.jsx)(p().zD,{popupType:p().nl.SlideUp,style:_.mobilePopup,open:void 0!==i,onDismiss:T,render:()=>i?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(b().H,{type:d().A.Y,style:{marginBottom:50,width:"100%"},children:(0,N.jsx)("div",{style:{padding:20,width:"100%"},children:(0,N.jsx)(Y,{formSnapshotData:i})})}),(0,N.jsx)(K,{handleModalClose:T,formSnapshotData:i})]}):null}):(0,N.jsx)(c().a,{ariaLabel:t.formatMessage({id:"FormResponseSnapshotModal.ariaLabel",defaultMessage:"Form Response"}),style:{},innerStyle:{height:`calc(100% - ${W}px*2)`,width:`calc(100% - ${L}px*2)`,maxWidth:960},open:void 0!==i,onDismiss:T,render:()=>i?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(z,{formSnapshotData:i,handleModalClose:T}),(0,N.jsx)(b().H,{type:d().A.Y,style:_.desktopModal,children:(0,N.jsx)(Y,{formSnapshotData:i})})]}):null})}function Q(){const e=`/icons/drafts_gray.svg?mode=${(0,l().eP)()}`;return(0,N.jsx)("img",{src:e,style:{height:75}})}function Y({formSnapshotData:e}){const o=(0,n().Y0)().isPhone,t=e.questionsAndAnswers??[];return(0,N.jsxs)("div",{style:{maxWidth:700,wordBreak:"break-word",marginTop:12},children:[(0,N.jsx)(Q,{}),(0,N.jsx)("h1",{style:{fontSize:o?28:40,fontWeight:700,marginBottom:42,lineHeight:1.2},children:(0,N.jsx)("span",{children:""===e.formTitle?(0,N.jsx)(y().sA,{id:"FormResponseSnapshotModal.yourResponse",defaultMessage:"Your form response"}):(0,N.jsx)(y().sA,{id:"FormResponseSnapshotModal.yourResponseToTitle",defaultMessage:"Your response to <a>{formTitle}</a>",values:{a:o=>(0,N.jsx)("a",{href:e.formUrl,style:{color:M().Tj.grayButtonPressedBackground,cursor:"pointer"},children:o}),formTitle:e.formTitle}})})}),(0,N.jsx)("div",{children:t.map(((e,o)=>(0,N.jsx)(V,{questionAndAnswer:e},o)))})]})}function V({questionAndAnswer:e}){const o=""===e.question?(0,N.jsx)(y().sA,{defaultMessage:"(Untitled question)",id:"FormResponseSnapshotModal.Question.defaultQuestion"}):e.question,t="checkbox"===e.questionType?(0,I().Fc)(e.answer):e.answer;return(0,N.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginBottom:25},children:[(0,N.jsx)("span",{style:{fontSize:24,fontWeight:600},children:o}),(0,N.jsx)("span",{style:{fontSize:16,fontWeight:400,marginTop:6,wordWrap:"break-word"},children:""!==t?t:(0,N.jsx)(y().sA,{defaultMessage:"(No answer)",id:"FormResponseSnapshotModal.Answer.defaultAnswer"})})]})}function z({formSnapshotData:e,handleModalClose:o}){const t=(0,n().v3)(),a=(0,i().S)(),r=(0,s.useCallback)((()=>{const s=null==a?void 0:a.spaceStore,n=null==a?void 0:a.spaceViewStore;s&&n&&P({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,formSnapshotData:e,currentSpaceStore:s,currentSpaceViewStore:n,handleModalClose:o})}),[t,e,o,null==a?void 0:a.spaceStore,null==a?void 0:a.spaceViewStore]);return(0,N.jsx)(h().m,{placement:"bottom",renderTooltip:()=>(0,N.jsx)(y().sA,{defaultMessage:"Save a copy of your response to your private section",id:"FormResponseSnapshotModal.ActionButtons.SavePage.tooltip"}),render:e=>(0,N.jsx)("div",{style:{position:"absolute",top:10,insetInlineEnd:10,zIndex:2},children:(0,N.jsx)(m().A,{size:"lg",iconLeading:{icon:g().arrowLineDownIcon,colorVariant:"secondary"},onClick:r,...e,children:(0,N.jsx)(y().sA,{defaultMessage:"Save page",id:"FormResponseSnapshotModal.ActionButtons.SavePage"})})})})}function K({handleModalClose:e,formSnapshotData:o}){const t=(0,n().v3)(),a=(0,i().S)(),r=(0,s.useCallback)((()=>{const s=null==a?void 0:a.spaceStore,n=null==a?void 0:a.spaceViewStore;s&&n&&P({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,formSnapshotData:o,currentSpaceStore:s,currentSpaceViewStore:n,handleModalClose:e})}),[t,o,e,null==a?void 0:a.spaceStore,null==a?void 0:a.spaceViewStore]),d=(0,l().IS)((()=>({actionButtons:{height:47,width:"50%",fontSize:17,borderRadius:12}})),[]);return(0,N.jsxs)("div",{style:{display:"flex",width:"100%",position:"absolute",bottom:10,gap:12,zIndex:2,paddingInlineStart:10,paddingInlineEnd:10,paddingBottom:40},children:[(0,N.jsx)(f().A,{colorPalette:"blue",onClick:r,style:{...d.actionButtons,justifyContent:"center"},children:(0,N.jsx)(y().sA,{defaultMessage:"Save",id:"FormResponseSnapshotModal.Mobile.SavePage"})}),(0,N.jsx)(m().A,{size:"lg",onClick:e,style:d.actionButtons,children:(0,N.jsx)(y().sA,{defaultMessage:"Close",id:"FormResponseSnapshotModal.Mobile.Close"})})]})}}}]);