"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[35756],{31902:(e,t,o)=>{o.d(t,{A:()=>l});o(296540);var n=()=>o(69708),i=o(474848);const l=function({collectionViewName:e,collectionViewType:t}){return(0,o(59226).X)("allow_empty_view_name")&&""===e?null:e?(0,i.jsx)(o(288722).A,{children:e}):"page"===t?(0,i.jsx)(n().sA,{id:"database.collectionView.untitledName.untitled",defaultMessage:"Untitled"}):(0,i.jsx)(n().sA,{...o(403905).X[t]})}},92253:(e,t,o)=>{o.d(t,{i:()=>c});o(18107),o(967357),o(898992),o(354520),o(581454);var n=()=>o(569797),i=()=>o(448801),l=()=>o(869558),r=()=>o(496603),s=()=>o(722101);function c(e){const{collectionViewBlockStore:t,newViewIds:o,transaction:c}=e,a=t.getCollectionViewStores(),{beforeOps:u}=(0,i().i)(a.map((e=>e.id)).slice(0,o.length),o);r().jJ(u,((e,i)=>{const r=n().p.createChildStore(t,{table:l().Gy,id:i,spaceId:t.getSpaceId()});if(e)s().nc({parentStore:t.getCollectionViewsStore(),insertStore:r,beforeStore:n().p.createChildStore(t,{table:l().Gy,id:e,spaceId:t.getSpaceId()}),transaction:c});else{const e=o.filter((e=>e!==i)).at(-1);s().WH({parentStore:t.getCollectionViewsStore(),insertStore:r,afterStore:e?n().p.createChildStore(t,{table:l().Gy,id:e,spaceId:t.getSpaceId()}):void 0,transaction:c})}}))}},152077:(e,t,o)=>{o.d(t,{Vs:()=>a,WA:()=>c,YU:()=>u,bO:()=>r,lU:()=>s});var n=o(296540),i=o(474848);const l=n.createContext(void 0);function r(e){return(0,i.jsx)(l.Provider,{value:e.surface,children:e.children})}function s(){return n.useContext(l)}function c(){const e=s();return"TeamHome"===e||"PersonalHome"===e}function a(){return void 0===s()}function u(){return a()?12:0}l.displayName="PostFeedSurfaceContext"},244407:(e,t,o)=>{o.d(t,{q:()=>b});var n=o(296540),i=()=>o(590526),l=()=>o(401497),r=()=>o(807449),s=()=>o(26697),c=()=>o(62616),a=()=>o(340498),u=()=>o(69708),d=()=>o(100622),p=()=>o(206372),S=()=>o(908201),v=()=>o(562969),w=()=>o(187820),m=()=>o(205981),g=()=>o(635462),f=()=>o(680288),h=()=>o(999140),x=()=>o(745266),y=o(474848);function b(e){const{collectionViewStore:t,placement:o}=e,b=(0,S().ET)(),A=(0,u().tz)(),j=(0,i().K8)((()=>{const e=t.getParentBlockStore();return Boolean(null==e?void 0:e.hasSingleSourceAndNoLinkedCollections())}),[t]),V=(0,i().K8)((()=>b.isMultiSourceViewFromStoreState),[b]),k=(0,i().K8)((()=>{var e;const o=null===(e=t.getParentBlockStore())||void 0===e?void 0:e.id;return!!o&&((0,g().s)(o)&&b.isInHomeWidgetStore.state)}),[b.isInHomeWidgetStore,t]),B=(0,i().K8)((()=>{if(!j)return;const e=t.getName(),o=t.getType(),n=(0,h().OO)({collectionViewName:e,collectionViewType:o});if(!o)return{tooltipFirstLine:n,tooltipSecondLine:void 0};const i=t.getFormat().description;if(i)return{tooltipFirstLine:n,tooltipSecondLine:i};const l=t.getCollectionStore();if(l){var r,s;const e=(0,v().getCollectionNameOrDefault)({intl:A,collectionStore:l});if((null===(r=l.getParentBlockStore())||void 0===r?void 0:r.id)===(null===(s=t.getParentBlockStore())||void 0===s?void 0:s.id))return{tooltipFirstLine:n,tooltipSecondLine:(0,y.jsx)(u().sA,{defaultMessage:"{viewType, select, Table {Table view of {collection}} Board {Board view of {collection}} Timeline {Timeline view of {collection}} Calendar {Calendar view of {collection}} List {List view of {collection}} Gallery {Gallery view of {collection}} Form {Form} Chart {Chart view of {collection}} other {collection}}",id:"collectionTabBar.viewTab.tooltip",values:{viewType:f().to[o],collection:e}},"viewTab.tooltip.2")}}return{tooltipFirstLine:n,tooltipSecondLine:(0,y.jsx)(u().sA,{id:"collectionTabBar.viewTab.tooltip.default",defaultMessage:"{viewType} view",values:{viewType:f().to[o]}},"viewTab.tooltip.2")}}),[t,A,j],{useDeepEqual:!0}),T=(0,i().K8)((()=>{if(j)return;const e=t.getCollectionStore(),o=(0,v().getCollectionNameOrDefault)({intl:A,collectionStore:e}),n=t.getName(),i=t.getType()??"table",l=t.getFormat().collection_view_icon,s=t.getFormat().description,u=(0,h().OO)({collectionViewName:n,collectionViewType:i}),d=null==e?void 0:e.getIcon();return{dataSourceIcon:d?(0,y.jsx)(w().B6,{disabled:!0,bucket:"secure",store:e,icon:d,iconRecordCategory:"collection",isEmptyPage:!1,size:a().Ev.sm}):(0,y.jsx)(r().I,{icon:c().c,size:"sm"}),dataSourceName:o,viewType:i,viewIcon:l,viewTitle:u,viewDescription:s,collectionStore:e}}),[t,A,j],{useDeepEqual:!0}),M=(0,i().K8)((()=>{var e;const o=t.getCollectionStore(),n=t.getParentBlockStore();return o&&n&&(null===(e=o.getParentBlockStore())||void 0===e?void 0:e.id)!==n.id}),[t]),I=(0,l().IS)((()=>({tooltip:k?{marginBottom:-5,marginInlineStart:8}:j?{}:{padding:"8px 10px"},tooltipSecondLine:{color:d().Tj.text.inverseSecondary},collectionViewSection:{color:d().Tj.text.inverseSecondary,marginTop:6},row:{display:"flex",alignItems:"flex-start",gap:5},viewTextContainer:{display:"flex",flexDirection:"column"},homeOffset:{marginInlineStart:-8},iconContainer:{position:"relative",display:"inline-flex"}})),[k,j]),{render:L}=e,_=(0,n.useCallback)((e=>k?(0,y.jsx)("div",{style:I.homeOffset,children:L(e)}):L(e)),[k,L,I.homeOffset]),D=(0,n.useCallback)((e=>{if(k||V)return(0,y.jsx)(u().sA,{id:"collectionTabBar.myTasksWidget.tooltip",defaultMessage:"See all your tasks in one place"});if(B)return(0,y.jsxs)("div",{...e,style:p().Q$,children:[B.tooltipFirstLine,(0,y.jsx)("div",{style:I.tooltipSecondLine,children:B.tooltipSecondLine})]});if(T){const{dataSourceIcon:t,dataSourceName:o,viewType:n,viewIcon:i,viewTitle:l,viewDescription:r}=T;return(0,y.jsxs)("div",{...e,style:p().Q$,children:[(0,y.jsxs)("div",{style:I.row,children:[(0,y.jsxs)("div",{style:I.iconContainer,children:[t,M?(0,y.jsx)(m().H,{size:"xxs"}):void 0]}),(0,y.jsx)("div",{children:o})]}),(0,y.jsxs)("div",{style:{...I.row,...I.collectionViewSection},children:[(0,y.jsx)(C,{}),(0,y.jsx)(x().h,{color:"light",viewType:n,viewIcon:i,size:a().Ev.sm,shouldUseNoticon:!0}),(0,y.jsxs)("div",{style:I.viewTextContainer,children:[(0,y.jsx)("div",{children:l}),r?(0,y.jsx)("div",{children:r}):void 0]})]})]})}}),[k,V,B,T,M,I.tooltipSecondLine,I.row,I.collectionViewSection,I.viewTextContainer,I.iconContainer]);return(0,y.jsx)(s().m,{placement:o??(k?"top":"bottom"),originGap:k?0:void 0,alignment:"start",delayThreshold:500,style:I.tooltip,render:_,renderTooltip:D})}function C(){const e=(0,l().IS)((()=>{const e=a().Ev.sm;return{svg:{width:e,height:e,fill:"none",marginTop:2,marginInlineStart:4},rect:{width:e,height:e},path:{stroke:"white",strokeOpacity:"0.283",strokeWidth:"1.5",strokeLinecap:"round"}}}),[]);return(0,y.jsxs)("svg",{style:e.svg,children:[(0,y.jsx)("rect",{style:e.rect}),(0,y.jsx)("path",{d:"M2.5 1V5.5C2.5 7.70914 4.29086 9.5 6.5 9.5H11",style:e.path})]})}},343630:(e,t,o)=>{o.d(t,{k:()=>r});o(296540);var n=()=>o(69708),i=()=>o(534177),l=o(474848);function r({canAddCollectionResult:e}){if(!e||e.canAddView)return null;switch(e.reason){case"tooManyViews":return(0,l.jsx)(n().sA,{defaultMessage:"You are at the maximum number of views for this database.",id:"collectionTabBar.newDataSource.tooltip.tooManyViews"});case"tooManyCollections":return(0,l.jsx)(n().sA,{defaultMessage:"You are at the maximum number of data sources for this database.",id:"collectionTabBar.newDataSource.tooltip.tooManyDataSources"});default:throw(0,i().HB)(e.reason)}}},375555:(e,t,o)=>{function n(e,t){const{device:o}=e;o.isAndroid&&t.focus(),t.select()}o.d(t,{G:()=>n})},419357:(e,t,o)=>{o.d(t,{Ay:()=>x,KF:()=>h,LG:()=>m,Zf:()=>f,yD:()=>g});var n=o(296540),i=()=>o(484714),l=()=>o(401497),r=()=>o(718827),s=()=>o(695115),c=()=>o(31511),a=()=>o(546926),u=()=>o(424400),d=()=>o(340498),p=()=>o(100622),S=()=>o(496603),v=()=>o(284371),w=o(474848);const m=30,g=28;function f(e){const{icon:t}=e;return t({fill:p().Tj.icon.secondary,width:d().Ev.sm,height:d().Ev.sm,flexGrow:0,flexShrink:0})}function h(e){const t=(0,i().WS)(),o=(0,l().eP)(),n=(0,l().IS)((()=>({outlineButton:{...(0,r().qq)({shape:"default",size:"sm",hasIconOnly:!0,isButtonGapEnabled:!0}),fontWeight:v().Wy.medium,lineHeight:1.2,border:`1px solid ${p().Tj.border.primaryTranslucent}`,background:e.hasBackground?p().Tj.background.primary:void 0},outlineButtonHovered:{background:p().Tj.background.secondary},outlineButtonPressed:{background:(0,r().yZ)({color:p().Tj.background.primary,mode:o})}})),[e.hasBackground,o]);return(0,w.jsx)(s().A,{size:"xs",colorVariant:"primary",...e,ariaLabel:e.ariaLabel,style:{...n.outlineButton,...e.style,height:t?m:g,width:t?m:g},hoveredStyle:n.outlineButtonHovered,pressedStyle:n.outlineButtonPressed})}const x=n.forwardRef((function({preventCaptureArrowShortcuts:e,preventCaptureDeleteWhenEmpty:t,preventCaptureClipboardShortcuts:i,preventCaptureSpacebarWhenEmpty:l,...r},s){const{left:c,right:d,inputLeft:p,inputRight:v,inputRightStyle:m,disableInput:g,inputOuterStyle:f,rightMobileEditLabel:h,mobileKeyboardOnDismiss:x,style:y,value:A,onChange:j,autosize:V,autosizeMinHeight:k,autosizeMaxHeight:B,customElementAttributes:T,disabled:M,format:I,id:L,placeholder:_,type:D,autoFocus:F,focus:E,focusInitial:O,focusAfterAnimation:P,forceShowClearButton:R,ignoreKeyboardMode:K,inputElementAttributes:H,inputStyle:N,isRightLastElementOfInput:W,maxlength:z,min:q,max:G,selectAll:$,showClearButton:U,suppressFocusRing:Y,textarea:X,textareaSubmitOnEnter:Z,onBlur:J,onCancel:Q,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:ie,...le}=r,[re,se]=(0,n.useState)((()=>Boolean(E||O)));(0,n.useEffect)((()=>{void 0!==E&&se(E)}),[E]);const ce=e?void 0:S().D_,ae=!t||A.length>0?S().D_:void 0,ue=i?void 0:S().D_,de=!l||A.length>0?S().D_:void 0,pe=(0,a().Tf)(),Se=(0,n.useContext)(a().xu),ve=(0,n.useRef)(null),we={value:A,onChange:j,autosize:V,autosizeMinHeight:k,autosizeMaxHeight:B,customElementAttributes:T,disabled:M,format:I,id:L,placeholder:_,type:D,autoFocus:F,focus:E,focusInitial:O,focusAfterAnimation:P,forceShowClearButton:R,ignoreKeyboardMode:K,inputElementAttributes:H,inputStyle:N,isRightLastElementOfInput:W,maxlength:z,min:q,max:G,selectAll:$,showClearButton:U,suppressFocusRing:Y,textarea:X,textareaSubmitOnEnter:Z,onBlur:J,onCancel:Q,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:ie};return(0,w.jsx)(o(782482).N,{debugName:"InputMenuItem",capture:!0,onUntab:S().D_,onTab:S().D_,onSelectAll:S().D_,onRedo:S().D_,onUndo:S().D_,onToggleBold:S().D_,onToggleItalics:S().D_,onToggleCode:S().D_,onCut:ue,onCopy:ue,onPaste:ue,onKeypress:S().D_,onLeft:ce,onRight:ce,onDelete:ae,onBackspace:ae,onSpace:de,children:o(726637).A.isMobile?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u().Ay,{ref:s,...le,itemMarginLeft:pe?8:void 0,style:y,title:(0,w.jsx)(C,{ref:ve,left:c,right:d,inputLeft:p,inputRight:v,inputRightStyle:m,disableInput:g,inputOuterStyle:f,rightMobileEditLabel:h,isFocused:re,setIsFocused:se,...we})}),(0,w.jsx)(o(797324).A,{show:re&&Se.menuType!==a().gu.ActionSheet,onDismiss:x,inputRef:ve})]}):(0,w.jsx)(u().Ay,{ref:s,...le,left:c,right:d,isTokenTitle:!0,title:(0,w.jsx)(b,{ref:ve,disableInput:g,inputOuterStyle:f,inputRight:v,inputRightStyle:m,inputLeft:p,...we}),style:{paddingTop:4,paddingBottom:4,...y}})})}));function y({rightMobileEditLabel:e,inputRef:t}){const l=(0,i().v3)(),s=(0,n.useCallback)((e=>{e.preventDefault();const n=t.current;n&&(0,o(375555).G)(l,n)}),[l,t]);return(0,w.jsx)(r().Ay,{onClick:s,style:{color:p().Tj.text.secondary},children:e})}const b=n.forwardRef((function(e,t){const{disabled:o,disableInput:n,inputOuterStyle:i,inputRight:l,inputRightStyle:r,inputLeft:s,min:a,textarea:u,...d}=e;return(0,w.jsx)(c().A,{...d,ref:t,disabled:o||n,style:{height:u?void 0:28,padding:"3px 6px",...i},left:s,right:l,rightStyle:r,min:a,textarea:u})})),C=n.forwardRef((function(e,t){const{left:i,right:l,inputLeft:r,inputRight:s,inputRightStyle:a,disableInput:u,inputOuterStyle:d,rightMobileEditLabel:p,isFocused:S,setIsFocused:v,disabled:m,showClearButton:g,onBlur:f,onFocus:h,...x}=e,b=(0,n.useCallback)((e=>{v(!1),f&&f(e)}),[f,v]),C=(0,n.useCallback)((e=>{v(!0),h&&h(e)}),[h,v]),A=(0,n.useRef)(null),j=(0,o(93583).A)(A,t),V=p&&!S?(0,w.jsx)(y,{rightMobileEditLabel:p,inputRef:A}):null;return(0,w.jsx)(c().A,{...x,ref:j,format:"transparent",style:{fontSize:16,...d},onFocus:C,onBlur:b,showClearButton:!1!==g,disabled:m||u,left:r||i,right:V||s||l,rightStyle:a})}))},445689:(e,t,o)=>{o.r(t),o.d(t,{CollectionViewSelect:()=>K});o(898992),o(354520),o(581454);var n=o(296540),i=()=>o(726637),l=()=>o(484714),r=()=>o(590526),s=()=>o(127833),c=()=>o(250910),a=()=>o(118307),u=()=>o(807449),d=()=>o(546926),p=()=>o(81068),S=()=>o(663639),v=()=>o(736847),w=()=>o(480034),m=()=>o(69708),g=()=>o(100622),f=()=>o(496603),h=()=>o(430923),x=()=>o(274652),y=()=>o(152077),b=()=>o(635462),C=()=>o(621866),A=()=>o(271205),j=()=>o(244828),V=()=>o(92253),k=()=>o(999140),B=()=>o(383036),T=()=>o(695115),M=()=>o(126617),I=()=>o(340498),L=()=>o(804666),_=()=>o(939556),D=()=>o(745266),F=()=>o(244407),E=()=>o(31902),O=o(474848);function P(e){const{collectionContextStore:t,collectionViewStore:o,menuListItemProps:l,onClose:s}=e,u=(0,m().tz)(),d=(0,r().uB)(void 0,a().A),S=(0,y().WA)(),[v,w,g,f]=(0,r().K8)((()=>[o.getName(),o.getType(),o.getFormat().collection_view_icon,t.permissionScopesStore.state.canConfigureBlock&&!S]),[o,t,S]),h=(0,n.useCallback)((e=>{d.setState({open:!1}),e&&s()}),[d,s]),{renderMenu:x}=(0,_().y)({collectionViewStore:o,collectionContextStore:t,onClose:h}),b=(0,r().K8)((()=>{var e;if(!t.isInLibraryBlock())return;const n=null==o||null===(e=o.getCollectionSource())||void 0===e?void 0:e.type;return(0,L().a0)(n)?n:void 0}),[t,o]);return void 0===w?null:(0,O.jsx)(F().q,{collectionViewStore:o,render:e=>(0,O.jsx)(p().A,{title:(0,O.jsx)(E().A,{collectionViewType:w,collectionViewName:v}),icon:(0,O.jsx)(D().h,{color:"regular",viewIcon:g,viewType:w,libraryViewSource:b}),showDragHandle:!i().A.isMobile&&f,right:f?(0,O.jsx)(c().A,{popupType:i().A.isMobile?c().z.BottomSheet:c().z.Popup,renderOrigin:e=>(0,O.jsx)(T().A,{icon:M().ellipsisSmallIcon,iconStyle:{width:I().Ev.sm,height:I().Ev.sm},ariaLabel:u.formatMessage({id:"collectionViewSelectItem.viewSettings.ariaLabel",defaultMessage:"Database view settings"}),...e}),render:x,buttonPopupStore:d}):null,rightStyle:{marginInlineEnd:8},...(0,B().A)(e,l)}),placement:"left"})}function R(e){const{collectionContextStore:t,onClose:i,onViewClick:s}=e,c=(0,m().tz)(),u=(0,l().v3)(),p=(0,l().Y0)(),[w,g]=n.useState(0),[h,x]=n.useState(""),[b,C]=(0,o(791177).$)(),A=(0,r().uB)(void 0,a().A),j=(0,r().uB)(void 0,o(452004).$),V=(0,y().WA)(),B=(0,r().K8)((()=>{var e;return!(p.isPhone||null!==(e=t.collectionViewBlockStore())&&void 0!==e&&e.isCollectionViewPageWithContent()||V)}),[t,p.isPhone,V]),T=(0,r().K8)((()=>{var e;const n=(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.getCollectionViewStores())??[],i=t.isInLibraryBlock();return n.filter((e=>!(0,o(462402).p)({viewStore:e,viewIsInLibrary:i})&&(0,k().As)(e,h)))}),[t,h]),M=(0,r().K8)((()=>t.permissionScopesStore.state.canConfigureBlock&&!V),[t,V]),I=!p.isPhone&&M&&""===h,L=(0,r().K8)((()=>!(0,k().NB)(t)),[t]),_=(0,r().K8)((()=>z(t)),[t]),D=(0,r().K8)((()=>"viewsMain"!==t.viewsModuleContextStore.getViewModuleType()&&!t.isInLibraryBlock()&&!t.isEditableHomeCollectionStore.state),[t]),F=n.useCallback((e=>{x(e.target.value),j.setState({...j.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}),[j]),E=n.useCallback(((e,n)=>{const l=t.collectionViewStore(),r=(0,o(381175).V)(e);l&&s({currentCollectionViewStore:l,newCollectionViewStore:n,openInNew:r});const c=t.isFullScreenStore.state,a=t.isRootChildStore.state,d=t.isInPeekRendererStore.state;(0,o(180762).t)({environment:u,collectionContextStore:t,collectionViewId:n.id,openInNew:r,isFullScreen:c,isRootChild:a,isInPeekRenderer:d}),(0,o(436696).X)({environment:u,collectionContextStore:t,action:"click_view_in_dropdown",new_view_type:n.getType(),new_view_id:n.id}),r||i()}),[t,u,s,i]);n.useEffect((()=>{var e,o;const n=null===(e=t.collectionViewStore())||void 0===e?void 0:e.id,i=((null===(o=t.collectionViewBlockStore())||void 0===o?void 0:o.getCollectionViewStores())||[]).findIndex((e=>e.id===n));i>=0&&g(i)}),[t]);const P=(0,n.useMemo)((()=>o(206267).JW()),[]),R=T.map((e=>({key:e.id,render:o=>(0,O.jsx)(W,{collectionContextStore:t,onClose:i,collectionViewStore:e,props:o}),action:({event:t})=>{E(t,e)}}))),K=T.length>0?{key:"views",render:e=>(0,O.jsx)(N,{menuListSectionProps:e,collectionContextStore:t,filteredViewStores:T,isDraggable:I,menuListStore:j}),items:R}:void 0,G=h&&0===T.length?{key:"noResults",render:e=>(0,O.jsx)(v().A,{...e}),items:[{key:"noResults",action:()=>{},render:e=>(0,O.jsx)(o(736767).A,{caption:(0,O.jsx)(m().sA,{defaultMessage:"No results",id:"database.collectionViewSelect.noResultsTitle"})})}]}:void 0,$=(0,o(589522).Q)({collectionContextStore:t,environment:u,onAction:i,analytics:{from:"addNewDatabaseButtonInViewOverflowMenu",dataSourceFrom:"view_creation",dataSourceSessionId:P}}),U=(0,r().K8)((()=>{var e;return(null===(e=t.collectionViewBlockStore())||void 0===e?void 0:e.canAddCollectionView())??!1}),[t]),Y=(0,f().oE)([_?{key:"newView",action:()=>{A.setState({open:!0})},render:e=>(0,O.jsx)(o(26697).m,{render:o=>(0,O.jsx)(q,{...e,...o,disabled:!U,disabledFeedback:!U,buttonPopupStore:A,collectionContextStore:t,onClose:i,shouldShowFormButton:L}),placement:"right",disableTooltip:U,renderTooltip:()=>(0,O.jsx)(o(343630).k,{canAddCollectionResult:{canAddView:U,reason:"tooManyViews"}})})}:void 0,D?$:void 0]),X=M&&Y.length>0?{key:"config",render:e=>(0,O.jsx)(v().A,{topBorder:!0,...e}),items:Y}:void 0;return(0,O.jsx)(o(933922).A,{capture:!0,allowEsc:!0,render:e=>{let n;return n=p.isPhone?{menuType:d().gu.Modal,title:(0,O.jsx)(H,{collectionContextStore:t}),right:(0,O.jsx)(m().sA,{...o(245720).W.done}),onClickRight:i}:{menuType:d().gu.Popup,minWidth:290,maxWidth:320,maxHeight:"50vh"},(0,O.jsx)(o(890492).A,{...n,...e,header:B?(0,O.jsx)(v().A,{disableDesktopPadding:!0,children:(0,O.jsx)(o(419357).Ay,{value:h,focus:!p.isPhone,style:{marginTop:8,marginBottom:4},textWrapperStyle:{marginInlineStart:8,marginInlineEnd:8},onChange:F,placeholder:c.formatMessage({defaultMessage:"Search for a view...",id:"collectionViewSelect.viewSearch.label"}),...b})}):null,children:(0,O.jsx)(S().A,{type:S().O.Vertical,initialFocus:w,sections:(0,f().oE)([K,G,X]),store:j,comboboxProps:C})})}})}const K=n.memo(R);function H({collectionContextStore:e}){const t=(0,r().K8)((()=>{var t;return(null===(t=e.collectionViewBlockStore())||void 0===t?void 0:t.getCollectionViewStores())||[]}),[e]);return(0,O.jsx)(m().sA,{defaultMessage:"{numberOfViews, plural, one {{numberOfViews} view} other {{numberOfViews} views}}",id:"database.mobileSelectViewMenu.title",values:{numberOfViews:t.length}})}function N(e){const t=(0,l().v3)(),o=(0,r().K8)((()=>e.filteredViewStores.map((e=>e.id))),[e.filteredViewStores]),i=n.useCallback(((o,n)=>{const i=e.collectionContextStore.collectionViewBlockStore();i&&(j().createAndCommit({userAction:"CollectionViewSelect2.handleViewsDrop",environment:t,canUndo:!0,perform:e=>{(0,V().i)({collectionViewBlockStore:i,newViewIds:o,transaction:e})}}),e.menuListStore.reset())}),[t,e.collectionContextStore,e.menuListStore]);return e.isDraggable?(0,O.jsx)(v().A,{...e.menuListSectionProps,children:(0,O.jsx)(A().Ay,{direction:"vertical",keys:o,renderKey:t=>e.menuListSectionProps.children[o.indexOf(t)],onDrop:i})}):(0,O.jsx)(v().A,{...e.menuListSectionProps})}function W({collectionViewStore:e,props:t,collectionContextStore:o,onClose:n}){return(0,O.jsx)(P,{collectionContextStore:o,collectionViewStore:e,onClose:n,menuListItemProps:t})}function z(e){var t;if(!e.permissionScopesStore.state.canConfigureBlock)return!1;return!(0,b().s)((null==e||null===(t=e.collectionViewBlockStore())||void 0===t?void 0:t.id)??"")&&!e.isInLibraryBlock()}function q(e){const{collectionContextStore:t,onClose:o,shouldShowFormButton:n,...i}=e,a=(0,l().Y0)(),u=(0,r().K8)((()=>z(e.collectionContextStore)),[e.collectionContextStore]),d=(0,r().K8)((()=>"viewsMain"===e.collectionContextStore.viewsModuleContextStore.getViewModuleType()),[e.collectionContextStore]);return u?d?(0,O.jsx)(C().i,{renderOrigin:e=>(0,O.jsx)(G,{...e,...i,onClick:()=>e.onClick()}),onClose:e.onClose}):(0,O.jsx)(c().A,{buttonPopupStore:e.buttonPopupStore,popupType:a.isPhone?s().nl.SlideUp:s().nl.Popup,alignmentToOrigin:"center",placementToOrigin:"right",renderOrigin:e=>(0,O.jsx)(G,{...e,...i}),render:t=>(0,O.jsx)(h().zS,{collectionContextStore:e.collectionContextStore,onClose:()=>{e.onClose(),t.close()},hideAddDataSource:!0})}):null}function G(e){const t=(0,O.jsx)(m().sA,{defaultMessage:"New view",id:"database.collectionViewSelect.newViewButton.title"});return i().A.isMobile?(0,O.jsx)(p().A,{...e,title:t,caption:(0,O.jsx)(m().sA,{defaultMessage:"Table, chart, form and more",id:"database.collectionViewSelect.newViewButton.caption"}),icon:(0,O.jsx)(u().I,{icon:w().q,style:{fill:g().oZ.blue}})}):(0,O.jsx)(x().o,{...e,title:t,color:"primary"})}},462402:(e,t,o)=>{o.d(t,{p:()=>r});var n=()=>o(907258),i=()=>o(47373),l=()=>o(288157);function r(e){var t;const{viewStore:o,viewIsInLibrary:r}=e,s=null===(t=o.getFormat())||void 0===t||null===(t=t.collection_view_source)||void 0===t?void 0:t.type;if(!r)return!1;if("teamspaceDirectory"===s&&!(0,l().a1)())return!0;if("libraryExternalPages"===s&&!(0,l().un)())return!0;const c=n().AppStoreSidebarSpaceViewStore.state;return!("myMeetings"!==s||c&&(0,i().pe)(c))}},480034:(e,t,o)=>{o.d(t,{q:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,o(474848).jsx)("path",{d:"M10 2.375a7.625 7.625 0 1 0 0 15.25 7.625 7.625 0 0 0 0-15.25m0 4c.345 0 .625.28.625.625v2.375H13a.625.625 0 1 1 0 1.25h-2.375V13a.625.625 0 1 1-1.25 0v-2.375H7a.625.625 0 1 1 0-1.25h2.375V7c0-.345.28-.625.625-.625"})},i=(0,o(340498).wt)("plusCircleFill",n,"fill")},589522:(e,t,o)=>{o.d(t,{Q:()=>S});o(296540);var n=()=>o(590526),i=()=>o(807449),l=()=>o(26697),r=()=>o(81068),s=()=>o(904789),c=()=>o(69708),a=()=>o(985156),u=()=>o(244828),d=()=>o(343630),p=o(474848);function S({environment:e,collectionContextStore:t,onAction:o,analytics:S}){const v=(0,n().K8)((()=>{var e;return null===(e=t.collectionStore())||void 0===e?void 0:e.isPageTreeCollection()}),[t]),w=(0,n().O$)(t.isInHomeWidgetStore),m=(0,n().K8)((()=>t.collectionViewBlockStore()),[t]),g=(0,n().K8)((()=>null==m?void 0:m.canAddCollection()),[m]),f=!(null!=g&&g.canAddView),h=(0,n().K8)((()=>null==m?void 0:m.hasAnySyncedCollection()),[m]);if(!(v||w||h))return{key:"newDataSource",render:e=>(0,p.jsx)(l().m,{render:t=>(0,p.jsx)(r().A,{title:(0,p.jsx)(c().sA,{defaultMessage:"New data source",id:"collectionTabBar.newDataSource.title"}),disabled:f,disabledFeedback:f,icon:(0,p.jsx)(i().I,{icon:s().squareOnSquarePlusIcon}),...e,...t}),placement:"right",renderTooltip:()=>(0,p.jsx)(d().k,{canAddCollectionResult:g}),disableTooltip:!f}),action:()=>{u().createAndCommit({environment:e,userAction:"createAndFocusNewDataSource",canUndo:!0,perform:o=>{(0,a().n)({environment:e,collectionContextStore:t,transaction:o,analytics:S})}}),null==o||o()}}}},621866:(e,t,o)=>{o.d(t,{i:()=>l});var n=()=>o(79926);const i={ConfigureViewsMainModuleAddViewButton:new(n().O2)("ConfigureViewsMainModuleAddViewButton",(async()=>await Promise.all([o.e(75134),o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(96346),o.e(44711),o.e(53321),o.e(51220),o.e(62475),o.e(3151),o.e(98629),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(14578),o.e(87017),o.e(34877),o.e(46414),o.e(11676),o.e(61165),o.e(47668),o.e(94522),o.e(24587),o.e(44584),o.e(67494),o.e(10522),o.e(38293),o.e(40992),o.e(88455),o.e(63515),o.e(33893),o.e(55162),o.e(91793),o.e(32370),o.e(26264),o.e(97989),o.e(36437),o.e(55113),o.e(25588),o.e(6769),o.e(23640),o.e(72252),o.e(93134),o.e(29351),o.e(93049),o.e(18636),o.e(64242),o.e(39986),o.e(76677),o.e(68609),o.e(37384),o.e(79340),o.e(72659),o.e(37759),o.e(41423),o.e(3261),o.e(23371),o.e(17729),o.e(94995),o.e(98339),o.e(51240),o.e(81803),o.e(68643),o.e(32625),o.e(95885),o.e(11424),o.e(40119),o.e(88522),o.e(69668),o.e(92924),o.e(92192),o.e(80326),o.e(53352),o.e(73069),o.e(88208)]).then(o.bind(o,965731))))},l=(0,n()._h)(i.ConfigureViewsMainModuleAddViewButton,(e=>e.ConfigureViewsMainModuleAddViewButton))},637096:(e,t,o)=>{o.d(t,{W:()=>u});var n=o(296540),i=()=>o(907258),l=()=>o(484714),r=()=>o(590526),s=()=>o(365917),c=()=>o(40970),a=()=>o(645200);function u(e){const{collectionContextStore:t,entrypoint:o}=e,u=(0,l().v3)(),d=(0,r().O$)(i().AppStoreSidebarSpaceStore),p=(0,r().O$)(s().X);return(0,n.useCallback)((()=>{const e=t.collectionViewStore(),n=t.collectionStore(),i=null==n?void 0:n.getParentBlockStore();e&&n&&i&&d&&(c().tC(u,{is_calendar_connected:p,collection_id:n.id,collection_view_id:e.id,collection_view_block_id:i.id,entrypoint:o}),a().Op({environment:u,collectionViewStore:e,spaceStore:d,from:"openInCalendarButton"}))}),[u,t,d,p,o])}},736767:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(296540),i=o(474848);function l(e,t){return(0,i.jsx)(o(424400).Ay,{...e,ref:t,style:{background:"none",borderBottom:"none",boxShadow:"",marginTop:2,marginBottom:6,paddingTop:4,paddingBottom:4,minHeight:"none",...e.style}})}const r=(0,n.forwardRef)(l)},791177:(e,t,o)=>{o.d(t,{$:()=>i});var n=o(296540);function i(){const[e,t]=(0,n.useState)({inputElementAttributes:void 0,suppressFocusRing:!1}),[o,i]=(0,n.useState)(!1),[l,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(o){function e(){r(!1)}function t(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||r(!0)}return window.addEventListener("pointerdown",e),window.addEventListener("keydown",t),()=>{window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",t)}}}),[o]);return[(0,n.useMemo)((()=>({inputElementAttributes:e.inputElementAttributes,suppressFocusRing:e.suppressFocusRing&&l,onFocus:()=>{i(!0)},onBlur:()=>{i(!1)}})),[e,l]),(0,n.useMemo)((()=>({setComboboxState:t,isFocusVisible:l,isComboboxFocused:o,onItemHover:()=>{r(!1)}})),[l,o])]}},797324:(e,t,o)=>{o.d(t,{A:()=>w});var n=o(296540),i=()=>o(560520),l=()=>o(484714),r=()=>o(790748),s=()=>o(581010),c=()=>o(69708),a=()=>o(100622),u=()=>o(284371),d=()=>o(396406),p=()=>o(718827),S=()=>o(843798),v=o(474848);function w(e){const{onDismiss:t,inputRef:o}=e,w=(0,l().Y0)(),m=(0,n.useRef)(null),g=w.isMobileNative&&w.isIOS,f=g&&e.show;(0,r().b)(s().A,(()=>({getNode:()=>m.current,isShown:()=>f})),[f]);const h=(0,i().n)(),x=(0,n.useCallback)((()=>{var e;null==o||null===(e=o.current)||void 0===e||e.focus(),t&&t();const n=document.activeElement;n instanceof HTMLElement&&n.blur()}),[o,t]);if(!g)return null;const y=f?-(S().j+h):0;return(0,v.jsx)(d().O,{open:!0,children:(0,v.jsx)("div",{style:{position:"fixed",top:"100vh",width:"100%",height:S().j,display:f?"flex":"none",alignItems:"center",justifyContent:"flex-end",backgroundColor:a().Tj.keyboardDoneBarBackground,transform:`translateY(${y}px)`,transition:f?"ease-out":"ease-in",boxShadow:f?`\n\t\t\t\t\t\t\t\t0 -1px 0 ${a().Tj.border.primaryTranslucent}\n\t\t\t\t\t\t\t`:void 0},ref:m,children:(0,v.jsx)(p().Ay,{style:{display:"flex",alignItems:"center",marginInlineEnd:16,color:a().oZ.blue,fontWeight:u().Wy.semibold},onTouchEnd:()=>{x()},children:(0,v.jsx)(c().sA,{defaultMessage:"Done",id:"mobile.dismissKeyboardBar.button.label"})})})})}},904789:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>i,squareOnSquarePlusIcon:()=>l});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.51 15.51",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M12 8.875c.345 0 .625.28.625.625v1.875H14.5a.625.625 0 1 1 0 1.25h-1.875V14.5a.625.625 0 1 1-1.25 0v-1.875H9.5a.625.625 0 1 1 0-1.25h1.875V9.5c0-.345.28-.625.625-.625"}),(0,n.jsx)("path",{d:"M4.5 2.375A2.125 2.125 0 0 0 2.375 4.5V12c0 1.174.951 2.125 2.125 2.125h1.625v1.625c0 1.174.951 2.125 2.125 2.125h7.5a2.125 2.125 0 0 0 2.125-2.125v-7.5a2.125 2.125 0 0 0-2.125-2.125h-1.625V4.5A2.125 2.125 0 0 0 12 2.375zm8.375 3.75H8.25A2.125 2.125 0 0 0 6.125 8.25v4.625H4.5A.875.875 0 0 1 3.625 12V4.5c0-.483.392-.875.875-.875H12c.483 0 .875.392.875.875zm-5.5 2.125c0-.483.392-.875.875-.875h7.5c.483 0 .875.392.875.875v7.5a.875.875 0 0 1-.875.875h-7.5a.875.875 0 0 1-.875-.875z"})]})},l=(0,o(340498).wt)("squareOnSquarePlus",i,"default")},939556:(e,t,o)=>{o.d(t,{y:()=>y});o(898992),o(430670),o(581454);var n=o(296540),i=()=>o(59226),l=()=>o(726637),r=()=>o(484714),s=()=>o(590526),c=()=>o(79926),a=()=>o(546926),u=()=>o(890492),d=()=>o(663639),p=()=>o(736847),S=()=>o(69708),v=()=>o(496603),w=()=>o(320865),m=()=>o(106412),g=()=>o(955450),f=()=>o(637096),h=o(474848);const x={getCollectionViewActionMenuSections:new(c().O2)("getCollectionViewActionMenuSections",(async()=>await o.e(67561).then(o.bind(o,861477))))};function y({collectionViewStore:e,collectionContextStore:t,onClose:o}){const y=(0,r().v3)(),b=(0,S().tz)(),C=(0,m().Zp)(),A=(0,g().K)({collectionContextStore:t}),j=(0,i().X)("notion_calendar_db_integration_non_time_views"),V=(0,f().W)({collectionContextStore:t,entrypoint:"view_menu"}),k=(0,c().fJ)(x.getCollectionViewActionMenuSections),B=(0,s().K8)((()=>"resolved"===k.status&&k.value?k.value.getMenuSections({collectionViewStore:e,collectionContextStore:t,onClose:o,environment:y,intl:b,previewContext:C,canSeeCalendarButton:A&&j,openInCalendar:V}):[[{key:"loading-view-action-menu-sections",render:()=>(0,h.jsx)(w().A,{}),action:()=>{}}]]),[k,t,e,A,j,V,y,b,C,o]),T=B.flatMap((e=>e)).length>0;return{renderMenu:(0,n.useCallback)((()=>{if(!T)return null;const e=l().A.isMobile?{menuType:a().gu.Modal,title:(0,h.jsx)(S().sA,{defaultMessage:"View options",id:"database.viewSettings.viewActionMenu.title"})}:{menuType:a().gu.Popup,width:220};return(0,h.jsx)(u().A,{...e,children:(0,h.jsx)(d().A,{type:d().O.Vertical,initialFocus:void 0,sections:v().oE(B.map(((e,t)=>{if(e.length>0)return{key:t,render:e=>(0,h.jsx)(p().A,{...e,topBorder:0!==t}),items:e}})))})})}),[T,B]),hasMenuItems:T}}},955450:(e,t,o)=>{o.d(t,{K:()=>a});var n=()=>o(135168),i=()=>o(59226),l=()=>o(484714),r=()=>o(590526),s=()=>o(106412),c=()=>o(583238);function a(e){const{collectionContextStore:t}=e,o=(0,l().v3)(),a=(0,s().Zp)(),u=(0,r().O$)(t.normalizedSchemaStore),d=(0,r().K8)((()=>t.collectionViewStore()),[t]),p=(0,r().K8)((()=>null==d?void 0:d.getType()),[d]),S=(0,i().X)("notion_calendar_db_integration_non_time_views"),v=(0,r().K8)((()=>t.isDashboardWidget()),[t]),w=(0,r().K8)((()=>{const e=t.collectionStore();return(0,c().JF)({environment:o,spaceStore:(0,n().f)(e),schema:u,collectionContextType:t.contextTypeFromStoreState,collectionViewType:p,enableForNonTimeBasedViews:S})}),[o,u,t,p,S]);return!v&&(Boolean(w)&&!(null!=a&&a.disablePageLinks))}}}]);