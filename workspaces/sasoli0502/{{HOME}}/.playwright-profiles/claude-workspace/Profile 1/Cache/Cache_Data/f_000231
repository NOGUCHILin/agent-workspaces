"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28463,35905],{346:(e,t,n)=>{n.d(t,{MG:()=>g,T1:()=>p,a1:()=>v,dt:()=>f,kg:()=>b,lC:()=>S,n_:()=>m});var o=n(296540),i=()=>n(484714),a=()=>n(590526),r=()=>n(79926),s=()=>n(187174),l=()=>n(941463),c=()=>n(441199),d=()=>n(749687),u=()=>n(737230),h=()=>n(756114);const p=new(r().O2)("PerformanceToolbar",(()=>Promise.all([n.e(23640),n.e(45624)]).then(n.bind(n,688201)))),g=(0,r()._h)(p,(e=>e.PerformanceToolbar)),f=(0,r()._h)(p,(e=>e.PerformanceToolbarSettings));function b(){const e=(0,i().v3)();return(0,a().K8)((()=>(0,h().D)(e,e.RouterStore.state)),[e])}function m(){const e=(0,i().v3)(),t=y("performanceToolbarStore"),n=y("isPerformanceToolbarVisible");return(0,a().K8)((()=>!(!t||!n)&&n(e,e.RouterStore.state,t.state)),[n,e,t])}function S(){const e=y("performanceToolbarStore");return(0,a().K8)((()=>!!e&&e.state.isPerformanceToolbarMounted),[e])}function v(){const e=(0,i().v3)(),t=y("createPerformanceToolbarMouseListeners"),n=y("performanceToolbarStore"),{sidebarExpanded:r,sidebarWidth:s,secondarySidebarExpanded:h,secondarySidebarWidth:p,updateSidebarExpanded:g,updateSidebarWidth:f}=(0,a().K8)((()=>({sidebarExpanded:d().sidebarExpandedStore.state,sidebarWidth:d().sidebarWidthStore.state,secondarySidebarExpanded:c().default.isOpen(),secondarySidebarWidth:l().Ay.getWidth(),updateSidebarExpanded:u().Ay.state.expanded,updateSidebarWidth:u().Ay.state.width})),[]);return(0,o.useEffect)((()=>{if(n&&t)return t(e,(e=>n.update((t=>({...t,isMouseNearPerformanceToolbar:e})))),r,s,h,p,g,f)}),[t,e,n,r,s,h,p,g,f])}function y(e){const t=b(),[{value:n}]=(0,s().Yb)((()=>t?p.load().then((t=>t[e])):Promise.resolve(void 0)),[e,t]);return n}},12956:(e,t,n)=>{n.d(t,{u:()=>v});n(296540);var o=()=>n(383036),i=()=>n(26697),a=()=>n(81068),r=()=>n(575143),s=()=>n(662971),l=()=>n(484714),c=()=>n(590526),d=()=>n(283163),u=()=>n(245720),h=()=>n(546926),p=()=>n(890492),g=()=>n(69708),f=()=>n(636714),b=n(474848);function m(e){const{context:t,extensionMenuParent:n,actionMenuListParent:o,popupEvents:i,displayName:a,width:r,initialFocus:s,subActions:m}=e,{isPhone:S}=(0,l().Y0)(),v=(0,h().Tf)();let y;y=S?v?{menuType:h().gu.Modal,onClickLeft:n.close,left:(0,b.jsx)(d().h,{}),enableMobileRefresh:v,paddingTop:10,title:(0,b.jsx)(g().sA,{...a}),...i}:{menuType:h().gu.Modal,right:(0,b.jsx)(g().sA,{...u().W.done}),onClickRight:n.close,...i}:{menuType:h().gu.Popup,width:r??220,...i};const x=(0,c().K8)((()=>m(t)),[t,m]);return(0,b.jsx)(p().A,{...y,children:(0,b.jsx)(f().A,{initialFocus:s??0,context:t,sections:x,onAccept:o.onAccept})})}var S=()=>n(267271);function v(e){const{key:t,displayName:n,displayNameInterpolatedValues:l,subTitle:c,analyticsName:d,validators:u,subActions:h,collapseSubActionsIntoParent:p,hideSubActions:g,svg:f,icon:v,right:y,rightStyle:x,renderTooltip:C,disableTooltip:k,tooltipPlacement:w,width:P,initialFocus:M,clientSkill:A,fuzzySearchKeywordsArray:j,disabled:z,bottomSheetInitialState:T}=e,R=(0,S().Ls)({clientSkill:A,key:`extension ${t}`,displayName:n,displayNameInterpolatedValues:l,analyticsName:d,validators:u,subActions:h,collapseSubActionsIntoParent:p,hideSubActions:g,fuzzySearchKeywordsArray:j,closeParentMenu:!0,disabled:z,action:()=>{},render:(t,l,d)=>(0,b.jsx)(i().m,{render:i=>{var u;const p=null===(u=e.disabled)||void 0===u?void 0:u.call(e,l);return(0,b.jsx)(s().A,{...t,disabled:p,disabledFeedback:p,renderOrigin:(e,t)=>{const n={...(0,o().A)(e,i),title:c?(0,b.jsx)(S().fh,{subTitle:c(l),children:R.displayName}):R.displayName,right:y,rightStyle:x};return f?(0,b.jsx)(r().A,{...n,svg:f,ref:t}):(0,b.jsx)(a().A,{...n,icon:v,ref:t})},onFocus:d.onFocus,renderExtension:(e,t)=>(0,b.jsx)(m,{context:l,extensionMenuParent:t,actionMenuListParent:d,popupEvents:e,displayName:n,width:P,initialFocus:M,subActions:h}),bottomSheetInitialState:T})},renderTooltip:()=>(0,b.jsx)("div",{style:S().FG,children:null==C?void 0:C({context:l,title:R.displayName})}),disableTooltip:!C||(null==k?void 0:k(l)),placement:w})});return R}},38554:(e,t,n)=>{n.d(t,{U:()=>r});var o=()=>n(590526),i=()=>n(822789),a=()=>n(229508);function r(){const e=(0,a().a)();return(0,o().K8)((()=>(0,i().XM)(e)),[e])}},72307:(e,t,n)=>{n.d(t,{A:()=>o});const o={appCursorListener:{sidebar:1,secondarySidebar:2,editor:3,aiChat:3,marketplace:3,teamHome:3,aiChatSidebar:4}}},106702:(e,t,n)=>{n.d(t,{$:()=>a});var o=()=>n(590526);const i=new(n(140934).ComputedStore)((()=>n(907258).default.state.currentUserStore),{debugName:"AppStoreCurrentUserStore"});function a(){return(0,o().O$)(i)}},107620:(e,t,n)=>{n.d(t,{y:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"1.81 2.89 16.38 15.08",svg:(0,n(474848).jsx)("path",{d:"M16.938 9.853c0-2.97-2.539-5.54-6.545-5.697L10 4.148c-4.232 0-6.938 2.639-6.938 5.705 0 1.438.583 2.752 1.617 3.76a.63.63 0 0 1 .18.546 7.3 7.3 0 0 1-.89 2.528c1.108-.13 2.12-.614 3.01-1.344l.063-.044a.63.63 0 0 1 .505-.073 9 9 0 0 0 2.454.333l.392-.007c4.006-.158 6.545-2.728 6.545-5.699m1.25 0c0 3.803-3.234 6.766-7.747 6.948l-.44.008a10.2 10.2 0 0 1-2.485-.299c-1.349 1.022-2.985 1.62-4.826 1.428a.625.625 0 0 1-.406-1.033c.712-.817 1.096-1.737 1.284-2.642-1.116-1.197-1.756-2.733-1.756-4.41 0-3.925 3.447-6.955 8.189-6.955l.44.009c4.512.181 7.747 3.143 7.747 6.946"})},i=(0,n(340498).wt)("chatBubble",o,"default")},229508:(e,t,n)=>{n.d(t,{a:()=>a});var o=()=>n(907258),i=()=>n(590526);function a(){return(0,i().O$)(o().AppStoreSidebarSpaceViewStore)}},231536:(e,t,n)=>{n.d(t,{Y:()=>r,G:()=>a});var o=()=>n(534177);const i={clipboardActions:n(884107).R.clipboardActions,duplicationActions:n(855801).VI.duplicateActions,formulasModule:n(862292).T.formulas,markdownLinkifyIt:n(659602).g,tinyMceMicrosoftWordPasteFilter:n(335722).S};function a(...e){for(const t of e)i[t].load()}function r(e){const t=i[e].getLoadingState();if("idle"===t.status)a(e);else if("pending"===t.status||"rejected"===t.status);else{if("resolved"===t.status)return t.value;(0,o().HB)(t)}}},245720:(e,t,n)=>{n.d(t,{W:()=>o});const o=(0,n(69708).YK)({done:{id:"modal.doneButton",defaultMessage:"Done"},cancel:{id:"modal.cancelButton",defaultMessage:"Cancel"},back:{id:"modal.backButton",defaultMessage:"Back"}})},274023:(e,t,n)=>{n.d(t,{PK:()=>i,wo:()=>a});n(16280);var o=()=>n(706119);function i(e){const t=function(e){return"default"===e?"openai-gpt-4o":e}(e),n=o().U_.get(t);if(!n)throw new Error(`Model not found in registry: ${e}`);return n}function a(e){return i(e).isHipaaCompliant}},283163:(e,t,n)=>{n.d(t,{h:()=>r});n(296540);var o=()=>n(473541),i=()=>n(807449),a=n(474848);function r(){return(0,a.jsx)(i().I,{icon:o().w,size:"lg",colorVariant:"primary"})}},353755:(e,t,n)=>{n.d(t,{j:()=>u});var o=n(296540),i=()=>n(106702),a=()=>n(484714),r=()=>n(590526),s=()=>n(791256),l=()=>n(965454),c=()=>n(770160),d=()=>n(680514);function u({clientStore:e,chatPanelState:t,spaceStore:n}){const{threadStore:u,isNewThread:h}=function({clientStore:e,chatPanelState:t,spaceStore:n}){const o=(0,a().v3)(),s=(0,i().$)(),u=(0,l().AD)(),h=(0,r().K8)((()=>{if(!n||!t||!s)return;const e=(0,c().getChatPanelState)(o)??t;if(!("isNewThread"in e)||!e.isNewThread){const t=(0,c().threadStoreGivenRouteData)({spaceStore:n,chatPanelState:e});return(0,d().dr)(null==t?void 0:t.id)??t}n&&u.getOrCreateThreadId({environment:o,spaceId:n.id,maybeThreadStore:void 0})}),[n,t,s,u,o]);return{threadStore:h,isNewThread:"isNewThread"in t&&t.isNewThread}}({clientStore:e,chatPanelState:t,spaceStore:n}),{steps:p,allReady:g}=(0,r().K8)((()=>u?(0,s().A3)({clientStore:e,threadStore:u}):{steps:[],allReady:!1}),[e,u]),[f,b]=(0,o.useState)(g),[m,S]=(0,o.useState)(void 0);if((m!==u||g&&!f)&&(S(u),b(g)),h)return{state:"new",threadStore:u,transcript:p};return(g||f)&&u?{state:"ready",threadStore:u,transcript:p}:{state:"loading",threadStore:void 0,transcript:void 0}}},362750:(e,t,n)=>{n.d(t,{Zl:()=>i,lH:()=>a,oV:()=>o});n(16280),n(410838),n(944114),n(581454);const o=12e3;function i(e){const t=[];for(const n of e){const e=t[t.length-1];e?"text"===n.type&&"text"===e.type?t[t.length-1]={type:"text",content:e.content+n.content}:"thinking"!==n.type||"thinking"!==e.type||n.encryptedContent||e.encryptedContent||n.signature&&e.signature||n.modelProvider!==e.modelProvider||n.notionModelName!==e.notionModelName?"tool_use"===n.type&&"tool_use"===e.type&&n.id===e.id?t[t.length-1]={type:"tool_use",id:n.id,name:n.name,content:e.content+n.content,signature:n.signature||e.signature}:t.push({...n}):t[t.length-1]={type:"thinking",content:e.content+n.content,id:n.id||e.id,signature:n.signature||e.signature,encryptedContent:n.encryptedContent||e.encryptedContent,modelProvider:n.modelProvider||e.modelProvider,notionModelName:n.notionModelName||e.notionModelName}:t.push({...n})}return t}function a(e){return"string"==typeof e?[{type:"text",content:e}]:e??[]}},473541:(e,t,n)=>{n.d(t,{w:()=>i});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"5.87 3.72 7.16 12.56",directional:!0,svg:(0,n(474848).jsx)("path",{d:"M6.131 9.381a.875.875 0 0 0 0 1.238l5.4 5.4a.875.875 0 1 0 1.238-1.238L7.987 10l4.782-4.781A.875.875 0 0 0 11.53 3.98z"})},i=(0,n(340498).wt)("arrowChevronSingleLeftFill",o,"fill")},514608:(e,t,n)=>{n.r(t),n.d(t,{eyeFillSmallIcon:()=>a,iconDefinition:()=>i});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"0.7 3.26 14.6 9.48",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M8 7.122a.875.875 0 1 1 0 1.75.875.875 0 0 1 0-1.75"}),(0,o.jsx)("path",{d:"M8 3.26c3.125 0 5.857 1.673 7.152 4.141l.065.144c.11.293.11.617 0 .91l-.065.145c-1.295 2.468-4.027 4.14-7.152 4.14-3.027 0-5.685-1.57-7.026-3.912L.848 8.6a1.29 1.29 0 0 1 0-1.199l.126-.228C2.314 4.83 4.972 3.26 8 3.26m0 2.112a2.626 2.626 0 0 0-2.625 2.626l.014.269A2.626 2.626 0 0 0 7.73 10.61l.269.014a2.626 2.626 0 0 0 2.611-2.357l.014-.269A2.626 2.626 0 0 0 8 5.372"})]})},a=(0,n(340498).wt)("eyeFillSmall",i,"fillSmall")},567121:(e,t,n)=>{n.d(t,{EG:()=>r,K5:()=>a,RH:()=>i,Yi:()=>s,ls:()=>o});const o=32,i=202,a=1e3,r="Want to add a metric? Look for 'src/client/performanceToolbar/config.ts' in notion-next.",s="To disable the toolbar entirely, go to the 'Experiments' panel and look for the 'performance_debugging_toolbar' flag."},589407:(e,t,n)=>{n.r(t),n.d(t,{ellipsisIcon:()=>i,iconDefinition:()=>o});n(296540);const o={viewBox:"0 0 20 20",fittedViewBox:"2.62 8.62 14.76 2.76",svg:(0,n(474848).jsx)("path",{d:"M4 11.375a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75m6 0a1.375 1.375 0 1 0 0-2.75 1.375 1.375 0 0 0 0 2.75"})},i=(0,n(340498).wt)("ellipsis",o,"default")},592933:(e,t,n)=>{n.d(t,{G1:()=>a,Pn:()=>r,Vf:()=>o,yD:()=>i});n(410838),n(813451),n(944114),n(898992),n(354520),n(672577),n(803949),n(581454),n(737550);function o(e){return"inference"!==e.type&&"queue-handoff"!==e.type&&"reenqueue-with-delay"!==e.type&&"record-map"!==e.type&&"patch-start"!==e.type&&"patch"!==e.type&&"agent-search-extracted-results"!==e.type}function i(e){return"patch"===e.type||"patch-start"===e.type}function a(e){return function(e){const t=e.find((e=>"context"===e.type));return"daily_brief_reminder"===(null==t?void 0:t.value.surface)}(e)&&function(e){return e.filter((e=>"user"===e.type||"user-injected"===e.type)).length}(e)<=1}function r(e){let t=0;const n=e.findLastIndex((e=>"user"===e.type));-1!==n&&(t=n+1);return e.slice(t)}},636714:(e,t,n)=>{n.d(t,{A:()=>x});n(898992),n(354520),n(581454);var o=n(296540),i=()=>n(590526),a=()=>n(182412),r=()=>n(683021),s=()=>n(498521),l=()=>n(449279),c=()=>n(663639),d=()=>n(922931),u=()=>n(535393),h=()=>n(736847),p=()=>n(452004),g=()=>n(69708),f=()=>n(231536),b=()=>n(671894),m=n(474848);const S=25,v=200,y=n(757695).Store.createClass(S,{name:"limitStore"});function x({topBorder:e,context:t,onAccept:n,onFocus:x,empty:C,keyboardPriority:k,disableKeyboard:w,initialFocus:P,onEmptyEnter:M,comboboxProps:A,useLimit:j,onFilteredSectionsChange:z,filter:T,sections:R,menuListStore:I,resetInitialFocusOnSectionChangeAlways:E,resetFocusOnMouseOut:D,role:B,showNoResultsMessage:F,onFooterEnter:N,filterSections:W,flattenSectionsOnSearch:L,renderItemStyles:_,shouldShowBlockTypeTitle:O}){const K=(0,i().uB)(void 0,y),V=(0,i().uB)(I,p().$),[U,$,Y]=(0,i().K8)((()=>{let e=0;const n=(0,b().js)({sections:T&&W?W:R,context:t,query:T||"",shouldShowBlockTypeTitle:O});for(const t of n)e+=t.actions.length;return[j?(0,b().Le)(n,K.state):n,e,n]}),[R,t,T,j,K,W,O]);(0,o.useEffect)((()=>{r().Ay.state.open&&r().rA.setState(0===Y.length)}),[Y]),(0,o.useEffect)((()=>{null==z||z(U)}),[z,U]);const X=(0,o.useRef)(T),G=(0,o.useCallback)((e=>{e<v&&K.state<$&&K.setState(K.state+S)}),[K,$]),H=Boolean(L&&T),q=(0,o.useMemo)((()=>{const e=new Map;for(const t of Y)if(t.key!==a().IZ)for(const n of t.actions)e.set(n.key,t.title);return e}),[Y]),{menuItemActionMap:Z,menuItemSectionKeyMap:J,menuListSections:Q}=(0,o.useMemo)((()=>{const o=new Map,i=new Map,r=U.map((r=>{const s=r.key.toString();return{key:r.key,render:t=>r.render({...t,topBorder:!H&&(0!==t.index||Boolean(e)),title:r.title,hideTitle:H}),items:r.actions.map((e=>{e.lazyDependencyKeys&&(0,f().G)(...e.lazyDependencyKeys);const l={key:e.key,render:(o,i)=>{const l=r.key===a().IZ?q.get(e.key):r.title,c=H||r.key===a().IZ;return e.render(o,t,{onAccept:(e,t,o)=>{null==n||n(e,t,o,s)},onFocus:i.onFocus,sectionTitle:l,extendItemTitle:c,styles:_})},action:({event:n})=>{e.action(t,n)}};return o.set(l,e),i.set(l,s),l}))}}));return{menuItemActionMap:o,menuItemSectionKeyMap:i,menuListSections:r}}),[U,H,e,q,t,_,n]);(0,o.useEffect)((()=>{if(T!==X.current&&0===P){X.current=T;if(Boolean(N)&&0===u().i2(Q))return d().rd({store:V});V.setState({...V.state,focus:{section:0,indexLocal:0,indexGlobal:0,footerFocused:!1}})}}),[T,P,Q,V,N]);const ee=(0,o.useCallback)(((e,o)=>{if(n){const a=Z.get(e),r=J.get(e);if(a){var i;if(null!==(i=a.isDisabled)&&void 0!==i&&i.call(a,t))return;n(a,t,o.event,r,o.index)}}}),[n,t,Z,J]),te=(0,o.useCallback)((e=>{let n;var o;(e.indexLocal&&(n=u().SG(e.indexLocal,Q)),e.indexGlobal)&&(n=null===(o=u().e7(e.indexGlobal,Q))||void 0===o?void 0:o.item);if(!n)return;const i=Z.get(n),a=J.get(n);i&&(null==x||x(i,t,a))}),[Z,J,x,Q,t]);return(0,m.jsxs)(m.Fragment,{children:[Boolean(F)&&0===U.length?(0,m.jsx)(h().A,{children:(0,m.jsx)(l().u,{title:C||(0,m.jsx)(g().sA,{id:"action.search.noResults",defaultMessage:"No results"})})}):void 0,(0,m.jsx)(c().A,{type:c().O.Vertical,role:B,priority:k,store:V,disableKeyboard:w,sections:Q,initialFocus:P,onEmptyEnter:M,onAccept:ee,onFocus:te,comboboxProps:A,resetInitialFocusOnSectionChangeAlways:E,resetFocusOnMouseOut:D,onFooterEnter:N}),j?(0,m.jsx)(s().A,{onChange:G}):void 0]})}},671894:(e,t,n)=>{n.d(t,{hS:()=>y,o2:()=>x,js:()=>S,Le:()=>v,F6:()=>C});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(823215),n(354520),n(581454);var o=()=>n(675133),i=()=>n(69708),a=()=>n(778078),r=()=>n(496603),s=(n(296540),()=>n(736847)),l=()=>n(589407),c=()=>n(12956),d=n(474848);const u=(0,i().YK)({moreOptions:{id:"action.moreOptions",defaultMessage:"More options"}});var h=()=>n(431404),p=()=>n(680288),g=()=>n(129522);const f=25,b=5,m=(0,i().YK)({mixedBlocks:{id:"actionMenuHelpers.mixedBlocks.title",defaultMessage:"{count, plural, one {{count} block} other {{count} blocks}}"}});function S(e){const t=o().A.getIntl(),{sections:n,context:i,query:S,shouldShowBlockTypeTitle:v}=e;let y=S.trim().toLowerCase();y.startsWith("/")&&(y=y.slice(1));const k=x(n,i).map(((e,n)=>{let{actions:o,title:a}=e;const r=o.length-b;if(e.shouldShowMoreOptions&&r>1){const e=function(e){return(0,c().u)({key:"more options",displayName:u.moreOptions,analyticsName:u.moreOptions.defaultMessage,svg:l().ellipsisIcon,validators:[],subActions:()=>[{key:0,title:void 0,render:e=>(0,d.jsx)(s().A,{...e}),actions:e}]})}(o.slice(b));o=[...o.slice(0,b),e]}const f=i.blocks[0];if(f){const e=f.getType();if(v&&e&&0===n){const n=i.blocks.every((t=>t.getType()===e))?(0,h().Z)(e):m.mixedBlocks;if(n){var S;a=t.formatMessage(n,{count:i.blocks.length});const e=null===(S=g().K.findCollectionViewBlockFromStore(f))||void 0===S?void 0:S.collectionContextStore.getViewType();if(e){const t=p().to[e];t&&(a+=` Â· ${t}`)}}}}return{...e,actions:o,title:a}}));if(!y)return k;const w=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const n=t.searchName||t.displayName||"",o=[n,e.searchTitle||e.title||"",n].join(" ");return{...t,searchName:o}}))})))}(function(e,t){const n=[];for(const o of e){const e={...o,actions:[]};for(const i of o.actions)if(C(i,t))if(i.subActions){const a=x(i.subActions(t),t);if(i.hideSubActions){e.actions.push(i);continue}if(i.collapseSubActionsIntoParent){for(const t of a)for(const n of t.actions)e.actions.push(n);continue}const r=a.map((e=>({...e,key:`${o.key} ${i.key} ${e.key}`,title:e.title||i.displayName,searchTitle:[i.searchName||i.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of r)n.push(e)}else e.actions.push(i);e.actions.length&&n.push(e)}return n}(n,i)),P=[],M=new Map;for(const o of w)for(const e of o.actions)M.set(e,o),P.push(e);const A=(0,a().Ay)(y,P,(e=>e.searchName||""),{minScore:f,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),j=new Set(A),z=P.filter((e=>Boolean(e.alwaysShowInSearch)&&!j.has(e))),T=z.filter((e=>"start"===e.alwaysShowInSearch)),R=z.filter((e=>"end"===e.alwaysShowInSearch)),I=r().$z([...T,...A,...R],(e=>{const t=M.get(e);if(t)return t.title})),E=[];for(const o of Object.keys(I)){const e=I[o],t=M.get(e[0]);t&&E.push({...t,actions:e})}return E}function v(e,t){if(!t)return e;let n=0;const o=[];for(const i of e){if(n>=t)break;const e=i.actions.slice(0,t-n);e.length>0&&(n+=e.length,o.push({...i,actions:e}))}return o}function y(e,t){const n=[];for(const o of e){const e=o.actions.filter(t);e.length>0&&n.push({...o,actions:e})}return n}function x(e,t){return y(e,(e=>C(e,t)))}function C(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},680514:(e,t,n)=>{n.d(t,{dr:()=>d,xX:()=>u});var o=()=>n(463086),i=()=>n(234459),a=()=>n(384944),r=()=>n(140992),s=()=>n(965454),l=()=>n(244828);const c=new Map;function d(e){if(e)return c.get(e)}function u(e){var t,n;const{threadStore:d,environment:u,spaceStore:h,userStore:p}=e;if(!d||!(0,s().Ci)(d))return d;const g=u.defaultRecordCache.inMemoryRecordCache;for(const o of g.cacheOverrides.slice())o.name===s().Ll&&g.removeCacheOverride(o);const f=d.getTranscript(),b=d.getParentId(),m=d.getParentTable(),S=null===(t=d.getData())||void 0===t?void 0:t.workflow_id,v=d.getType(),y=null===(n=d.getData())||void 0===n?void 0:n.title,x=d.getSpaceId()??h.id,{performResult:C}=l().createAndCommit({userAction:"databaseAgent.persistTemporaryThread",environment:u,canUndo:!0,perform:e=>{const t=(0,r().aP)({environment:u,spaceStore:h,userStore:p,transcript:f,transaction:e,threadId:d.id,workflowId:S,threadType:v});return b&&m&&a().zv({store:t,transaction:e,data:{parent_id:b,parent_table:m,space_id:x}}),y&&a().zv({store:t.getDataStore(),transaction:e,data:{title:y}}),t}});var k;return k=d.id,c.delete(k),C??o().E.createChildStore(h,{id:d.id,spaceId:x,table:i().To})}},703778:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>i,linkSmallIcon:()=>a});n(296540);var o=n(474848);const i={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.19 12.19",svg:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("path",{d:"M12.848 2.8a3.145 3.145 0 0 0-4.448 0L6.918 4.283a.625.625 0 0 0 .884.883l1.482-1.482c.74-.74 1.94-.74 2.68 0l.294.294c.74.74.74 1.94 0 2.68l-1.482 1.483a.625.625 0 1 0 .884.884l1.482-1.482a3.145 3.145 0 0 0 0-4.449z"}),(0,o.jsx)("path",{d:"M10.472 5.47a.625.625 0 0 0-.884 0L5.229 9.83a.625.625 0 1 0 .884.883l4.359-4.359a.625.625 0 0 0 0-.883"}),(0,o.jsx)("path",{d:"M5.167 6.918a.625.625 0 0 0-.884 0L2.8 8.4a3.146 3.146 0 0 0 0 4.448l.294.294a3.145 3.145 0 0 0 4.449 0l1.482-1.482a.625.625 0 0 0-.884-.884L6.66 12.258c-.74.74-1.94.74-2.68 0l-.295-.294c-.74-.74-.74-1.94 0-2.68L5.167 7.8a.625.625 0 0 0 0-.883"})]})},a=(0,n(340498).wt)("linkSmall",i,"small")},706959:(e,t,n)=>{n.d(t,{c:()=>l});var o=n(296540),i=()=>n(484714),a=()=>n(590526),r=()=>n(703748),s=()=>n(981475);function l(){const e=(0,i().v3)(),{visibility:t,naturalPanelContentSize:n,mode:l}=(0,a().K8)((()=>({visibility:s().globalChatPanelRuntimeStore.state.chatPanelVisibility,naturalPanelContentSize:s().globalChatPanelRuntimeStore.state.naturalPanelContentSize,mode:s().globalChatPanelRuntimeStore.state.chatPanelMode})),[]),c=(0,a().O$)(s().BC),d="open"===t||"opening"===t||"closing"===t,u=(0,o.useCallback)((()=>{s().BC.setState(void 0),s().globalChatPanelRuntimeStore.update((e=>({...e,chatPanelVisibility:"closed",editorWidthUsed:0}))),(0,r().closeChatSidebar)({environment:e})}),[e]),h=(0,o.useCallback)((()=>{d&&(0,r().dismissChatSidebar)()}),[d]),p=(0,o.useCallback)((()=>{d&&(0,r().dismissChatSidebar)()}),[d]);return{onDismissed:u,onDismiss:h,userPreferenceSidebarWidth:c,naturalPanelContentSize:n,visibility:t,isOpen:d,mode:l,onEsc:"sidebar"===l?void 0:p}}},756114:(e,t,n)=>{n.d(t,{D:()=>o});function o(e,t){t.route.name;return!1}},760562:(e,t,n)=>{n.r(t),n.d(t,{DockedSidebar:()=>Se});var o=n(296540),i=()=>n(870956),a=()=>n(484714),r=()=>n(401497),s=()=>n(882722),l=()=>n(72307),c=()=>n(100622);function d(e,t){const n=(0,r().IS)((()=>({theme:{backgroundColor:c().Tj.background.primary}})),[]);(0,o.useLayoutEffect)((()=>{if(e)return"open"!==t&&"opening"!==t||function(e){document.body.style.overflow="visible",e&&(document.body.style.backgroundColor=e);const t=document.getElementById("notion-app");t&&(t.style.overflow="visible",t.style.overscrollBehavior="contain")}(n.theme.backgroundColor),()=>{!function(){document.body.style.overflow="",document.body.style.backgroundColor="";const e=document.getElementById("notion-app");e&&(e.style.overflow="",e.style.overscrollBehavior="")}()}}),[t,n.theme.backgroundColor,e])}n(944114),n(898992),n(354520),n(672577);var u=()=>n(203066),h=()=>n(153321),p=()=>n(59226),g=()=>n(756117),f=()=>n(782482),b=()=>n(590526),m=()=>n(15258),S=()=>n(75435),v=()=>n(209199),y=()=>n(600434),x=()=>n(35392),C=()=>n(111043),k=()=>n(346),w=()=>n(567121),P=()=>n(644914),M=()=>n(703748),A=()=>n(522282),j=()=>n(534177);function z(e){return{opacity:e?1:0,scale:e?1:A().m7,transformOrigin:"bottom right"}}function T(e){return{translateX:e?0:"100%"}}var R=()=>n(304261),I=()=>n(510331);var E=()=>n(755222),D=()=>n(591779),B=()=>n(981475);var F=()=>n(706959);var N=n(474848);function W(e){const{chatPanelVisibility:t,editorWidthUsed:n,animationConfig:o,shouldAnimate:i}=e,{isTablet:s}=(0,a().Y0)(),l=(0,r().IS)((()=>({spacer:{background:"transparent",height:"100%",flexShrink:0,flexGrow:0,pointerEvents:"none"}})),[]),c=function(e){const{chatPanelVisibility:t,editorWidthUsed:n}=e;return{initial:{width:0},animate:{width:"opening"===t||"open"===t?n??0:0}}}({chatPanelVisibility:t,editorWidthUsed:n});return(0,N.jsx)(g().A,{style:l.spacer,initial:c.initial,animate:c.animate,config:o,skip:!i,visible:!s})}var L=()=>n(920198),_=()=>n(907258),O=()=>n(560533),K=()=>n(852507),V=()=>n(943101),U=()=>n(699143),$=()=>n(98126),Y=()=>n(944584),X=()=>n(277942),G=()=>n(353755),H=()=>n(166442),q=()=>n(631611),Z=()=>n(207214),J=()=>n(965454),Q=()=>n(770160);function ee(e){const{chatPanelState:t,chatPanelMode:n,panelSize:i,onDismiss:s,onEsc:l,fromSurface:c="corner",aiChatFeature:d}=e,u=(0,a().v3)(),h=(0,L().L)(),p=(0,b().O$)(_().AppStoreMainEditorCurrentBlockStore),g=(0,b().K8)((()=>null!=p&&p.isPersonalHomePage()?"home":"page"),[p]),f=(0,r().IS)((()=>{const e="sidebar"===n;return{content:{position:"absolute",bottom:0,insetInlineStart:0,insetInlineEnd:0,top:e?0:void 0},layout:{...e?{flex:1}:{minHeight:i.height.min,maxHeight:i.height.max}}}}),[i.height.min,i.height.max,n]);(0,K().w)((()=>{Y().trackAiOpened({environment:u,agentEnabled:!0,surface:c,cornerSurface:g})}));const{state:m,threadStore:S,transcript:v}=(0,G().j)({clientStore:H().defaultClientAIChatStore,chatPanelState:t,spaceStore:h}),y=(0,b().K8)((()=>B().globalChatPanelRuntimeStore.state.isLoadingDependencies??!1),[]),x=(0,Z().L)(u),C=(0,J().AD)(),k=(0,o.useCallback)((({newThreadStore:e})=>{const t=_().default.state.mainEditorCurrentBlockStore||x,n=u.RouterStore.state.route,o=(0,Q().shouldAllowOpeningAgentOnSpecifiedRoute)(n);(t||o)&&(C.reset(),(0,M().openChatPanel)({environment:u,store:t,chatPanelState:e?{isOpen:!0,threadId:e.id}:{isOpen:!0,isNewThread:!0}}))}),[u,x,C]),w=(0,o.useRef)(null),P=(0,o.useCallback)((e=>{w.current&&B().globalChatPanelRuntimeStore.setState({...B().globalChatPanelRuntimeStore.state,naturalPanelContentSize:e})}),[]);let A;switch((0,V().tK)(w,P),n){case"sidebar":A=d||"agent";break;case"popup":case"full":A=d||"agent_popup";break;default:(0,j().HB)(n)}return(0,N.jsx)(O().e.Provider,{value:s,children:(0,N.jsx)(q().hP,{surface:q().wy.inferenceTranscriptChatView,children:(0,N.jsx)("div",{ref:w,style:f.content,children:(0,N.jsx)(U().Y1,{direction:"vertical",width:"content"===i.width.resizeMode?"hug":i.width.value,height:"content"===i.height.resizeMode?"hug":i.height.value,style:f.layout,children:h?(0,N.jsx)(X().NV,{aiChatFeature:A,clientStore:H().defaultClientAIChatStore,hideAgentName:!0,onEsc:l,onThreadChange:k,parentStore:h,threadStore:S,threadStoreState:y?"loading":m,transcript:v||[]}):(0,N.jsx)(U().Y1,{width:"fill",height:"fill",align:"center",children:(0,N.jsx)($().k,{})})})})})})}var te=()=>n(751735);function ne(e){const{chatPanelMode:t}=e,n=(0,r().eP)(),o=(0,r().IS)((()=>{const e=`linear-gradient(to bottom, ${(0,te().X4)(c().Tj.background.primary,.25)}, ${(0,te().X4)(c().Tj.background.primary,0)} 50%), linear-gradient(to right, rgba(0, 0, 0, 0.008), rgba(0, 0, 0, 0) 32px), linear-gradient(to right, rgba(0, 0, 0, 0.01), rgba(0, 0, 0, 0) 72px)`;let o;return"popup"===t&&"dark"===n?o=c().Tj.gray.background.primary:"sidebar"===t&&(o=e),{shading:{background:o,willChange:"background",position:"absolute",inset:0,transition:`opacity ${A().nW}ms ease-in-out, background ${A().nW}ms ease-in-out`}}}),[t,n]);return(0,N.jsx)("div",{style:o.shading})}var oe=()=>n(383036),ie=()=>n(819121),ae=()=>n(93583),re=()=>n(86159),se=()=>n(493552),le=()=>n(26697),ce=()=>n(69708),de=()=>n(496603),ue=()=>n(440024),he=()=>n(222321);function pe(e){const{size:t,anchorToSide:n,minSize:i,maxSize:s,onSizeWillChange:l,onSizeChanging:d,onSizeChangeFinished:u,onDismiss:h,keyboardShortcut:p}=e,g=(0,ce().tz)(),b=(0,a().v3)(),{device:m}=b,[S,y]=(0,o.useState)(!1),[x,C]=(0,o.useState)({x:0,y:0}),[k,w]=(0,ie().A)(),P=(0,o.useRef)(null),M=(0,ae().A)(k,P),j=(0,o.useRef)(null),z=(0,o.useRef)(!1),T=(0,o.useCallback)((e=>Math.max(i,Math.min(s,e))),[i,s]),R=(0,o.useCallback)((e=>{(0,ue().I)({environment:b}),j.current={startX:e.currentX,startSize:t},z.current=!1,null==l||l()}),[b,t,l]),I=(0,o.useCallback)((e=>{if(!j.current)return;re().clear(b),z.current=!0;const{startX:t,startSize:o}=j.current,i=e.currentX-t,a="right"===n?o-((0,v().A1)()?-i:i):o+((0,v().A1)()?-i:i),r=T(a);null==d||d(r)}),[n,b,T,d]),E=(0,o.useCallback)((()=>{!z.current&&h&&h(),j.current=null,null==u||u()}),[h,u]),D=(0,o.useCallback)((()=>{j.current=null}),[]),B=(0,o.useCallback)((()=>{var e;const t=null===(e=P.current)||void 0===e?void 0:e.getBoundingClientRect();t&&C((e=>({x:t.left+t.width/2,y:e.y||t.top+t.height/2})))}),[]),F=(0,o.useCallback)((e=>{var t;y(!0);const n=null===(t=P.current)||void 0===t?void 0:t.getBoundingClientRect();n&&C({x:n.left+n.width/2,y:e.clientY})}),[]),W=(0,o.useCallback)((()=>{y(!0)}),[]),L=(0,o.useCallback)((()=>{y(!1)}),[]),_=(0,o.useCallback)((()=>{const e=T(t-A().xw);null==d||d(e),null==u||u(),requestAnimationFrame(B)}),[t,T,d,u,B]),O=(0,o.useCallback)((()=>{const e=T(t+A().xw);null==d||d(e),null==u||u(),requestAnimationFrame(B)}),[t,T,d,u,B]),K=(0,o.useCallback)((()=>{h&&h()}),[h]);(0,o.useEffect)((()=>{requestAnimationFrame(B)}),[w,B]);const V=(t-i)/(s-i),U=e=>(0,N.jsx)(se().D,{as:"span",colorVariant:"inverseSecondary",children:e}),$=(0,o.useCallback)((()=>{const e=Boolean(h),t=Boolean(p);return e&&t?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ce().sA,{defaultMessage:"Close <invertedcolor>Click or {keyboardShortcut}</invertedcolor>",id:"collapsiblePanelResizer.tooltip.closeWithShortcut",values:{invertedcolor:U,keyboardShortcut:p}}),(0,N.jsx)("br",{}),(0,N.jsx)(ce().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:U}})]}):e?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(ce().sA,{defaultMessage:"Close <invertedcolor>Click</invertedcolor>",id:"collapsiblePanelResizer.tooltip.closeMessage",values:{invertedcolor:U}}),(0,N.jsx)("br",{}),(0,N.jsx)(ce().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:U}})]}):(0,N.jsx)(ce().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:U}})}),[h,p]),Y=(0,v().A1)()?"left"===n?O:_:"left"===n?_:O,X=(0,v().A1)()?"left"===n?_:O:"left"===n?O:_,G=(0,r().IS)((()=>({wrapper:{height:"100%",zIndex:1},draggable:{cursor:"col-resize",height:"100%",width:12,position:"absolute",pointerEvents:"auto",..."right"===n?{insetInlineStart:0}:{insetInlineEnd:0},top:0},resizer:{position:"absolute",..."right"===n?{insetInlineStart:0}:{insetInlineEnd:0},top:0,height:"100%",width:1,backgroundColor:S?c().Tj.border.primary:c().Tj.border.secondary,pointerEvents:"none"}})),[n,S]);return m.isChromebook?null:(0,N.jsx)(f().N,{capture:w,debugName:"SidebarResizer",onLeft:Y,onRight:X,onUp:de().D_,onDown:de().D_,onTab:de().D_,onUntab:de().D_,onEnter:K,children:(0,N.jsx)(le().m,{renderTooltip:$,originRect:new DOMRect(x.x,x.y,0,0),placement:"right"===n?"left":"right",originGap:16,delayThreshold:0,render:e=>(0,N.jsxs)("div",{className:"wrapper",style:G.wrapper,...(0,oe().A)(e,{onMouseMove:W,onMouseLeave:L,onMouseEnter:F}),children:[(0,N.jsx)("div",{style:G.resizer}),(0,N.jsx)(he().A,{onDraggableDragStart:R,onDraggableDragMove:I,onDraggableDragEnd:E,onDraggableDragCancel:D,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,N.jsx)("div",{className:"separator",ref:M,role:"separator",tabIndex:0,"aria-label":g.formatMessage({id:"sidebarResizer.tooltip.resizeLabel",defaultMessage:"Resize with left and right arrow keys"}),"aria-orientation":"vertical","aria-valuenow":Math.round(100*V),"aria-valuemin":0,"aria-valuemax":100,style:G.draggable,...e})})]})})})}function ge(e){const{chatSidebarRouteData:t,fromSurface:n="corner",aiChatFeature:i}=e,l=(0,a().v3)(),d=(0,m().cD)(),L=(0,o.useRef)(!1),_=(0,b().O$)(S().b),O=(0,p().X)("agent_popup_dnd"),K=(0,p().X)("ai_product_agent_chat_scroll_behavior_v2"),{onDismiss:V,onDismissed:U,naturalPanelContentSize:$,userPreferenceSidebarWidth:Y,visibility:X,onEsc:G}=(0,F().c)(),H=(0,b().K8)((()=>B().globalChatPanelRuntimeStore.state.chatPanelMode),[]),q=(0,R().yr)(),Z=(0,k().n_)(),J=(0,C().o)(),Q=(0,b().K8)((()=>l.WindowSizeStore.getSafePaddingTopPx(0)),[l]),[te,oe]=(0,o.useState)(void 0),[ie,ae]=(0,o.useState)(void 0),[re,se]=(0,o.useState)(void 0),[le,ce]=(0,o.useState)(void 0),[de,ue]=(0,o.useState)([]),he=(0,b().K8)((()=>B().globalChatPanelRuntimeStore.state.isDragging),[]),ge=function(e){const t=(0,o.useRef)(e);return e.isOpen&&(t.current=e),t.current}(t),fe=(0,b().K8)((()=>(0,P().km)(l)),[l]),be=(0,o.useMemo)((()=>({width:d.width-fe,height:Z?d.height-w().ls:d.height})),[d,fe,Z]),me=(0,b().K8)((()=>B().globalChatPanelRuntimeStore.state.isDragging?"popup":H),[H]),Se=K&&("agent_popup"===i||!i&&"popup"===me),{handleAnimationEnd:ve}=function(e){const{shouldAnimateRef:t,chatPanelMode:n,chatPanelVisibility:i,onClosingFinished:a}=e;(0,D().ZC)(n)!==n&&(t.current=!0);const r=(0,o.useCallback)((()=>{E().P.setState(!1),t.current=!1,"closing"===i&&a()}),[i,t,a]);return(0,o.useEffect)((()=>{"opening"===i&&(t.current=!0,requestAnimationFrame((()=>{B().globalChatPanelRuntimeStore.update((e=>({...e,chatPanelVisibility:"open"})))})))}),[i,t]),{handleAnimationEnd:r}}({shouldAnimateRef:L,chatPanelMode:H,chatPanelVisibility:X,onClosingFinished:U}),{dragSize:ye,onSizeWillChange:xe,onWidthChange:Ce,onSizeChangeFinished:ke}=function(e){const{shouldAnimateRef:t,chatPanelMode:n}=e,[i,a]=(0,o.useState)(void 0);(0,o.useEffect)((()=>{a(void 0)}),[n]);const r=(0,o.useCallback)((()=>{t.current=!1}),[t]),s=(0,o.useCallback)((e=>{"sidebar"===n&&a({width:e})}),[n]),l=(0,o.useCallback)((()=>{if("sidebar"===n&&void 0!==i&&(B().BC.setState(i.width),a(void 0),void 0!==i.width)){const e=i.width;B().globalChatPanelRuntimeStore.update((t=>({...t,editorWidthUsed:e})))}}),[n,i]);return{dragSize:i,onSizeWillChange:r,onWidthChange:s,onSizeChangeFinished:l}}({shouldAnimateRef:L,chatPanelMode:H}),{editorWidthUsed:we,panelSize:Pe,panelRect:Me}=(0,o.useMemo)((()=>(0,I().m)({availableEditorSize:be,chatPanelMode:me,currentPerformanceToolbarHeight:Z?w().ls:0,dragSize:ye,naturalPanelContentSize:$,notionSidebarWidth:fe,userPreferenceSidebarWidth:Y,tempDragPosition:te,mobileBottomPadding:J,safeAreaTopPadding:Q,disablePopupContentResize:Se})),[be,me,Z,ye,$,fe,te,Y,J,Q,Se]);!function(e){const{chatPanelMode:t,chatSidebarPreferences:n,availableEditorSize:i,userPreferenceSidebarWidth:r}=e,s=(0,a().v3)(),l=(0,o.useRef)(null),c=(0,o.useRef)(i.width),d=(0,o.useRef)(!1),u=(0,o.useRef)(null),h=(0,b().K8)((()=>{const e=(0,I().d)({availableEditorSize:i,userPreferenceSidebarWidth:r});return i.width-e}),[i,r]);(0,o.useEffect)((()=>{"sidebar"!==t&&"popup"!==t||t!==n.chatPanelMode||(d.current=!0)}),[t,n.chatPanelMode]),(0,o.useEffect)((()=>{if("sidebar"!==t&&"popup"!==t)return;const e=h<A().UP?"popup":"sidebar"===n.chatPanelMode?"sidebar":"popup";c.current!==i.width&&(c.current=i.width,null!==u.current&&u.current!==e&&(d.current=!1),u.current=e),d.current||(t!==e?(l.current=e,(0,M().setChatPanelMode)({environment:s,chatPanelMode:e,trackAnalytics:!1,saveUserPreference:!1})):l.current=null),null===u.current&&(u.current=e)}),[t,n.chatPanelMode,h,i.width,s])}({chatPanelMode:H,chatSidebarPreferences:q,availableEditorSize:be,userPreferenceSidebarWidth:Y});const Ae=(0,o.useMemo)((()=>(0,I().d)({availableEditorSize:be,userPreferenceSidebarWidth:Y})),[be,Y]),je=l.device.isElectron&&!_,ze=je||!O,Te=(0,r().eP)(),Re=(0,r().IS)((()=>{const e="dark"===Te?[c().Tj.shadow.base.sm,`0 0 0 1px ${c().Tj.border.secondaryTranslucent}`,"0 0.5px 0 0 rgba(255, 255, 255, 0.20) inset"]:[c().Tj.shadow.base.md,`0 0 0 1px ${c().Tj.border.secondaryTranslucent}`],t=(0,y().f8)(i)?e.join(", "):c().Tj.shadowMD;return{clip:{overflow:"clip",position:"fixed",minWidth:0,pointerEvents:"none",backgroundColor:c().Tj.background.primary,borderRadius:"popup"===me?"22px 22px 36px 36px":0,boxShadow:"popup"===me?t:"none",transitionProperty:"box-shadow, border-radius",transitionTimingFunction:"ease-in-out, ease-in-out",transitionDuration:`${A().nW}ms, ${A().nW}ms`},dropzoneSidebar:{position:"fixed",zIndex:0,pointerEvents:"none",backgroundColor:c().Tj.blue.background.secondaryTranslucent,top:0,insetInlineEnd:0,bottom:0,width:Ae},dragArea:{position:"absolute",top:0,insetInlineStart:0,insetInlineEnd:0,height:44,zIndex:0,pointerEvents:"auto",cursor:ze?void 0:void 0!==ie?"grabbing":"grab"}}}),[me,Ae,ze,ie,i,Te]);(0,o.useEffect)((()=>{void 0===ye&&"closing"!==X&&void 0!==we&&B().globalChatPanelRuntimeStore.setState({...B().globalChatPanelRuntimeStore.state,editorWidthUsed:we})}),[we,ye,X]);const Ie=(0,o.useRef)(null),Ee=(0,o.useCallback)(((e,t)=>{const n=[];return((0,v().A1)()?e<=Ae:e>=d.width-Ae)&&n.push("sidebar"),n.push("popup"),n}),[d.width,Ae]),De=(0,o.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget.setPointerCapture(e.pointerId),ue([H]);const t=Ie.current;(null==t?void 0:t.getBoundingClientRect())&&ae({x:e.clientX,y:e.clientY})}),[H]),Be=(0,o.useCallback)((e=>{if(!ie)return;const t=e.clientX-ie.x,n=e.clientY-ie.y,o=Math.sqrt(t*t+n*n);if(!he&&o<A().GW)return;if(!he)if(B().globalChatPanelRuntimeStore.update((e=>({...e,isDragging:!0}))),"sidebar"===H){const t=Math.max(0,(0,v().A1)()?d.width-e.clientX-fe-A().Y_/2:Math.min(e.clientX-fe-A().Y_/2,d.width-fe-A().Y_)),n=0;se({x:t,y:n}),oe({x:t,y:n}),L.current=!1}else if("popup"===H){const e=Me.fromLeftNumeric-fe,t=Me.fromTopNumeric;se({x:e,y:t}),oe({x:e,y:t}),L.current=!1}if(!he||!re)return;const i=Ee(e.clientX,e.clientY);ue((e=>e.filter((e=>i.includes(e)))));const a=i.find((e=>!de.includes(e)));ce(a);const r=re.x+((0,v().A1)()?-t:t),s=re.y+n,l=Math.max(0,Math.min(r,d.width-A().Y_)),c=Math.max(0,Math.min(s,d.height-A().wl));oe({x:l,y:c})}),[H,ie,Ee,de,re,he,fe,Me.fromLeftNumeric,Me.fromTopNumeric,d.height,d.width]),Fe=(0,o.useCallback)((e=>{if(ie){if(e.currentTarget.releasePointerCapture(e.pointerId),he){L.current=!0;const t=Ee(e.clientX,e.clientY).find((e=>!de.includes(e)));t&&t!==H&&(0,M().setChatPanelMode)({environment:l,chatPanelMode:t,trackAnalytics:!0,saveUserPreference:!0})}ae(void 0),se(void 0),oe(void 0),ce(void 0),ue([]),B().globalChatPanelRuntimeStore.update((e=>({...e,isDragging:!1})))}}),[ie,he,Ee,H,de,l]),Ne=(0,o.useMemo)((()=>"sidebar"!==me?null:(0,N.jsx)("div",{style:{position:"absolute",top:0,insetInlineStart:0,bottom:0,zIndex:2},children:(0,N.jsx)(pe,{size:Pe.width.value,minSize:Pe.width.min,maxSize:Pe.width.max,anchorToSide:"right",onSizeWillChange:xe,onSizeChanging:Ce,onSizeChangeFinished:ke,onDismiss:V,keyboardShortcut:(0,N.jsx)(x().A,{name:"toggleAISidebar"})})})),[me,Pe.width.value,Pe.width.min,Pe.width.max,xe,Ce,ke,V]),We=function(e){const{chatPanelMode:t,chatPanelVisibility:n}=e,o="opening"===n||"open"===n;switch(t){case"popup":case"full":return{initial:z(!1),animate:z(o)};case"sidebar":return{initial:T(!1),animate:T(o)};default:(0,j().HB)(t)}}({chatPanelMode:me,chatPanelVisibility:X}),Le=L.current||"opening"===X||"closing"===X;return(0,N.jsx)(f().N,{capture:"open"===X,debugName:"ChatPanel",onEsc:G,onBackButton:V,children:(0,N.jsxs)(N.Fragment,{children:[he?(0,N.jsx)(u().N,{children:"sidebar"===le?(0,N.jsx)(h().P.div,{style:Re.dropzoneSidebar,variants:A().Kg,initial:"hiddenVariant",animate:"visibleVariant",exit:"hiddenVariant",transition:A().S_},"sidebar-dropzone"):void 0}):void 0,(0,N.jsx)(W,{chatPanelVisibility:X,editorWidthUsed:we,animationConfig:A().UZ,shouldAnimate:Le}),(0,N.jsxs)(g().A,{className:"test123",style:Re.clip,initial:We.initial,animate:{...We.animate,top:Me.fromTopCss,bottom:Me.fromBottomCss,insetInlineStart:Me.fromLeftCss,insetInlineEnd:Me.fromRightCss},skip:!Le||he,config:A().UZ,onAnimationEnd:ve,children:[(0,N.jsx)(ne,{chatPanelMode:me}),(0,N.jsx)("div",{ref:Ie,role:"none",className:je?s().sbV:void 0,style:Re.dragArea,onPointerDown:ze?void 0:De,onPointerMove:ze?void 0:Be,onPointerUp:ze?void 0:Fe}),(0,N.jsx)("div",{style:{width:Pe.width.value,height:Pe.height.value,position:"absolute",zIndex:1,...Le?{top:"50%",insetInlineStart:"50%",transform:"translate(calc(var(--direction, 1) * -50%), -50%)"}:{bottom:0,insetInlineEnd:0}},children:(0,N.jsx)(ee,{chatPanelState:ge,chatPanelMode:me,panelSize:Pe,onDismiss:V,onEsc:V,fromSurface:n,aiChatFeature:i})}),Ne]})]})})}var fe=()=>n(118503),be=()=>n(829298);function me(e){const{chatPanelState:t}=e,n=(0,b().K8)((()=>B().globalChatPanelRuntimeStore.state.debugSidebarWidth),[]),i=(0,b().K8)((()=>(null===H().defaultClientAIChatStore||void 0===H().defaultClientAIChatStore?void 0:H().defaultClientAIChatStore.state.showDebug)??!1),[]);(0,o.useEffect)((()=>{B().globalChatPanelRuntimeStore.setState({...B().globalChatPanelRuntimeStore.state,isDebugSidebarOpen:i})}),[i]);const a=(0,L().L)(),s=(0,b().K8)((()=>{if(a&&t)return(0,Q().threadStoreGivenRouteData)({spaceStore:a,chatPanelState:t})}),[a,t]),l=(0,r().IS)((()=>({debugPanelContent:{position:"relative",height:"100%",width:"100%",background:c().Tj.background.primary,pointerEvents:"auto"},content:{position:"absolute",top:0,bottom:0,insetInlineStart:0,insetInlineEnd:0,display:"flex",flexDirection:"column",overflow:"visible"}})),[]),d=(0,o.useCallback)((e=>{B().globalChatPanelRuntimeStore.setState({...B().globalChatPanelRuntimeStore.state,debugSidebarWidth:e})}),[]);return(0,N.jsx)(be().CollapsiblePanel,{config:t.isOpen&&i?{mode:"resizable",min:A().jp,max:A().pj,defaultSize:n||A().eI,userOverride:void 0,onUserResize:d}:{mode:"closed"},anchorToSide:"right",children:(0,N.jsx)("div",{style:l.debugPanelContent,children:(0,N.jsx)("div",{style:l.content,children:(0,N.jsx)(fe().m,{clientStore:H().defaultClientAIChatStore,threadStore:s})})})})}function Se({aiChatFeature:e,routeData:t,visibility:n,mode:o,fromSurface:c="corner"}){const{isMobileBrowser:u}=(0,a().Y0)();d(u,n);const h=(0,r().IS)((()=>({container:{order:l().A.appCursorListener.aiChatSidebar,cursor:"default",zIndex:110,height:"100%",insetInlineEnd:0,flexShrink:0,top:100,display:"flex",flexDirection:"row",justifyContent:"flex-end"}})),[]),p=(0,i().A)(!0);return"closed"===n?null:(0,N.jsxs)("div",{style:h.container,className:s().AF8,...p,children:["sidebar"===o&&t?(0,N.jsx)(me,{chatPanelState:t}):null,t?(0,N.jsx)(ge,{aiChatFeature:e,chatSidebarRouteData:t}):null]})}},829298:(e,t,n)=>{n.r(t),n.d(t,{CollapsiblePanel:()=>P,Resizer:()=>A});var o=n(296540),i=()=>n(756117),a=()=>n(782482),r=()=>n(383036),s=()=>n(484714),l=()=>n(951500),c=()=>n(819121),d=()=>n(93583),u=()=>n(401497),h=()=>n(86159),p=()=>n(699143),g=()=>n(493552),f=()=>n(26697),b=()=>n(591779),m=()=>n(69708),S=()=>n(100622),v=()=>n(496603),y=()=>n(534177),x=()=>n(440024),C=()=>n(222321),k=n(474848);const w=10;function P(e){const{config:t,anchorToSide:n,children:a,onDismiss:r,onAnimationEnd:s,keyboardShortcut:c,onWidthWillChange:d,onWidthChanged:h,appearance:g}=e,f=(0,l().l)(t),m=(0,b().ZC)(f),[v,x]=(0,o.useState)(void 0),C="resizable"===f.mode,w="resizable"===f.mode?f.min:0,P="resizable"===f.mode?f.max:1/0,[j,z]=(0,o.useState)(0);(0,o.useEffect)((()=>{let e;switch(f.mode){case"closed":e=0;break;case"fill":e=f.availableWidth;break;case"fixed":e=f.width;break;case"resizable":e=v??f.userOverride??f.defaultSize;break;default:(0,y().HB)(f)}const t=Math.max(w,Math.min(P,e));t!==j&&(null==d||d(t,void 0!==v),z(t))}),[f,v,j,d,w,P]);const T=(0,o.useRef)(!1);m!==f&&(T.current=(null==m?void 0:m.mode)!==f.mode);const R="closed"!==f.mode,I=(0,o.useCallback)((()=>{T.current=!1,null==s||s(f),null==h||h(j)}),[f,s,j,h]);(0,o.useEffect)((()=>{x(void 0)}),[f]);const E=(0,o.useCallback)((e=>{C&&(T.current=!1,x(e))}),[C]),D=(0,o.useCallback)((()=>{var e;"resizable"===f.mode&&v&&(null===(e=f.onUserResize)||void 0===e||e.call(f,v),x(void 0),null==h||h(v))}),[f,v,h]),B=(0,u().IS)((()=>({outer:{overflow:"clip",height:"100%",position:"relative",minWidth:0,pointerEvents:"none",flexShrink:0,..."elevated"===g&&R?{boxShadow:S().Tj.shadowMD}:{}},borderArea:{position:"absolute",top:0,height:"100%",zIndex:100,display:"flex",insetInlineEnd:"left"===n?0:void 0,insetInlineStart:"right"===n?0:void 0}})),[n,g,R]);let F;"resizable"===f.mode?F=(0,k.jsx)(A,{size:j,minSize:w,maxSize:P,anchorToSide:n,onSizeChanging:E,onSizeChangeFinished:D,onDismiss:r,keyboardShortcut:c}):"fixed"===f.mode&&(F=(0,k.jsx)(M,{}));const N=T.current;return(0,k.jsx)(i().A,{style:B.outer,forceCompositeLayer:!0,config:{duration:400},animate:{width:R?j:0},skip:!N,onAnimationEnd:I,children:(0,k.jsx)("div",{style:{width:j,height:"100%",position:"absolute",..."right"===n?{right:0}:{left:0}},children:(0,k.jsxs)(p().Y1,{direction:"horizontal",height:"fill",width:"fill",children:[a,(0,k.jsx)("div",{style:B.borderArea,children:F})]})})})}function M(){const e=(0,u().IS)((()=>({separator:{width:1,backgroundColor:S().Tj.border.secondary}})),[]);return(0,k.jsx)("div",{style:e.separator})}function A(e){const{size:t,anchorToSide:n,minSize:i,maxSize:l,onSizeChanging:p,onSizeChangeFinished:b,onDismiss:y,keyboardShortcut:P}=e,M=(0,m().tz)(),A=(0,s().v3)(),{device:j}=A,[z,T]=(0,o.useState)(!1),[R,I]=(0,o.useState)({x:0,y:0}),[E,D]=(0,c().A)(),B=(0,o.useRef)(null),F=(0,d().A)(E,B),N=(0,o.useRef)(null),W=(0,o.useRef)(!1),L=(0,o.useCallback)((e=>Math.max(i,Math.min(l,e))),[i,l]),_=(0,o.useCallback)((e=>{(0,x().I)({environment:A}),N.current={startX:e.currentX,startSize:t},W.current=!1}),[A,t]),O=(0,o.useCallback)((e=>{if(!N.current)return;h().clear(A),W.current=!0;const{startX:t,startSize:o}=N.current,i=e.currentX-t,a=L("right"===n?o-i:o+i);null==p||p(a)}),[n,A,L,p]),K=(0,o.useCallback)((()=>{!W.current&&y&&y(),N.current=null,null==b||b()}),[y,b]),V=(0,o.useCallback)((()=>{N.current=null}),[]),U=(0,o.useCallback)((()=>{var e;const t=null===(e=B.current)||void 0===e?void 0:e.getBoundingClientRect();t&&I((e=>({x:t.left+t.width/2,y:e.y||t.top+t.height/2})))}),[]),$=(0,o.useCallback)((e=>{var t;T(!0);const n=null===(t=B.current)||void 0===t?void 0:t.getBoundingClientRect();n&&I({x:n.left+n.width/2,y:e.clientY})}),[]),Y=(0,o.useCallback)((()=>{T(!0)}),[]),X=(0,o.useCallback)((()=>{T(!1)}),[]),G=(0,o.useCallback)((()=>{const e=L(t-w);null==p||p(e),null==b||b(),requestAnimationFrame(U)}),[t,L,p,b,U]),H=(0,o.useCallback)((()=>{const e=L(t+w);null==p||p(e),null==b||b(),requestAnimationFrame(U)}),[t,L,p,b,U]),q=(0,o.useCallback)((()=>{y&&y()}),[y]);(0,o.useEffect)((()=>{requestAnimationFrame(U)}),[D,U]);const Z=(t-i)/(l-i),J=e=>(0,k.jsx)(g().D,{as:"span",colorVariant:"inverseSecondary",children:e}),Q=(0,o.useCallback)((()=>{const e=Boolean(y),t=Boolean(P);return e&&t?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(m().sA,{defaultMessage:"Close <invertedcolor>Click or {keyboardShortcut}</invertedcolor>",id:"collapsiblePanelResizer.tooltip.closeWithShortcut",values:{invertedcolor:J,keyboardShortcut:P}}),(0,k.jsx)("br",{}),(0,k.jsx)(m().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:J}})]}):e?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(m().sA,{defaultMessage:"Close <invertedcolor>Click</invertedcolor>",id:"collapsiblePanelResizer.tooltip.closeMessage",values:{invertedcolor:J}}),(0,k.jsx)("br",{}),(0,k.jsx)(m().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:J}})]}):(0,k.jsx)(m().sA,{defaultMessage:"Resize <invertedcolor>Drag</invertedcolor>",id:"collapsiblePanelResizer.tooltip.resizeMessage",values:{invertedcolor:J}})}),[y,P]),ee="left"===n?G:H,te="right"===n?G:H,ne=(0,u().IS)((()=>({wrapper:{height:"100%",zIndex:1},draggable:{cursor:"col-resize",height:"100%",width:12,position:"absolute",pointerEvents:"auto",..."right"===n?{insetInlineStart:0}:{insetInlineEnd:0},top:0},resizer:{position:"absolute",..."right"===n?{insetInlineStart:0}:{insetInlineEnd:0},top:0,height:"100%",width:z?1:0,backgroundColor:z?S().Tj.border.primary:S().Tj.border.secondary,pointerEvents:"none"}})),[n,z]);return j.isChromebook?null:(0,k.jsx)(a().N,{capture:D,debugName:"SidebarResizer",onLeft:ee,onRight:te,onUp:v().D_,onDown:v().D_,onTab:v().D_,onUntab:v().D_,onEnter:q,children:(0,k.jsx)(f().m,{renderTooltip:Q,originRect:new DOMRect(R.x,R.y,0,0),placement:"right"===n?"left":"right",originGap:16,delayThreshold:0,render:e=>(0,k.jsxs)("div",{className:"wrapper",style:ne.wrapper,...(0,r().A)(e,{onMouseMove:Y,onMouseLeave:X,onMouseEnter:$}),children:[(0,k.jsx)("div",{style:ne.resizer}),(0,k.jsx)(C().A,{onDraggableDragStart:_,onDraggableDragMove:O,onDraggableDragEnd:K,onDraggableDragCancel:V,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,k.jsx)("div",{className:"separator",ref:F,role:"separator",tabIndex:0,"aria-label":M.formatMessage({id:"sidebarResizer.tooltip.resizeLabel",defaultMessage:"Resize with left and right arrow keys"}),"aria-orientation":"vertical","aria-valuenow":Math.round(100*Z),"aria-valuemin":0,"aria-valuemax":100,style:ne.draggable,...e})})]})})})}}}]);