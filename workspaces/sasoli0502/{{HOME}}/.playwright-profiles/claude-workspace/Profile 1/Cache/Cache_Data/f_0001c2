"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[61165],{81252:(e,t,n)=>{n.d(t,{TF:()=>m});n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(803949),n(581454);var i=()=>n(534177),o=()=>n(687249);const r="\t",a=/([\\*~`$[\]<>{}|^])/g;function l(e){return e.replace(a,"\\$1")}const c="<user-selection>",d="</user-selection>";function s(e){const{text:t,selectionStartIndices:n,selectionEndIndices:i,collapsedCursorIndices:o,escapeChars:r}=e;let a=e.currentIndex,s="";for(let u=0;u<t.length;u++){null!=i&&i.has(a)&&(s+=d),null!=o&&o.has(a)&&(s+=c,s+=d),null!=n&&n.has(a)&&(s+=c);const e=t[u];s+=r?l(e):e,a++}return{result:s,newIndex:a}}function u(e,t){const n=[],i=[];return e.strike&&!t.strike&&n.push("~~"),e.bold&&!t.bold&&n.push("**"),e.italic&&!t.italic&&n.push("*"),!e.bold&&t.bold&&i.push("**"),!e.italic&&t.italic&&i.push("*"),!e.strike&&t.strike&&i.push("~~"),{close:n,open:i}}function p(e){const t=e.annotations??{};return!(t.href||t.code||t.color||t.underline||t.discussionUrls&&0!==t.discussionUrls.length)}function b(e){var t,n,i;return"string"!=typeof e&&"annotated"===e.type&&p(e)?{bold:Boolean(null===(t=e.annotations)||void 0===t?void 0:t.bold),italic:Boolean(null===(n=e.annotations)||void 0===n?void 0:n.italic),strike:Boolean(null===(i=e.annotations)||void 0===i?void 0:i.strikethrough)}:"string"!=typeof e&&"mention"===e.type&&e.annotations&&(e.annotations.bold||e.annotations.italic||e.annotations.strikethrough)?{bold:Boolean(e.annotations.bold),italic:Boolean(e.annotations.italic),strike:Boolean(e.annotations.strikethrough)}:{}}function f(e){const{elems:t,selectionStartIndices:n,selectionEndIndices:i,collapsedCursorIndices:o}=e;let r="",a={},l=0;const f=()=>{null!=o&&o.has(l)?(r+=c,r+=d):(null!=i&&i.has(l)&&(r+=d),null!=n&&n.has(l)&&(r+=c))};for(const c of t){const e=b(c),{close:t,open:d}=u(a,e);if(r+=t.join("")+d.join(""),"string"==typeof c){const e=s({text:c,currentIndex:l,selectionStartIndices:n,selectionEndIndices:i,collapsedCursorIndices:o,escapeChars:!0});r+=e.result.replace(/\n/g,"<br>"),l=e.newIndex}else{if("annotated"===c.type&&p(c)){const t=s({text:c.text,currentIndex:l,selectionStartIndices:n,selectionEndIndices:i,collapsedCursorIndices:o,escapeChars:!0});r+=t.result.replace(/\n/g,"<br>"),l=t.newIndex,a=e;continue}switch(c.type){case"annotated":{const{result:e,newIndex:t}=$(c.text,c.annotations,l,n,i,o);r+=e,l=t;break}case"equation":f(),r+=`$\`${c.equation.trim()}\`$`;break;case"mention":f(),r+=v(c),l++;break;case"citation":f(),r+=`[^${c.href}]`,l++}}a=e}return r+=u(a,{}).close.join(""),f(),r}function m({blocks:e,omitUnknownBlocks:t=!1,skipTranscriptionTranscript:n=!0,selectedBlockIds:i,textSelection:o,textSelections:r}){const a=function(e,t){const n=(null==t?void 0:t.omitUnknownBlocks)??!1,i=(null==t?void 0:t.addCitations)??!1,o=(null==t?void 0:t.skipTranscriptionTranscript)??!1,r=null!=t&&t.selectedBlockIds?new Set(t.selectedBlockIds):void 0,a=function(e){const{textSelection:t,textSelections:n}=e,i=n??(t?[t]:void 0);if(!i||0===i.length)return;const o=new Map,r=new Map,a=new Map,l=new Set;for(const c of i){let e=c.start,t=c.end;e.pointer.id===t.pointer.id&&e.index>t.index&&(e=c.end,t=c.start);const n=[e.pointer.id,e.pointer.spaceId??"",e.index,t.pointer.id,t.pointer.spaceId??"",t.index].join(":");if(l.has(n))continue;if(l.add(n),e.pointer.id===t.pointer.id&&e.index===t.index){const t=a.get(e.pointer.id)??new Set;t.add(e.index),a.set(e.pointer.id,t);continue}const i=o.get(e.pointer.id)??new Set;i.add(e.index),o.set(e.pointer.id,i);const d=r.get(t.pointer.id)??new Set;d.add(t.index),r.set(t.pointer.id,d)}return{startIndicesByBlockId:o,endIndicesByBlockId:r,collapsedCursorIndicesByBlockId:a}}({textSelection:null==t?void 0:t.textSelection,textSelections:null==t?void 0:t.textSelections}),l=[];let c=0,d=1;const s=e=>{let t=0;if(e.children)for(const n of e.children)t+=n.content.split("\n").length,t+=s(n),"cells"in n&&n.cells&&(t+=n.cells.length);return t};for(let u=0;u<e.length;u++){const t=e[u],p=e[u-1],b="numbered_list"===(null==p?void 0:p.type),f=y(t,0,"numbered_list"===t.type&&b?c:0,d,n,i,o,r,a);d+=f.content.split("\n").length,f.children&&(d+=s(f)),l.push(f),"numbered_list"!==t.type?c=0:c++}return l}(e,{omitUnknownBlocks:t,skipTranscriptionTranscript:n,selectedBlockIds:i,textSelection:o,textSelections:r}),l=new Map;for(const c of a){const e=h([c]);l.set(c.id,e)}return a.map((e=>{const t=l.get(e.id)||"";return{id:e.id,content:t}}))}function h(e){const t=[];function n(e,i=0){if(!e)return;let o;if(e.content)if(o=function(e){const t=e.content.trim();if(t.includes("<synced_block_reference"))return"synced_block_reference";if(t.includes("<synced_block"))return"synced_block";if(t.includes("<callout"))return"callout";if(t.includes("<meeting-notes"))return"meeting-notes";if(t.includes("<tabs"))return"tabs";if(t.includes("<columns"))return"columns";if(t.includes("<column"))return"column";if(t.includes("<summary"))return"summary";if(t.includes("<notes"))return"notes";if(t.includes("<transcript"))return"transcript";if(t.includes("<table>")||t.includes("<table "))return"table";if(t.includes("<tr"))return"tr";if(/<tab(\s|>)/.test(t))return"tab";return}(e),o){const n=e.content.split("\n"),i=n[0];if(t.push(i),n.length>2)for(let e=1;e<n.length-1;e++)t.push(n[e]);if("tr"===o&&"cells"in e&&e.cells)for(const o of e.cells)t.push(o.content)}else t.push(e.content);if(e.children&&e.children.length>0)for(const t of e.children)n(t,i+1);if(o){const e=r.repeat(i),n="tr"===o?"":e;t.push(`${n}</${o}>`)}}for(const i of e)n(i);return t.join("\n")}function g(e){return e?` {color="${e}"}`:""}function y(e,t,n=0,a=1,l,u=!1,p=!1,b,m){const h=r.repeat(t),$=t=>b&&b.has(e.id)?`${c}${t}${d}`:t,v=null==m?void 0:m.startIndicesByBlockId.get(e.id),_=null==m?void 0:m.endIndicesByBlockId.get(e.id),I=null==m?void 0:m.collapsedCursorIndicesByBlockId.get(e.id),k=e=>{if(0===e.length){let e="";return null!=_&&_.has(0)&&(e+=d),null!=I&&I.has(0)&&(e+=c,e+=d),null!=v&&v.has(0)&&(e+=c),e}return f({elems:e,selectionStartIndices:v,selectionEndIndices:_,collapsedCursorIndices:I})},x=e=>"children"in e&&Array.isArray(e.children)?e.children:void 0,w=e=>{let t=e.content.split("\n").length;if(e.children)for(const n of e.children)t+=w(n);return t},T=(e,t,n)=>{const i=[];let o=t+1,r=0,a=y(e[0],n+1,0,o,l,u,p,b,m);i.push(a),"numbered_list"===e[0].type&&(r=1);for(let d=1;d<e.length;d++){var c;o+=w(a);const t=e[d],s="numbered_list"===(null===(c=e[d-1])||void 0===c?void 0:c.type),f=y(t,n+1,"numbered_list"===t.type&&s?r:0,o,l,u,p,b,m);i.push(f),a=f,"numbered_list"===t.type?r++:r=0}return i};switch(e.type){case"text":{let n="";if(e.text&&0!==e.text.length)n=`${h}${k(e.text)}${g(e.color)}`,e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);else{let e="";null!=_&&_.has(0)&&(e+=d),null!=I&&I.has(0)&&(e+=c,e+=d),null!=v&&v.has(0)&&(e+=c),n=`${h}<empty-block/>${e}`}const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"ai_block":{const n=`${h}${e.text&&k(e.text)}`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"h1":case"h2":case"h3":case"h4":{const n="h1"===e.type?"#":"h2"===e.type?"##":"h3"===e.type?"###":"####";if(e.toggleable){const n="h1"===e.type?"▶#":"h2"===e.type?"▶##":"h3"===e.type?"▶###":"▶####",i=k(e.text||[]);let r=`${h}${n}${i?` ${i}`:""}${g(e.color)}`;e.citationData&&(r+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const l=x(e);return{content:$(r),lineNumber:a,children:l?T(l,a,t):void 0,id:e.id}}const i=x(e),r=k(e.text||[]);let l=`${h}${n}${r?` ${r}`:""}${g(e.color)}`;return e.citationData&&(l+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`),{content:$(l),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"toggle":{let n=`${h}▶${e.text&&e.text.length?` ${k(e.text)}`:""}${g(e.color)}`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"callout":{const n=e.color?` color="${e.color}"`:"";let i=`${h}<callout${e.icon?` icon="${e.icon}"`:""}${n}>`;e.text&&(i+=`\n${h}${r}${k(e.text)}`),i+="\n</callout>",e.citationData&&(i+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const l=x(e);return{content:$(i),lineNumber:a,children:l?T(l,a,t):void 0,id:e.id}}case"to_do":{const n=e.checked?"[x]":"[ ]",i=e.text?k(e.text):"";let r=`${h}- ${n}${i?` ${i}`:""}${g(e.color)}`;e.citationData&&(r+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const l=x(e);return{content:$(r),lineNumber:a,children:l?T(l,a,t):void 0,id:e.id}}case"bulleted_list":{const n=e.text?k(e.text):"";let i=`${h}-${n?` ${n}`:""}${g(e.color)}`;e.citationData&&(i+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const r=x(e);return{content:$(i),lineNumber:a,children:r?T(r,a,t):void 0,id:e.id}}case"numbered_list":{const i=e.text?k(e.text):"";let r=`${h}${n+1}.${i?` ${i}`:""}${g(e.color)}`;e.citationData&&(r+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const l=x(e);return{content:$(r),lineNumber:a,children:l?T(l,a,t):void 0,id:e.id}}case"quote":{const n=k(e.text||[]);let i=`${h}>${n?` ${n}`:""}${g(e.color)}`;e.citationData&&(i+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const r=x(e);return{content:$(i),lineNumber:a,children:r?T(r,a,t):void 0,id:e.id}}case"divider":{const n=x(e);return{content:$(`${h}---`),lineNumber:a,children:n?T(n,a,t):void 0,id:e.id}}case"code":{var D;const n=`${h}\`\`\`${(null===(D=e.language)||void 0===D?void 0:D.toLowerCase())||""}\n${s({text:(U=e.text)&&0!==U.length?U.map((e=>{if("string"==typeof e)return e;switch(e.type){case"annotated":return e.text;case"equation":return e.equation;case"mention":{const t=e.mention;return"name"in t&&t.name?t.name:"title"in t&&t.title?t.title:""}case"citation":return"";default:(0,i().HB)(e)}})).join(""):"",currentIndex:0,selectionStartIndices:v,selectionEndIndices:_,collapsedCursorIndices:I,escapeChars:!1}).result}\n${h}\`\`\``,o=x(e);return{content:$(n),lineNumber:a,children:o?T(o,a,t):void 0,id:e.id}}case"equation":{let n=`${h}$$\n${h}${s({text:e.text&&"string"==typeof e.text[0]?e.text[0]:"",currentIndex:0,selectionStartIndices:v,selectionEndIndices:_,collapsedCursorIndices:I,escapeChars:!1}).result}\n${h}$$${g(e.color)}`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"table":return function(e,t,n,i){const o=t=>i&&i.has(e.id)?`<user-selection>${t}</user-selection>`:t;if(!e.rows||0===e.rows.length)return{content:o(`${t}<table>\n${t}</table>`),lineNumber:n,children:void 0,id:e.id};const{attrsStr:r,colgroupContent:a,renderCell:l}=function(e,t){const n=[];void 0!==e.fitPageWidth&&n.push(`fit-page-width="${e.fitPageWidth}"`);void 0!==e.headerRow&&n.push(`header-row="${e.headerRow}"`);void 0!==e.headerColumn&&n.push(`header-column="${e.headerColumn}"`);const i=n.length>0?` ${n.join(" ")}`:"";let o="";e.columnStyles&&e.columnStyles.length>0&&(o=`\n${t}<colgroup>`,e.columnStyles.forEach((e=>{const n=e.color?` color="${e.color}"`:"",i=e.width?` width="${e.width}"`:"";o+=`\n${t}<col${n}${i}>`})),o+=`\n${t}</colgroup>`);const r=e=>`<td${e.color?` color="${e.color}"`:""}>${f({elems:e.text||[]})}</td>`;return{attrsStr:i,colgroupContent:o,renderCell:r}}(e,t);let c=`${t}<table${r}>`;c+=a,c+=`\n${t}</table>`;const d=[];let s=n+1;return e.rows.forEach((e=>{const t=`<tr${e.color?` color="${e.color}"`:""}>\n</tr>`,n=[];let i=s+1;e.cells.forEach((e=>{const t=l(e);n.push({content:t,lineNumber:i}),i++})),d.push({id:e.id,content:t,lineNumber:s,cells:n}),s+=n.length+2})),{content:o(c),lineNumber:n,children:d,id:e.id}}(e,h,a,b);case"column_list":{const n=`${h}<columns>\n</columns>`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"column":{const n=`${h}<column>\n</column>`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"tab":{const n=`${h}<tabs>\n</tabs>`,i=x(e);if(!i||0===i.length)return{content:$(n),lineNumber:a,children:void 0,id:e.id};const l=(e,t)=>{const n=null==m?void 0:m.startIndicesByBlockId.get(e),i=null==m?void 0:m.endIndicesByBlockId.get(e);if(0===t.length){let e="";return null!=i&&i.has(0)&&(e+=d),null!=n&&n.has(0)&&(e+=c),e}return f({elems:t,selectionStartIndices:n,selectionEndIndices:i})},s=(e,t)=>b&&b.has(e)?`${c}${t}${d}`:t,u=(e,t,n)=>{const i=r.repeat(t),a="text"in e?e.text:void 0,c=a?l(e.id,a):"",d="color"in e?e.color:void 0;let u=`${i}<tab>`;if(void 0!==a){let t=`${i}${r}${c}${g(d)}`;"citationData"in e&&e.citationData&&(t+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`),u+=`\n${t}`}u+=`\n${i}</tab>`;const p=void 0!==a?1:0,b="children"in e&&e.children?T(e.children,n+p,t):void 0;return{content:s(e.id,u),lineNumber:n,children:b,id:e.id}},p=[];let y=a+1;for(const e of i){const n=u(e,t+1,y);p.push(n),y+=w(n)}return{content:$(n),lineNumber:a,children:p,id:e.id}}case"synced_block":{let n=`${h}<synced_block${e.url?` url="${e.url}"`:""}>\n</synced_block>`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"synced_block_reference":{let n=`${h}<synced_block_reference url="${e.originalUrl}">\n</synced_block_reference>`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"page":{const n=`${h}${function(e){return`<page url="${e.url}"${e.deleted?" deleted":""}${e.color?` color="${e.color}"`:""}>${f({elems:e.text||[]})}</page>`}(e)}`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"database":{const n=`${h}${function(e){const t=[];e.url&&t.push(`url="${e.url}"`);t.push(`inline="${!0===e.inline}"`),e.deleted&&t.push("deleted");e.icon&&t.push(`icon="${e.icon}"`);e.dataSourceUrl&&t.push(`data-source-url="${e.dataSourceUrl}"`);e.color&&t.push(`color="${e.color}"`);return`<database ${t.join(" ")}>${f({elems:e.text||[]})}</database>`}(e)}`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"audio":case"image":case"video":case"file":case"pdf":{let n=`${h}${function(e){const t=` source="${e.source||""}"`,n=e.color?` color="${e.color}"`:"";return`<${e.type}${t}${n}>${f({elems:e.text||[]})}</${e.type}>`}(e)}`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"mail":{var E;let n=`${h}<mail>`;null!==(E=e.text)&&void 0!==E&&E.length&&(n+=`\n${h}${r}${k(e.text)}`,a+=1),n+=`\n${h}</mail>`;const i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"transcription":{var N;let n=`${h}<meeting-notes${e.attendeeIds&&e.attendeeIds.length>0?` attendees="${e.attendeeIds.map((e=>`user://${e}`)).join(",")}"`:""}${p&&e.url?` readOnlyViewMeetingNoteUrl="${e.url}"`:""}>`;e.citationData&&(n+=` [^{{${(0,o().Ts)({id:e.id,recordType:e.citationData.type,url:e.citationData.url,spaceId:e.citationData.spaceId})}}}]`);const i=a;null!==(N=e.text)&&void 0!==N&&N.length&&(n+=`\n${h}${r}${k(e.text)}`,a+=1),n+="\n</meeting-notes>";const l=e.summary?x(e.summary):void 0,c=e.transcript?x(e.transcript):void 0,d=e.notes?x(e.notes):void 0,s=[];let u=a+1;if(e.summary&&l){const n={id:e.summary.id,content:`${h}${r}<summary>\n</summary>`,lineNumber:u,children:T(l,u,t+1)};s.push(n),u+=w(n)}if(e.notes){const n={id:e.notes.id,content:`${h}${r}<notes>\n</notes>`,lineNumber:u,children:d&&d.length>0?T(d,u,t+1):void 0};s.push(n),u+=w(n)}if(e.transcript&&c)if(p){const t={id:e.transcript.id,content:`${h}${r}<transcript>\n${h}${r}${r}Transcript omitted. Use the view tool with the meeting note url to view this transcript.\n${h}${r}</transcript>`,lineNumber:u,children:void 0};s.push(t),u+=w(t)}else{const n={id:e.transcript.id,content:`${h}${r}<transcript>\n</transcript>`,lineNumber:u,children:T(c,u,t+1)};s.push(n),u+=w(n)}return{content:$(n),lineNumber:i,children:s,id:e.id}}case"table_of_contents":{const n=`${h}<table_of_contents${e.color?` color="${e.color}"`:""}/>`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}case"unknown":{if(l)return{content:$(""),lineNumber:a,children:void 0,id:e.id};const n=`${h}<unknown url="${e.url}"${e.alt?` alt="${e.alt}"`:""}/>`,i=x(e);return{content:$(n),lineNumber:a,children:i?T(i,a,t):void 0,id:e.id}}default:const u=x(e);return{content:$(`${h}/* unsupported ${e.type} */`),lineNumber:a,children:u?T(u,a,t):void 0,id:e.id}}var U}function $(e,t={},n=0,i,o,r){const a=s({text:e,currentIndex:n,selectionStartIndices:i,selectionEndIndices:o,collapsedCursorIndices:r,escapeChars:!t.code});let l=t.code?a.result.replace(/`/g,"\\`"):a.result;l=l.replace(/\n/g,"<br>"),t.code&&(l=`\`${l}\``),t.strikethrough&&(l=`~~${l}~~`),t.bold&&t.italic?l=`***${l}***`:(t.bold&&(l=`**${l}**`),t.italic&&(l=`*${l}*`)),t.href&&(l=`[${l}](${t.href})`);const c=[];return t.color&&c.push(`color="${t.color}"`),t.underline&&c.push('underline="true"'),t.discussionUrls&&t.discussionUrls.length>0&&c.push(`discussion-urls="${t.discussionUrls.join(",")}"`),c.length>0&&(l=`<span ${c.join(" ")}>${l}</span>`),{result:l,newIndex:a.newIndex}}function v(e){const{mention:t}=e,n=t=>{const n=e.annotations??{};if(!(n.color||n.underline||n.discussionUrls&&0!==n.discussionUrls.length))return t;const i=[];return n.color&&i.push(`color="${n.color}"`),n.underline&&i.push('underline="true"'),n.discussionUrls&&n.discussionUrls.length>0&&i.push(`discussion-urls="${n.discussionUrls.join(",")}"`),`<span ${i.join(" ")}>${t}</span>`};switch(t.type){case"user":return n(void 0===t.name?`<mention-user url="${t.url}"/>`:`<mention-user url="${t.url}">${l(t.name)}</mention-user>`);case"page":return n(void 0===t.title?`<mention-page url="${t.url}"/>`:`<mention-page url="${t.url}">${l(t.title)}</mention-page>`);case"database":return n(void 0===t.title?`<mention-database url="${t.url}"/>`:`<mention-database url="${t.url}">${l(t.title)}</mention-database>`);case"data-source":return n(void 0===t.title?`<mention-data-source url="${t.url}"/>`:`<mention-data-source url="${t.url}">${l(t.title)}</mention-data-source>`);case"agent":return n(void 0===t.name?`<mention-agent url="${t.url}"/>`:`<mention-agent url="${t.url}">${l(t.name)}</mention-agent>`);case"date":return n(`<mention-date start="${t.start}"${t.end?` end="${t.end}"`:""}/>`);case"custom_emoji":return n(`:${t.name}:`)}}},265282:(e,t,n)=>{n.d(t,{Ah:()=>a,Er:()=>c,Fi:()=>r,f9:()=>l});var i=()=>n(534177);const o={gray:"gray",brown:"brown",orange:"orange",yellow:"yellow",green:"teal",blue:"blue",purple:"purple",pink:"pink",red:"red",gray_bg:"gray_background",brown_bg:"brown_background",orange_bg:"orange_background",yellow_bg:"yellow_background",green_bg:"teal_background",blue_bg:"blue_background",purple_bg:"purple_background",pink_bg:"pink_background",red_bg:"red_background"};function r(e){for(const t of(0,i().uv)(o))if(t===e)return!0;return!1}function a(e){if(e)return o[e]}function l(e){if(e)for(const[t,n]of Object.entries(o))if(n===e)return t}function c(e){return"image"===e.type||"pdf"===e.type||"file"===e.type||"audio"===e.type||"video"===e.type?(e.type,!0):(e.type,!1)}},492736:(e,t,n)=>{n.d(t,{CU:()=>a,FS:()=>l,yr:()=>r});n(16280);var i=()=>n(534177),o=()=>n(522419);function r(e){const t=e.type;return"audio"===t?"audio":"bulleted_list"===t?"bulleted_list":"callout"===t?"callout":"code"===t?"code":"collection_view"===t||"collection_view_page"===t?"database":"column"===t?"column":"column_list"===t?"column_list":"divider"===t?"divider":"equation"===t?"equation":"file"===t?"file":"header"===t?"h1":"sub_header"===t?"h2":"sub_sub_header"===t?"h3":"header_4"===t?"h4":"image"===t?"image":"numbered_list"===t?"numbered_list":"page"===t?"page":"pdf"===t?"pdf":"quote"===t?"quote":"table"===t?"table":"table_of_contents"===t?"table_of_contents":"table_row"===t?"table_row":"tab"===t?"tab":"text"===t?"text":"to_do"===t?"to_do":"toggle"===t?"toggle":"video"===t?"video":"transcription"===t?"transcription":"transclusion_container"===t?"synced_block":"transclusion_reference"===t?"synced_block_reference":"ai_block"===t?"ai_block":"mail"===t?"mail":"drawing"===t||"abstract"===t||"alias"===t||"bookmark"===t||"breadcrumb"===t||"button"===t||"codepen"===t||"copy_indicator"===t||"deepnote"===t||"drive"===t||"embed"===t||"excalidraw"===t||"external_object_instance"===t||"external_object_instance_page"===t||"factory"===t||"figma"===t||"framer"===t||"gist"===t||"hex"===t||"invision"===t||"link_to_collection"===t||"link_to_page"===t||"loom"===t||"maps"===t||"miro"===t||"mixpanel"===t||"personal_home_page"===t||"home_shortcuts"===t||"replit"===t||"sketch"===t||"slide"===t||"tweet"===t||"typeform"===t||"whimsical"===t||"form"===t||"post"===t||"workflow"===t||"temporary_ui"===t||"edit_reference"===t?"unknown":void(0,i().HB)(t)}function a(e){if("text"===e.type)return"text";if("ai_block"===e.type)return"ai_block";if("to_do"===e.type)return"to_do";if("bulleted_list"===e.type)return"bulleted_list";if("numbered_list"===e.type)return"numbered_list";if("toggle"===e.type)return"toggle";if("column"===e.type)return"column";if("column_list"===e.type)return"column_list";if("callout"===e.type)return"callout";if("quote"===e.type)return"quote";if("h1"===e.type)return"header";if("h2"===e.type)return"sub_header";if("h3"===e.type)return"sub_sub_header";if("h4"===e.type)return"header_4";if("page"===e.type)return"page";if("database"===e.type)return"collection_view";if("equation"===e.type)return"equation";if("audio"===e.type)return"audio";if("image"===e.type)return"image";if("file"===e.type)return"file";if("divider"===e.type)return"divider";if("pdf"===e.type)return"pdf";if("table_of_contents"===e.type)return"table_of_contents";if("code"===e.type)return"code";if("table"===e.type)return"table";if("table_row"===e.type)return"table_row";if("tab"===e.type)return"tab";if("video"===e.type)return"video";if("transcription"===e.type)return"transcription";if("synced_block"===e.type)return"transclusion_container";if("synced_block_reference"===e.type)return"transclusion_reference";if("edit_reference"===e.type)return"edit_reference";if("mail"===e.type)return"mail";if("unknown"===e.type)throw new Error(`Unknown block type: ${e}`);(0,i().HB)(e)}function l(e){return!o()._J(e)&&(e.startsWith("https://")||e.startsWith("http://"))}},661165:(e,t,n)=>{n.d(t,{_5:()=>I});n(16280),n(944114),n(898992),n(354520),n(430670),n(581454),n(737550);var i=()=>n(496603),o=()=>n(700500),r=()=>n(15440),a=()=>n(416504),l=()=>n(402390),c=()=>n(792071),d=()=>n(142748),s=()=>n(179034),u=()=>n(201980),p=()=>n(265282);var b=()=>n(687249),f=()=>n(761865),m=()=>n(798880),h=()=>n(743246);function g(e){const{title:t,baseUrl:n,disableTemplateWrapper:i,recordMap:o,parseAnnotationsAsMentions:r=!0,skipUrlNormalization:a=!1}=e,d=[],p=e.intl||(0,l().wW)();for(const l of(0,u().RQ)(t)){const e=a?(0,u().N8A)(l):(0,b().TE)((0,u().N8A)(l),{baseUrl:n,publicDomainName:""}),t=(0,u().uPN)(l),g=$(t,i);if((0,u().qXl)(l)){const e=(0,u().snh)(t);if(e){const t=(0,u().NcG)(e),n=null==o?void 0:o.getModel({table:m().oo,id:t}),r=null==n?void 0:n.getEmail();d.push({type:"mention",mention:{type:"user",url:i?(0,b().dE)({userId:t,email:r}):`{{${(0,b().dE)({userId:t,email:r})}}}`,name:null==n?void 0:n.getDisplayName(p,!0)},...g&&{annotations:g}});continue}const r=(0,u().Sev)(t);if(r){var f;const e=(0,u().v55)(r);d.push({type:"mention",mention:{type:"page",url:i?(0,b().Q2)({baseUrl:n,pageId:e}):`{{${(0,b().Q2)({baseUrl:n,pageId:e})}}}`,title:null==o||null===(f=o.getModel({table:s().ev,id:e}))||void 0===f?void 0:f.getRenderTitle({getRecordModel:c().b4_.fromRecordMap(o),intl:p,userTimeZone:"UTC"})},...g&&{annotations:g}});continue}const a=(0,u().c_)(t);if(a){const e=(0,u().vjW)(a),t=null==o?void 0:o.getModel({table:"bot",id:e}),n=null==t?void 0:t.getWorkflowId(),i=null==t?void 0:t.getSpaceId();if(n&&i){const e=(0,b().F)({workflowId:n,spaceId:i}),r=null==o?void 0:o.getModel({table:h().C0,id:n,spaceId:i});d.push({type:"mention",mention:{type:"agent",url:e,name:(null==r?void 0:r.getName())??(null==t?void 0:t.getName())},...g&&{annotations:g}});continue}}const l=(0,u().$CJ)(t);if(l){const e=(0,u().K7D)(l),t="daterange"===e.type?e.end_date:void 0;d.push({type:"mention",mention:{type:"date",start:e.start_date,end:t},...g&&{annotations:g}});continue}const y=(0,u().G6d)(t);if(y&&o){const e=(0,u().qS0)(y);if(e){const t=o.getModel(e);if(t){d.push({type:"mention",mention:{type:"custom_emoji",name:t.getName()},...g&&{annotations:g}});continue}}}const $=(0,u().lqY)(t);if($){const e=(0,u().q1R)($),t={type:"annotated",text:e.title??e.href,annotations:{...g??{},href:i?e.href:`{{${e.href}}}`}};d.push(t);continue}const v=(0,u().MzR)(t);if(v){const e=(0,u()._tF)(v),t=o.getModel({table:s().ev,id:e.id}),n=null==t?void 0:t.getFormat().original_url;if(n){d.push({type:"annotated",text:n,annotations:{...g??{},href:i?n:`{{${n}}}`}});continue}}const _=(0,u()._Vv)(t);if(_){const e=(0,u().FLg)(_);if(e){if("everyone"===e.mentionType){d.push("@everyone");continue}if("teamspace"===e.mentionType){if(o){const e=(0,u().KGg)(_);if(e){const t=o.getModel(e);if(t){d.push(`@${t.getName()}`);continue}}}d.push(`@[Team:${e.teamId}]`);continue}}}const I=(0,u().g2K)(t);if(I){const e=(0,u().NpB)(I);d.push({type:"citation",href:i?e.href:`{{${e.href}}}`,...g&&{annotations:g}});continue}const k=(0,u().dHc)(t);if(k){const e=(0,u().TSJ)(k),t=(0,b().CM)(e.id);d.push({type:"mention",mention:{type:"data-source",url:i?t:`{{${t}}}`}});continue}const x=(0,u().TVE)(t);if(x){const e=(0,u().GCe)(x);if((0,u().QkK)(e)){const t=(0,u().MaE)(e);if(t){const n=(0,b().ne)(t.collectionId,t.propertyId);d.push({type:"mention",mention:{type:"data-source",url:i?n:`{{${n}}}`,title:e.name},...g&&{annotations:g}});continue}}}}else{if((0,u().GiG)(l)){const e=(0,u().j1D)(t);if(e){d.push({type:"equation",equation:(0,u().U35)(e),...g&&{annotations:g}});continue}throw new Error("Equation token without equation annotation")}if(g){const t=(0,u().So_)(l);if(o&&t&&r){const e=y({url:t,baseUrl:n,recordMap:o,disableTemplateWrapper:i,agentAnnotations:g});if(e){d.push(e);continue}}d.push({type:"annotated",text:e,annotations:g})}else d.push(e)}}return d.length>0?d:void 0}function y(e){const{url:t,baseUrl:n,recordMap:i,disableTemplateWrapper:o,agentAnnotations:r}=e;let a;try{a=(0,b().Mg)(t,{baseUrl:n,publicDomainName:""})}catch(d){return}if("pageOrCollectionViewBlock"!==a.type)return;const l=i.getModel({table:s().ev,id:a.id});if(!l)return;const c=(0,b().Q2)({baseUrl:n,pageId:l.id});return{type:"mention",mention:{type:l.isCollectionView()?"database":"page",url:o?c:`{{${c}}}`},...r&&{annotations:r}}}function $(e,t){const n={};for(const i of e)if((0,u().dRK)(i))n.bold=!0;else if((0,u().WWk)(i))n.italic=!0;else if((0,u().EgN)(i))n.strikethrough=!0;else if((0,u().cyx)(i))n.underline=!0;else if((0,u().rlz)(i))n.code=!0;else if((0,u().YuY)(i))n.color=(0,p().f9)((0,u().uIc)(i));else if((0,u().sh$)(i)){const e=(0,u().cQR)(i);if(e){const i=(0,b().TE)(e,{baseUrl:"",publicDomainName:""});n.href=t?i:`{{${i}}}`}}else if((0,u().iQL)(i)){const e=`discussion://${(0,u().Orm)(i)}`;n.discussionUrls=[...n.discussionUrls??[],t?e:`{{${e}}}`]}return Object.keys(n).length>0?n:void 0}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var v=()=>n(492736);function _(e){const{blockId:t,recordMap:n,spaceId:l,baseUrl:f,pageId:m,intl:h,disableTemplateWrapper:y,navigablePageId:$,addCitationData:I=!1,parseAnnotationsAsMentions:k=!0}=e,x=n.getModel({table:s().ev,id:t,spaceId:l});if(!x||!x.getType()){const e=(0,b().Q2)({baseUrl:f,pageId:m,blockId:t});return{type:"unknown",id:t,url:y?e:`{{${e}}}`}}const w=(0,o().$I)(x.type),T=w?(0,b().Q2)({baseUrl:f,pageId:x.id}):(0,b().Q2)({baseUrl:f,pageId:$??m,blockId:t}),D=y?T:`{{${T}}}`,E=c().b4_.fromRecordMap(n),N=x.getRenderTitleTextValue({getRecordModel:E}),U=g({title:N||[],baseUrl:f,disableTemplateWrapper:y,recordMap:n,intl:h,parseAnnotationsAsMentions:k}),M=()=>{const e=(x.getContentIds()||[]).map((e=>_({blockId:e,recordMap:n,spaceId:l,baseUrl:f,pageId:w?x.id:m,disableTemplateWrapper:y,intl:h,navigablePageId:$,addCitationData:I,parseAnnotationsAsMentions:k})));return e.length>0?e:void 0},C=(0,p().f9)(x.getFormat().block_color),A=(0,v().yr)(x);if("unknown"===A)return{type:"unknown",id:t,url:D,alt:x.type,lastEditedAt:x.getLastEditedTime()};if("callout"===A)return{type:"callout",id:t,children:M(),text:U,icon:x.getFormat().page_icon,color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("ai_block"===A)return{type:"ai_block",text:U,children:M(),id:t,lastEditedAt:x.getLastEditedTime()};if("database"===A){var S;const e=!U&&h?[x.getEmptyTitlePlaceholder({getRecordModel:E,intl:h,userTimeZone:(0,a().P)()})]:void 0,n=null===(S=x.getRenderIcon({getRecordModel:E}))||void 0===S?void 0:S.icon;let i;if(x.isCollectionView()){const e=x.DANGEROUSLY_INCORRECT_getCollectionPointer();if(e){const t=(0,b().CM)(e.id);i=y?t:`{{${t}}}`}}const o=!(0,d()._n)({table:s().ev,id:t,spaceId:l},E)||x.isCollectionView()&&x.getCollectionPointers().some((e=>!(0,d()._n)(e,E)));return{type:"database",id:t,url:D,text:U??e,inline:"collection_view"===x.type,icon:n,color:C,deleted:!!o||void 0,...i?{dataSourceUrl:i}:{},lastEditedAt:x.getLastEditedTime()}}var B;if("to_do"===A)return{type:"to_do",id:t,text:U,children:M(),checked:i().n4(null===(B=x.getProperties())||void 0===B?void 0:B.checked,[["Yes"]]),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("code"===A){if(!x.isType("code"))throw new Error(`agentBlockType was 'code', but block type was '${x.type}'`);const e=x.getLanguage().name.toLowerCase();return{type:"code",id:t,text:g({title:N||[],baseUrl:f,disableTemplateWrapper:y,recordMap:n,intl:h,parseAnnotationsAsMentions:k,skipUrlNormalization:!0}),language:(0,r().Ll)(e)?r().nD[e]:void 0,lastEditedAt:x.getLastEditedTime()}}if("numbered_list"===A)return{type:"numbered_list",id:t,text:U,children:M(),color:C,list_format:x.getFormat().list_format,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("table"===A)return function(e){const{block:t,recordMap:n,spaceId:o,baseUrl:r,disableTemplateWrapper:a}=e;if("table"!==t.type)throw new Error("Only table block can be rendered as agent table block");const l=t.getFormat(),c=l.table_block_column_order||[],d=i().oE((t.getContentIds()||[]).map((e=>{const t=n.getModel({table:s().ev,id:e,spaceId:o});if("table_row"!==(null==t?void 0:t.type)||!t.getProperties())return;const i=t.getProperties(),l=t.getFormat(),d={type:"table_row",cells:c.map((e=>{var t;const o=g({title:i[e]||[],baseUrl:r,disableTemplateWrapper:a,recordMap:n})||[],c=null===(t=l.cell_format)||void 0===t||null===(t=t[e])||void 0===t?void 0:t.color,d={text:o};return c&&(d.color=(0,p().f9)(c)),d})),id:e};null!=l&&l.block_color&&(d.color=(0,p().f9)(l.block_color));const u=null==t?void 0:t.getLastEditedTime();return void 0!==u&&(d.lastEditedAt=u),d}))),u=c.map((e=>{var t;const n=null===(t=l.table_block_column_format)||void 0===t?void 0:t[e];return{color:null!=n&&n.color?(0,p().f9)(n.color):void 0,width:null==n?void 0:n.width}})),b=u.some((e=>void 0!==e.color||void 0!==e.width));return{type:"table",id:t.id,rows:d,...b&&{columnStyles:u},fitPageWidth:l.block_full_width,headerRow:l.table_block_column_header,headerColumn:l.table_block_row_header}}({block:x,recordMap:n,spaceId:l,baseUrl:f,pageId:m,disableTemplateWrapper:y});if("audio"===A||"video"===A||"file"===A||"image"===A||"pdf"===A){var L,W;const e=(0,u().q4_)(null===(L=x.getProperties())||void 0===L?void 0:L.source);let i;if(e)if((0,v().FS)(e))i=e;else if(!e.startsWith("data:")){var q;const t=(null===(q=x.getFormat())||void 0===q?void 0:q.copied_from_pointer)??{table:s().ev,id:x.id,spaceId:l};i=(0,b().w8)({source:e,permissionRecord:t})}return{type:A,id:t,text:g({title:(null===(W=x.getProperties())||void 0===W?void 0:W.caption)||[],baseUrl:f,disableTemplateWrapper:y,recordMap:n})??void 0,...i&&{source:y?i:`{{${i}}}`},lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0}}if("h1"===A||"h2"===A||"h3"===A||"h4"===A){return{type:A,id:t,text:U,toggleable:x.getFormat().toggleable||void 0,children:M(),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0}}if("table_row"===A)throw new Error("Table row should be rendered as children of table block");if("synced_block"===A)return{type:"synced_block",id:t,url:D,children:M(),lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("synced_block_reference"===A){var R;const e=null===(R=x.getFormat().transclusion_reference_pointer)||void 0===R?void 0:R.id;let i,o=D;if(e){o=(0,b().Q2)({baseUrl:f,pageId:m,blockId:e}),o=y?o:`{{${o}}}`;const t=n.getModel({table:s().ev,id:e,spaceId:l});t&&(i=(t.getContentIds()||[]).map((e=>_({blockId:e,recordMap:n,spaceId:l,baseUrl:f,pageId:m,intl:h,disableTemplateWrapper:y,addCitationData:I}))),i=i.length>0?i:void 0)}return{type:"synced_block_reference",id:t,...i?{children:i}:{},originalUrl:o,lastEditedAt:x.getLastEditedTime(),...I?{citationData:{url:D,id:t,spaceId:l,type:"block"}}:{}}}if("transcription"===A){var j;const e=x.getFormat(),i=e.transcription_summary_id,o=e.transcription_notes_id,r=e.transcription_transcript_id,a=null===(j=e.transcription_calendar_event)||void 0===j?void 0:j.attendeeIds,d=e=>{if(!e)return;const t=n.getModel({table:s().ev,id:e,spaceId:l}),i=(null==t?void 0:t.getContentIds())||[];return 0!==i.length?i.map((e=>_({blockId:e,recordMap:n,spaceId:l,baseUrl:f,pageId:m,intl:h,disableTemplateWrapper:y,addCitationData:I}))):void 0},u=i?d(i):void 0,p=o?d(o):void 0,b=r?d(r):void 0,$=x.getRenderTitleTextValue({getRecordModel:c().b4_.fromRecordMap(n)}),v=null!=$&&$.length?g({title:$,baseUrl:f,disableTemplateWrapper:y,recordMap:n}):void 0;return{type:"transcription",id:t,...v?{text:v}:{},summary:i?{type:"text",id:i,children:u}:void 0,notes:o?{type:"text",id:o,children:p}:void 0,transcript:r?{type:"text",id:r,children:b}:void 0,...a&&a.length>0?{attendeeIds:a}:{},url:D,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0}}if("text"===A)return{type:"text",id:t,text:U,children:M(),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("bulleted_list"===A)return{type:"bulleted_list",id:t,text:U,children:M(),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("toggle"===A)return{type:"toggle",id:t,text:U,children:M(),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("column"===A)return{type:"column",id:t,text:U,children:M(),lastEditedAt:x.getLastEditedTime()};if("column_list"===A)return{type:"column_list",id:t,text:U,children:M(),lastEditedAt:x.getLastEditedTime()};if("tab"===A)return{type:"tab",id:t,children:M(),lastEditedAt:x.getLastEditedTime()};if("quote"===A)return{type:"quote",id:t,text:U,children:M(),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0};if("page"===A){return{type:"page",id:t,url:D,text:U,color:C,deleted:!!!(0,d()._n)({table:s().ev,id:t,spaceId:l},E)||void 0,lastEditedAt:x.getLastEditedTime()}}if("equation"===A){return{type:"equation",id:t,text:g({title:N||[],baseUrl:f,disableTemplateWrapper:y,recordMap:n,intl:h,parseAnnotationsAsMentions:k,skipUrlNormalization:!0}),color:C,lastEditedAt:x.getLastEditedTime(),citationData:I?{url:D,id:t,spaceId:l,type:"block"}:void 0}}if("divider"===A)return{type:"divider",id:t,lastEditedAt:x.getLastEditedTime()};if("table_of_contents"===A)return{type:"table_of_contents",id:t,color:C,lastEditedAt:x.getLastEditedTime()};if("mail"===A){var P;const e=x.getProperty("searchable_text"),n=null==e||null===(P=e[0])||void 0===P?void 0:P[0];return{type:"mail",id:t,text:n?[n]:U,children:M(),lastEditedAt:x.getLastEditedTime()}}return A}function I(e){const{pageId:t,recordMap:n,spaceId:i,baseUrl:o,intl:r,disableTemplateWrapper:a,navigablePageId:l,addCitationData:c=!1,parseAnnotationsAsMentions:d=!0}=e,u=n.getModel({table:s().ev,id:t,spaceId:i});if(!u)throw new(f().xL)("Page not found in record map: {pageId}",{variables:{pageId:t}});return u.getContentIds().map((e=>_({blockId:e,recordMap:n,spaceId:i,baseUrl:o,pageId:u.id,disableTemplateWrapper:a,intl:r,navigablePageId:l,addCitationData:c,parseAnnotationsAsMentions:d})))}}}]);