"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[15194],{101981:(e,t,o)=>{o.d(t,{A:()=>l});var n=o(296540),r=()=>o(590526),i=o(474848);function a(e){const{resultStore:t,render:a,...l}=e,s=(0,o(75544).A)(l),c=(0,r().uB)(t,o(757695).Store.createClass(void 0)),d=(0,r().K8)((()=>e.collectionContextStore.collectionViewStore()),[e.collectionContextStore]);(0,n.useEffect)((()=>{c.setState(s);const t=e.reducer;"groups"===t.type&&"groups"===(null==s?void 0:s.type)&&e.collectionContextStore.groupsStore.setGroupBlockResults(t,s)}),[e.collectionContextStore.groupsStore,e.reducer,s,c,d]);const u=(0,r().K8)((()=>a?a(c):null),[a,c]);return(0,i.jsx)(i.Fragment,{children:u})}const l=n.memo(a)},267639:(e,t,o)=>{o.d(t,{T:()=>r});o(944114),o(898992),o(908872);var n=()=>o(94750);function r(e){const{environment:t,collectionStore:o,duplicate:r,droppedStores:i,transaction:a,duplicateActions:l}=e,{movedStores:s,reparentedStores:c}=i.reduce(((e,t)=>(r||t.getAssociatedCollectionId()!==(null==o?void 0:o.id)?e.reparentedStores.push(t):e.movedStores.push(t),e)),{movedStores:[],reparentedStores:[]});return[...s,...(0,n().M)({environment:t,droppedStores:c,duplicate:r,transaction:a,resolveTemplateVariables:!1,duplicateActions:l})]}},274652:(e,t,o)=>{o.d(t,{o:()=>a});var n=o(296540),r=()=>o(100622),i=o(474848);const a=n.forwardRef((function({color:e="primary",...t},n){const a=(0,o(401497).IS)((()=>{const o="blue"===e?r().oZ.blue:"secondary"===e?r().Tj.text.secondary:r().Tj.text.primary;return{title:{color:o,fill:o},icon:{fill:"blue"===e?r().oZ.blue:void 0},buttonMenuItem:{...t.style,...t.disabled?{cursor:"not-allowed"}:{}}}}),[t.disabled,e,t.style]),l="blue"!==e?e:void 0;return(0,i.jsx)(o(81068).A,{ref:n,...t,title:(0,i.jsx)("div",{style:a.title,children:t.title}),icon:(0,i.jsx)(o(807449).I,{icon:o(617668).plusIcon,style:a.icon,colorVariant:l}),style:a.buttonMenuItem})}))},319357:(e,t,o)=>{o.d(t,{O:()=>c});var n=o(296540),r=()=>o(726637),i=()=>o(250910),a=()=>o(430923),l=()=>o(352153),s=o(474848);function c(e){const{collectionContextStore:t,groupFormat:o,renderLinkButton:c,onAddOrLink:d,...u}=e,p=(0,n.useCallback)((e=>(0,s.jsx)(a().l7,{collectionContextStore:t,onClose:e.close,groupFormat:o,onAddOrLink:d})),[t,o,d]);return(0,s.jsx)(i().A,{popupType:r().A.isMobile?i().z.BottomSheet:i().z.Popup,placementToOrigin:"top",alignmentToOrigin:"start",disableFlippingPlacement:!0,popupWrapStyle:{width:l().Qd},...u,renderOrigin:c,render:p})}},320865:(e,t,o)=>{o.d(t,{A:()=>r});o(296540);var n=o(474848);const r=function(){return(0,n.jsx)(o(424400).Ay,{title:(0,n.jsx)(o(98126).k,{size:"default"}),titleStyle:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%"}})}},424641:(e,t,o)=>{o.d(t,{Gj:()=>u,Jx:()=>d,RN:()=>v,_X:()=>y,sM:()=>h,sR:()=>S,vZ:()=>p,xy:()=>x,y6:()=>g});o(944114),o(898992),o(823215),o(354520),o(672577);var n=()=>o(906745),r=()=>o(726637),i=()=>o(295633),a=()=>o(761940),l=()=>o(651784),s=()=>o(179034),c=()=>o(615234);function d(e){return"owner"===e.accessRole||"writer"===e.accessRole}function u(e){const t=n().DateTime.fromMillis(e.startUnixTimestampMS),o=e.endUnixTimestampMS?n().DateTime.fromMillis(e.endUnixTimestampMS):void 0,r=n().DateTime.fromMillis(e.startOfWeekUnixTimestampMS),i=n().DateTime.fromMillis(e.endOfWeekUnixTimestampMS),a=t.startOf("day"),l=n().DateTime.max(r,a),s=Math.ceil(l.diff(r,"days").get("days"));let c=1;if(o){const e=o.endOf("day"),t=n().DateTime.min(i,e);c=Math.ceil(t.diff(l,"days").get("days"))}return{start:t,end:o,startOfWeek:r,endOfWeek:i,startColumn:s,columnCount:c}}function p(e){const t=(e.attendees||[]).filter((e=>!e.self&&!e.resource));return e.hasParticipants&&t.length>0&&t.every((e=>"declined"===e.responseStatus))}const f={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:15},m={upcomingMinsThreshold:10,startingMinsThreshold:5,startedMinsThreshold:5},S={upcomingMinsThreshold:10,startingMinsThreshold:15,startedMinsThreshold:15};function g(e){const{events:t,accounts:o,thresholds:r=f,filters:i}=e,l=t.filter((e=>{if(!(e.conferencing||null!=i&&i.includeEventsWithoutConferencing))return!1;const t=o.find((t=>t.id===e.accountId));return!(null==t||!t.email)&&(!!(0,a().Ko)(e,t.email)&&(!function(e){if("declined"===e)return!0;return!1}(e.responseStatus??"declined")&&!e.isAllDay))}));if(0===l.length)return[];const{upcomingMinsThreshold:s,startingMinsThreshold:d,startedMinsThreshold:u}=r,p=n().DateTime.now(),m=void 0!==(null==i?void 0:i.maxDaysInFuture)?i.maxDaysInFuture*c().XQ:void 0,S=void 0!==(null==i?void 0:i.maxDaysInPast)?i.maxDaysInPast*c().XQ:void 0,g=[],v=[],y=[],h=[],x=[],_=[];for(const n of l){if(n.isAllDay)continue;const e=C(n),t=p.diff(e.end,"minutes").minutes;if(void 0!==S&&t>S)continue;if(null!=i&&i.excludeEventsOnDifferentDays){if(p.setZone(e.start.zone).toISODate()!==e.start.toISODate())continue}const o=e.start.diff(p,"minutes").minutes;if(!(void 0!==m&&o>m))if(o>=0&&o<=s)g.push(n);else if(o<0){const r=-o,i=t>=0?t:void 0;r>0&&r<=d?y.push(n):r>d&&r<=u?h.push(n):e.contains(p)?v.push(n):void 0!==S&&void 0!==i&&i<=S&&x.push(n)}else _.push(n)}v.sort(((e,t)=>{const o=n().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone});return n().DateTime.fromISO(t.start.dateTime,{zone:t.start.timeZone}).diff(o).toMillis()})),x.length>1&&x.sort(((e,t)=>{const o=n().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return n().DateTime.fromISO(t.end.dateTime,{zone:t.end.timeZone}).diff(o).toMillis()}));return[...g,...y,...h,...null!=i&&i.excludeInProgressEvents?[]:v,...x,...null!=i&&i.excludeUpcomingLaterEvents?[]:_]}function v(e,t){return g({events:e,accounts:t,thresholds:f,filters:void 0})[0]}function y(e,t){return h(e,t)[0]}function h(e,t,o){return g({events:e,accounts:t,thresholds:m,filters:{excludeUpcomingLaterEvents:!0,...o}})}function C(e){const t=n().DateTime.fromISO(e.start.dateTime,{zone:e.start.timeZone}),o=n().DateTime.fromISO(e.end.dateTime,{zone:e.end.timeZone});return n().IX.fromDateTimes(t,o)}function x(e){const{spaceStore:t}=e;let o=e.fileUrl;if(!t)return;const n=(0,l().parseRoute)({url:o,isMobile:r().A.isMobile,baseUrl:r().A.domainBaseUrl,publicDomainName:r().A.publicDomainName,protocol:r().A.protocol,currentUrl:window.location.href}),a="page"===n.name?n.blockId:void 0;if(!a)return;const c=i().B.createChildStore(t,{table:s().ev,id:a});return c.load(),c}},430923:(e,t,o)=>{o.d(t,{DV:()=>s,W5:()=>a,l7:()=>l,zS:()=>i});var n=()=>o(79926);const r={CollectionNewViewPopupComponent:new(n().O2)("CollectionNewViewPopupComponent",(async()=>await Promise.all([o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(96346),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(14578),o.e(87017),o.e(34877),o.e(46414),o.e(11676),o.e(61165),o.e(47668),o.e(94522),o.e(24587),o.e(44584),o.e(67494),o.e(10522),o.e(40992),o.e(88455),o.e(33893),o.e(36437),o.e(17729),o.e(49875)]).then(o.bind(o,611225)))),CollectionViewSelect:new(n().O2)("CollectionViewSelect",(async()=>await o.e(35756).then(o.bind(o,445689)))),CollectionLinkExistingModal:new(n().O2)("CollectionLinkExistingModal",(async()=>await Promise.all([o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(62475),o.e(3151),o.e(98629),o.e(96711),o.e(27992),o.e(63452),o.e(66249),o.e(87249),o.e(79022),o.e(34877),o.e(11676),o.e(94522),o.e(38293),o.e(63515),o.e(55162),o.e(32370),o.e(26264),o.e(6769),o.e(64242),o.e(39986),o.e(47160),o.e(76677),o.e(68609),o.e(79340),o.e(42056),o.e(3261),o.e(54219),o.e(68643),o.e(27083),o.e(96385),o.e(5287)]).then(o.bind(o,901226)))),ModalOverlayCollectionView:new(n().O2)("ModalOverlayCollectionView",(async()=>await Promise.all([o.e(93980),o.e(22778),o.e(32413)]).then(o.bind(o,700868))))},i=(0,n()._h)(r.CollectionNewViewPopupComponent,(e=>e.CollectionNewViewPopupComponent)),a=(0,n()._h)(r.CollectionViewSelect,(e=>e.CollectionViewSelect)),l=(0,n()._h)(r.CollectionLinkExistingModal,(e=>e.CollectionLinkExistingModal)),s=(0,n()._h)(r.ModalOverlayCollectionView,(e=>e.ModalOverlayCollectionView))},448801:(e,t,o)=>{o.d(t,{i:()=>r});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698);var n=()=>o(371562);n();function r(e,t){const o=n().create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!o)return{beforeOps:{},removeOps:new Set};let r=[],i=[];for(const n in o)"_t"!==n&&("_"===n[0]?r.push(parseInt(n.slice(1),10)):1===o[n].length&&i.push({index:parseInt(n,10),value:o[n][0]}));const a={},l=new Set,s=[...e];r=r.sort(((e,t)=>e-t));for(let n=r.length-1;n>=0;n--){const e=r[n],t=s.splice(e,1)[0];l.add(t)}i=i.sort(((e,t)=>e.index-t.index));for(let n=0;n<i.length;n++){const e=i[n];a[e.value]=s[e.index],s.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:l}}},465364:(e,t,o)=>{o.d(t,{$N:()=>P,D5:()=>V,GB:()=>b,M9:()=>M,Pt:()=>I,eW:()=>D,jo:()=>E,v7:()=>w});o(944114),o(898992),o(803949),o(581454);var n=()=>o(906745),r=()=>o(242422),i=()=>o(587682),a=()=>o(295633),l=()=>o(187696),s=()=>o(713998),c=()=>o(597777),d=()=>o(604995),u=()=>o(416504),p=()=>o(519831),f=()=>o(496603),m=()=>o(534177),S=()=>o(299709),g=()=>o(44729),v=()=>o(384944),y=()=>o(622811),h=()=>o(267639),C=()=>o(210552),x=()=>o(999140),_=()=>o(836724),T=()=>o(295304),O=()=>o(747671);function M(e){var t;const{environment:o,droppedStores:r,duplicate:i,calendarBy:a,transaction:s,collectionContextStore:f,duplicateActions:m}=e,v=n().DateTime.fromMillis(e.startOfDay);let C=!0;if(null!==(t=f.collectionStore())&&void 0!==t&&t.isExternalSyncedCollection())return;for(const n of r){const t=e.collectionStore?e.collectionStore:(0,x().Dj)({store:n,collectionContextStore:f});if(n.getParentTable()===p().Vl||!t){C=!1;break}g().X$({childStore:n,parentStore:t,transaction:s})||(C=!1)}const _=(0,h().T)({environment:o,droppedStores:r,duplicate:i,transaction:s,collectionStore:e.collectionStore,duplicateActions:m});for(const n of _){const t=e.collectionStore?e.collectionStore:(0,x().Dj)({store:n,collectionContextStore:f});if(!t)continue;const r=t.getMappedProperty(a),i=n.getPropertyStore(r),p=(0,l().b)(i.getValue())||d().Ec((0,u().P)()),m=d().kW(p,(0,u().P)()),g=v.toFormat(d().tr);let h;if("date"===m.type||"datetime"===m.type)h={...m,start_date:g};else{const e=d().AA(m,(0,u().P)());if(!e.end)return;const t={...m,start_date:g},o=d().AA(t,(0,u().P)()).start.diff(e.start,"days"),n=e.end.plus(o).toFormat(d().tr);h={...m,start_date:g,end_date:n}}const _=d().kW(h,c().$K(p)||(0,u().P)());(0,y().j)({environment:o,store:n,collectionStore:t,collectionContextStore:f,shouldCoerce:!0,groupsPointer:[],transaction:s,alreadyMovedToCollection:C}),V({environment:o,type:"dateValue",propertyId:r,store:n,transaction:s,dateValue:_}),(0,S().E)({environment:o,collectionContextStore:f,block_id:n.id,property:r,property_type:"date",from:"calendar"})}}function w(e){const{calendarStore:t,direction:o,targetStore:n}=e;t.setState({...t.state,isDragging:!0,targetStore:n,direction:o,temporaryValue:void 0})}function b(e){const{calendarStore:t,x:o,y:r,calendarBy:a}=e,s=t.state;if(s.isDragging){const e=(0,l().b)(s.targetStore.getPropertyStore(a).getValue());if(!e)return;const p=d().kW(e,(0,u().P)()),m=s.temporaryValue||e,S=d().kW(m,(0,u().P)()),g=[];s.dayStoreMap.forEach(((e,t)=>{g.push({store:e,timestamp:t})}));const v=g.find((({store:e})=>{const t=_().T.getRectFromStore(e);return Boolean(t&&i().ux(t,o,r))}));let y;if(v){const e=n().DateTime.fromMillis(v.timestamp),t=e.endOf("day"),o=e.toFormat(d().tr);if(p){const r=d().AA(p,(0,u().P)());if(s.direction===O().Q.Left)if(n().IX.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="datetimerange"===p.type||"daterange"===p.type?{...p,start_date:o,end_date:p.end_date}:"datetime"===p.type?{type:"datetimerange",start_date:o,start_time:p.start_time,end_date:p.start_date,end_time:p.start_time,time_zone:p.time_zone,reminder:p.reminder}:{type:"daterange",start_date:o,end_date:p.start_date,reminder:p.reminder};const t=d().AA(e,(0,u().P)());y=!r.end&&t.start>r.start||r.end&&t.start>r.end?S:e}else if(r.end?n().IX.fromDateTimes(e,t).contains(r.end):n().IX.fromDateTimes(e,t).contains(r.start))y=p;else{let e;e="date"===p.type?{...p,type:"daterange",end_date:o}:"datetime"===p.type?{...p,type:"datetimerange",end_date:o,end_time:"00:00"}:{...p,end_date:o};const t=d().AA(e,(0,u().P)());y=t.end&&t.end<t.start?S:e}}}if(y&&!f().n4(S,y)){const e=d().kW(y,c().$K(m)||(0,u().P)());t.setState({...s,temporaryValue:e})}}}function D(e){const{environment:t,calendarStore:o,calendarBy:n,transaction:r}=e,i=o.state;i.isDragging&&i.temporaryValue&&(V({type:"dateValue",environment:t,dateValue:i.temporaryValue,propertyId:n,store:i.targetStore,transaction:r}),o.setState({...o.state,isDragging:!1}))}function I(e){const{calendarStore:t}=e,o=t.state;o.isDragging&&t.setState({...o,isDragging:!1})}function P(e){const{environment:t,store:o,collectionStore:r,collectionContextStore:i,startDayOfWeek:a,transaction:l}=e,c=i.dateRangeStartStore.state,p=(0,u().P)(),f=i.normalizedQueryStore.state;if(!f||!f.calendar_by)return;const m=(null==r?void 0:r.getMappedProperty(f.calendar_by))??f.calendar_by,S=d().hp(c,a,p),g=S.startOf("month"),h=S.endOf("month"),C=n().DateTime.now().startOf("day");let x;return x=n().IX.fromDateTimes(g,h).contains(C)?d().p6(C.valueOf(),p):d().p6(d().iB(c,a,p).valueOf(),p),v().zv({store:o.getPropertiesStore(),data:{[m]:s().m5(x)},transaction:l}),(0,y().j)({environment:t,store:o,collectionStore:r,collectionContextStore:i,shouldCoerce:!0,groupsPointer:[],transaction:l}),o}function V(e){const{environment:t,store:o,propertyId:n,transaction:i}=e;let a;"timestamp"===e.type?a=d().p6(e.timestampMs.valueOf(),(0,u().P)()):"dateValue"===e.type?a=e.dateValue:(0,m().HB)(e);const l=o.getPropertyValue(n);if(a&&function(e){const{propertyId:t,oldDateValue:o,newPersistedDate:n,store:i}=e;if(o||!n||void 0!==n.reminder)return!1;if(!r().default.checkGate({gateName:"adoption_reminder_collection_default"}))return!1;const a=k(t,i);if(void 0===a)return!1;return!0}({propertyId:n,oldDateValue:l,newPersistedDate:a,store:o})){const e=k(n,o);void 0!==e&&(a={...a,reminder:e})}const c=s().m5(a);v().zv({store:o.getPropertiesStore(),data:{[n]:c},transaction:i}),C().O4({environment:t,store:o,dateProperty:{id:n,oldValue:l,newValue:c}})}function k(e,t){const o=t.getAssociatedCollectionStore();if(!o)return;const n=o.getSchema();if(!n)return;const r=n[e];return r&&"date"===r.type?r.default_reminder:void 0}function E(e){const{environment:t,collectionStore:o,calendarBy:n,store:r,insertStores:i,collectionContextStore:l,transaction:s}=e,c=r.getPropertyStore(n).getValue();for(const a of i)(0,y().j)({environment:t,store:a,collectionStore:o,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:s}),T().R9({environment:t,store:a.getPropertyStore(n),value:c,transaction:s});return i.map((e=>a().B.createChildStore(o,e.pointer)))}},482871:(e,t,o)=>{o.d(t,{z:()=>d});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(430670),o(581454);var n=()=>o(770063),r=()=>o(898244),i=()=>o(448801),a=()=>o(179034),l=()=>o(722101),s=(o(354520),()=>o(496603));function c(e){const{collectionContextStore:t,collectionViewStore:o,transaction:i}=e,c=o.getPageSortStore(),d=c.getValue(),u=t.groupsStore.getAllGroupStates(),p=function(e){const{pageSort:t,currentResults:o}=e;if(!t||t.length<=r().WF)return[];const n=t.filter((e=>!o.has(e)));return s().sb([...n.reverse(),...s().o8(t).reverse()]).slice(0,t.length-r().WF)}({pageSort:d,currentResults:new Set(u.flatMap((e=>e.resultsStore.state.map((e=>e.id)))))});for(const r of p)l().TF({parentStore:c,childToRemoveStore:(0,n().v3)(c,{table:a().ev,id:r}),transaction:i})}function d(e){const{resultIds:t,collectionViewStore:o,collectionContextStore:s,transaction:d}=e,u=o.getPageSortStore(),p=u.getValue()||[],{beforeOps:f}=(0,i().i)(p,t.slice(0,r().WF));for(const[r,i]of Object.entries(f))if(i){const e=(0,n().v3)(o,{table:a().ev,id:i});l().nc({parentStore:u,insertStore:(0,n().v3)(o,{table:a().ev,id:r}),beforeStore:e,transaction:d})}else{const e=t.findIndex((e=>e===r)),i=t[e-1],s=i?(0,n().v3)(o,{table:a().ev,id:i}):void 0;l().WH({parentStore:u,insertStore:(0,n().v3)(o,{table:a().ev,id:r}),afterStore:s,transaction:d})}c({collectionContextStore:s,collectionViewStore:o,transaction:d})}},491848:(e,t,o)=>{o.d(t,{w:()=>r});o(898992),o(672577);var n=()=>o(209866);function r({collectionContextStore:e,transaction:t}){const o="collectionTypedView"===e.contextTypeFromStoreState,r=e.databaseTypeFromStoreState,i=e.collectionStoresStore.state,a=i.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||i[0];!o&&a&&(0,n().e)({transaction:t,databaseType:r,collectionId:a.id,spaceId:a.getSpaceId()})}},703878:(e,t,o)=>{o.d(t,{S4:()=>x,Sn:()=>h,j2:()=>y,oq:()=>C,kc:()=>v});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(803949),o(581454);var n=()=>o(242422),r=()=>o(906745),i=()=>o(604995),a=()=>o(416504);function l(e){const{dateRangeStartDate:t,dateRangeEndDate:o,calendarBy:n}=e;return{type:"results",filter:{operator:"and",filters:[{property:n,filter:{operator:"date_is_on_or_after",use_end:!0,value:{type:"exact",value:t}}},{property:n,filter:{operator:"date_is_on_or_before",value:{type:"exact",value:o}}}]},limit:5e3}}var s=()=>o(748580),c=()=>o(597777),d=()=>o(792071),u=()=>o(496603),p=()=>o(89053),f=()=>o(833106),m=()=>o(842076),S=()=>o(180252),g=()=>o(424641);function v(e){return!1===e.isDragging}function y(e){const{collectionContextStore:t}=e,o=t.collectionViewStore();if(!o)return;const n=t.normalizedSchemaStore.state,r=(0,f().$)({collectionViewStore:o,schema:n});if(!r||!r.calendar_by)return;return function({dateRangeStart:e,dateRangeEnd:t,query:o,timeZone:n=(0,a().P)()}){if(!o||!o.calendar_by)return;const r=(0,i().p6)(e,n),s=(0,i().p6)(t,n);return l({calendarBy:o.calendar_by,dateRangeStartDate:r,dateRangeEndDate:s})}({dateRangeStart:t.dateRangeStartStore.state,dateRangeEnd:t.dateRangeEndStore.state,query:r})}function h(e){const{collectionContextStore:t,startOfDay:o}=e,n=t.collectionViewStore();if(!n)return;const s=t.normalizedSchemaStore.state,c=(0,f().$)({collectionViewStore:n,schema:s});return c&&c.calendar_by?function({startOfDay:e,query:t,timeZone:o=(0,a().P)()}){if(!t||!t.calendar_by)return;const n=r().DateTime.fromMillis(e).endOf("day").valueOf(),s=(0,i().p6)(e,o),c=(0,i().p6)(n,o);return l({calendarBy:t.calendar_by,dateRangeStartDate:s,dateRangeEndDate:c})}({startOfDay:o,query:c}):void 0}function C(e){var t;const{collectionContextStore:o,results:n,getRecordValue:r,intl:l,formulasModule:s,environment:d}=e,p=o.collectionViewStore(),f=o.normalizedQueryStore.state,m=o.normalizedSchemaStore.state,v=f?f.calendar_by:void 0,y=o.dateRangeStartStore.state,h=o.dateRangeEndStore.state,C=(null===(t=o.collectionViewStore())||void 0===t?void 0:t.getFormat().calendar_show_weekends)??!0,T=S().XX.state,O=(0,a().P)(),M=o.getCurrentUserId();if(!(p&&f&&v&&m))return;const w=new Map,b=new Map,D=new Map,I=u().oE(n.map((e=>x({blockStore:e,calendarBy:v,schema:m,getRecordValue:r,userId:M,intl:l,resultCache:w,regExpCache:b,formatDateCache:D,formulasModule:s,environment:d})))),P={};n.forEach(((e,t)=>{P[e.id]=t}));0===(f.sort||[]).length&&I.sort(((e,t)=>{const o=e.start.valueOf(),n=t.start.valueOf();if(o===n){return P[e.id]-P[t.id]}return o-n}));const V=C?(0,i().iB)(y,T,O):(0,i().J0)(y,T,O),k=C?(0,i().hp)(h,T,O):(0,i().EK)(h,T,O);let E=V;const R=[];do{const e=C?(0,i().hp)(E.valueOf(),T,O):(0,i().EK)(E.valueOf(),T,O),t={},o=I.filter((t=>(0,c().m6)(E.valueOf(),e.valueOf(),t.start.valueOf(),t.end?t.end.valueOf():void 0))).map((o=>{const{id:n,start:r,end:i,includeTime:a,timeZone:l}=o,{startColumn:s,columnCount:c}=(0,g().Gj)({startUnixTimestampMS:r.valueOf(),endUnixTimestampMS:i?i.valueOf():void 0,startOfWeekUnixTimestampMS:E.valueOf(),endOfWeekUnixTimestampMS:e.valueOf()}),d=_(s,c,t);return{id:n,start:r.valueOf(),end:i?i.valueOf():void 0,row:d,includeTime:a,timeZone:l}}));R.push({start:E.valueOf(),end:e.valueOf(),items:o}),E=C?(0,i().iB)(E.plus({week:1}).plus({hour:25}).valueOf(),T,O):(0,i().J0)(E.plus({week:1}).plus({hour:25}).valueOf(),T,O)}while(E<k);return R}function x(e){const{blockStore:t,calendarBy:o,schema:r,getRecordValue:l,intl:c,userId:u,resultCache:f,regExpCache:S,formatDateCache:g,formulasModule:v,environment:y}=e,h=t.getAssociatedCollectionStore(),C=t.getModel();if(!C)return;const x=d().b4_.fromGetRecordValueFn(l),_=(0,s().d2)({property:o,schema:r,block:C,getRecordModel:x,propertyMapping:null==h?void 0:h.getPropertyMapping(),collectionRequestContext:{userId:u,userTimeZone:(0,a().P)(),depth:0,intl:c,visitedProperties:new Set,resultCache:f,regExpCache:S,formatDateCache:g,experimentService:n().default,collectionFeatureGates:(0,p().i)(),getRelationEdgeList:(0,m().Y)({environment:y,spaceId:C.space_id})},formulasModule:v,spaceIdCreator:t.environment.idCreator.getSpaceIdCreatorSync(t.getSpaceId())}).next().value;if("date"!==(null==_?void 0:_.type))return;const T=_.value;if(!T)return;const O=(0,i().AA)(T,(0,a().P)());if(!O)return;return{id:C.id,start:O.start,end:O.end,includeTime:"datetime"===T.type||"datetimerange"===T.type,timeZone:"datetime"===T.type||"datetimerange"===T.type?T.time_zone:void 0}}function _(e,t,o){let n=0;for(;;){let r=!1;for(let i=0;i<t;i++)T(o,e+i,n)&&(r=!0);if(!r)break;n++}for(let r=0;r<t;r++)O(o,e+r,n);return n}function T(e,t,o){return Boolean(e[o]&&e[o][t])}function O(e,t,o){e[o]||(e[o]={}),e[o][t]=!0}},747671:(e,t,o)=>{o.d(t,{Q:()=>n,a:()=>r});let n=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class r extends(()=>o(757695))().Store{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}}},766854:(e,t,o)=>{o.d(t,{H:()=>_,Q:()=>x});o(898992),o(672577);var n=()=>o(230711),r=()=>o(907258),i=()=>o(135168),a=()=>o(242422),l=()=>o(929219),s=()=>o(711339),c=()=>o(295633),d=()=>o(700500),u=()=>o(179034),p=()=>o(201980),f=()=>o(384944),m=()=>o(649813),S=()=>o(390650),g=()=>o(381678),v=()=>o(622811),y=()=>o(491848),h=()=>o(482871);function C(e,t,o){const r=(0,g()._)(e),i=null==r?void 0:r.id;if(!i||!o)return;if(!a().default.checkGate({gateName:"full_access_for_created_collection_pages"}))return;if(t.canAdmin())return;const l=t.getSpaceStore();return l&&(0,n().dp)(l,i).isMember()?[{role:"editor",type:"user_permission",user_id:i}]:void 0}function x(e){const{collectionContextStore:t,transaction:o}=e;return(0,y().w)({collectionContextStore:t,transaction:o}),_(e)}function _(e){var t,o,n;const{environment:g,collectionContextStore:y,groupsPointer:x,insertAtIndex:_,shouldCoerce:T,templateStore:O,transaction:M,from:w,tracker:b,inMemoryRecordCache:D,isKeyboard:I,title:P}=e,V=s().default.DO_NOT_USE_markLegacy("collections.add_item_lag");s().default.DO_NOT_USE_measureAfterNextFlushLegacy(V,{environment:g,getData:()=>({...S().kz(y),from:w.createBlock})});const k="collectionTypedView"===y.contextTypeFromStoreState,E=y.databaseTypeFromStoreState,R=y.collectionStoresStore.state,A=R.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||R[0],B=null===(t=(0,i().f)(A))||void 0===t?void 0:t.id,z=r().default.state.currentUserSettingsStore,F=k&&E&&B&&z&&[...z.getAllPreferredCollections(B),...z.getPreferredCollectionsOfType(B,E)]||[];let j;const W=x[0];if("group_header"===w.createBlock&&"location"===W.value.type){const e=W.value.value;if(e){j=R.find((t=>t.id===e.id&&(t.canEdit()||t.canEditCollection()||t.canEditContentOnly())))}}else j=function(e,t){for(const o of e){const e=t.find((e=>e.id===o&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));if(e)return e}}(F,R);const U=j??A,Z=null==U?void 0:U.getSpaceId(),L=y.collectionViewStore(),G=y.getViewType(),N=f().Wv({environment:g,type:d().xd.page,inMemoryRecordCache:D,transaction:M,spaceId:Z,tracker:b,permissions:C(g,U,Z),properties:{title:(0,p().x9d)(P)}});if(!U||!L||!G)return{coercionSucceeded:!0,newStore:N};const X=null===(o=y.groupsStore.getGroupState(x))||void 0===o?void 0:o.groupUiParentStore;if(!X)return{coercionSucceeded:!0,newStore:N};const K=c().B.createChildStore(X,{table:u().ev,id:N.id});O&&l().A.state.online&&m().TB({title:"template",environment:g,store:N,templateStore:O,isKeyboard:I??!1,isCreateIn:!1,transaction:M,from:w.initCollection??"collection_group_actions"});const Q=(0,v().j)({environment:g,store:N,collectionStore:U,collectionContextStore:y,groupsPointer:x,shouldCoerce:T,transaction:M}),q=(null===(n=y.groupsStore.getGroupState(x))||void 0===n||null===(n=n.reducerResultStore.state)||void 0===n?void 0:n.blockIds)||[],$=void 0!==_?_:q.length,H=y.permissionScopesStore.state;if((a().default.checkGate({gateName:"can_create_pages_in_collection_permission"})?H.canCreatePagesInCollection:H.canEditContent)||k){const e=[...q.slice(0,$),K.id,...q.slice($)];(0,h().z)({resultIds:e,collectionViewStore:L,collectionContextStore:y,transaction:M})}return{coercionSucceeded:Q,newStore:K}}},860118:(e,t,o)=>{o.d(t,{T:()=>r});var n=()=>o(726317);function r(e){const{block:t,property:o,schema:r,getRecordModel:i,userId:a,userTimeZone:l,intl:s,experimentService:c,collectionFeatureGates:d,formulasModule:u,spaceIdCreator:p,getRelationEdgeList:f}=e;if(!t)return!1;if("title"===o)return!1;const m=r[o];return!(!m||"checkbox"!==m.type)||(!(!m||"button"!==m.type)||(!(!m||"status"!==m.type)||!n().r({property:o,schema:r,block:t,getRecordModel:i,userId:a,userTimeZone:l,intl:s,experimentService:c,collectionFeatureGates:d,formulasModule:u,spaceIdCreator:p,getRelationEdgeList:f})))}}}]);