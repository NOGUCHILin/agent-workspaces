"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[17680,53697,79665,82106],{6697:(e,t,o)=>{o.d(t,{h:()=>a});var n=()=>o(79926);const i=new(n().O2)("DictationAvatar",(async()=>await Promise.all([o.e(75134),o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(14578),o.e(87017),o.e(34877),o.e(46414),o.e(11676),o.e(61165),o.e(94522),o.e(44584),o.e(38293),o.e(40992),o.e(88455),o.e(52871),o.e(47160),o.e(49021),o.e(53697),o.e(17680),o.e(6039),o.e(71136),o.e(86341),o.e(29316),o.e(3101)]).then(o.bind(o,310947)))),a=(0,n()._h)(i,(e=>e.DictationAvatar))},17680:(e,t,o)=>{o.d(t,{eQ:()=>$,hJ:()=>le,Ay:()=>G,Uo:()=>X,XE:()=>re});o(944114),o(898992),o(823215),o(354520),o(672577),o(581454);var n=o(296540),i=()=>o(59226),a=()=>o(484714),r=()=>o(590526),s=()=>o(401497),l=()=>o(929219),c=()=>o(75435),d=()=>o(609679),u=()=>o(849255),p=()=>o(56268),m=()=>o(718827),g=()=>o(631524),f=()=>o(26697),h=()=>o(302501),y=()=>o(869190),v=()=>o(641007),S=()=>o(187174),b=()=>o(798880),x=()=>o(695608),w=()=>o(69708),A=()=>o(100622),I=()=>o(496603),j=()=>o(23420),C=()=>o(488923),M=()=>o(102172),T=()=>o(130119),k=()=>o(6697),_=()=>o(673657),B=()=>o(64790),P=()=>o(852273);const V=function(e){const t=(0,a().v3)(),i=(0,n.useRef)(),r=(0,o(336811).T)(),s=(0,n.useCallback)((async()=>{if(await o(129286).transactionQueue.awaitRecordTransaction(e.blockStore.pointer),!r.current)return;const n=(0,o(921997).Ws)(e.blockStore.id);i.current=P().Ay.addListener(n,void 0,I().nF((()=>o(466721).updatePageVisits(t,{blockStore:e.blockStore,pageVisitStore:e.pageVisitStore,incremental:!0,limit:e.limit})),1e3),void 0,t)}),[t,r,e.blockStore,e.limit,e.pageVisitStore]),l=(0,n.useCallback)((()=>{i.current&&(P().Ay.removeListener(i.current,t),i.current=void 0)}),[t]);return(0,n.useEffect)((()=>(s(),l)),[s,l]),null};var E=()=>o(869562),D=()=>o(737230),R=()=>o(994006),U=()=>o(453697),K=()=>o(79926);const N=new(K().O2)("AvatarHoverCard",(async()=>await Promise.all([o.e(86036),o.e(6608)]).then(o.bind(o,356221)))),F=(0,K()._h)(N,(e=>e.AvatarHoverCard)),O=new(K().O2)("LastViewedByHoverCard",(async()=>await o.e(1930).then(o.bind(o,652429)))),L=(0,K()._h)(O,(e=>e.LastViewedByHoverCard));var W=o(474848);const z=5,H=25,q=6,$=22;const G=function({pageVisitStore:e,presenceStore:t,rootStore:n,maxUsers:i}){return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(o(912474).a,{rootStore:n}),(0,W.jsx)(le,{rootStore:n,pageVisitStore:e,presenceStore:t,maxUsers:i,isShowingInFeed:!1}),(0,W.jsx)(V,{blockStore:n,pageVisitStore:e,limit:1+Q(i)+H})]})};function Y(e){return I().Ul(e,(e=>e.activityTimestampNearestMinuteMs))}function Q(e){return e??z}function Z(e,t){return u().L.createChildStore(t,{table:b().oo,id:e})}function X(e){const{environment:t,isShowingTabBar:o,isShowingInFeed:n}=e;return{...(0,T().g)({noDrag:t.device.isElectron&&!o}),display:"flex",alignItems:"center",position:"relative",flexDirection:"row-reverse",marginInlineStart:8,paddingInlineEnd:q,transform:"translateZ(0)",...n&&{maxHeight:54,paddingBottom:12}}}function J(){return{color:A().Tj.text.inverseSecondary,fontSize:10,textTransform:"uppercase",letterSpacing:"0.015em"}}function ee({userData:e,isPresent:t,rootStore:o,isShowingInFeed:n}){const i=(0,a().v3)(),s=(0,w().tz)(),l=i.currentUser.id,c=(0,r().K8)((()=>Z(e.userId,o)),[e,o]),u=(0,r().K8)((()=>c.isDefined()),[c]),p=(0,r().K8)((()=>(0,x().c6)(s,c.getModel())),[s,c]),m=(0,r().K8)((()=>c.getEmail()),[c]);if(!u)return null;let g;return t?l!==c.id&&(g=e.blockId&&!n?(0,W.jsx)(w().sA,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,W.jsx)(w().sA,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"})):l!==c.id&&e.activityTimestampNearestMinuteMs&&(g=(0,W.jsx)(w().sA,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,y().v9)(Math.min(e.activityTimestampNearestMinuteMs,Date.now()),d().locale)}})),(0,W.jsxs)("div",{children:[(0,W.jsx)("div",{className:"notranslate",children:p}),(0,W.jsx)("div",{style:{fontWeight:400},children:m}),g?(0,W.jsx)("div",{style:{color:A().Tj.text.inverseSecondary,minWidth:150,paddingTop:2,paddingBottom:2,lineHeight:1.3},children:g}):void 0]})}function te({userData:e,index:t,rootStore:o}){const n=(0,a().v3)(),i=(0,B().dp)(n,e),s=(0,r().K8)((()=>Z(e.userId,o)),[e,o]);if(!(0,r().K8)((()=>s.isDefined()),[s]))return null;let l;!i&&e.activityTimestampNearestMinuteMs&&(l=(0,y().v9)(e.activityTimestampNearestMinuteMs,d().locale));const c=(0,W.jsxs)("div",{style:{display:"flex",alignContent:"flex-end",minWidth:140,width:"100%",marginTop:4},children:[(0,W.jsx)(R().A,{userStore:s,avatarSize:18,style:{flexGrow:1},hasPersonHoverCard:!1}),(0,W.jsx)("div",{style:{marginInlineStart:"auto",paddingInlineStart:12,textAlign:"end",flexShrink:1,color:A().Tj.text.inverseSecondary},children:l})]});if(i&&e.blockId){const t=e.blockId;return(0,W.jsx)(m().Ay,{onClick:()=>(0,j().B)([t],!0,n),style:{display:"flex",alignItems:"center"},children:c})}return(0,W.jsx)("div",{style:{display:"flex",alignItems:"center"},children:c})}function oe({hiddenUsers:e,hiddenUsersCount:t,hasMore:o,rootStore:n,environment:a}){if(!(0,i().X)("use_topbar_person_hovercards"))return(0,W.jsx)(f().m,{allowHover:!0,originGap:7,renderTooltip:i=>(0,W.jsx)(ne,{hiddenUsers:e,hiddenUsersCount:t,hasMore:o,rootStore:n,events:i}),render:e=>(0,W.jsx)(ie,{hiddenUsersCount:t,events:e,environment:a,rootStore:n})});const r=e.filter((e=>!(0,B().dp)(a,e))),s=e.filter((e=>(0,B().dp)(a,e))).length,l=t-s;return(0,W.jsx)(L,{trigger:(0,W.jsx)(ie,{hiddenUsersCount:t,environment:a,rootStore:n}),viewers:r,totalCount:l,rootStore:n})}function ne({hiddenUsers:e,hiddenUsersCount:t,hasMore:o,rootStore:n,events:i}){const r=(0,a().v3)(),s=[],l=[];for(const a of e)(0,B().dp)(r,a)?s.push(a):l.push(a);const c=l.slice(0,H-s.length),d=t-(s.length+c.length);return(0,W.jsxs)("div",{...i,children:[s.length>0?(0,W.jsxs)("div",{style:{marginBottom:4},children:[(0,W.jsx)(h().A,{style:J(),children:(0,W.jsx)(w().sA,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.hiddenUsers.viewingNow.tooltip"})}),s.map(((e,t)=>(0,W.jsx)(te,{userData:e,index:t,rootStore:n},t)))]}):void 0,c.length>0?(0,W.jsxs)("div",{style:{marginBottom:4},children:[(0,W.jsx)(h().A,{style:{...J()},children:(0,W.jsx)(w().sA,{defaultMessage:"Last viewed by",id:"topbar.presenceIndicator.hiddenUsers.lastViewedBy.tooltip"})}),c.map(((e,t)=>(0,W.jsx)(te,{userData:e,index:t,rootStore:n},t)))]}):void 0,(0,W.jsx)(ae,{remainingHiddenUsersCount:d,hasMore:o})]})}function ie({hiddenUsersCount:e,events:t,environment:o,rootStore:i}){const a=(0,s().IS)((()=>({origin:{paddingInline:8,marginInlineStart:4,marginInlineEnd:-q-4}})),[]),r=(0,n.useCallback)((()=>{E().handleSidebarButtonClick(o,i,D().tF.Updates,"more_menu"),D().Ay.setState({...D().Ay.state,updatesSubTab:D().VE.Analytics})}),[o,i]);return(0,W.jsx)(g().p,{style:a.origin,size:"sm",shape:"pill",colorPalette:"gray",onClick:r,...t,children:(0,W.jsx)(w().sA,{defaultMessage:"{hiddenUsersCount, plural, one {+{hiddenUsersCount}} other {+{hiddenUsersCount}}}",id:"topbar.presenceIndicator.hiddenUsers.otherCount.message",values:{hiddenUsersCount:e}})})}function ae({hasMore:e,remainingHiddenUsersCount:t}){const o=(0,s().IS)((()=>({message:{marginInlineStart:2,marginTop:2,color:A().Tj.text.inverseSecondary}})),[]);return t>0?(0,W.jsx)("div",{style:o.message,children:e?(0,W.jsx)(w().sA,{defaultMessage:"{remainingVisitorsCount}+ more…",id:"topbarPresence.presenceIndicator.hiddenUsers.evenMoreUsersNotViewing.tooltip",values:{remainingVisitorsCount:t}}):(0,W.jsx)(w().sA,{defaultMessage:"{remainingVisitorsCount} more…",id:"topbarPresence.presenceIndicator.hiddenUsers.moreUsersNotViewing.tooltip",values:{remainingVisitorsCount:t}})}):null}function re(e,t){const o=(0,s().DP)();return(0,s().IS)((()=>{const n={width:$,height:$,borderRadius:$},i=e(o);return{button:{transition:"all 0.2s ease",transform:"scale(1)"},buttonHovered:{transform:"scale(1.15)",background:"none"},buttonPressed:{transform:"scale(0.9)",background:"none"},uiUserAvatarStyles:{...n},avatarInnerOutline:{...n,outlineStyle:"solid",outlineColor:A().Tj.UIUserAvatarInnerOutline,outlineWidth:.5,outlineOffset:-.5},avatarBorder:t?{...n,outlineStyle:"solid",outlineColor:i,outlineWidth:1.5,outlineOffset:-.5}:{},avatarOuterOutline:{...n,outlineStyle:"solid",outlineColor:t?A().Tj.background.primary:A().Tj.UIUserAvatarIdleOutline,outlineWidth:.5,outlineOffset:t?1:0,backgroundColor:A().Tj.background.primary,marginInlineEnd:-6,position:"relative"},initialColor:{color:t?i:A().Tj.icon.secondary}}}),[e,t,o])}function se(e){const{userData:t,rootStore:o,isShowingInFeed:s=!1}=e,l=(0,a().v3)(),{userId:c}=t,u=(0,B().dp)(l,t),p=(0,b().MF)(c),g=(0,i().X)("use_topbar_person_hovercards"),{userStore:h,showAvatar:S}=(0,r().K8)((()=>{const e=Z(c,o);return{userStore:e,showAvatar:(e.isDefined()||p)&&!e.getIsSuspended()}}),[c,o,p]),x=re((0,n.useCallback)((e=>(0,b().MF)(c)?A().Tj.icon.secondary:c===l.currentUser.id?A().Tj.border.accentPrimary:(0,A().Nq)(c,e)),[l.currentUser.id,c]),u);if(!S)return null;const I=(0,W.jsx)("div",{style:x.avatarOuterOutline,children:(0,W.jsx)("div",{style:x.avatarBorder,children:(0,W.jsx)(U().A,{iconStyle:x.avatarInnerOutline,userStore:p?v().px:h,style:x.uiUserAvatarStyles,isOffline:!u,size:$,avatarShouldShowShadow:!s,initialOverrideStyle:x.initialColor})})}),C=u&&t.blockId?(0,W.jsx)(m().Ay,{onClick:()=>(0,j().B)([t.blockId??""],!0,l),style:x.button,hoveredStyle:x.buttonHovered,pressedStyle:x.buttonPressed,children:I}):I;if(s||!l.currentUser.id)return C;if(g){const e=function({userData:e,isPresent:t,currentUserId:o,userId:n,isShowingInFeed:i}){if(o!==n)return t?e.blockId&&!i?(0,W.jsx)(w().sA,{defaultMessage:"Viewing now. Click to see where they are.",id:"topbar.presenceIndicator.viewingNowWithLocation.tooltip"}):(0,W.jsx)(w().sA,{defaultMessage:"Viewing now",id:"topbar.presenceIndicator.viewingNow.tooltip"}):e.activityTimestampNearestMinuteMs?(0,W.jsx)(w().sA,{defaultMessage:"Last viewed {timeFromNow}",id:"topbar.presenceIndicator.lastViewedTime.tooltip",values:{timeFromNow:(0,y().v9)(Math.min(e.activityTimestampNearestMinuteMs,Date.now()),d().locale)}}):void 0}({userData:t,isPresent:u,currentUserId:l.currentUser.id,userId:c,isShowingInFeed:s});return(0,W.jsx)(F,{trigger:C,userStore:h,header:e})}return(0,W.jsx)(f().m,{disableTooltip:s,textWrap:!0,renderTooltip:()=>(0,W.jsx)(ee,{rootStore:o,userData:t,isPresent:u,isShowingInFeed:s}),render:e=>(0,W.jsx)("div",{...e,children:C})})}function le(e){const{rootStore:t,pageVisitStore:o,presenceStore:n,maxUsers:i,isShowingInFeed:s}=e,d=(0,a().v3)(),u=d.currentUser.id,[{status:m,value:g}]=(0,S().Yb)((async()=>(0,C().$g)()),[]),f=(0,r().K8)((()=>{var e;if("resolved"===m)return null==g||null===(e=g.getPresencesForBlock(t.id))||void 0===e?void 0:e.find((e=>e.blockId===t.id))}),[g,m,t.id]),h=(0,r().K8)((()=>{const e=d.currentUser.id;if(!e)return;const a=s||(0,B().xm)(n)?(0,B().PZ)({pageVisitStore:o,presenceStore:n}):[];let r=(null==o?void 0:o.state.totalCount)??a.length;const l=[],c=[];for(const t of a)t.userId!==e?(0,B().dp)(d,t)?l.push(t):c.push(t):r--;!(0,p().r)({environment:d,store:t})&&t.isNavigableBlock()&&(0,M().BP)(t,d,d.device)&&"resolved"===m&&null!=f&&f.present&&l.push(f);const u=[...Y(l).reverse(),...Y(c).reverse()],g=Q(i)-1;return{visibleUsers:u.slice(0,g),hiddenUsers:u.slice(g),totalCount:r,hasMore:Boolean(null==o?void 0:o.state.hasMore)}}),[o,n,d,s,i,t,m,f],{useDeepEqual:!0}),{visibleUsers:y,hiddenUsers:v,hiddenUsersCount:x,hasMoreHiddenUsers:w,isEveryUserStoreReady:A}=(0,r().K8)((()=>{if(!u)return{};const{visibleUsers:e=[],hiddenUsers:o=[]}=h??{},n=[u,...e.map((e=>e.userId)),...o.map((e=>e.userId))].map((e=>Z(e,t)));return{visibleUsers:e,hiddenUsers:o,hiddenUsersCount:Number(null==h?void 0:h.totalCount)-e.length,hasMoreHiddenUsers:Boolean(null==h?void 0:h.hasMore),isEveryUserStoreReady:n.every((e=>e.isReady()||(0,b().MF)(e.id)))}}),[u,h,t]),I=(0,r().O$)(c().b),j=(0,_().n)(t),T=!(0,r().O$)(l().e);if(!u||!h||!A||T)return null;if(u!==t.userId)return null;if(0===y.length&&0===v.length)return j?(0,W.jsx)("div",{style:X({environment:d,isShowingTabBar:I,isShowingInFeed:s}),children:(0,W.jsx)(k().h,{enableClickToScroll:!0,rootStore:t})}):null;{const e=[...y];return e.reverse(),(0,W.jsxs)("div",{style:X({environment:d,isShowingTabBar:I,isShowingInFeed:s}),children:[x>0?(0,W.jsx)(oe,{rootStore:t,hiddenUsers:v,hiddenUsersCount:x,hasMore:w,environment:d}):void 0,e.map((e=>(0,W.jsx)(se,{userData:e,rootStore:t},e.userId))),s?void 0:(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(se,{rootStore:t,userData:{userId:u,present:!0}}),(0,W.jsx)(k().h,{enableClickToScroll:!0,rootStore:t})]})]})}}},28853:(e,t,o)=>{o.d(t,{X:()=>p});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(803949),o(581454),o(737550);var n=o(296540),i=()=>o(664594),a=()=>o(590526),r=()=>o(350013),s=()=>o(743246),l=()=>o(69708),c=()=>o(388832);o(474848);const d=(0,l().YK)({fillFirstPage:{defaultMessage:"First page",id:"database.agentHelpers.fillFirstPage"},fillFirst5Pages:{defaultMessage:"First 5 pages",id:"database.agentHelpers.fillFirst5Pages"},fillFirst10Pages:{defaultMessage:"First 10 pages",id:"database.agentHelpers.fillFirst10Pages"},fillAllPages:{defaultMessage:"All pages in this view",id:"database.agentHelpers.fillAllPages"},fillAllRowsCaption:{defaultMessage:"Fills the first 1,000 pages",id:"database.agentHelpers.fillAllRowsCaption"},unnamedAgent:{defaultMessage:"New agent",id:"database.agentHelpers.unnamedAgent"},configureAgent:{defaultMessage:"Configure agent",id:"database.agentHelpers.configureAgent"},createdByMeSection:{defaultMessage:"Created by me",id:"database.agentHelpers.createdByMeSection"},inDatabaseSection:{defaultMessage:"In this database",id:"database.agentHelpers.inDatabaseSection"},autofillDescription:{defaultMessage:"Auto-fills {propertyNames} when {triggers}",id:"database.agentHelpers.autofillDescription"},pageIsUpdatedTrigger:{defaultMessage:"a page is updated",id:"database.agentHelpers.pageIsUpdatedTrigger"},pageIsCreatedTrigger:{defaultMessage:"when a page is created",id:"database.agentHelpers.pageIsCreatedTrigger"},pageIsCreatedOrUpdatedTriggers:{defaultMessage:"a page is created or updated",id:"database.agentHelpers.pageIsCreatedOrUpdatedTriggers"}});var u=()=>o(595917);function p(e){const{collectionContextStore:t}=e,o=(0,l().tz)(),c=(0,i().T)(),d=(0,a().K8)((()=>t.collectionStore()),[t]),p=(0,a().K8)((()=>t.collectionViewBlockStore()),[t]),g=(0,a().K8)((()=>null==d?void 0:d.getSpaceId()),[d]),f=(0,u().a)(d),h=(0,a().K8)((()=>{if(!p||!d||!g)return[];const e=("value"in f?f.value:[]).filter((e=>"none"!==e.access)).map((e=>r().N.createChildStore(p,{table:s().C0,id:e.workflowId,spaceId:g}))),t=[];for(const n of e)void 0===n.getMovedToTrashTime()&&t.push(m({workflowStore:n,collectionStore:d,currentUserId:c,intl:o}));return t}),[p,d,g,f,c,o]);return(0,n.useMemo)((()=>{const e=[],t=[];return h.forEach((o=>{o.isCreatedByMe?e.push(o):t.push(o)})),{createdByMe:e,inDatabase:t}}),[h])}function m(e){const{workflowStore:t,collectionStore:o,currentUserId:n,intl:i,property:a,propertySchema:r}=e,s=t.getDraftData()??t.getData(),l=(null==s?void 0:s.name)||i.formatMessage(d.unnamedAgent),u=t.getCreatedById()===n,p=new Set((0,c().d_)(t)),m=o.getSchema(),g=[];for(const c of p){var f;const e=null===(f=m[c])||void 0===f?void 0:f.name;e&&g.push(e)}const h=e=>!(null==s||!s.triggers)&&s.triggers.some((t=>{var o;return(null===(o=t.state)||void 0===o?void 0:o.type)===e})),y=h("notion.page.updated"),v=h("notion.page.created");let S=d.pageIsCreatedOrUpdatedTriggers;y&&v?S=d.pageIsCreatedOrUpdatedTriggers:y?S=d.pageIsUpdatedTrigger:v&&(S=d.pageIsCreatedTrigger);const b=new Intl.ListFormat(i.locale,{style:"long",type:"conjunction"}),x=i.formatMessage(d.autofillDescription,{propertyNames:b.format(g),triggers:i.formatMessage(S)}),w=!u,A={workflowStore:t,workflowId:t.id,agentName:l,agentDescription:x,isCreatedByMe:u,isInDatabase:w,associatedPropertyNames:g};if(a&&r){var I;const e=(null==s||null===(I=s.modules)||void 0===I?void 0:I.some((e=>{var t;return"notion"===e.type&&(null===(t=e.state)||void 0===t||null===(t=t.ownedByDatabasePropertyIds)||void 0===t?void 0:t.includes(a))})))??!1,o=r.default_workflow_id===t.id;return{...A,isForCurrentProperty:e,isDefault:o}}return A}},64035:(e,t,o)=>{o.d(t,{C:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.5 1.37 13 13.25",svg:(0,o(474848).jsx)("path",{d:"M9.385 1.375a.625.625 0 1 0 0 1.25h.769c.76 0 1.375.616 1.375 1.375v1.223c0 1.085.49 2.097 1.298 2.777a3.63 3.63 0 0 0-1.298 2.777V12c0 .76-.616 1.375-1.375 1.375h-.77a.625.625 0 1 0 0 1.25h.77A2.625 2.625 0 0 0 12.779 12v-1.223c0-.897.514-1.725 1.32-2.128a.726.726 0 0 0 0-1.298 2.39 2.39 0 0 1-1.32-2.128V4a2.625 2.625 0 0 0-2.625-2.625zm-2.77 0h-.769A2.625 2.625 0 0 0 3.221 4v1.223c0 .897-.514 1.725-1.32 2.128a.726.726 0 0 0 0 1.298 2.39 2.39 0 0 1 1.32 2.128V12a2.625 2.625 0 0 0 2.625 2.625h.77a.625.625 0 1 0 0-1.25h-.77c-.76 0-1.375-.616-1.375-1.375v-1.223c0-1.085-.49-2.097-1.298-2.777a3.63 3.63 0 0 0 1.298-2.777V4c0-.76.616-1.375 1.375-1.375h.77a.625.625 0 1 0 0-1.25"})},i=(0,o(340498).wt)("curlyBracesSmall",n,"small")},64790:(e,t,o)=>{o.d(t,{$L:()=>u,EV:()=>s,PZ:()=>d,dp:()=>l,xm:()=>c});o(944114);var n=()=>o(798880),i=()=>o(100622),a=()=>o(496603),r=()=>o(720665);function s(e){if(null!=e&&e.blockId)return e.blockId}function l(e,t){const o=e.currentUser.id;return t.userId===o||t.present}function c(e){var t;return(null===(t=e.state.rootStore)||void 0===t?void 0:t.canEdit())??!1}function d(e){const{pageVisitStore:t,presenceStore:o}=e,{remotePresenceData:n}=o.state;let i=[];n&&a().uk(n,(e=>{null!=e&&e.userId&&i.push(e)}));const{pageId:s,lastViewTime:l,lastExitTime:c,totalCount:d,hasMore:u,...p}=t.state;return a().uk(p,(e=>{e.isDefined()&&i.push({userId:e.getUserId(),activityTimestampNearestMinuteMs:(0,r().WY)(e.getVisitedAt()),present:!1})})),i=a().hS(i,(e=>e.userId)),a().Ul(i,(({activityTimestampNearestMinuteMs:e})=>e?-e:0))}function u(e){const{userId:t,theme:o}=e;return(0,n().MF)(t)?i().Tj.icon.secondary:(0,i().Nq)(t,o)}},94686:(e,t,o)=>{o.d(t,{o:()=>s});o(296540);var n=()=>o(590526),i=()=>o(326887),a=()=>o(546461),r=o(474848);function s(e){const{automationStore:t,children:o,enableExistenceGuarantees:s}=e,l=(0,n().K8)((()=>{var e;return(null===(e=t.getTrigger())||void 0===e?void 0:e.type)??"event"}),[t]);return(0,r.jsx)(a().u,{automationStore:t,contextType:(0,i().H8)(l),enableExistenceGuarantees:s,children:o})}},107620:(e,t,o)=>{o.d(t,{y:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"1.81 2.89 16.38 15.08",svg:(0,o(474848).jsx)("path",{d:"M16.938 9.853c0-2.97-2.539-5.54-6.545-5.697L10 4.148c-4.232 0-6.938 2.639-6.938 5.705 0 1.438.583 2.752 1.617 3.76a.63.63 0 0 1 .18.546 7.3 7.3 0 0 1-.89 2.528c1.108-.13 2.12-.614 3.01-1.344l.063-.044a.63.63 0 0 1 .505-.073 9 9 0 0 0 2.454.333l.392-.007c4.006-.158 6.545-2.728 6.545-5.699m1.25 0c0 3.803-3.234 6.766-7.747 6.948l-.44.008a10.2 10.2 0 0 1-2.485-.299c-1.349 1.022-2.985 1.62-4.826 1.428a.625.625 0 0 1-.406-1.033c.712-.817 1.096-1.737 1.284-2.642-1.116-1.197-1.756-2.733-1.756-4.41 0-3.925 3.447-6.955 8.189-6.955l.44.009c4.512.181 7.747 3.143 7.747 6.946"})},i=(0,o(340498).wt)("chatBubble",n,"default")},130119:(e,t,o)=>{function n(e){return"drag"in e&&e.drag?{WebkitAppRegion:"drag"}:"noDrag"in e&&e.noDrag?{WebkitAppRegion:"no-drag"}:{}}o.d(t,{g:()=>n})},132855:(e,t,o)=>{o.r(t),o.d(t,{arrowInCircleUpFillIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.37 2.37 15.25 15.26",svg:(0,o(474848).jsx)("path",{d:"M10 17.625a7.625 7.625 0 1 0 0-15.25 7.625 7.625 0 0 0 0 15.25m3.042-8.07a.625.625 0 0 1-.884 0L10.625 8.02v5.466a.625.625 0 1 1-1.25 0V8.021L7.842 9.554a.625.625 0 1 1-.884-.883l2.6-2.6a.625.625 0 0 1 .884 0l2.6 2.6a.625.625 0 0 1 0 .883"})},i=(0,o(340498).wt)("arrowInCircleUpFill",n,"fill")},158115:(e,t,o)=>{o.r(t),o.d(t,{arrowChevronSingleRightFillSmallIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"5.54 2.94 5.81 10.11",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M11.13 8.53a.75.75 0 0 0 0-1.06L6.81 3.15a.75.75 0 0 0-1.06 1.06L9.54 8l-3.79 3.79a.75.75 0 0 0 1.06 1.06z"})},i=(0,o(340498).wt)("arrowChevronSingleRightFillSmall",n,"fillSmall")},175213:(e,t,o)=>{o.d(t,{G:()=>i});var n=()=>o(314529);function i(e,t){(0,n().DO_NOT_USE_trackLegacy)(e,"delete_property",t)}},182060:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,questionMarkCircleFillSmallIcon:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"1.95 1.94 12.11 12.1",svg:(0,o(474848).jsx)("path",{d:"M8 1.95a6.05 6.05 0 1 0 0 12.1 6.05 6.05 0 0 0 0-12.1m-.02 3.58c-.694 0-1.161.395-1.255.77a.5.5 0 0 1-.97-.243C5.989 5.12 6.96 4.53 7.981 4.53c1.151 0 2.279.764 2.279 1.926 0 .678-.409 1.235-.948 1.568l-.644.44a.75.75 0 0 0-.338.603.5.5 0 0 1-1 0c0-.574.3-1.101.77-1.427l.003-.001.667-.455.01-.007c.327-.199.48-.471.48-.721 0-.415-.462-.926-1.28-.926m.583 5.389a.7.7 0 1 1-1.4 0 .7.7 0 0 1 1.4 0"})},i=(0,o(340498).wt)("questionMarkCircleFillSmall",n,"fillSmall")},191356:(e,t,o)=>{o.d(t,{C4:()=>S,Nf:()=>x,qM:()=>b});o(16280),o(944114),o(898992),o(430670),o(581454);var n=()=>o(726637),i=()=>o(675133),a=()=>o(792057),r=()=>o(732810),s=()=>o(617871),l=()=>o(388693),c=()=>o(519831),d=()=>o(161479),u=()=>o(534177),p=()=>o(753812),m=()=>o(457583),g=()=>o(384944),f=()=>o(594794),h=()=>o(620791),y=()=>o(661075);const v=(0,o(69708).YK)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function S(e,t,o,r){const s=null==t?void 0:t.getSpaceStore();if(!s)return;const l=(0,h().jw)(o.id).length;if(n().A.isMobile&&r&&!l){const e=i().A.formatMessage(v.mobileAdminError);throw a().f1(e),new Error(e)}if(n().A.isMobile&&!r&&!l){const e=i().A.formatMessage(v.mobileError);throw a().f1(e),new Error(e)}if(!l&&r&&s.canAdmin()||!l&&!r)try{await m().Jq({environment:e,integration:o,spaceId:s.id,from:"collection_settings_property_type"})}catch(c){const e=i().A.formatMessage(v.authError);throw a().f1(e),new Error(e)}if(!(0,h().jw)(o.id).length){const e=i().A.formatMessage(v.authError);throw a().f1(e),new Error(e)}}function b(e){const{environment:t,pattern:o,integration:n,parentCollectionStore:i,transaction:a}=e;if(!o.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const s=new(r().m)(t,(0,f().zP)({environment:t,table:c().Vl,spaceId:i.pointer.spaceId})),l={};o.connected_relation_sub_schemas&&(0,u().WP)(o.connected_relation_sub_schemas).map((([e,o])=>{const n=new(r().m)(t,(0,f().zP)({environment:t,table:c().Vl,spaceId:i.pointer.spaceId})),u={bot_id:void 0,external_object_id:void 0,uri:e,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:o,sync_state:void 0,pattern_name:void 0},p={id:n.id,version:0,space_id:(0,d().e)(i.pointer.spaceId),parent_table:c().Vl,parent_id:s.id,alive:!0,format:u,schema:{}};l[e]=n.id,g().zv({store:n,data:p,transaction:a})}));const p={id:s.id,version:0,space_id:(0,d().e)(i.pointer.spaceId),parent_table:c().Vl,parent_id:i.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,y().Fe)({pattern:o,integration:n})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${n.id}/${o.name}`,integration_id:n.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:o.connected_relation_properties,sync_state:void 0,pattern_name:o.name,related_external_object_uris_to_instance_ids:l},schema:{}};return g().zv({store:s,data:p,transaction:a}),s}async function x(e){const{bot:t,connected_relation_properties:o}=e;if(t.integration_id===s().Iy||t.integration_id===s().mn)return await async function(e){var t,o,n;const{environment:i,objectName:a,spaceId:r,bot:s}=e,c=await p().callApi({eventName:"describeSalesforceObject",environment:i,data:{spaceId:r,objectName:a,botId:s.id}});if("success"!==(null==c?void 0:c.type))return{error:l().qh.FAILED_TO_FETCH_SALESFORCE_PROPERTIES};var d,u;if((null===(t=c.data)||void 0===t?void 0:t.responseStatus)===l().qh.REAUTHENTICATION_REQUIRED||(null===(o=c.data)||void 0===o?void 0:o.responseStatus)===l().qh.NO_USER_API_ACCESS)return{error:`${null===(d=c.data)||void 0===d?void 0:d.responseStatus}:${null===(u=c.data)||void 0===u?void 0:u.userType}`};const m=null==c||null===(n=c.data)||void 0===n?void 0:n.properties;if(m){return{value:m.flatMap((e=>{const t=e.custom?e.label:e.relationshipName||e.label;return"User"===e.referenceTo||"Group"===e.referenceTo?[{id:e.name,name:t,isSelected:!1,type:e.type,metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible},{id:`mapped_${e.name}`,name:`${t} (Notion User)`,isSelected:!1,type:"person",metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible}]:[{id:"Name"===e.name?"title":e.name,name:"relation"===e.type?t:e.label,isSelected:!1,type:e.type,metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible}]}))}}return{error:l().qh.NO_PROPERTIES_FOUND}}(e);const n=[],i=o;for(const a in i){const e=i[a];null!=e&&e.name&&null!=e&&e.type&&n.push({id:a,name:e.name,isSelected:!1,type:e.type,metadata:{name:e.name,label:e.name,type:e.type,custom:!1},isAlreadySynced:!1})}return{value:n}}},200424:(e,t,o)=>{e.exports=o.p+"9ade71d75a1c0e93.png"},240865:(e,t,o)=>{o.d(t,{V:()=>a});var n=()=>o(755531),i=()=>o(590526);function a(e){return(0,i().K8)((()=>{var t;return e?e.getMemberCountFromPublicSpaceData()??void 0:(null===(t=(0,n().S)())||void 0===t?void 0:t.getMemberCountFromPublicSpaceData())??void 0}),[e])}},245720:(e,t,o)=>{o.d(t,{W:()=>n});const n=(0,o(69708).YK)({done:{id:"modal.doneButton",defaultMessage:"Done"},cancel:{id:"modal.cancelButton",defaultMessage:"Cancel"},back:{id:"modal.backButton",defaultMessage:"Back"}})},278589:(e,t,o)=>{o.d(t,{N:()=>a});var n=()=>o(534177),i=()=>o(17680);function a(e){return"avatar"===e?i().eQ:"xsmall"===e?18:"xsmall_plus"===e?24:"small"===e?28:"small_plus"===e?32:"medium"===e?36:"medium_plus"===e?44:"medium_large"===e?48:"large"===e?50:"large_plus"===e?64:"xlarge"===e?94:"plans"===e?20:"deep_dive"===e?16:"upsell_banner"===e?74:"personalization_modal"===e?96:(0,n().HB)(e)}},293529:(e,t,o)=>{o.d(t,{w:()=>n});const n=(0,o(340498).xh)("arrowDiagonalUpRight",{default:{loader:()=>o.e(66972).then(o.bind(o,955363))},small:{loader:()=>o.e(66972).then(o.bind(o,8741))},fill:{loader:()=>o.e(66972).then(o.bind(o,663247))},fillSmall:{loader:()=>o.e(66972).then(o.bind(o,748902))}},["arrow","up","right","direction","navigation"])},299177:(e,t,o)=>{o.d(t,{A:()=>a});class n extends(()=>o(757695))().Store{getInitialState(){return{}}}const i=new n;o(852832).exposeDebugValue("SpaceWorkflowTemplateInstanceMapStore",i);const a=i},348670:(e,t,o)=>{o.d(t,{W:()=>f,t:()=>g});var n=o(296540),i=()=>o(870956),a=()=>o(717137),r=()=>o(484714),s=()=>o(590526),l=()=>o(232615),c=()=>o(31511),d=()=>o(384944),u=()=>o(440024),p=()=>o(366360),m=o(474848);function g(e){const{value:t,onChange:o,wrapStyle:s,onBlur:d,...p}=e,[g,f]=(0,n.useState)(!1),h=(0,r().v3)(),y=(0,i().A)(!0),v=(0,n.useCallback)((()=>{f(!1),null==d||d()}),[d]),S=(0,n.useCallback)((e=>o(e.currentTarget.value)),[o]),b=(0,n.useCallback)((()=>{"empty"!==l().default.state.mode&&(0,u().I)({environment:h}),f(!0)}),[h]);return(0,m.jsx)(a().A,{debugName:"AutomationPlainTextInput",capture:g,children:(0,m.jsx)("div",{...y,style:s,children:(0,m.jsx)(c().A,{...p,onBlur:v,onChange:S,onFocus:b,value:t})})})}function f(e){const{onChange:t,store:o,...i}=e,{maybePersistedTransactionActions:a}=(0,p().b)(),r=(0,s().K8)((()=>o.getValue()??""),[o]),l=(0,n.useCallback)((e=>{a.createAndCommit({userAction:"AutomationPlainTextInput.setValue",perform:t=>{d().KY({store:o,transaction:t,value:e})}}),null==t||t(e)}),[a,t,o]);return(0,m.jsx)(g,{value:r,onChange:l,...i})}},360576:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,personFillSmallIcon:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.89 1.85 10.22 12.3",svg:(0,o(474848).jsx)("path",{d:"M8 1.85c-.925 0-1.673.382-2.179 1.012-.495.617-.73 1.435-.73 2.29 0 .856.235 1.674.73 2.291.506.63 1.255 1.012 2.18 1.012.924 0 1.672-.382 2.178-1.012.495-.617.73-1.435.73-2.29 0-.856-.235-1.674-.73-2.291C9.673 2.232 8.925 1.85 8 1.85m0 7.403c-2.175 0-4.115 1.06-4.94 2.672-.3.585-.165 1.179.19 1.594.34.396.873.63 1.43.63h6.64c.557 0 1.09-.234 1.43-.63.355-.415.49-1.01.19-1.594-.825-1.612-2.765-2.672-4.94-2.672"})},i=(0,o(340498).wt)("personFillSmall",n,"fillSmall")},366360:(e,t,o)=>{o.d(t,{b:()=>s,k:()=>l});o(16280);var n=o(296540),i=()=>o(590526),a=()=>o(546461),r=()=>o(911724);function s(){return(0,n.useContext)(r().A)}function l(){const{automationStore:e}=(0,a().q8)(),{collectionStore:t,...o}=s(),n=(0,i().K8)((()=>{if(!(null!=e&&e.isTriggerType("event")||null!=e&&e.isTriggerType("recurrence")))throw new Error("automationStore is wrong type. Is this called in the wrong type of automation?");return e}),[e]);if(!t)throw new Error("collectionStore is undefined. Is this rendered inside an AutomationEditorContext.Provider?");return{...o,collectionStore:t,automationStore:n}}},375555:(e,t,o)=>{function n(e,t){const{device:o}=e;o.isAndroid&&t.focus(),t.select()}o.d(t,{G:()=>n})},378711:(e,t,o)=>{o.d(t,{L:()=>h});var n=o(296540),i=()=>o(484714),a=()=>o(590526),r=()=>o(128933),s=()=>o(807449),l=()=>o(695115),c=()=>o(26697),d=()=>o(236262),u=()=>o(69708),p=()=>o(339798),m=()=>o(815510),g=o(474848);const f=(0,u().YK)({deleteLabel:{defaultMessage:"Delete agent",id:"collectionSettings.propertyAgentAutofill.deleteAgent.icon"},agentDeletedSuccessfully:{defaultMessage:"Agent deleted successfully",id:"database.collectionViewAgentsMenu.agentDeletedSuccessfully"}});function h(e){const{collectionSettingsStore:t,collectionStore:o,onDeleteAgent:h,spaceId:y,workflowStore:v}=e,S=(0,i().v3)(),b=(0,u().tz)(),x=(0,n.useCallback)((()=>{if(!y||!v||!o)return;const e=o.getParentCollectionViewBlockStore();m().MT({workflowStore:v,collectionStore:o,collectionViewBlockStore:e,environment:S,spaceId:y}),t&&p().os({collectionSettingsStore:t}),h&&h(),r().D6({label:b.formatMessage(f.agentDeletedSuccessfully)})}),[y,v,o,S,t,h,b]),w=(0,a().K8)((()=>null==v?void 0:v.canEdit()),[v]),A=(0,a().K8)((()=>!!v&&!1===v.getAlive()),[v]),I=(0,n.useMemo)((()=>!!(v&&o&&y&&w)&&!A),[o,w,A,y,v]);return{handleDeleteAgent:x,shouldShowDeleteButton:I,deleteButton:I?(0,g.jsx)(c().m,{renderTooltip:()=>(0,g.jsx)(u().sA,{...f.deleteLabel}),render:e=>(0,g.jsx)(l().A,{...e,size:"xxs",icon:()=>(0,g.jsx)(s().I,{icon:d().trashIcon,colorVariant:"tertiary"}),ariaLabel:b.formatMessage(f.deleteLabel),onClick:x})}):null}}},383567:(e,t,o)=>{o.d(t,{F:()=>a});o(296540);var n=o(474848);const i={viewBox:"0 0 20 20",fittedViewBox:"3.26 1.98 16.32 17.52",svg:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("path",{d:"M15.825 12a3.75 3.75 0 1 1-.001 7.501 3.75 3.75 0 0 1 0-7.501m0 1.325a.55.55 0 0 0-.55.55V15.2H13.95a.55.55 0 0 0-.001 1.1h1.326v1.325a.55.55 0 0 0 1.1 0V16.3h1.324a.55.55 0 0 0 0-1.1h-1.325v-1.325a.55.55 0 0 0-.55-.55M9.702 5.022a3.918 3.918 0 0 1 6.742.036.626.626 0 0 1-1.08.63 2.667 2.667 0 0 0-4.59-.023L5.376 14.68l4.19.678a.626.626 0 0 1-.2 1.235l-5.1-.827a.625.625 0 0 1-.437-.938z"}),(0,n.jsx)("path",{d:"M10.912 8.094a1.178 1.178 0 1 1 2.326.377 1.178 1.178 0 0 1-2.326-.377M4.7 7.087a1.178 1.178 0 1 1 2.327.377A1.178 1.178 0 0 1 4.7 7.087M3.488 2.985a3.92 3.92 0 0 1 5.572.357.625.625 0 0 1-.944.818 2.67 2.67 0 0 0-3.796-.243.625.625 0 1 1-.832-.932"})]})},a=(0,o(340498).wt)("aiFacePlus",i,"default")},388832:(e,t,o)=>{o.d(t,{d_:()=>s,gY:()=>l,so:()=>c});o(944114),o(898992),o(354520),o(803949),o(581454);var n=()=>o(350013),i=()=>o(824862),a=()=>o(743246),r=()=>o(319625);function s(e){var t;const o=e.getDraftData()??e.getData(),n=[];return null==o||null===(t=o.modules)||void 0===t||t.forEach((e=>{var t;"notion"===e.type&&null!==(t=e.state)&&void 0!==t&&t.ownedByDatabasePropertyIds&&n.push(...e.state.ownedByDatabasePropertyIds)})),n}function l(e){const{workflowsData:t,collectionViewBlockStore:o,currentCollectionStore:i,property:r,spaceId:s}=e;if(0===t.length||!i)return[];const l=[];for(const n of t)"none"!==n.access&&n.collectionId===i.id&&l.push(n.workflowId);return l.map((e=>n().N.createChildStore(o,{table:a().C0,id:e,spaceId:s}))).filter((e=>{const t=e.getDraftData()??e.getData(),o=null==t?void 0:t.modules;for(const i of o??[]){var n;if("notion"===i.type)return(null===(n=i.state)||void 0===n||null===(n=n.ownedByDatabasePropertyIds)||void 0===n?void 0:n.includes(r))??!1}return!1}))}function c(e){const{collectionStore:t,spaceId:o}=e,a=t.getParentStore(),s=null==a?void 0:a.getFormat(),l=s&&"database_agent_ids"in s&&Array.isArray(s.database_agent_ids)?s.database_agent_ids:[];if(!a||!s||0===l.length)return{value:[]};const c=l.map((e=>{const t={id:e,table:"workflow",spaceId:o};return n().N.createChildStore(a,t)})).filter((e=>e.isDefined()&&void 0===e.getMovedToTrashTime()));try{return{value:c.map((e=>{const o=e.getData();let n;const r=null==o?void 0:o.runtime_actor_pointer;r&&r.table===i().GP&&(n=r.id);return{...{blockId:a.id,collectionId:t.id,workflowId:e.id,botId:n},access:"write"}}))}}catch(d){return{error:(0,r().A)(d)}}}},390518:(e,t,o)=>{o.d(t,{A:()=>a});o(296540);var n=()=>o(98126),i=o(474848);function a(){return(0,i.jsx)("div",{style:{alignItems:"center",display:"flex",justifyContent:"center",minHeight:200,overflow:"hidden"},children:(0,i.jsx)(n().k,{})})}},401634:(e,t,o)=>{o.d(t,{i:()=>v});o(296540);var n=()=>o(782482),i=()=>o(726637),a=()=>o(401497),r=()=>o(394888),s=()=>o(882722),l=()=>o(245720),c=()=>o(807449),d=()=>o(546926),u=()=>o(890492),p=()=>o(526278),m=()=>o(69708),g=()=>o(534177),f=o(474848);const h=(0,m().YK)({createTitle:{id:"automations.builderModal.createTitle",defaultMessage:"Create automation"},updateTitle:{id:"automations.builderModal.updateTitle",defaultMessage:"Edit automation"},saveButton:{id:"automations.builderModal.saveButton",defaultMessage:"Save"}}),y=88;function v(e){const{children:t,handleOnDismiss:o,canSave:v,handleOnSave:S,mode:b}=e,x=(0,m().tz)(),w=(0,a().IS)((()=>({container:{padding:i().A.isMobile?0:"12px 16px",display:"flex",flexDirection:"column",overflow:"hidden",...i().A.isMobile?{}:{flexGrow:1}}})),[]);if(i().A.isMobile){let e;return"create"===b?e=x.formatMessage(h.createTitle):"update"===b||"button_property"===b?e=x.formatMessage(h.updateTitle):"loading"===b?e=null:(0,g().HB)(b),(0,f.jsx)(u().A,{menuType:d().gu.Modal,whiteBackground:!0,title:e,left:(0,f.jsx)(c().I,{icon:p().arrowStraightLeftIcon,colorVariant:"secondary"}),onClickLeft:o,rightDisabled:!v,right:"button_property"===b?(0,f.jsx)(m().sA,{...l().W.done}):(0,f.jsx)(m().sA,{...h.saveButton}),onClickRight:S,children:(0,f.jsx)("div",{style:w.container,className:s().sux,children:t})})}return(0,f.jsx)(r().s,{anchor:"top",minimumOutsideSpacing:{type:"axes",vertical:y},areaConstraint:{width:{type:"fixed",length:500},height:{type:"min",length:600,scroll:"disallow"}},allowDismissByEscape:!1,isOpen:!0,render:()=>(0,f.jsxs)("div",{style:w.container,className:s().sux,children:[t,(0,f.jsx)(n().N,{debugName:"AutomationBuilderModal",capture:!0,onEsc:e=>{o()}})]})})}},404845:(e,t,o)=>{o.r(t),o.d(t,{AutomationBuilderModal:()=>It,ButtonBuilderModal:()=>Rt});o(944114),o(898992),o(354520),o(737550);var n=o(296540),i=()=>o(106702),a=()=>o(726637),r=()=>o(484714),s=()=>o(590526),l=()=>o(401497),c=()=>o(79926),d=()=>o(128933),u=()=>o(302655),p=()=>o(695115),m=()=>o(406094),g=()=>o(160432),f=()=>o(663639),h=()=>o(736847),y=()=>o(422540),v=()=>o(278132),S=()=>o(187174),b=()=>o(995847),x=()=>o(340498),w=()=>o(912720),A=()=>o(69708),I=()=>o(100622),j=()=>o(496603),C=()=>o(973647),M=()=>o(534177),T=()=>o(284371),k=()=>o(813297),_=()=>o(339798),B=()=>o(637759),P=()=>o(326887),V=()=>o(969318),E=()=>o(261503),D=()=>o(457823),R=()=>o(314529),U=()=>o(907258),K=()=>o(59226),N=()=>o(295633),F=()=>o(457205),O=()=>o(807449),L=()=>o(416783),W=()=>o(631524),z=()=>o(584262),H=()=>o(765974),q=()=>o(281844),$=()=>o(236262),G=()=>o(792071),Y=()=>o(142748),Q=()=>o(179034),Z=()=>o(824862),X=()=>o(519831),J=()=>o(96689),ee=()=>o(837570),te=()=>o(774256),oe=()=>o(826352),ne=()=>o(546461),ie=()=>o(367742),ae=()=>o(76190),re=()=>o(284489),se=()=>o(862292),le=()=>o(761309),ce=()=>o(975394),de=()=>o(528093),ue=()=>o(704658),pe=o(474848);const me=(0,A().YK)({automationIncompatibleViewFilterAndOwner:{defaultMessage:"This automation may not work because the view has a non-supported filter",id:"AutomationHeaderView.incompatibleCollectionViewFilter.owner"},automationPublicAccess:{defaultMessage:"This automation is part of a public page",id:"AutomationHeaderView.automationPublicAccess"},automationUpgrade:{defaultMessage:"<anchor-upsell>Upgrade</anchor-upsell> to edit this automation or create your own",id:"AutomationHeaderView.automationUpgrade"},automationEditOnSite:{defaultMessage:"This automation can only be edited on notion.com",id:"AutomationHeaderView.automationEditOnSite"},automationExternalBotNoPermissions:{defaultMessage:"Ask {user} to edit this automation",id:"AutomationHeaderView.automationExternalBotNoPermissions"},automationExternalBotWithPermissions:{defaultMessage:"Ask {user} to edit this automation or <anchor-delete>delete</anchor-delete> it when necessary",id:"AutomationHeaderView.automationExternalBotWithPermissions"},automationMissingPermissionsNoPermissionsForDatabase:{defaultMessage:"You must have full access to target databases in this automation to edit it",id:"AutomationHeaderView.automationMissingPermissionsNoPermissionsForDatabase"},automationGenericFullAccess:{defaultMessage:"You must have full access to this database to edit automations",id:"AutomationHeaderView.automationGenericFullAccess"},automationCollectionInTrashedPage:{defaultMessage:"This database is in the trash and cannot be edited.",id:"AutomationHeaderView.automationCollectionInTrash"},automationCollectionInTrashedPageViewDeletedPageButton:{defaultMessage:"View deleted page",id:"AutomationHeaderView.automationCollectionInTrashedPageViewDeletedPageButton"},automationMissingActionFeature:{defaultMessage:"The {actionName} action is not available in your workspace",id:"AutomationHeaderView.automationMissingActionFeature"},mustBeWorkspaceMember:{defaultMessage:"You must be a workspace member to edit automations",id:"AutomationHeaderView.mustBeWorkspaceMember"}});function ge(e){const{automationPermissionScope:t,collectionStore:o,collectionSettingsStore:n,onDelete:i,referencesIncompatibleCollectionViewFilter:a,requiresSubscriptionUpgrade:l}=e,d=(0,r().v3)(),{automationStore:u,contextType:p}=(0,ne().q8)(),m=(0,A().tz)(),{value:g}=(0,c().fJ)(se().T.formulas),{value:f}=(0,c().fJ)(k().QV.automationActionRegistry),{value:h}=(0,c().fJ)(k().QV.automationTypecheck),y=(0,s().K8)((()=>Boolean((0,le().qb)(d,u,u.getSpaceStore()))),[u,d]),v=(0,s().K8)((()=>u.getSpaceId()),[u]),S=(0,s().K8)((()=>{var e;return null===(e=U().default.state.currentUserStore)||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.id}),[]),b=(0,ae().n)(u),x=(0,s().K8)((()=>(0,ie().sl)({environment:d,automationStore:u,automationActionRegistryModule:f,automationTypecheckModule:h,contextType:p,formulasModule:g,intl:m,isSubscribed:b})),[d,u,f,h,p,g,m,b]),w=(0,s().K8)((()=>{const e=(0,Y().O)({recordPointer:o.pointer,getRecordModel:o.getRecordModel});if(!e||e.table!==Q().ev)return;const t=e.pointer;return N().B.createChildStore(o,t)}),[o]),I=ve(),j=(0,de()._)({name:"premium_automations",spaceId:v,userId:S}),C=(0,re().k)({upsell:null==j?void 0:j.upsell,from:"database_automation_settings_header_message"}),T=(0,K().X)("upgrade_system_db_properties_automations"),_=(0,s().K8)((()=>u.getSpaceStore()),[u]);if(l&&null!=j&&j.upsell)return T?(0,pe.jsx)("div",{style:I.upgradeButton,children:(0,pe.jsx)(ue().UpgradeButton,{source:"database_automation_settings_header_message",display:"text",upsell:j.upsell,customMessages:Se,spaceStore:_})}):(0,pe.jsx)(oe().j,{onUpsellClick:C});if(w)return(0,pe.jsx)(ye,{icon:(0,pe.jsx)("div",{style:I.lockedIconWrap,children:(0,pe.jsx)(O().I,{icon:$().trashIcon,colorVariant:"secondary",style:I.lockedIcon})}),children:(0,pe.jsxs)("div",{children:[(0,pe.jsx)("p",{style:I.paragraph,children:(0,pe.jsx)(A().sA,{...me.automationCollectionInTrashedPage})}),(0,pe.jsx)(W().p,{onClick:()=>{!function(e,t){(function(e){(0,R().DO_NOT_USE_trackLegacy)(e,"view_deleted_page_from_automation_edit_menu")})(t),(0,ce().Y)({environment:t,store:e,pageVisitSource:z().y8.LinkInPage})}(w,d),ee().V({collectionSettingsStore:n})},style:I.restoreButton,colorVariant:"tertiary",children:(0,pe.jsx)(A().sA,{...me.automationCollectionInTrashedPageViewDeletedPageButton})})]})});if(y)return(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationPublicAccess})});if("insufficient"===x.editPermissionStatus){if("free_workspace"===x.reason)return(0,ie().ip)({contextType:p,environment:d})?(0,pe.jsx)(he,{icon:(0,pe.jsx)(O().I,{icon:q().v,colorPalette:"yellow",colorVariant:"accentPrimary"}),children:(0,pe.jsx)("p",{style:I.paragraph,children:(0,pe.jsx)(A().sA,{...me.automationUpgrade,values:{"anchor-upsell":e=>(0,pe.jsx)(L().V,{onClick:C,style:I.link,children:e})}})})}):(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationEditOnSite})});if("feature_not_enabled"===x.reason)return(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationMissingActionFeature,values:{actionName:x.actionName.toLocaleLowerCase()}})});var B,P,V;if("missing_permissions"===x.reason)return(null===(B=x.relatedPointer)||void 0===B?void 0:B.table)===Z().GP?(0,pe.jsx)(fe,{botId:x.relatedPointer.id,automationPermissionScope:t,onDelete:i,automationStore:u}):(null===(P=x.relatedPointer)||void 0===P?void 0:P.table)===X().Vl&&x.relatedPointer.id!==o.id?(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationMissingPermissionsNoPermissionsForDatabase})}):(null===(V=x.relatedPointer)||void 0===V?void 0:V.table)===J().NX?(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.mustBeWorkspaceMember})}):(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationGenericFullAccess})});(0,M().HB)(x)}else{if("unknown"===x.editPermissionStatus)return(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...me.automationGenericFullAccess})});if("sufficient"===x.editPermissionStatus)return a?(0,pe.jsx)(te().z,{icon:{icon:H().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"},children:(0,pe.jsx)(A().sA,{...me.automationIncompatibleViewFilterAndOwner})}):null;(0,M().HB)(x)}}function fe(e){const{botId:t,automationPermissionScope:o,onDelete:n,automationStore:i}=e,a=(0,A().tz)(),r=ve(),l=(0,s().K8)((()=>{const e=F().v.createChildStore(i,{id:t,spaceId:i.getSpaceId(),table:Z().GP}).getCreatedByStore();return e?e.getDisplayName(a):a.formatMessage(G().Fvx.messages.anonymousPlaceholder)}),[i,t,a]);return(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{..."readonly"===o?me.automationExternalBotNoPermissions:me.automationExternalBotWithPermissions,values:{"anchor-delete":e=>(0,pe.jsx)(L().V,{onClick:n,style:r.link,children:e}),user:l}})})}function he(e){const{children:t,icon:o}=e,n=ve();return(0,pe.jsx)("div",{style:n.wrapWrap,children:(0,pe.jsxs)("div",{style:n.upsellWrap,children:[o?(0,pe.jsx)("div",{style:n.iconWrap,children:o}):void 0,(0,pe.jsx)("div",{style:n.messageWrap,children:t})]})})}function ye(e){const{children:t,icon:o}=e,n=ve();return(0,pe.jsx)("div",{style:n.wrapWrap,children:(0,pe.jsxs)("div",{style:n.trashPageWrap,children:[o?(0,pe.jsx)("div",{style:n.iconWrap,children:o}):void 0,(0,pe.jsx)("div",{style:n.messageWrap,children:t})]})})}function ve(){return(0,l().IS)((()=>({upgradeButton:{paddingBottom:8},iconWrap:{flexGrow:0,flexShrink:0},lockedIcon:{height:"100%",width:"100%"},lockedIconWrap:{background:I().Tj.gray.background.secondaryTranslucent,borderRadius:4,height:20,padding:2,width:20},link:{color:I().Tj.blue.text.accentPrimary},messageWrap:{flexGrow:1},paragraph:{color:I().Tj.text.secondary,fontSize:a().A.isMobile?14:12,margin:0},restoreButton:{fontSize:a().A.isMobile?14:12,fontWeight:T().Wy.medium,marginInlineStart:-8},wrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10},wrapWrap:{padding:a().A.isMobile?"0 12px 12px":"0 0 6px 0"},upsellWrap:{alignItems:"center",background:I().Tj.palette.yellow[50],border:`1px solid ${I().Tj.palette.yellow[100]}`,borderRadius:6,display:"flex",flexDirection:"row",gap:10,padding:8},trashPageWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:10,background:I().Tj.palette.gray[30],padding:8,borderRadius:6},personBadgeQuestionMark:{fill:I().Tj.icon.secondary,width:16,height:"auto"},personBadgeQuestionMarkWrap:{height:20,padding:2,width:20}})),[])}const Se=(0,A().YK)({eligible_to_purchase:{id:"database_automations.automationUpgradeMessages.eligibleForUpgrade",defaultMessage:"<highlight>Upgrade</highlight> to edit this connected action"},eligible_for_trial:{id:"database_automations.automationUpgradeMessages.eligibleForTrial",defaultMessage:"<highlight>Start trial</highlight> to edit this connected action"},sales_eligible:{id:"database_automations.automationUpgradeMessages.salesEligible",defaultMessage:"<highlight>Contact sales</highlight> to edit this connected action"},sales_assisted:{id:"database_automations.automationUpgradeMessages.salesAssisted",defaultMessage:"<highlight>Contact sales</highlight> to edit this connected action"},eligible_to_request:{id:"database_automations.automationUpgradeMessages.eligibleToRequest",defaultMessage:"<highlight>Request upgrade</highlight> to edit this connected action"},request_pending:{id:"database_automations.automationUpgradeMessages.requestPending",defaultMessage:"<highlight>Requested upgrade</highlight> to edit this connected action"}});var be=()=>o(287188),xe=()=>o(26697),we=()=>o(366360),Ae=()=>o(115512);const Ie=(0,A().YK)({automationEnabledLabel:{defaultMessage:"Active",id:"collectionSettings.editAutomationView.automationEnabledLabel"},automationEnabledHiddenAriaLabel:{defaultMessage:"Automation is active.",id:"collectionSettings.editAutomationView.automationEnabledHiddenAriaLabel"},automationPausedHiddenAriaLabel:{defaultMessage:"Automation is paused.",id:"collectionSettings.editAutomationView.automationPausedHiddenAriaLabel"},automationDisabledTooltip:{defaultMessage:"Ask {user} to resume this automation.",id:"collectionSettings.editAutomationView.automationDisabledTooltip"},automationErrorsDisabledTooltip:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"collectionSettings.editAutomationView.automationErrorsDisabledTooltip"}});function je(e){const{automationId:t,automationOwner:o,disabled:i,isAutomationPaused:r,onPause:s,onResume:c}=e,{cantSaveDueToError:d}=(0,we().b)(),u=`toggle-${t}`,p=(0,n.useCallback)((()=>{r?null==c||c():null==s||s()}),[r,c,s]),m=(0,l().IS)((()=>({labelWrap:{color:i?I().Tj.text.tertiary:I().Tj.text.secondary,flex:"1 1 auto",fontSize:Ae().vQ},sectionWrap:{alignItems:"start",display:"flex",flexDirection:"row",gap:6,marginBlockEnd:0},toggleWrap:{flex:"0 0 auto",paddingBlockStart:a().A.isMobile?5:2}})),[i]),g=Ie.automationEnabledLabel,f=r?Ie.automationPausedHiddenAriaLabel:Ie.automationEnabledHiddenAriaLabel;return(0,pe.jsxs)("section",{style:m.sectionWrap,children:[(0,pe.jsx)("div",{style:m.toggleWrap,children:(0,pe.jsx)(xe().m,{disableTooltip:!i||!r,renderTooltip:()=>d?(0,pe.jsx)(A().sA,{...Ie.automationErrorsDisabledTooltip}):(0,pe.jsx)(A().sA,{...Ie.automationDisabledTooltip,values:{user:o}}),render:e=>(0,pe.jsx)("div",{...e,children:(0,pe.jsx)(be().A,{disabled:i,inputId:u,on:!r,onClick:p})})})}),(0,pe.jsx)("div",{style:m.labelWrap,children:(0,pe.jsxs)("label",{htmlFor:u,children:[(0,pe.jsx)("span",{"aria-hidden":!0,children:(0,pe.jsx)(A().sA,{...g})}),(0,pe.jsx)("span",{style:Ae().Qg,children:(0,pe.jsx)(A().sA,{...f})})]})})]})}var Ce=()=>o(564884);var Me=()=>o(338381),Te=()=>o(441775);var ke=()=>o(253579),_e=()=>o(720503);function Be(e){const{shouldInvokeHandler:t,onClick:o}=e;(0,n.useEffect)((()=>{async function e(e){const n=_e().A.state.open,i=e.target instanceof Element&&((0,ke().pM)(e.target)||function(e){const t=(0,Me().EV)(e,(e=>e.classList&&e.classList.contains(Te().m)));return Boolean(t)}(e.target)&&!n);e.eventPhase===Event.CAPTURING_PHASE&&t&&i&&(e.stopPropagation(),e.preventDefault(),await o())}if(!a().A.isMobile)return window.addEventListener("click",e,{capture:!0}),()=>{window.removeEventListener("click",e,{capture:!0})}}),[t,o])}var Pe=()=>o(594794),Ve=()=>o(246125),Ee=()=>o(911724),De=()=>o(94686),Re=()=>o(276936),Ue=()=>o(104636),Ke=()=>o(190019),Ne=()=>o(559419),Fe=()=>o(242422),Oe=()=>o(324587);var Le=()=>o(633904);function We(){const{automationStore:e}=(0,we().k)();return(0,s().K8)((()=>function(e){var t;const o=(null===(t=e.getTrigger())||void 0===t?void 0:t.type)??"event";return"event"===o||"recurrence"!==o&&void(0,M().HB)(o)}(e)),[e])}var ze=()=>o(419357),He=()=>o(244828);const qe=(0,A().YK)({loadingPlaceholder:{defaultMessage:"Loading...",id:"AutomationNameInput.loadingPlaceholder"},placeholder:{defaultMessage:"Automation name",id:"AutomationNameInput.placeholder"}});const $e=(0,n.forwardRef)((function(e,t){const{disabled:i,focusInitial:r,placeholder:c,...d}=e,{automationStore:u}=(0,ne().q8)(),{maybePersistedTransactionActions:p}=(0,we().b)(),m=function(e){const{disabled:t}=e;return(0,l().IS)((()=>({automationNameInput:{marginBlockEnd:0,paddingInline:0},automationNameText:{color:t?I().Tj.text.tertiary:I().Tj.text.primary,marginInlineStart:a().A.isMobile?12:0,marginInlineEnd:a().A.isMobile?12:18,fontWeight:T().Wy.medium,padding:0},input:{background:"transparent",boxShadow:"unset",fontWeight:T().Wy.medium,padding:0}})),[t])}({disabled:i}),g=(0,A().tz)(),f=(0,s().K8)((()=>(null==u?void 0:u.getName())??""),[u]),h=c||g.formatMessage(qe.placeholder),y=(0,n.useCallback)((e=>{p.createAndCommit({userAction:"Automation.updateName",perform:t=>{He().applyOperation({store:u,operation:{path:["properties"],pointer:u.pointer,command:"update",args:{name:e}},transaction:t})}})}),[u,p]),v=(0,n.useCallback)((e=>{const t=e.currentTarget.value;y(t)}),[y]),S=(0,n.useCallback)((e=>{e.currentTarget.value||y(h)}),[y,h]);return(0,o(852507).w)((()=>{a().A.isMobile&&!f&&y(h)})),(0,pe.jsx)(ze().Ay,{...d,disabled:i,focusInitial:r,format:"extra-large",inputOuterStyle:m.input,inputStyle:{paddingInline:0},onBlur:S,onChange:v,placeholder:h,ref:t,style:m.automationNameInput,textWrapperStyle:m.automationNameText,value:f??g.formatMessage(qe.loadingPlaceholder)})}));var Ge=()=>o(401634),Ye=()=>o(250910),Qe=()=>o(324254),Ze=()=>o(869558),Xe=()=>o(656134),Je=(o(581454),o(908872),()=>o(569797)),et=()=>o(245720),tt=()=>o(546926),ot=()=>o(890492),nt=()=>o(81068),it=()=>o(214388),at=()=>o(806080),rt=()=>o(833106),st=()=>o(745266),lt=()=>o(31902),ct=()=>o(680288),dt=()=>o(999140),ut=()=>o(736767),pt=()=>o(187820),mt=()=>o(71304);const gt=(0,A().YK)({forPagesIn:{id:"collectionSettings.editAutomationView.notifyForOption.title",defaultMessage:"For pages in"}});function ft(e){const{selectedSourcePointer:t,collectionContextStore:o,onSelect:i,onClose:l}=e,c=(0,A().tz)(),d=(0,r().v3)(),[u,p]=n.useState(""),m=(0,s().K8)((()=>o.collectionStore()),[o]),g=(0,s().K8)((()=>o.collectionViewBlockStore()),[o]),y=(0,s().K8)((()=>g&&m?g.getCollectionViewStores().filter((e=>{var t;const o=null===(t=e.getCollectionStore())||void 0===t?void 0:t.pointer;return(null==o?void 0:o.id)===m.id})):[]),[g,m]),v=(0,s().K8)((()=>{if(!m)return[];let e;t&&"collection_view"===t.table&&(e=Je().p.createChildStore(m,t));return j().hS([...y,e].filter(M().O9),(({id:e})=>e)).filter((e=>(0,dt().As)(e,u)))}),[m,y,u,t]),S=(0,s().K8)((()=>{if(m&&(0,ct().zY)({collectionStore:m,environment:d,intl:c,queryForFilter:u}))return function(e){const{collectionStore:t,environment:o,selectedSourcePointer:n,onSelect:i,isMobile:a,intl:r}=e,s=t.getIcon(),l=(0,mt().tS)({environment:o,intl:r,store:t}),c=n&&"collection"===n.table&&n.id===t.id,d=t.getSpaceShardedPointer(),u={key:t.id,action:()=>{d&&i(d)},render:e=>(0,pe.jsx)(nt().A,{...e,icon:s&&(0,pe.jsx)(pt().B6,{isEmptyPage:!1,size:a?18:16,disabled:!0,icon:s}),title:l,caption:(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.dataSource.caption",defaultMessage:"Entire data source"}),isChecked:c})};return{key:"collection",items:[u],render:e=>(0,pe.jsx)(h().A,{...e})}}({collectionStore:m,environment:d,selectedSourcePointer:t,onSelect:i,isMobile:a().A.isMobile,intl:c})}),[m,d,c,i,u,t]),b=(0,s().K8)((()=>m&&g&&y?function(e){const{blockStore:t,filteredCollectionViewStores:o,collectionStore:n,selectedSourcePointer:i,onSelect:a,intl:r}=e,s=n.getSchema(),l=o.map((e=>{if("form_editor"===e.getType()||"chart"===e.getType())return;const o=e.getSpaceShardedPointer();if(e.isDefined()&&o){const l=i&&"collection_view"===i.table&&i.id===o.id,c=(0,B().RN)({collectionViewStore:e,collectionSchema:s}),d=(0,B().EN)({collectionViewStore:e,collectionSchema:s}),u=(0,M().O9)(c)||(0,M().O9)(d),p=e.getType(),m=e.getFormat().collection_view_icon,g=e.getName(),f=(o,n)=>(0,pe.jsx)(nt().A,{...o,...n,icon:(0,pe.jsx)(st().h,{color:"lightGray",viewType:p,viewIcon:m}),title:(0,pe.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4},children:[(0,pe.jsx)(lt().A,{collectionViewType:p,collectionViewName:g}),u&&l?(0,pe.jsx)(O().I,{icon:H().exclamationMarkTriangleFillIcon}):void 0]}),caption:(0,pe.jsx)(ht,{blockStore:t,collectionViewStore:e,intl:r,collectionSchema:s,referencesIncompatibleProperties:u}),isChecked:l,disabled:u,disabledFeedback:u});let h;if(u&&c){var n;const e=null===(n=s[c])||void 0===n?void 0:n.type,t=e?ct().dC[e]:void 0,o=t?(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.specific",defaultMessage:"{propertyTypeName} properties are not supported",values:{propertyTypeName:t}}):(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.default",defaultMessage:"Some properties are not supported"});h=e=>(0,pe.jsx)(xe().m,{placement:"right",renderTooltip:()=>o,render:t=>f(e,t)})}else if((0,M().O9)(d)){const e=(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.tooltip.incompatibleFiltersWarning.crossSpace",defaultMessage:"Cross work-space properties are not supported"});h=t=>(0,pe.jsx)(xe().m,{placement:"right",renderTooltip:()=>e,render:e=>f(t,e)})}else h=f;return{key:e.id,action:()=>{a(o)},render:h}}}));return[...l].filter(M().O9)}({blockStore:g,collectionStore:m,filteredCollectionViewStores:v,selectedSourcePointer:t,onSelect:i,intl:c}):[]),[g,m,y,v,c,i,t]),x=function(e){const{menuListItems:t}=e;if(0===t.length)return;return{key:"collection-views",items:t,render:e=>(0,pe.jsx)(h().A,{...e,topBorder:!0})}}({menuListItems:b}),w={key:"search",items:[{key:"search_item",action:()=>{},render:()=>(0,pe.jsx)(ze().Ay,{value:u,focus:!0,onChange:e=>p(e.target.value),placeholder:c.formatMessage({defaultMessage:"Search views...",id:"collectionViewSelect.viewSearch.placeholder"})})}],render:e=>(0,pe.jsx)(h().A,{isInput:!0,...e})};let I;(0,M().O9)(S)||(0,M().O9)(x)||(I={key:"no-results-section",items:[{key:"no-results-item",action:at().lQ,render:()=>(0,pe.jsx)(ut().A,{caption:(0,pe.jsx)(A().sA,{defaultMessage:"No results",id:"collectionViewSelect.noResults.title"})})}],render:e=>(0,pe.jsx)(h().A,{...e,topBorder:!0})});const C=[w,S,x,I].filter(M().O9);if(!m)return null;let T;return T=a().A.isMobile?{menuType:tt().gu.Modal,title:(0,pe.jsx)("div",{style:{display:"flex"},children:(0,pe.jsx)(A().sA,{...gt.forPagesIn})}),right:(0,pe.jsx)(A().sA,{...et().W.done}),onClickRight:()=>{l()}}:{menuType:tt().gu.Popup,width:230,maxHeight:"50vh"},(0,pe.jsx)(ot().A,{...T,children:(0,pe.jsx)(f().A,{type:f().O.Vertical,sections:C,initialFocus:0,onAccept:()=>{l()}})})}function ht(e){const{blockStore:t,collectionViewStore:o,intl:n,collectionSchema:i,referencesIncompatibleProperties:a}=e,l=(0,r().v3)(),c=(0,s().K8)((()=>!o.getAlive()),[o]),d=(0,s().K8)((()=>{const e=o.getParentBlockStore();if(e)return t.id!==e.id?(0,mt().tS)({environment:l,intl:n,store:e}):void 0}),[t.id,o,n,l]),u=(0,s().K8)((()=>{const e=(0,rt().$)({collectionViewStore:o,schema:i});return(0,it().rg)({propertyFilters:o.getPropertyFiltersStore().getValue()??[],combinatorFilter:null==e?void 0:e.filter,schema:i}).reduce(((e,t)=>{if((0,it().yX)(t))return e+1;return e+(t.filters??[]).length}),0)}),[i,o]);return a?(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.collectionView.unsupportedView",defaultMessage:"Not supported"}):c?(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.collectionView.deletedView",defaultMessage:"<emphasis>View not found.</emphasis>",values:{emphasis:e=>(0,pe.jsx)("em",{children:e})}}):d?(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionDifferentParent",defaultMessage:"<emphasis>View configured in {externalParentBlockName}</emphasis>",values:{emphasis:e=>(0,pe.jsx)("em",{children:e}),externalParentBlockName:d}}):0===u?(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithNoFilters",defaultMessage:"Any page in this view"}):(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.collectionView.captionWithFilters",defaultMessage:"{ruleCount, plural, one {{ruleCount} filter} other {{ruleCount} filters}}",values:{ruleCount:u}})}var yt=()=>o(732810);function vt(e){const{pointer:t,collectionStore:o,intl:n}=e,i=(0,r().v3)(),a=(0,l().IS)((()=>({titleContainer:{display:"flex",flexDirection:"row",alignItems:"center",padding:0,gap:4,flex:"1 1 auto",minWidth:0},title:{...T().RC},errorText:{color:I().Tj.red.text.accentPrimary,fontWeight:T().Wy.medium}})),[]),c=(0,s().K8)((()=>{if(t)return t.table===X().Vl?yt().m.createChildStore(o,t):t.table===Ze().Gy?Je().p.createChildStore(o,t):void(0,M().HB)(t)}),[o,t]),d=(0,s().K8)((()=>c?(0,mt().tS)({environment:i,intl:n,store:c}):(0,pe.jsx)("span",{style:a.errorText,children:(0,pe.jsx)(A().sA,{id:"AutomationCollectionSelectMenu.dataSource.missing",defaultMessage:"Select data source"})})),[i,n,a.errorText,c]),u=(0,s().K8)((()=>{if(!c||c.table===X().Vl)return!1;const e=o.getSchema();return(0,M().O9)((0,B().RN)({collectionViewStore:c,collectionSchema:e}))}),[o,c]);return(0,pe.jsxs)("div",{style:a.titleContainer,children:[u?(0,pe.jsx)(O().I,{icon:H().exclamationMarkTriangleFillIcon,colorPalette:"orange",colorVariant:"accentPrimary"}):void 0,(0,pe.jsx)("span",{style:a.title,children:d})]})}function St(e){const{collectionContextStore:t,disabled:o}=e,i=(0,A().tz)(),a=(0,l().IS)((()=>{const e=o?I().Tj.text.tertiary:I().Tj.text.secondary,t=Ae().vQ;return{wrap:{alignItems:"center",color:e,cursor:"default",display:"grid",fontSize:t,gridTemplateColumns:"auto auto"},button:{color:e,fontWeight:T().Wy.medium,fontSize:t,width:"100%",height:24,paddingInlineStart:6,paddingInlineEnd:6,marginInlineStart:1}}}),[o]),{automationStore:r}=(0,ne().q8)(),{maybePersistedTransactionActions:c}=(0,we().b)(),d=(0,s().K8)((()=>t.collectionStore()),[t]),u=(0,s().K8)((()=>{const e=null==r?void 0:r.getTrigger();if("event"===(null==e?void 0:e.type)){const t=e.event.source;if(t&&"filter"!==t.type)return t.pointer}}),[r]),p=(0,n.useCallback)((e=>{const t=e.table===X().Vl?{pointer:e,type:X().Vl}:{pointer:e,type:Ze().Gy};c.createAndCommit({userAction:"Automation.updateSource",perform:e=>{He().applyOperation({store:r,operation:{path:["trigger","event"],pointer:r.pointer,command:"update",args:{source:t}},transaction:e})}})}),[r,c]),m=(0,Xe().j)(),g=d?(0,pe.jsx)(vt,{pointer:u,collectionStore:d,intl:i}):(0,pe.jsx)(n.Fragment,{}),f=(0,pe.jsx)(Ye().A,{alignmentToOrigin:"start",placementToOrigin:"bottom",popupType:m,render:e=>(0,pe.jsx)(ft,{selectedSourcePointer:u,onSelect:p,onClose:()=>{e.close()},collectionContextStore:t}),renderOrigin:e=>(0,pe.jsx)(W().p,{...e,style:a.button,disabled:o,iconTrailing:{icon:Qe().arrowChevronSingleDownSmallIcon,colorVariant:o?"disabled":"secondary",size:"xs"},children:g})});return(0,pe.jsx)("div",{style:a.wrap,children:(0,pe.jsx)(A().sA,{id:"automationBuilderModal.SourceInput.appliesTo",defaultMessage:"For all pages in {button}",values:{button:f}})})}function bt(){const e=(0,r().v3)(),t=(0,A().tz)(),o=(0,l().IS)((()=>{const e=Ae().vQ;return{wrap:{color:I().Tj.text.secondary,fontSize:e},title:{color:I().Tj.text.secondary,fontWeight:T().Wy.medium,fontSize:e}}}),[]),{collectionStore:n}=(0,we().k)(),i=(0,s().K8)((()=>(0,mt().tS)({environment:e,intl:t,store:n})),[n,e,t]),a=(0,pe.jsx)("span",{style:o.title,children:i});return(0,pe.jsx)("div",{style:o.wrap,children:(0,pe.jsx)(A().sA,{id:"automationBuilderModal.SourceLabel.appliesTo",defaultMessage:"For {source}",values:{source:a}})})}let xt;(0,o(852832).exposeDebugGetter)("currentAutomation",(()=>xt));const wt=(0,A().YK)({deleteButton:{id:"automationBuilderModal.editAutomationView.deleteButton",defaultMessage:"Delete"},createButton:{id:"automationBuilderModal.editAutomationView.createButton.label",defaultMessage:"Create"},saveButton:{id:"automationBuilderModal.editAutomationView.saveButton.label",defaultMessage:"Save"},cancelButton:{id:"automationBuilderModal.editAutomationView.cancelButton.label",defaultMessage:"Cancel"},doneButton:{id:"automationBuilderModal.editAutomationView.doneButton.label",defaultMessage:"Done"},enableButton:{id:"automationBuilderModal.editAutomationView.enableButton.label",defaultMessage:"Enable"},errorsFooterCaption:{id:"automationBuilderModal.editAutomationView.errorCaption",defaultMessage:"Fix errors to enable"}});function At(){}function It(e){const{collectionSettingsStore:t,collectionContextStore:o,source:R,...U}=e,[K]=(0,n.useState)((()=>U)),{mode:N}=K,F=(0,A().tz)(),O=(0,r().v3)(),{value:L}=(0,c().fJ)(se().T.formulas),{value:W}=(0,c().fJ)(k().QV.automationTypecheck),[z,H]=(0,n.useState)([]),q="create"===N,$=(0,Ve().l)("BuilderModal",{cacheFallback:O.defaultRecordCache.inMemoryRecordCache,isTemporaryData:!0}),G=(0,i().$)(),Y=(0,s().K8)((()=>null==G?void 0:G.userId),[G]),Q=(0,s().K8)((()=>null==G?void 0:G.getDisplayName(F)),[G,F]),Z=(0,s().K8)((()=>o.collectionStore()),[o]),X=(0,s().K8)((()=>null==Z?void 0:Z.getSpaceId()),[Z]),J=(0,s().K8)((()=>null==Z?void 0:Z.id),[Z]),te=(0,n.useMemo)((()=>"update"===K.mode?K.automationId:(0,Pe().Z1)({environment:O,table:w().yB,spaceId:X})),[K,O,X]),oe=(0,s().O$)(o.aliveAutomationCountStore),ne=(0,s().K8)((()=>{if(X&&Z&&Y)return new(u().d)(O,{id:te,table:w().yB,spaceId:X})}),[te,Z,Y,O,X]);!function(e){(0,n.useEffect)((()=>(xt=e,()=>{xt=void 0})),[e])}(ne);const ie=(0,s().K8)((()=>(0,v().PK)(F,Q)),[Q,F]),re=(0,s().K8)((()=>{if(!X||!Z||!Y)return;const e={id:te,table:w().yB,spaceId:X},t=$.getEntry({pointer:e,userId:Y});return t?t.value.value:B().EZ({automationId:te,automationName:"",collectionStore:Z,userId:Y})}),[te,Z,Y,X,$]),{maybePersistedAutomationStore:le,maybePersistedTransactionActions:ce,hasUnpersistedChanges:de}=(0,Le().t)({automationId:te,spaceId:X,defaultValue:q?re:void 0,persist:!1}),ue=(0,s().K8)((()=>{if(le&&(0,P().$X)(le))return le}),[le]),me=(0,s().K8)((()=>((null==ue?void 0:ue.getActionStores())??[]).filter((e=>e.isDefined()))),[ue]),fe=(0,s().K8)((()=>(0,P().H8)((null==ue?void 0:ue.getTriggerType())??"event")),[ue]),he=(0,s().K8)((()=>{const e=null==Z?void 0:Z.getParentBlockStore();return!!e&&e.pathIsDead()}),[Z]),ye=function(e){const{actionStores:t,automationStore:o,collectionStore:n,loadingStatus:i,mode:a}=e,[{value:r}]=(0,S().Yb)((async()=>"resolved"===i&&o&&t&&n?await(0,B().TT)({automationStore:o,actionStores:t,collectionStore:n}):Promise.resolve(!1)),[t,o,n,i]);return(0,s().K8)((()=>"create"===a?"edit":"resolved"===i&&o&&t&&n?r?"edit":(0,B().Gz)({automationStore:o,collectionStore:n})?"readonly_with_delete":"readonly":"readonly"),[a,i,o,t,n,r])}({automationStore:ue,actionStores:me,collectionStore:Z,loadingStatus:"resolved",mode:K.mode}),ve=("readonly_with_delete"===ye||"edit"===ye&&!q)&&!he,Se=(0,ae().n)(ue),be=(0,s().K8)((()=>!(!ue||!Z)&&B().l({automationStore:ue,collectionStore:Z})),[ue,Z]),xe=(0,s().K8)((()=>ue&&L&&W?(0,Ke().Z)({environment:O,automationStore:ue,automationTypecheckModule:W,contextType:fe,formulasModule:L,intl:F,isSubscribed:Se}):void 0),[ue,L,W,O,fe,F,Se]),we=(0,s().K8)((()=>!!(Z&&ue&&xe)&&B().Qn({automationStore:ue,collectionStore:Z,typecheckResult:xe})),[ue,Z,xe]),[{value:Ae}]=(0,S().Yb)((async()=>!!xe&&await(0,Re().h)({environment:O,typecheckResult:xe,automationStore:ue})),[xe,O,ue]),Ie=Ae||!1,je=(0,s().K8)((()=>ne&&L&&W?(0,Ke().Z)({environment:O,automationStore:ne,automationTypecheckModule:W,contextType:fe,formulasModule:L,intl:F,isSubscribed:Se}):void 0),[O,ne,fe,L,W,F,Se]),Me=(0,s().K8)((()=>!!(Z&&ne&&je)&&B().Qn({automationStore:ne,collectionStore:Z,typecheckResult:je})),[Z,ne,je]),Te=(0,s().K8)((()=>{if(!ue)return!0;let e;var t;ue.isTriggerType("event")&&(e=null===(t=ue.getEventConfiguration())||void 0===t?void 0:t.pagePropertiesEdited.type);const o=(0,M().O9)(e)&&"none"!==e,n=ue.getActionStores().length>0;if(!n&&!o)return!1;const i=!(0,y().aE)({automationTrigger:ue.getTrigger(),collectionSchema:null==Z?void 0:Z.getSchema()});if(o&&i)return!0;if(n&&(0,M().O9)(xe)&&C().Q.isSuccess(xe)){if(Object.keys(xe.value.actionValidationFailures).some((e=>!z.includes(e))))return!0}return!1}),[ue,Z,z,xe]);!function(e){const{automationStore:t,collectionStoreId:o,source:i}=e,a=(0,r().v3)(),[l,c]=(0,n.useState)(!1),d=(0,s().K8)((()=>(null==t?void 0:t.getActionIds().length)??0),[t]),u=(0,s().K8)((()=>{if(!t||!t.isTriggerType("event"))return 0;const e=t.getTriggerStore().getKeyStore("event");let o=0;e.getKeyStore("pagesAdded").getValue()&&o++;const n=e.getKeyStore("pagePropertiesEdited").getValue();if("any"===(null==n?void 0:n.type))o++;else if("some"===(null==n?void 0:n.type)){var i;o+=(null===(i=n.some)||void 0===i?void 0:i.length)??0}else if("all"===(null==n?void 0:n.type)){var a;o+=(null===(a=n.all)||void 0===a?void 0:a.length)??0}return o}),[t]);(0,n.useEffect)((()=>{o&&!l&&t&&((0,Ce().u)({environment:a,event:{eventName:"automation_configure_view",eventProperties:{automation_id:t.id,automation_total_actions:d,automation_total_triggers:u,collection_id:o,source:i}}}),c(!0))}),[a,o,l,d,u,null==t?void 0:t.id,t,i])}({automationStore:ue,collectionStoreId:J,source:e.source});const ke="edit"===ye&&!he&&!Ie;!function(e){const{environment:t,intl:o,automationStore:i,persistedAutomationStore:a,typecheckResult:r,persistedTypecheckResult:s,maybePersistedTransactionActions:l}=e,c=(0,n.useRef)(!1);(0,n.useEffect)((()=>{if(!Fe().default.checkGate({gateName:"formula_null_check"})||!i||!a||!r||!s||c.current)return;const e=(0,M().O9)(i.getLastFailedReason());if(i.isActive()||!e)return;const n=C().Q.isSuccess(s)?s.value.actionValidationFailures:{},u=C().Q.isSuccess(s)?s.value.actionValidationWarnings:{},p=Object.keys(n).length>0||Object.keys(u).length>0,m=C().Q.isSuccess(r)?r.value.actionValidationFailures:{},g=C().Q.isSuccess(r)?r.value.actionValidationWarnings:{},f=Object.keys(m).length>0||Object.keys(g).length>0;p&&!f&&(c.current=!0,l.createAndCommit({userAction:"auto_enable_automation_after_fix",perform:e=>{Oe().enableAutomation({automationStore:i,environment:t,transaction:e})}}),d().D6({label:o.formatMessage({id:"automations.autoEnable.success",defaultMessage:"Automation re-enabled after fixing all issues"})}))}),[i,t,o,l,a,s,r])}({environment:O,intl:F,automationStore:ue,persistedAutomationStore:ne,typecheckResult:xe,persistedTypecheckResult:je,maybePersistedTransactionActions:ce});const _e=(0,n.useCallback)((()=>{H([])}),[]),Ue=(0,n.useCallback)((()=>{Z&&ue&&de&&("create"===N?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,intl:a,from:r}=e;D().nO({automationStore:t,collectionStore:n,environment:i,intl:a,from:r,builderType:"modal"}),d().D6({label:(0,pe.jsx)(A().sA,{id:"automations.editAutomationView.createdConfirmation",defaultMessage:"{automationName} created",values:{automationName:t.getName()}})}),ee().V({collectionSettingsStore:o});const s=(0,E().S)(o);s&&"automationSettings"!==s.type&&_().a2({collectionSettingsStore:o,item:{type:"automationSettings",source:"first_automation_created"}})}({automationStore:ue,collectionSettingsStore:t,collectionStore:Z,environment:O,intl:F,from:K.from}):"update"===N?function(e){const{automationStore:t,collectionSettingsStore:o,collectionStore:n,environment:i,source:a}=e;D().kU({automationStore:t,collectionStore:n,environment:i,builderType:"modal",source:a}),d().D6({label:(0,pe.jsx)(A().sA,{id:"automations.editAutomationView.updatedConfirmation",defaultMessage:"{automationName} updated",values:{automationName:t.getName()}})}),ee().V({collectionSettingsStore:o})}({automationStore:ue,collectionSettingsStore:t,collectionStore:Z,environment:O,source:R}):(0,M().HB)(N))}),[ue,t,Z,O,de,F,N,K,R]),We=(0,n.useCallback)((async()=>{ue&&Z&&!q&&await D().lg({intl:F,environment:O,existingAutomationStore:ue,collectionStore:Z,onDelete:()=>{var e;ee().V({collectionSettingsStore:t}),1===oe&&"automationSettings"===(null===(e=(0,E().S)(t))||void 0===e?void 0:e.type)&&_().R8({collectionSettingsStore:t,item:{type:"main"}})}})}),[oe,ue,t,Z,O,F,q]),ze=(0,n.useCallback)((async()=>{if(de){await D().US({hasPendingChanges:de})&&ee().V({collectionSettingsStore:t})}else ee().V({collectionSettingsStore:t})}),[t,de]);Be({shouldInvokeHandler:!0,onClick:ze});const He=(0,n.useCallback)((e=>{H([e.id])}),[]),qe=(0,Ne().c)(),Ye=function(){const e=Tt();return(0,l().IS)((()=>({header:{backgroundColor:I().Tj.background.elevated,zIndex:100,width:"100%",...a().A.isMobile?{paddingBottom:0,paddingTop:0}:{paddingBottom:8,borderBottom:`1px solid ${I().Tj.border.secondary}`}},nameInput:{...a().A.isMobile&&{paddingTop:8}},buttons:{backgroundColor:I().Tj.background.elevated,display:"flex",flexDirection:"row",paddingBottom:a().A.isMobile?16:4,paddingTop:12,justifyContent:"space-between",gap:a().A.isMobile?"10px":0,width:"100%",zIndex:100,...a().A.isMobile&&{paddingInlineStart:jt,paddingInlineEnd:jt,flexDirection:"column-reverse"}},footerButton:{height:32,width:a().A.isMobile?"100%":"auto",pointerEvents:"auto"},footerErrorCaption:{color:I().Tj.text.tertiary,fontSize:T().J.UISmall.desktop},footerRight:{alignItems:"center",display:"flex",gap:14,justifyContent:"space-between"},automationOptionIconDesktop:{marginInlineStart:12},wrap:{marginTop:a().A.isMobile?16:17,marginBottom:a().A.isMobile?20:0,paddingBottom:16,width:"100%",flexGrow:1,overflowY:"auto"},closeButtonContainer:{position:"absolute",top:10,insetInlineEnd:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:I().Tj.background.tertiaryTranslucent,width:24,height:24},closeButtonHover:{background:I().Tj.buttonPressedBackground},closeButtonIcon:{width:x().Ev.xs,height:x().Ev.xs,fill:I().Tj.icon.secondary},...e})),[e])}(),Qe=[],Ze=de&&we;ke&&!a().A.isMobile&&Qe.push((0,pe.jsxs)(h().A,{style:Ye.buttons,mobileStyle:Ye.buttons,children:[(0,pe.jsx)(m().A,{size:"lg",onClick:ze,style:Ye.footerButton,children:(0,pe.jsx)(A().sA,{...wt.cancelButton})}),(0,pe.jsxs)("div",{style:Ye.footerRight,children:[!Ze&&Te?(0,pe.jsx)("div",{style:Ye.footerErrorCaption,children:(0,pe.jsx)(A().sA,{...wt.errorsFooterCaption})}):void 0,(0,pe.jsx)(g().A,{colorPalette:"blue",onClick:Ue,onMouseEnter:_e,disabled:!Ze,style:Ye.footerButton,children:q?(0,pe.jsx)(A().sA,{...wt.enableButton}):(0,pe.jsx)(A().sA,{...wt.doneButton})})]})]},"save"));const Xe=(0,s().K8)((()=>{if(!Z||!ue)return null;const e=!a().A.isMobile&&ke&&"create"===N;return(0,pe.jsx)(De().o,{automationStore:ue,enableExistenceGuarantees:!0,children:(0,pe.jsxs)(Ee().v,{value:{collectionStore:Z,disabled:!ke,editorPlacement:{type:"inline"},editorWidth:V().vE,maybePersistedTransactionActions:ce,onActionAdded:He,suppressActionErrors:z,hideDragHandle:Ie,cantSaveDueToError:Te,...qe},defaultCollapseActions:Ie,children:[a().A.isMobile?void 0:(0,pe.jsx)("div",{style:Ye.closeButtonContainer,children:(0,pe.jsx)(p().A,{ariaLabel:F.formatMessage({id:"automations.builderModal.closeButton.ariaLabel",defaultMessage:"Close"}),onClick:ze,style:Ye.closeButton,hoveredStyle:Ye.closeButtonHover,icon:b().xMarkSmallIcon,iconStyle:Ye.closeButtonIcon})}),(0,pe.jsx)("div",{style:Ye.header,children:(0,pe.jsx)(f().A,{type:f().O.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:(0,j().oE)([{key:"automation_name",action:()=>{},render:t=>(0,pe.jsx)("div",{...t,style:Ye.nameInput,children:(0,pe.jsx)($e,{...t,disabled:!ke,focusInitial:e,placeholder:ie})})},Ct({showActiveAutomationToggle:ve,isPersistedStateComplete:Me,collectionContextStore:o,canEdit:ke,automationStore:ue})]),render:e=>(0,pe.jsx)(h().A,{...e,disableMobilePadding:!0,desktopStyle:{paddingTop:0,paddingBottom:0}})}]})}),(0,pe.jsxs)("div",{style:Ye.wrap,children:[(0,pe.jsx)(ge,{collectionStore:Z,collectionSettingsStore:t,automationPermissionScope:ye,referencesIncompatibleCollectionViewFilter:be,requiresSubscriptionUpgrade:Ie,onDelete:We}),(0,pe.jsx)(k().U3,{areActionsEditable:ke,areTriggersEditable:ke})]})]})})}),[Z,ue,ke,N,ce,He,z,Ie,Te,qe,Ye.closeButtonContainer,Ye.closeButton,Ye.closeButtonHover,Ye.closeButtonIcon,Ye.header,Ye.wrap,Ye.nameInput,F,ze,ve,Me,o,t,ye,be,We,ie]);return(0,pe.jsxs)(Ge().i,{handleOnDismiss:ze,handleOnSave:Ue,canSave:Ze,mode:N,children:[Xe,Qe]})}const jt=16;function Ct(e){const{showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i}=e;return{key:"automation_toggle_and_source",action:At,render:e=>(0,pe.jsx)(Mt,{menuListItemProps:e,showActiveAutomationToggle:t,isPersistedStateComplete:o,collectionContextStore:n,canEdit:i})}}function Mt(e){const{menuListItemProps:t,showActiveAutomationToggle:o,isPersistedStateComplete:i,collectionContextStore:c,canEdit:d}=e,u=(0,A().tz)(),p=(0,r().v3)(),m=Tt(),g=(0,l().IS)((()=>({wrap:{display:"flex",...a().A.isMobile?{flexDirection:"column",justifyContent:"center",alignItems:"flex-start",paddingInline:12,borderBottom:`1px solid ${I().Tj.border.primary}`,paddingBlock:12,gap:12}:{gap:8,minHeight:24,alignItems:"center"}},toggle:{display:"flex",alignItems:"center",marginInlineStart:1},...m})),[m]),{automationStore:f}=(0,ne().q8)(),h=(0,s().K8)((()=>{var e;return(null==f||null===(e=f.getOwnerStore())||void 0===e?void 0:e.getDisplayName(u))??""}),[u,f]),y="active"===(0,s().K8)((()=>(null==f?void 0:f.getStatus())??"disabled"),[f]),v=We(),S=(0,n.useCallback)((()=>{f&&D().WA({automationStore:f,environment:p})}),[p,f]),b=(0,n.useCallback)((()=>{f&&D().HJ({automationStore:f,environment:p})}),[p,f]),x=(0,s().K8)((()=>!i||(0,Ue().NH)(f)),[f,i]);return(0,pe.jsxs)("div",{...t,style:g.wrap,children:[!i&&y||!o?void 0:(0,pe.jsxs)(pe.Fragment,{children:[(0,pe.jsx)("div",{style:g.toggle,children:(0,pe.jsx)(je,{automationId:f.id,automationOwner:h,isAutomationPaused:!y,onPause:S,onResume:b,disabled:x})}),(0,pe.jsx)("div",{style:g.verticalDivider})]}),v?(0,pe.jsx)(St,{disabled:!d,collectionContextStore:c}):(0,pe.jsx)(bt,{})]})}function Tt(){return(0,l().IS)((()=>({verticalDivider:{background:I().Tj.border.secondary,height:16,width:1,borderRadius:1,display:a().A.isMobile?"none":"block"}})),[])}var kt=()=>o(384944),_t=()=>o(840094),Bt=()=>o(845715);const Pt=(0,A().YK)({placeholder:{id:"automations.builderModal.buttonBuilderLabelInput.placeholder",defaultMessage:"Enter a name"},loading:{id:"automations.builderModal.buttonBuilderLabelInput.loading",defaultMessage:"Loading..."}}),Vt=(0,n.forwardRef)((function({disabled:e,buttonName:t,handleNameChange:o,handleBlur:i,handleSubmit:r,...s},c){const d=(0,A().tz)(),u=(0,l().IS)((()=>({buttonNamePropertyInput:{marginBlockEnd:0,boxShadow:"none"},buttonNameText:{marginInlineStart:a().A.isMobile?12:0,marginInlineEnd:a().A.isMobile?12:18},inputOuterStyle:{background:"transparent",boxShadow:"unset"}})),[]),p=(0,n.useCallback)((e=>{o(e)}),[o]),m=(0,n.useCallback)((e=>{i(e.target.value)}),[i]),g=(0,n.useCallback)((()=>{r(t)}),[r,t]);return(0,pe.jsx)(ze().Ay,{style:u.buttonNamePropertyInput,...s,value:t??d.formatMessage(Pt.loading),onChange:p,disabled:e,ref:c,inputOuterStyle:u.inputOuterStyle,format:"extra-large",textWrapperStyle:u.buttonNameText,placeholder:d.formatMessage(Pt.placeholder),onBlur:m,onSubmit:g,autoFocus:!t})}));var Et=()=>o(390518);const Dt=(0,A().YK)({saveButton:{defaultMessage:"Save",id:"database.buttonProperty.saveButtonLabel"},noEditError:{defaultMessage:"You don’t have full access to edit this button",id:"database.buttonProperty.noEditError"}});function Rt(e){const{collectionContextStore:t,propertySchema:o}=e,i=(0,s().K8)((()=>t.collectionStore()),[t]),a=(0,s().K8)((()=>null==i?void 0:i.getSpaceId()),[i]),r=(0,n.useMemo)((()=>{const e=o.automation_id;if(e&&a)return{id:e,spaceId:a,table:w().yB}}),[o.automation_id,a]);return(0,Bt().K)(i,r)?(0,pe.jsx)(Ut,{...e}):(0,pe.jsx)(Et().A,{})}function Ut(e){const{collectionContextStore:t,collectionSettingsStore:o,property:c,propertySchema:d}=e,u=(0,r().v3)(),m=(0,A().tz)(),y=(0,i().$)(),v=(0,s().K8)((()=>null==y?void 0:y.userId),[y]),[x,w]=(0,n.useState)([]),j=(0,s().K8)((()=>t.collectionStore()),[t]),C=(0,s().K8)((()=>null==j?void 0:j.getSpaceId()),[j]),{maybePersistedAutomationStore:M,maybePersistedTransactionActions:T}=(0,Le().t)({automationId:d.automation_id,spaceId:C,defaultValue:void 0,persist:!0}),_=(0,s().K8)((()=>null==M?void 0:M.getTrigger()),[M]),B=(0,_t().Qj)({automationStore:M,property:c,propertySchema:d,collectionContextStore:t}),P=(0,s().K8)((()=>{var e;return"sufficient"===(null==B||null===(e=B.state)||void 0===e?void 0:e.editPermissionStatus)}),[B]),E=(0,s().K8)((()=>{var e;return null==B||null===(e=B.state)||void 0===e?void 0:e.typecheckResult}),[B]),[{value:D}]=(0,S().Yb)((async()=>!!E&&await(0,Re().h)({environment:u,typecheckResult:E,automationStore:M})),[E,u,M]),R=D||!1,U=(0,s().K8)((()=>(null==M?void 0:M.getNameStore().getValue())??d.name),[M,d.name]),K=(0,s().K8)((()=>"collectionTypedView"===t.contextTypeFromStoreState),[t]),N=(0,n.useCallback)((e=>{if(!M)return;const t=e.currentTarget.value;T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:e=>{kt().KY({store:M.getNameStore(),transaction:e,value:t})}})}),[M,T]),F=(0,n.useCallback)((e=>{w((t=>[...t,e.id]))}),[]),O=(0,Ne().c)(),L=function(){const e=(0,l().eP)();return(0,l().IS)((()=>({header:{backgroundColor:"transparent",borderBottom:`1px solid ${I().Tj.border.secondary}`,paddingBottom:8,paddingTop:Wt,position:"absolute",top:0,width:`calc(100% - ${2*Lt}px)`,zIndex:100,...a().A.isMobile&&{paddingBottom:0,paddingTop:0,width:"100%"}},buttons:{backgroundColor:"dark"===e?I().Tj.palette.gray[100]:I().Tj.white,display:"flex",gap:4,paddingBlock:`${Wt}px ${Lt}px`,position:"absolute",bottom:0,width:`calc(100% - ${2*Lt}px)`,zIndex:100,...a().A.isMobile&&{paddingInlineStart:Lt,paddingInlineEnd:Lt,flexDirection:"column-reverse",width:"100%"}},label:{paddingTop:a().A.isMobile?"10px":0},closeButtonContainer:{position:"absolute",top:10,insetInlineEnd:10,zIndex:101},closeButton:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:I().Tj.buttonHoveredBackground,width:20,height:20,padding:4},closeButtonHover:{background:I().Tj.buttonPressedBackground},closeButtonIcon:{fill:I().Tj.text.secondary},wrap:{overflowY:"auto",overflowX:"hidden",marginTop:a().A.isMobile?Ft:Kt,marginBottom:a().A.isMobile?Ot:Nt,paddingInline:a().A.isMobile?0:2,width:"100%"},desktopButtonLabelNameContainer:{paddingInlineStart:0,paddingInlineEnd:0,color:I().Tj.text.tertiary},mobileButtonLabelNameContainer:{paddingTop:Wt,paddingBottom:4,paddingInlineStart:Lt,paddingInlineEnd:Lt,color:I().Tj.text.tertiary},buttonLabelNameTextWrapperStyle:{marginInlineStart:a().A.isMobile?Lt:0,marginInlineEnd:a().A.isMobile?Lt:0},footerButton:{height:32,width:"100%"},inputStyle:{background:"transparent"},inputOuterStyle:{background:"transparent"}})),[e])}(),W=(0,n.useCallback)((()=>{ee().V({collectionSettingsStore:o})}),[o]);Be({shouldInvokeHandler:!0,onClick:W});const z=(0,n.useCallback)((e=>{M&&T.createAndCommit({userAction:"ButtonBuilderModal.setName",perform:t=>{kt().KY({store:M.getNameStore(),transaction:t,value:e})}})}),[M,T]),H=(0,de()._)({name:"premium_automations",spaceId:C,userId:v}),q=(0,re().k)({from:"button_builder_modal_header_message",upsell:null==H?void 0:H.upsell}),$=(0,n.useMemo)((()=>j&&M&&_&&"button"===_.type?(0,pe.jsx)(ne().u,{automationStore:M,contextType:"button_property",enableExistenceGuarantees:!0,children:(0,pe.jsxs)(Ee().v,{value:{collectionStore:j,disabled:!P,editorPlacement:{type:"inline"},editorWidth:V().vE,maybePersistedTransactionActions:T,onActionAdded:F,suppressActionErrors:x,hideDragHandle:R,...O},defaultCollapseActions:R,children:[a().A.isMobile?void 0:(0,pe.jsx)("div",{style:L.closeButtonContainer,children:(0,pe.jsx)(p().A,{ariaLabel:m.formatMessage({id:"automations.builderModal.closeButton.ariaLabel",defaultMessage:"Close"}),onClick:W,style:L.closeButton,hoveredStyle:L.closeButtonHover,icon:b().xMarkSmallIcon,iconStyle:L.closeButtonIcon})}),(0,pe.jsx)("div",{style:L.header,children:(0,pe.jsx)(f().A,{type:f().O.Vertical,initialFocus:void 0,sections:[{key:"automation_top_input",items:[{key:"automation_name",action:()=>{},render:e=>(0,pe.jsx)(Vt,{...e,disabled:K,buttonName:U,handleNameChange:N,handleBlur:z,handleSubmit:z})}],render:e=>(0,pe.jsx)(h().A,{...e,disableMobilePadding:!0,shouldShowBottomDivider:!0,desktopStyle:{paddingTop:0}})}]})}),(0,pe.jsxs)("div",{style:L.wrap,children:[R?(0,pe.jsx)(oe().j,{onUpsellClick:q}):void 0,P?void 0:(0,pe.jsx)(te().z,{children:(0,pe.jsx)(A().sA,{...Dt.noEditError})}),(0,pe.jsx)(k().U3,{areActionsEditable:!R,areTriggersEditable:!1})]})]})}):null),[j,M,_,P,T,F,x,R,O,L.closeButtonContainer,L.closeButton,L.closeButtonHover,L.closeButtonIcon,L.header,L.wrap,m,W,q,K,U,N,z]),G=a().A.isMobile?(0,pe.jsx)(n.Fragment,{}):(0,pe.jsx)(h().A,{mobileStyle:L.buttons,style:L.buttons,children:(0,pe.jsx)(g().A,{colorPalette:"blue",onClick:W,disabled:!P,style:L.footerButton,children:(0,pe.jsx)(A().sA,{...Dt.saveButton})})});return j&&M&&_&&"button"===_.type?(0,pe.jsxs)(Ge().i,{handleOnDismiss:W,canSave:!0,mode:"button_property",handleOnSave:W,children:[$,G]}):null}const Kt=60,Nt=60,Ft=60,Ot=60,Lt=16,Wt=12},419357:(e,t,o)=>{o.d(t,{Ay:()=>b,KF:()=>S,LG:()=>h,Zf:()=>v,yD:()=>y});var n=o(296540),i=()=>o(484714),a=()=>o(401497),r=()=>o(718827),s=()=>o(695115),l=()=>o(31511),c=()=>o(546926),d=()=>o(424400),u=()=>o(340498),p=()=>o(100622),m=()=>o(496603),g=()=>o(284371),f=o(474848);const h=30,y=28;function v(e){const{icon:t}=e;return t({fill:p().Tj.icon.secondary,width:u().Ev.sm,height:u().Ev.sm,flexGrow:0,flexShrink:0})}function S(e){const t=(0,i().WS)(),o=(0,a().eP)(),n=(0,a().IS)((()=>({outlineButton:{...(0,r().qq)({shape:"default",size:"sm",hasIconOnly:!0,isButtonGapEnabled:!0}),fontWeight:g().Wy.medium,lineHeight:1.2,border:`1px solid ${p().Tj.border.primaryTranslucent}`,background:e.hasBackground?p().Tj.background.primary:void 0},outlineButtonHovered:{background:p().Tj.background.secondary},outlineButtonPressed:{background:(0,r().yZ)({color:p().Tj.background.primary,mode:o})}})),[e.hasBackground,o]);return(0,f.jsx)(s().A,{size:"xs",colorVariant:"primary",...e,ariaLabel:e.ariaLabel,style:{...n.outlineButton,...e.style,height:t?h:y,width:t?h:y},hoveredStyle:n.outlineButtonHovered,pressedStyle:n.outlineButtonPressed})}const b=n.forwardRef((function({preventCaptureArrowShortcuts:e,preventCaptureDeleteWhenEmpty:t,preventCaptureClipboardShortcuts:i,preventCaptureSpacebarWhenEmpty:a,...r},s){const{left:l,right:u,inputLeft:p,inputRight:g,inputRightStyle:h,disableInput:y,inputOuterStyle:v,rightMobileEditLabel:S,mobileKeyboardOnDismiss:b,style:x,value:I,onChange:j,autosize:C,autosizeMinHeight:M,autosizeMaxHeight:T,customElementAttributes:k,disabled:_,format:B,id:P,placeholder:V,type:E,autoFocus:D,focus:R,focusInitial:U,focusAfterAnimation:K,forceShowClearButton:N,ignoreKeyboardMode:F,inputElementAttributes:O,inputStyle:L,isRightLastElementOfInput:W,maxlength:z,min:H,max:q,selectAll:$,showClearButton:G,suppressFocusRing:Y,textarea:Q,textareaSubmitOnEnter:Z,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:ie,...ae}=r,[re,se]=(0,n.useState)((()=>Boolean(R||U)));(0,n.useEffect)((()=>{void 0!==R&&se(R)}),[R]);const le=e?void 0:m().D_,ce=!t||I.length>0?m().D_:void 0,de=i?void 0:m().D_,ue=!a||I.length>0?m().D_:void 0,pe=(0,c().Tf)(),me=(0,n.useContext)(c().xu),ge=(0,n.useRef)(null),fe={value:I,onChange:j,autosize:C,autosizeMinHeight:M,autosizeMaxHeight:T,customElementAttributes:k,disabled:_,format:B,id:P,placeholder:V,type:E,autoFocus:D,focus:R,focusInitial:U,focusAfterAnimation:K,forceShowClearButton:N,ignoreKeyboardMode:F,inputElementAttributes:O,inputStyle:L,isRightLastElementOfInput:W,maxlength:z,min:H,max:q,selectAll:$,showClearButton:G,suppressFocusRing:Y,textarea:Q,textareaSubmitOnEnter:Z,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:ie};return(0,f.jsx)(o(782482).N,{debugName:"InputMenuItem",capture:!0,onUntab:m().D_,onTab:m().D_,onSelectAll:m().D_,onRedo:m().D_,onUndo:m().D_,onToggleBold:m().D_,onToggleItalics:m().D_,onToggleCode:m().D_,onCut:de,onCopy:de,onPaste:de,onKeypress:m().D_,onLeft:le,onRight:le,onDelete:ce,onBackspace:ce,onSpace:ue,children:o(726637).A.isMobile?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d().Ay,{ref:s,...ae,itemMarginLeft:pe?8:void 0,style:x,title:(0,f.jsx)(A,{ref:ge,left:l,right:u,inputLeft:p,inputRight:g,inputRightStyle:h,disableInput:y,inputOuterStyle:v,rightMobileEditLabel:S,isFocused:re,setIsFocused:se,...fe})}),(0,f.jsx)(o(797324).A,{show:re&&me.menuType!==c().gu.ActionSheet,onDismiss:b,inputRef:ge})]}):(0,f.jsx)(d().Ay,{ref:s,...ae,left:l,right:u,isTokenTitle:!0,title:(0,f.jsx)(w,{ref:ge,disableInput:y,inputOuterStyle:v,inputRight:g,inputRightStyle:h,inputLeft:p,...fe}),style:{paddingTop:4,paddingBottom:4,...x}})})}));function x({rightMobileEditLabel:e,inputRef:t}){const a=(0,i().v3)(),s=(0,n.useCallback)((e=>{e.preventDefault();const n=t.current;n&&(0,o(375555).G)(a,n)}),[a,t]);return(0,f.jsx)(r().Ay,{onClick:s,style:{color:p().Tj.text.secondary},children:e})}const w=n.forwardRef((function(e,t){const{disabled:o,disableInput:n,inputOuterStyle:i,inputRight:a,inputRightStyle:r,inputLeft:s,min:c,textarea:d,...u}=e;return(0,f.jsx)(l().A,{...u,ref:t,disabled:o||n,style:{height:d?void 0:28,padding:"3px 6px",...i},left:s,right:a,rightStyle:r,min:c,textarea:d})})),A=n.forwardRef((function(e,t){const{left:i,right:a,inputLeft:r,inputRight:s,inputRightStyle:c,disableInput:d,inputOuterStyle:u,rightMobileEditLabel:p,isFocused:m,setIsFocused:g,disabled:h,showClearButton:y,onBlur:v,onFocus:S,...b}=e,w=(0,n.useCallback)((e=>{g(!1),v&&v(e)}),[v,g]),A=(0,n.useCallback)((e=>{g(!0),S&&S(e)}),[S,g]),I=(0,n.useRef)(null),j=(0,o(93583).A)(I,t),C=p&&!m?(0,f.jsx)(x,{rightMobileEditLabel:p,inputRef:I}):null;return(0,f.jsx)(l().A,{...b,ref:j,format:"transparent",style:{fontSize:16,...u},onFocus:A,onBlur:w,showClearButton:!1!==y,disabled:h||d,left:r||i,right:C||s||a,rightStyle:c})}))},436525:(e,t,o)=>{o.d(t,{D:()=>u});var n=o(296540),i=()=>o(59226),a=()=>o(484714),r=()=>o(79926),s=()=>o(562984),l=()=>o(742734),c=()=>o(141465),d=o(474848);function u({userStore:e,suppressMouse:t,children:o,spaceStore:u}){const p=(0,n.useRef)(null),m=(0,l().E)({spaceStore:u,viewedUserId:null==e?void 0:e.id}),g=(0,i().X)("prefetch_extended_user_profiles"),f=m&&g,h=(0,r().fJ)(s().u.extendedUserProfileActions,{disabled:!f}),y=(0,a().v3)();(0,n.useEffect)((()=>{f&&"resolved"===h.status&&null!=e&&e.id&&u&&null!=u&&u.userId&&h.value.prefetchExtendedUserProfiles({spaceStore:u,actorUserId:u.userId,viewedUserIds:[e.id]},y)}),[f,null==e?void 0:e.id,u,m,y,h]);const v=(0,n.useCallback)((()=>{p.current&&e&&u&&!t&&c().A.setState({type:"user",store:e,domRect:p.current.getBoundingClientRect(),spaceStore:u})}),[e,u,t]),S=(0,n.useCallback)((()=>{c().A.setState(void 0)}),[]);return e&&m?(0,d.jsx)("div",{ref:p,onMouseEnter:m?v:void 0,onMouseLeave:m?S:void 0,children:o}):o}},453697:(e,t,o)=>{o.d(t,{A:()=>p,n:()=>u});var n=o(296540),i=()=>o(590526),a=()=>o(401497),r=()=>o(849255),s=()=>o(807449),l=()=>o(798880),c=()=>o(100622),d=o(474848);function u(e){return(0,a().IS)((()=>({tooltipTextStyle:{color:c().Tj.text.inverseSecondary},tooltipAvatarContainer:{display:"flex",alignItems:"center",marginInlineEnd:8},tooltipContainer:{display:"flex",flexDirection:"row",padding:"4px 6px",alignItems:"center",...e},tooltipUserInfoContainer:{overflow:"hidden",textOverflow:"ellipsis"}})),[e])}const p=function(e){const{hasTooltip:t,showAvatarInTooltip:p,tooltipHeader:m,style:g,iconStyle:f,isOffline:h,borderStyle:y,avatarShouldShowShadow:v,initialOverrideStyle:S,tooltipOverrideStyle:b,userValue:x,userStore:w,avatar:A,type:I="avatar",delayThreshold:j,hasPersonHoverCard:C,avatarOutlineOffset:M}=e,T=(0,o(69708).tz)(),k=(0,i().O$)(o(907258).AppStoreSidebarSpaceStore),_=(0,o(792485).S)(),B=(0,i().K8)((()=>(0,o(876338).$)(_)??k),[_,k]),P=e.size??18,{initialStyle:V,avatarWrapStyle:E,avatarStyle:D,proxiedImageStyle:R,suspendedUserStyle:U}=(0,a().IS)((()=>({initialStyle:{boxSizing:"content-box",borderRadius:"100%",lineHeight:`${P}px`,width:P,height:P,overflow:"hidden",textAlign:"center",fontSize:Math.max(.4375*P,11),background:c().Tj.popoverBackground,userSelect:"none",WebkitUserSelect:"none",color:c().Tj.icon.secondary,opacity:h?.3:1,isolation:"auto",...f,...S},avatarWrapStyle:{background:c().Tj.background.primary,borderRadius:"100%",boxShadow:v?c().Tj.avatarBoxShadow:"none",outlineWidth:1,outlineStyle:y??"solid",outlineColor:c().Tj.border.secondaryTranslucent,outlineOffset:M??-1,...f},avatarStyle:{borderRadius:"100%",width:P,height:P,display:"flex",alignItems:"center",justifyContent:"center",userSelect:"none",WebkitUserSelect:"none",opacity:h?.3:1,...f},proxiedImageStyle:{width:P,height:P,...f},suspendedUserStyle:{boxSizing:"content-box",borderRadius:"100%",width:P-2,height:P-2,overflow:"hidden",background:c().Tj.suspendedUIUserAvatarBackground,userSelect:"none",WebkitUserSelect:"none",color:c().Tj.text.primary,opacity:h?.3:1,display:"flex",justifyContent:"center",alignItems:"center",...f}})),[S,v,y,h,P,f,M]),{tooltipTextStyle:K,tooltipAvatarContainer:N,tooltipContainer:F,tooltipUserInfoContainer:O}=u(b),L=(0,n.useMemo)((()=>w??(x?o(792071).Bj6.fromValue(l().oo,x):void 0)),[w,x]),W=(0,n.useMemo)((()=>L instanceof r().L?L:B&&L?r().L.createChildStore(B,{id:L.id,table:l().oo}):void 0),[L,B]),z=(0,i().K8)((()=>null==L?void 0:L.getFullName(T)),[L,T]),H=(0,i().K8)((()=>null==L?void 0:L.getDisplayName(T)),[L,T]),q=(0,i().K8)((()=>null==L?void 0:L.getEmail()),[L]),$=(0,i().K8)((()=>null==L?void 0:L.getProfilePhoto()),[L]),G=(0,i().K8)((()=>null==L?void 0:L.getIsSuspended()),[L]),Y=(0,o(742734).E)({spaceStore:B,viewedUserId:null==L?void 0:L.id})&&C,Q=()=>e.defaultAvatar??(0,d.jsx)(s().I,{icon:o(360576).personFillSmallIcon,size:"sm",colorVariant:"primary"}),Z=(e,t,n)=>{if(!e)return Q();const i={width:"100%",height:"100%",borderRadius:"100%",...n};return(0,d.jsx)(o(738471).A,{alt:t,src:e,enableLoadingShimmer:!0,style:i,placeholderStyle:i})},X=e=>(0,d.jsxs)("div",{style:F,children:[(0,d.jsx)("div",{style:N,children:te()}),(0,d.jsxs)("div",{style:O,children:[L?H:null==A?void 0:A.name,e?void 0:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("br",{}),L?(0,d.jsx)("span",{style:K,children:q}):null!=A&&A.email?(0,d.jsx)("span",{style:K,children:null==A?void 0:A.email}):null]})]})]}),J=()=>p?X():(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{children:m}),H,(0,d.jsx)("br",{}),L?(0,d.jsx)("span",{style:K,children:q}):void 0]}),ee=e=>{const t=o(634201).PE(e)[0].toUpperCase();return(0,d.jsx)("div",{style:E,children:(0,d.jsx)("div",{style:V,children:(0,d.jsx)("div",{children:t})})})},te=()=>{if(L){if(G)return(0,d.jsx)("div",{style:E,children:(0,d.jsx)("div",{style:U,children:(0,d.jsx)(s().I,{icon:o(947086).personSlashIcon,size:P-2,colorVariant:"tertiary"})})});if($)return(0,d.jsx)("div",{style:D,children:(0,d.jsx)(o(360083).A,{stripGoogleIconQuery:!0,url:$,isAuthenticated:!1,width:Math.max(Number(R.width),120),render:(e,t)=>Z(t,z,E)})});if(z)return ee(z);if(q)return ee(q)}else if(A){if(!A.type&&A.avatarUrl)return(0,d.jsx)("div",{style:E,children:(0,d.jsx)("div",{style:D,children:Z(A.avatarUrl,A.name)})});if(A.name)return ee(A.name);if(A.email)return ee(A.email)}return Q()};switch(I){case"avatar":{const e=(0,d.jsx)("div",{style:g,children:te()});return Y&&W&&B?(0,d.jsx)(o(436525).D,{userStore:W,spaceStore:B,children:e}):t?(0,d.jsx)(o(26697).m,{renderTooltip:J,placement:"bottom",alignment:"start",delayThreshold:j,render:t=>(0,d.jsx)("div",{style:g,"aria-label":H,...t,children:e})}):e}case"avatar-name":case"avatar-name-email":return X("avatar-name"===I);default:(0,o(534177).HB)(I)}}},454503:(e,t,o)=>{o.r(t),o.d(t,{arrowUTurnUpLeftIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"2.12 3.72 15.76 12.16",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M7.592 4.792a.625.625 0 1 0-.884-.884l-4.4 4.4a.625.625 0 0 0 0 .884l4.4 4.4a.625.625 0 1 0 .884-.884L4.259 9.375H14a2.625 2.625 0 0 1 0 5.25h-1.42a.625.625 0 1 0 0 1.25H14a3.875 3.875 0 0 0 0-7.75H4.259z"})},i=(0,o(340498).wt)("arrowUTurnUpLeft",n,"default")},460957:(e,t,o)=>{o.d(t,{E:()=>r});o(581454);var n=()=>o(201980),i=()=>o(718957),a=()=>o(29554);function r(e){const{multiSelection:t}=e;return(0,i().$W)(t).map((({store:e,selection:t})=>{const o=(0,n().RQ)(e.getValue()),i=(0,n().xbM)(o,t),{tokensInsideRange:r}=(0,n().AI5)(o,i.startIndex,i.endIndex);return(0,a().r4)(r,e)})).join("\n\n")}},466721:(e,t,o)=>{o.r(t),o.d(t,{STORE_MAX_LIMIT:()=>x,initializePageVisit:()=>w,updatePageVisits:()=>A});o(898992),o(354520),o(581454);var n=()=>o(907258),i=()=>o(770063),a=()=>o(273648),r=()=>o(90023),s=()=>o(179034),l=()=>o(874852),c=()=>o(559653),d=()=>o(161479),u=()=>o(743246),p=()=>o(496603),m=()=>o(534177),g=()=>o(211716),f=()=>o(299545),h=()=>o(761309),y=()=>o(41161),v=()=>o(129286),S=()=>o(753812);const b=32,x=100;async function w(e,t){await n().default.waitUntilRendered();const{fromPageRefresh:o,blockStore:a,pageVisitStore:p,timestamp:m,type:b}=t,x=e.currentUser.id;if(void 0===x||o)return;t.blockStore.id!==p.state.pageId&&p.setState({...p.getInitialState(),pageId:t.blockStore.id});const w=(0,i().v3)(a,{table:c().F9,id:(0,c().$5)({parent_id:a.id,user_id:x}),spaceId:(0,d().e)(a.pointer.spaceId)}),A=(0,i().v3)(a,{table:l().ou,id:(0,c().$5)({parent_id:a.id,user_id:x}),spaceId:(0,d().e)(a.pointer.spaceId)});if(await v().transactionQueue.awaitRecordTransaction({table:s().ev,id:a.id}),await(0,f().hS)(a),!a.canRead()||(0,h().qb)(e,a,a.getSpaceStore()))return;await w.load(),await A.load();const j=w.getKeyStore("visited_at").getValue(),C=A.getKeyStore("exited_at").getValue(),M=await async function(e,t,o,n,i){const{id:a}=e.currentUser,s=t.id,l=t.getSystemBlockTypeStore().getValue();if((0,r().kR)(l))return{type:"skipped"};const c=t.getParentTable()===u().C0;if(c)return{type:"skipped"};if(a&&"passive"!==i){var d;null==e||null===(d=e.mobileNative)||void 0===d||d.recordPageVisit(a,{blockId:s,spaceId:o,visitedAt:n}),y().A.recordVisit({id:s,systemBlockType:l,type:g().ig.Default,currentUserId:a})}const p=await S().callApi({eventName:"recordPageVisit",environment:e,data:{block:{id:s,spaceId:o},timestamp:n,type:i},headers:{recordId:s,spaceId:o}});return p}(e,a,(0,d().e)(a.pointer.spaceId),m,b);if("skipped"===M.type)return;if("failed"===M.type)return;const T=I({pageVisits:M.data.pageVisits,currentState:p.state,blockStore:a,totalCount:p.state.totalCount,hasMore:void 0});p.state.pageId===a.id&&p.setState({...T,lastViewTime:j,lastExitTime:C})}async function A(e,t){await n().default.waitUntilRendered();const o=e.currentUser.id;if(void 0===o)return;const{blockStore:i,pageVisitStore:a,incremental:r}=t,s=t.limit||b;let l;if(r){const{pageId:e,lastViewTime:t,lastExitTime:n,totalCount:i,hasMore:r,...s}=a.state,c=Object.entries(s).map((([e,t])=>{if(o===e)return;const n=t.getVisitedAt();return void 0!==n?n+1:void 0}));l=p().T9(c.filter(m().O9))}const c=await S().callApi({eventName:"getPageVisitors",environment:e,data:{block:{id:i.id,spaceId:(0,d().e)(i.pointer.spaceId)},sinceTimestamp:l,limit:s,includeTotalCount:t.includeTotalCount},headers:{recordId:i.id,spaceId:(0,d().e)(i.pointer.spaceId)}});if("failed"===c.type)return;const u=I({pageVisits:c.data.pageVisits,blockStore:i,currentState:a.state,totalCount:c.data.totalCount,hasMore:c.data.hasMore});let g;if(Object.keys(u).length<=x)g=u;else{const{pageId:e,lastViewTime:t,lastExitTime:o,totalCount:n,hasMore:i,...a}=u,r=(0,m().WP)(a).map((([e,t])=>[e,t.getVisitedAt()??0]));g={pageId:e,lastViewTime:void 0,lastExitTime:void 0,totalCount:n,hasMore:i};const s=p().Ul(r,(([,e])=>-e)).slice(0,x);for(const[l]of s)g[l]=u[l]}a.state.pageId===u.pageId&&a.setState(g)}function I(e){const{blockStore:t,pageVisits:o,currentState:n,totalCount:i,hasMore:r}=e,s={...n,pageId:t.id,totalCount:i,hasMore:r};for(const l of o){const{id:e,user_id:o}=l;o in s||(s[o]=a()._.createChildStore(t,{table:c().F9,id:e,spaceId:(0,d().e)(t.pointer.spaceId)}))}return s}},500128:(e,t,o)=>{o.d(t,{K:()=>r});o(296540);var n=()=>o(59226),i=()=>o(704658),a=o(474848);function r(e){const{children:t,featureFlag:o,...r}=e;return(0,n().X)(o)?(0,a.jsx)(i().UpgradeButton,{...r}):t}},562984:(e,t,o)=>{o.d(t,{i:()=>a,u:()=>i});var n=()=>o(79926);const i={PersonProfileContainer:new(n().O2)("PersonProfileContainer",(()=>Promise.all([o.e(75134),o.e(32370),o.e(26264),o.e(69785),o.e(29357),o.e(22585),o.e(41751),o.e(17680),o.e(95576),o.e(77093),o.e(23730),o.e(44632)]).then(o.bind(o,635686)))),extendedUserProfileActions:new(n().O2)("extendedUserProfileActions",(()=>o.e(63717).then(o.bind(o,260513))))},a=(0,n()._h)(i.PersonProfileContainer,(e=>e.PersonProfileContainer))},569397:(e,t,o)=>{o.r(t),o.d(t,{arrowStraightRightSmallIcon:()=>i,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.12 3.05 11.76 9.9",directional:!0,svg:(0,o(474848).jsx)("path",{d:"M9.372 3.238a.625.625 0 1 0-.884.884l3.253 3.253H2.75a.625.625 0 0 0 0 1.25h8.991l-3.253 3.253a.625.625 0 0 0 .884.884l4.32-4.32a.625.625 0 0 0 0-.884z"})},i=(0,o(340498).wt)("arrowStraightRightSmall",n,"small")},588047:(e,t,o)=>{o.d(t,{k:()=>i});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"2.42 2.11 11.16 12.13",svg:(0,o(474848).jsx)("path",{d:"M8 2.115c-.854 0-1.569.554-1.824 1.315a3.96 3.96 0 0 0-2.138 3.518v.895c0 .655-.238 1.287-.669 1.78l-.616.704c-.75.858-.141 2.202 1 2.202H5.89a2.156 2.156 0 0 0 4.218 0h2.139c1.14 0 1.75-1.344.999-2.202l-.616-.704a2.7 2.7 0 0 1-.669-1.78v-.895A3.96 3.96 0 0 0 9.824 3.43 1.92 1.92 0 0 0 8 2.115m-.669 1.839A.68.68 0 0 1 8 3.365c.34 0 .623.253.669.589l.048.353.33.138a2.71 2.71 0 0 1 1.665 2.503v.895c0 .958.348 1.882.978 2.603l.616.704a.078.078 0 0 1-.058.129H3.752a.078.078 0 0 1-.058-.129l.616-.704c.63-.72.978-1.645.978-2.603v-.895c0-1.126.686-2.093 1.665-2.503l.33-.138zM8 13.084c-.394 0-.735-.226-.9-.555h1.8c-.165.33-.506.556-.9.556"})},i=(0,o(340498).wt)("bellSmall",n,"small")},595917:(e,t,o)=>{o.d(t,{a:()=>a});var n=()=>o(590526),i=()=>o(388832);function a(e){const t=(0,n().K8)((()=>{if(e)return e.getSpaceId()}),[e]);return(0,n().K8)((()=>e&&t?(0,i().so)({collectionStore:e,spaceId:t}):{value:[]}),[e,t])}},626001:(e,t,o)=>{o.d(t,{Af:()=>M,Bw:()=>k,Cs:()=>b,Oq:()=>f,Re:()=>y,X4:()=>h,YJ:()=>j,ZB:()=>C,Zd:()=>T,d2:()=>v,dd:()=>w,in:()=>S,kQ:()=>I});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(581454),o(737550);var n=()=>o(68169),i=()=>o(799288),a=()=>o(277153),r=()=>o(179034),s=()=>o(798880),l=()=>o(743246),c=()=>o(201980),d=()=>o(724639),u=()=>o(496603),p=()=>o(534177),m=()=>o(27267),g=()=>o(166442);function f(e,t){const o=g().UserChatPreferenceLocalStorageStore.getState();g().UserChatPreferenceLocalStorageStore.setState({...o,[e]:{...null==o?void 0:o[e],...t}})}function h(e){return e.some((e=>"in_progress"===e.status))}function y(e){return e.some((e=>"complete"===e.status&&"risky"===e.attachmentRisk))}function v(e,t){const o=c().w9s(e),n=((null==t?void 0:t.length)??0)>0;return!o||n}function S(e){const t=b({config:e,includeWeb:!1});return 1===t.length?t[0]:void 0}function b(e){const{config:t,includeWeb:o}=e,n=[];if("search"===t.type)n.push(t.scopeForNextSearch);else if("researcher"===t.type&&t.searchScope)n.push(t.searchScope);else{if("workflow"!==t.type)return[];n.push(...(0,d().n_)({config:t,modules:[]})??[])}return o&&t.useWebSearch&&n.push({type:"web"}),n}function x(e){const{botId:t,spaceStore:o,userStore:n}=e,i=m().R.getCachedWorkflowData(n.id,o.id);if(i)for(const r of i.workflowStores){var a;const e=r.getDraftData();if("bot"===(null==e||null===(a=e.runtime_actor_pointer)||void 0===a?void 0:a.table)&&e.runtime_actor_pointer.id===t)return r.id}}function w(e,t,o){if(!e)return[];const a=c().moK(e),r=c().Fbh(e).map((e=>({table:s().oo,id:e}))),d=c().jgW(e);return[...a,...r,...t&&o?d.map((e=>{if((0,i().ut)(e))return{table:l().C0,id:n().Lj,spaceId:t.id};const a=x({spaceStore:t,botId:e,userStore:o});return a?{table:l().C0,id:a,spaceId:t.id}:void 0})).filter(p().O9):[]]}function A(e,t){const o=new Set(e.map((e=>a().L3.toIdTableKey(e)))),n=new Set(t.map((e=>a().L3.toIdTableKey(e))));return{added:t.filter((e=>!o.has(a().L3.toIdTableKey(e)))),removed:e.filter((e=>!n.has(a().L3.toIdTableKey(e)))),unchanged:e.filter((e=>n.has(a().L3.toIdTableKey(e))))}}function I(e){const{currentTextMentionPointers:t,inputMentionPointers:o,allMentionPointers:n}=e;let i,r;const{added:s}=A(Array.from(n),t),{removed:l,unchanged:c}=A(o,t),d=s.length>0,u=l.length>0;if(d||u){let e=Array.from(n);if(u){const t=new Set(l.map((e=>a().L3.toIdTableKey(e))));e=e.filter((e=>!t.has(a().L3.toIdTableKey(e))))}d&&(e=[...e,...s]),i=e,r=[...c,...s]}return{newMentionPointers:i,newInputMentionPointers:r}}function j(e,t){return(0,u().n4)(e,t)}function C(e){return!!e&&("workspace"===e.type||"teamspace"===e.type||"collection"===e.type||"page"===e.type)}function M(e){const{currentScopes:t,scope:o,isMultiScopeEnabled:n}=e;let i=[];if("everything"===o.type)i=[{type:"everything"}];else if(n){const e=t.filter((e=>"everything"!==e.type));if(e.some((e=>j(e,o))))i=e.filter((e=>!j(e,o)));else if("notion"===o.type){i=[...e.filter((e=>!C(e))),o]}else if(C(o)){i=[...e.filter((e=>"notion"!==e.type)),o]}else i=[...e,o]}else i=[o];return 0===i.length?[{type:"everything"}]:i}function T(e,t){switch(e.type){case"workflow":return{...e,searchScopes:t};case"search":return{...e,scopeForNextSearch:t[0]};case"researcher":return{...e,searchScope:t[0]};default:return e}}function k(e,t,o,a){if(!c().qXl(e))return!1;const d=c().uPN(e);for(const u of d)if(t.table===s().oo&&c().rie(u)){if(c().NcG(u)===t.id)return!0}else if(t.table===r().ev&&c().jIt(u)){const e=c().i$F(u);if(e&&e.id===t.id)return!0}else if(t.table===l().C0&&c().XkZ(u)){const e=c().vjW(u);if(e&&(0,i().ut)(e)&&t.id===n().Lj)return!0;if(e&&o&&a){if(x({spaceStore:o,botId:e,userStore:a})===t.id)return!0}}return!1}},656134:(e,t,o)=>{o.d(t,{j:()=>r});var n=()=>o(484714),i=()=>o(590526),a=()=>o(127833);function r(e){const t=(0,n().Y0)();return(0,i().K8)((()=>t.isPhone||"slideUp"===(null==e?void 0:e.tabletBehavior)&&t.isTablet?a().nl.SlideUp:a().nl.Popup),[t,null==e?void 0:e.tabletBehavior])}},673657:(e,t,o)=>{o.d(t,{n:()=>a});var n=()=>o(590526),i=()=>o(964345);function a(e){return(0,n().K8)((()=>i().gZ.state&&(null==e?void 0:e.id)===i().Di.state),[e])}},680474:(e,t,o)=>{o.d(t,{Wx:()=>a,fM:()=>n,sM:()=>i});const n=new(o(79926).O2)("framer-motion",(async()=>await Promise.all([o.e(44711),o.e(53321),o.e(37043)]).then(o.bind(o,301716))));function i(e){return e.useAnimation()}function a(e,...t){return e.useInView(...t)}},720503:(e,t,o)=>{o.d(t,{A:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{open:!1}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:o,billingInterval:n,isTrial:i,sessionId:a,dismissMobilePlansModal:r,postUpgradeCallback:s,from:l,offer:c}=e;this.setState({open:!0,temporaryBillingInterval:n,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:"current_space",addOnFeature:o,onlyShowAddOn:void 0!==o,sessionId:a,isTrial:i,dismissMobilePlansModal:r,postUpgradeCallback:s,from:l,offer:c})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const i=new n},742734:(e,t,o)=>{o.d(t,{E:()=>r});var n=()=>o(230711),i=()=>o(590526),a=()=>o(304228);function r(e){const{spaceStore:t,viewedUserId:o}=e,r=(0,n().nB)(t),s=(0,n().V_)({spaceStore:t,userId:o});return(0,i().K8)((()=>(0,a().V)({spaceStore:t,actorRole:r,viewedRole:s})),[t,r,s])}},763765:(e,t,o)=>{o.d(t,{t:()=>i});class n extends(()=>o(757695))().Store{getInitialState(){return{loaded:!1}}USEWITHCAUTION_markStatsigUserFetched(e){const{userId:t,spaceId:o,fetched:n}=e;this.setState({loaded:n,userId:t,spaceId:o})}USEWITHCAUTION_isFetchedForSpaceAndUserId(e){const{spaceId:t,userId:o}=e;return this.state.loaded&&this.state.spaceId===t&&this.state.userId===o}}const i=new n;(0,o(852832).exposeDebugValue)("statsigUserLoadingStatusStore",i)},791177:(e,t,o)=>{o.d(t,{$:()=>i});var n=o(296540);function i(){const[e,t]=(0,n.useState)({inputElementAttributes:void 0,suppressFocusRing:!1}),[o,i]=(0,n.useState)(!1),[a,r]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(o){function e(){r(!1)}function t(e){"ArrowDown"!==e.key&&"ArrowUp"!==e.key||r(!0)}return window.addEventListener("pointerdown",e),window.addEventListener("keydown",t),()=>{window.removeEventListener("pointerdown",e),window.removeEventListener("keydown",t)}}}),[o]);return[(0,n.useMemo)((()=>({inputElementAttributes:e.inputElementAttributes,suppressFocusRing:e.suppressFocusRing&&a,onFocus:()=>{i(!0)},onBlur:()=>{i(!1)}})),[e,a]),(0,n.useMemo)((()=>({setComboboxState:t,isFocusVisible:a,isComboboxFocused:o,onItemHover:()=>{r(!1)}})),[a,o])]}},797324:(e,t,o)=>{o.d(t,{A:()=>f});var n=o(296540),i=()=>o(560520),a=()=>o(484714),r=()=>o(790748),s=()=>o(581010),l=()=>o(69708),c=()=>o(100622),d=()=>o(284371),u=()=>o(396406),p=()=>o(718827),m=()=>o(843798),g=o(474848);function f(e){const{onDismiss:t,inputRef:o}=e,f=(0,a().Y0)(),h=(0,n.useRef)(null),y=f.isMobileNative&&f.isIOS,v=y&&e.show;(0,r().b)(s().A,(()=>({getNode:()=>h.current,isShown:()=>v})),[v]);const S=(0,i().n)(),b=(0,n.useCallback)((()=>{var e;null==o||null===(e=o.current)||void 0===e||e.focus(),t&&t();const n=document.activeElement;n instanceof HTMLElement&&n.blur()}),[o,t]);if(!y)return null;const x=v?-(m().j+S):0;return(0,g.jsx)(u().O,{open:!0,children:(0,g.jsx)("div",{style:{position:"fixed",top:"100vh",width:"100%",height:m().j,display:v?"flex":"none",alignItems:"center",justifyContent:"flex-end",backgroundColor:c().Tj.keyboardDoneBarBackground,transform:`translateY(${x}px)`,transition:v?"ease-out":"ease-in",boxShadow:v?`\n\t\t\t\t\t\t\t\t0 -1px 0 ${c().Tj.border.primaryTranslucent}\n\t\t\t\t\t\t\t`:void 0},ref:h,children:(0,g.jsx)(p().Ay,{style:{display:"flex",alignItems:"center",marginInlineEnd:16,color:c().oZ.blue,fontWeight:d().Wy.semibold},onTouchEnd:()=>{b()},children:(0,g.jsx)(l().sA,{defaultMessage:"Done",id:"mobile.dismissKeyboardBar.button.label"})})})})}},846523:(e,t,o)=>{o.d(t,{u:()=>n});const n=(0,o(340498).xh)("questionMarkCircle",{default:{loader:()=>o.e(82106).then(o.bind(o,406533))},small:{loader:()=>o.e(82106).then(o.bind(o,721479))},fill:{loader:()=>o.e(82106).then(o.bind(o,299733))},fillSmall:{loader:()=>o.e(82106).then(o.bind(o,182060))}},["question","query","inquiry","uncertain","unknown","help","circle"])},888325:(e,t,o)=>{function n(e){return`${e.table}:${e.id}`}o.d(t,{_:()=>n})},912474:(e,t,o)=>{o.d(t,{a:()=>a});var n=()=>o(79926);const i=new(n().O2)("StopDictationButton",(async()=>await Promise.all([o.e(75134),o.e(35530),o.e(9773),o.e(36556),o.e(55373),o.e(36192),o.e(40537),o.e(27992),o.e(63452),o.e(66249),o.e(92845),o.e(87249),o.e(79022),o.e(14578),o.e(87017),o.e(34877),o.e(46414),o.e(11676),o.e(61165),o.e(94522),o.e(44584),o.e(38293),o.e(40992),o.e(88455),o.e(52871),o.e(47160),o.e(49021),o.e(53697),o.e(17680),o.e(6039),o.e(71136),o.e(86341),o.e(29316),o.e(3101)]).then(o.bind(o,962309)))),a=(0,n()._h)(i,(e=>e.StopDictationButton))},928213:(e,t,o)=>{o.d(t,{c:()=>r});var n=()=>o(165358),i=()=>o(519831),a=()=>o(753812);async function r(e){const{environment:t,collectionStore:o}=e,r={id:o.id,table:i().Vl,spaceId:o.getSpaceId()},s=await a().callApi({eventName:"suggestRecordKey",environment:t,data:{...r,shouldSetSuccessfullySuggestedRecord:!0}});if("success"===s.type)return s.data.key;n().log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},940169:(e,t,o)=>{o.r(t),o.d(t,{CollectionSettingsAutomationsView:()=>So});o(944114),o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577),o(803949),o(581454),o(737550);var n=o.n(o(844751)),i=o(296540),a=()=>o(564884),r=()=>o(907258),s=()=>o(59226),l=()=>o(726637),c=()=>o(484714),d=()=>o(792485),u=()=>o(590526),p=()=>o(401497),m=()=>o(929219),g=()=>o(128933),f=()=>o(807449),h=()=>o(552712),y=()=>o(268865),v=()=>o(631524),S=()=>o(160432),b=()=>o(493552),x=()=>o(26697),w=()=>o(736847),A=()=>o(764880),I=()=>o(422540),j=()=>o(368609),C=()=>o(352271),M=()=>o(343462),T=()=>o(341136),k=()=>o(927826),_=()=>o(478367);function B(e){return"person"===e.type}var P=()=>o(363170),V=()=>o(662149),E=()=>o(214388),D=()=>o(898244),R=()=>o(713998),U=()=>o(852424),K=()=>o(791089),N=()=>o(187174),F=()=>o(588047),O=()=>o(64035),L=()=>o(281844),W=()=>o(523389),z=()=>o(863330),H=()=>o(182060),q=()=>o(721479),$=()=>o(189814),G=()=>o(381553),Y=()=>o(407444),Q=()=>o(888382),Z=()=>o(277153),X=()=>o(437607),J=()=>o(69708),ee=()=>o(100622),te=()=>o(534177),oe=()=>o(284371),ne=()=>o(837570),ie=()=>o(741310),ae=()=>o(546461),re=()=>o(94686),se=()=>o(104636),le=()=>o(284489),ce=()=>o(339798),de=()=>o(735695),ue=()=>o(637759),pe=()=>o(402584),me=()=>o(680288),ge=()=>o(419357),fe=()=>o(312788),he=()=>o(718827),ye=()=>o(250910),ve=()=>o(396896),Se=()=>o(695115),be=()=>o(546926),xe=()=>o(890492),we=()=>o(81068),Ae=()=>o(663639),Ie=()=>o(8741),je=()=>o(589407),Ce=()=>o(496703),Me=()=>o(388832),Te=()=>o(22673),ke=()=>o(378711),_e=()=>o(28853),Be=o(474848);const Pe=(0,J().YK)({moreButtonLabel:{defaultMessage:"More…",id:"databaseAgentCardsList.moreButtonLabel"},deleteAgentLabel:{defaultMessage:"Delete agent",id:"databaseAgentCardsList.deleteAgentLabel"},advancedSettingsLabel:{defaultMessage:"Advanced settings",id:"databaseAgentCardList.advancedSettingsLabel"}});function Ve(e){const{collectionContextStore:t}=e,{createdByMe:o,inDatabase:n}=(0,_e().X)({collectionContextStore:t});return(0,Be.jsxs)(ve().VP,{gap:12,paddingInlineStart:12,paddingInlineEnd:12,children:[o.map((e=>(0,Be.jsx)(Ee,{workflow:e,collectionContextStore:t},e.workflowId))),n.map((e=>(0,Be.jsx)(Ee,{collectionContextStore:t,workflow:e},e.workflowId)))]})}function Ee(e){const{workflow:t,collectionContextStore:n}=e,a=(0,c().v3)(),r=(0,J().tz)(),{navigate:d}=(0,i.useContext)(fe().E),[m,g]=(0,i.useState)(!1),h=l().A.isMobile||m,y=(0,u().K8)((()=>n.settingsStore),[n]),v=(0,u().K8)((()=>n.collectionStore()),[n]),S=(0,u().K8)((()=>null==v?void 0:v.getSpaceId()),[v]),x=(0,s().X)("custom_agent_page_instructions"),{handleDeleteAgent:A,shouldShowDeleteButton:I}=(0,ke().L)({collectionSettingsStore:y,collectionStore:v,spaceId:S,workflowStore:t.workflowStore}),j=(0,p().IS)((()=>({wrap:{background:ee().Tj.background.elevated,border:`1px solid ${ee().Tj.border.primary}`,borderRadius:10,display:"flex",flexDirection:"column",paddingTop:16,paddingInlineStart:16,paddingInlineEnd:16,paddingBottom:13,position:"relative"},moreButtonIcon:{color:ee().Tj.icon.tertiary,height:16,width:16},moreButtonWrap:{display:I?"block":"none",position:"absolute",insetInlineEnd:8,top:8,zIndex:1},moreButtonIconButton:{border:`1px solid ${ee().Tj.border.secondaryTranslucent}`}})),[I]),C=(0,i.useCallback)((async()=>{if(!n||!v)return;(0,Te().tH)({environment:a,workflowId:t.workflowId,origin:"agents_menu"});const e=t.workflowId,i=(0,Me().d_)(t.workflowStore)[0];if(e&&i){var s;const t=null===(s=v.getSchema())||void 0===s?void 0:s[i];if(t){ce().os({collectionSettingsStore:n.settingsStore});const{triggerDatabaseAgentModal:s}=await Promise.all([o.e(75134),o.e(71562),o.e(44711),o.e(53321),o.e(51220),o.e(16471),o.e(37353),o.e(37571),o.e(29151),o.e(40118),o.e(50397),o.e(46414),o.e(11676),o.e(61165),o.e(94522),o.e(44584),o.e(67494),o.e(10522),o.e(40992),o.e(88455),o.e(63515),o.e(33893),o.e(55162),o.e(91793),o.e(97989),o.e(36437),o.e(93963),o.e(44590),o.e(7914),o.e(55113),o.e(85071),o.e(25588),o.e(23640),o.e(72252),o.e(93134),o.e(12452),o.e(18825),o.e(52871),o.e(29351),o.e(22370),o.e(93049),o.e(22582),o.e(18636),o.e(87289),o.e(16060),o.e(16529),o.e(34281),o.e(35279),o.e(69785),o.e(77754),o.e(29357),o.e(47160),o.e(41751),o.e(21627),o.e(41714),o.e(77777),o.e(23493),o.e(51240),o.e(81803),o.e(42810),o.e(20741),o.e(33695),o.e(86730)]).then(o.bind(o,825547));await s({collectionContextStore:n,collectionId:v.id,createInstructionsPageEnabled:x,environment:a,intl:r,propertyId:i,propertySchema:t,workflowId:e})}}ce().a2({collectionSettingsStore:n.settingsStore,item:{type:"propertyAgentAutofill",workflowId:e}})}),[n,v,x,a,r,t]),M=(0,i.useCallback)((()=>{if(!t.workflowStore)return;const e=(0,Ce().L)({workflowId:t.workflowStore.id,params:{workflowViewType:"settings"}});d({environment:a,url:e})}),[a,d,t.workflowStore]),T=(0,i.useCallback)((e=>{g(!0)}),[]),k=(0,i.useCallback)((e=>{g(!1)}),[]),_=(0,i.useCallback)((e=>{const t={key:"advanced-settings",action:M,render:e=>(0,Be.jsx)(we().A,{...e,title:r.formatMessage(Pe.advancedSettingsLabel),right:(0,Be.jsx)(f().I,{icon:Ie().arrowDiagonalUpRightSmallIcon,size:"sm",colorVariant:"tertiary"})})},o={key:"delete-agent",action:()=>{A(),e.close()},render:e=>(0,Be.jsx)(we().A,{...e,title:r.formatMessage(Pe.deleteAgentLabel),isRedOnHover:!0})};return[t,...I?[o]:[]]}),[A,M,r,I]);return(0,Be.jsxs)(he().Ay,{onClick:C,style:j.wrap,onMouseEnter:T,onMouseLeave:k,children:[h?(0,Be.jsx)("div",{style:j.moreButtonWrap,children:(0,Be.jsx)(ye().A,{renderOrigin:e=>(0,Be.jsx)(Se().A,{...e,size:"sm",icon:je().ellipsisIcon,iconStyle:j.moreButtonIcon,ariaLabel:r.formatMessage(Pe.moreButtonLabel),hasBackground:!0,style:j.moreButtonIconButton}),popupType:l().A.isMobile?ye().z.BottomSheet:ye().z.Popup,render:e=>(0,Be.jsx)(xe().A,{menuType:be().gu.Popup,minWidth:220,children:(0,Be.jsx)(Ae().A,{type:Ae().O.Vertical,sections:[{key:"database-agent-cards-list-more-menu",render:e=>(0,Be.jsx)(w().A,{...e}),items:_(e)}],initialFocus:0})})})}):null,(0,Be.jsx)(b().D,{styleKey:"bodyMedium",colorVariant:"primary",children:t.agentName}),(0,Be.jsx)(b().D,{styleKey:"captionRegular",colorVariant:"secondary",children:t.agentDescription})]})}var De=()=>o(761309),Re=()=>o(789586),Ue=()=>o(528093),Ke=()=>o(500128),Ne=()=>o(457823),Fe=()=>o(819121),Oe=()=>o(588316),Le=()=>o(970236),We=()=>o(569397),ze=()=>o(158661),He=()=>o(340498);const qe={viewBox:"0 0 16 16",fittedViewBox:"3 3 10 10",svg:(0,Be.jsx)("path",{d:"M3.75 3a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h2.3a.75.75 0 0 0 .75-.75v-8.5A.75.75 0 0 0 6.05 3zm6.2 0a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h2.3a.75.75 0 0 0 .75-.75v-8.5a.75.75 0 0 0-.75-.75z"})},$e=(0,He().wt)("mediaPauseFillSmall",qe,"fillSmall");var Ge=()=>o(558842),Ye=()=>o(118307),Qe=()=>o(775842),Ze=()=>o(764781),Xe=()=>o(126617),Je=()=>o(200582),et=()=>o(105819),tt=()=>o(236262),ot=()=>o(574036),nt=()=>o(781697),it=()=>o(656134);const at=(0,J().YK)({automationSummaryCardMoreButtonAriaLabel:{defaultMessage:"More",id:"automations.AutomationSummaryCard.MoreActionsButton.ariaLabel"},automationSummaryCardMoreMenuEditTitle:{defaultMessage:"Edit",id:"automations.AutomationSummaryCard.MoreActionsMenu.Edit.title"},automationSummaryCardMoreMenuDuplicateTitle:{defaultMessage:"Duplicate",id:"automations.AutomationSummaryCard.MoreActionsMenu.Duplicate.title"},automationSummaryCardMoreMenuDeleteTitle:{defaultMessage:"Delete",id:"automations.AutomationSummaryCard.MoreActionsMenu.Delete.title"},automationSummaryCardMoreMenuActiveTitle:{defaultMessage:"Active",id:"automations.AutomationSummaryCard.MoreActionsMenu.Active.title"},automationSummaryCardMoreMenuRestartTitle:{defaultMessage:"Restart",id:"automations.AutomationSummaryCard.MoreActionsMenu.Restart.title"}});function rt(e){const{focused:t,style:o,onEdit:n,onDelete:a,onDuplicate:r,onDisable:s,onEnable:l,onRestart:c}=e,d=(0,J().tz)(),m=(0,u().uB)(void 0,Ye().A),g=(0,it().j)();(0,i.useEffect)((()=>{t||m.setState({open:!1})}),[t,m]);const f=(0,p().IS)((()=>({iconButton:{border:`1px solid ${ee().Tj.border.secondaryTranslucent}`,height:26,width:26,...o},iconButtonIcon:{width:He().Ev.sm,height:He().Ev.sm}})),[o]);return(0,Be.jsx)(ye().A,{stopClickPropagation:!0,popupType:g,alignmentToOrigin:"center",placementToOrigin:"bottom",originGap:0,renderOrigin:e=>(0,Be.jsx)(Se().A,{ariaLabel:d.formatMessage(at.automationSummaryCardMoreButtonAriaLabel),icon:Xe().ellipsisSmallIcon,iconStyle:f.iconButtonIcon,style:f.iconButton,hasBackground:!0,...e}),render:e=>(0,Be.jsx)(st,{onClose:()=>e.close(),onEdit:n,onDelete:a,onDuplicate:r,onDisable:s,onEnable:l,onRestart:c}),buttonPopupStore:m})}function st(e){const{onClose:t,onEdit:o,onDelete:n,onDuplicate:i,onDisable:a,onEnable:r,onRestart:s}=e,l=(0,J().tz)(),c=(0,nt().e)(),d=o?{action:()=>{t(),o()},key:"edit",render:e=>(0,Be.jsx)(we().A,{...e,icon:(0,Be.jsx)(f().I,{icon:et().pencilLineIcon}),title:l.formatMessage(at.automationSummaryCardMoreMenuEditTitle)})}:void 0,u=s?{action:()=>{t(),s()},key:"restart",render:e=>(0,Be.jsx)(we().A,{...e,icon:(0,Be.jsx)(f().I,{icon:Qe().a}),title:l.formatMessage(at.automationSummaryCardMoreMenuRestartTitle)})}:void 0,p=i?{action:()=>{t(),i()},key:"duplicate",render:e=>(0,Be.jsx)(we().A,{...e,icon:(0,Be.jsx)(f().I,{icon:Ze().V}),title:l.formatMessage(at.automationSummaryCardMoreMenuDuplicateTitle)})}:void 0,m=r||a?{action:()=>{t(),r?r():a&&a()},key:"active",render:e=>(0,Be.jsx)(ot().A,{...e,icon:(0,Be.jsx)(f().I,{icon:Je().m}),title:l.formatMessage(at.automationSummaryCardMoreMenuActiveTitle),on:(0,te().O9)(a)})}:void 0,g=n?{action:()=>{t(),n()},key:"delete",render:e=>(0,Be.jsx)(we().A,{...e,icon:(0,Be.jsx)(f().I,{icon:tt().trashIcon}),title:l.formatMessage(at.automationSummaryCardMoreMenuDeleteTitle),isRedOnHover:!0})}:void 0,h=[];return(0,te().O9)(m)&&h.push({items:[m],key:"active-inactive",render:e=>(0,Be.jsx)(w().A,{enableActionSheetTitle:!0,...e})}),h.push({items:[u,d,p,g].filter(te().O9),key:"items",render:e=>(0,Be.jsx)(w().A,{enableActionSheetTitle:!0,topBorder:(0,te().O9)(m),...e})}),(0,Be.jsx)(xe().A,{...c,children:(0,Be.jsx)(Ae().A,{type:Ae().O.Vertical,sections:h,initialFocus:0})})}var lt=()=>o(448693),ct=()=>o(580648),dt=()=>o(115512);const ut=6;function pt(e){const{actions:t,caption:o,focused:n,status:a,maxIcons:r,onBlur:s,onClick:c,onDelete:d,onDisable:g,onDuplicate:h,onEdit:y,onRestart:v,onEnable:S,onFocus:b,onMouseDown:x,onMouseEnter:w,onMouseLeave:A,title:I,triggers:j}=e,C=(0,i.useRef)(null),[M,T]=(0,Fe().A)(),[k,_]=(0,Oe().A)(),[B,P]=(0,i.useState)(!1),V=l().A.isMobile||B||T||_,E=(0,p().IS)((()=>({wrap:{background:ee().Tj.background.elevated,border:`1px solid ${ee().Tj.border.primary}`,borderRadius:10,display:"flex",flexDirection:"column",gap:11,paddingTop:16,paddingInlineStart:16,paddingInlineEnd:16,paddingBottom:13,position:"relative"},moreButtonWrap:{display:V?"block":"none",position:"absolute",insetInlineEnd:8,top:8},iconList:{display:"flex",flexWrap:"wrap",gap:6,listStyle:"none",alignItems:"center",marginTop:0,marginInlineEnd:30,marginBottom:0,marginInlineStart:0,padding:0},body:{display:"flex",flexDirection:"column",gap:l().A.isMobile?4:0},titleWrap:{..."success"!==a?{alignItems:"center",display:"inline-flex",gap:4}:(0,dt().pA)(2),fontSize:l().A.isMobile?16:14,fontWeight:oe().Wy.medium,lineHeight:"20px"},title:{..."success"!==a?oe().RC:{}},caption:{...(0,dt().pA)(2),color:ee().Tj.text.secondary,fontSize:l().A.isMobile?14:12,fontWeight:oe().Wy.regular,lineHeight:"16px",margin:0}})),[V,a]),D=(0,i.useCallback)((e=>{P(!0),w&&w(e)}),[w]),R=(0,i.useCallback)((e=>{P(!1),A&&A(e)}),[A]);(0,i.useEffect)((()=>{n&&null!==C.current&&C.current.focus()}),[n]);const U=(0,Ge().Px)(C,M,k),K=function(e){const{actionIcons:t,maxIcons:o,triggerIcons:n}=e,i=n.length,a=t.length,r=i>0&&a>0,s=Math.max(o,3),l=r?s-1:s;let c=Math.max(Math.floor(l/2),1),d=Math.max(Math.ceil(l/2),1);if(i<c&&a>d){d+=c-i,c=i}else if(a<d&&i>c){c+=d-a,d=a}const u=[];if(i>0)if(i>c)if(1===c)u.push({color:"gray",type:"truncate",value:i});else{const e=i-(c-1);u.push(...n.slice(0,c-1)),u.push({color:"gray",type:"truncate",value:e})}else u.push(...n);r&&u.push({type:"arrow"});if(a>0)if(a>d)if(1===d)u.push({color:"gray",type:"truncate",value:a});else{const e=a-(d-1);u.push(...t.slice(0,d-1)),u.push({color:"gray",type:"truncate",value:e})}else u.push(...t);return u}({actionIcons:t,maxIcons:vt(r),triggerIcons:j}),N=(0,u().O$)(m().e),F=N&&Boolean(d||g||S||h||y||v),O=function({status:e,titleSize:t}){const o=function({status:e,titleSize:t}){const o=t??14;return(0,p().IS)((()=>{const t="error"===e?"red":"orange";return{warning:{color:ee().Tj[t].text.secondary,height:"auto",width:o},badgeContainer:{alignItems:"center",display:"flex",fontSize:10,gap:3}}}),[e,o])}({status:e,titleSize:t});return(0,i.useMemo)((()=>"invalid"===e?(0,Be.jsx)(Le().E,{color:"red",content:(0,Be.jsxs)("div",{style:o.badgeContainer,children:[(0,Be.jsx)(f().I,{icon:ze().exclamationMarkTriangleFillSmallIcon,size:"xxs"}),(0,Be.jsx)(J().sA,{defaultMessage:"Invalid",id:"automationSummaryCard.invalidToken"})]})}):"paused"===e?(0,Be.jsx)(Le().E,{content:(0,Be.jsxs)("div",{style:o.badgeContainer,children:[(0,Be.jsx)(f().I,{icon:$e,size:"xxs"}),(0,Be.jsx)(J().sA,{defaultMessage:"Paused",id:"automationSummaryCard.pausedToken"})]})}):"failing"===e?(0,Be.jsx)(Le().E,{color:"yellow",content:(0,Be.jsx)("div",{style:o.badgeContainer,children:(0,Be.jsx)(J().sA,{defaultMessage:"Failing",id:"automationSummaryCard.failingToken"})})}):"expired"===e?(0,Be.jsx)(Le().E,{color:"gray",content:(0,Be.jsx)("div",{style:o.badgeContainer,children:(0,Be.jsx)(J().sA,{defaultMessage:"Completed",id:"automationSummaryCard.completedToken"})})}):void("error"!==e&&"warning"!==e&&"success"!==e&&(0,te().HB)(e))),[e,o])}({status:a,titleSize:l().A.isMobile?16:14});return(0,Be.jsxs)(he().Ay,{onBlur:s,onClick:c,onFocus:b,onMouseDown:x,onMouseEnter:D,onMouseLeave:R,ref:U,style:E.wrap,disabled:!N,children:[(0,Be.jsxs)("header",{children:[F?(0,Be.jsx)("div",{style:E.moreButtonWrap,children:(0,Be.jsx)(rt,{focused:V,onDelete:d,onDisable:g,onEnable:S,onDuplicate:h,onEdit:y,onRestart:v})}):void 0,(0,Be.jsx)("ul",{"aria-hidden":"true",style:E.iconList,children:K.map(((e,t)=>(0,Be.jsx)("li",{children:(0,Be.jsx)(mt,{icon:e})},t)))})]}),(0,Be.jsxs)("div",{style:E.body,children:[(0,Be.jsxs)("div",{style:E.titleWrap,children:[(0,Be.jsx)("span",{style:E.title,children:I}),O]}),o?(0,Be.jsx)("p",{style:E.caption,children:o}):void 0]})]})}function mt(e){const{icon:t}=e;return"property"===t.type||"page"===t.type||"misc"===t.type?(0,Be.jsx)(gt,{color:t.color,icon:t.icon}):"person"===t.type?(0,Be.jsx)(yt,{actorOrGroup:t.actorOrGroup}):"app"===t.type?(0,Be.jsx)(ft,{color:"default",icon:t.icon}):"arrow"===t.type?(0,Be.jsx)(f().I,{icon:We().arrowStraightRightSmallIcon,size:"sm",colorVariant:"secondary"}):"truncate"===t.type?(0,Be.jsx)(ht,{color:t.color,value:t.value}):void(0,te().HB)(t.type)}function gt(e){const{color:t,icon:o}=e,n=St(t);return(0,Be.jsx)("div",{"aria-hidden":"true",style:n.iconWrap,children:o(n.icon)})}function ft(e){const{icon:t}=e,o=St("default");return(0,Be.jsx)("div",{"aria-hidden":"true",style:o.iconAppWrap,children:t(o.iconApp)})}function ht(e){const{color:t,value:o}=e,n=St(t);return(0,Be.jsxs)("div",{style:{...n.iconWrap,...n.truncateWrap},children:["+",o]})}function yt(e){const{actorOrGroup:t}=e,o=St("default");return(0,Be.jsx)("div",{"aria-hidden":"true",style:o.iconPersonWrap,children:"space_permission_group"===t.table?(0,Be.jsx)(ct().o,{group:t,size:26}):(0,Be.jsx)(lt().Ay,{actor:t,avatarSize:26,format:lt().Ay.Format.Inline,isSingle:!1,showRemoveButton:!1,style:{margin:0},hasPersonHoverCard:!1})})}function vt(e){return void 0===e||e<0?ut:e}function St(e){const t="default"===e?"gray":e;return(0,p().IS)((()=>({icon:{fill:ee().Tj[t].icon.secondary,width:He().Ev.sm},iconWrap:{background:ee().Tj[t].background.tertiaryTranslucent,borderRadius:6,padding:6,lineHeight:0},iconApp:{width:He().Ev.sm,height:He().Ev.sm},iconAppWrap:{borderRadius:6,borderWidth:1,borderStyle:"solid",borderColor:ee().Tj.border.primary,padding:6},iconPerson:{display:"block",width:"100%"},iconPersonWrap:{alignItems:"center",display:"flex",height:28,justifyContent:"center",width:28},truncateWrap:{alignItems:"center",background:ee().Tj.gray.background.tertiaryTranslucent,color:ee().Tj.text.secondary,display:"inline-flex",fontSize:12,fontWeight:oe().Wy.medium,height:28,justifyContent:"center",padding:3,width:28}})),[t])}var bt=()=>o(732810),xt=()=>o(310109),wt=()=>o(784892),At=()=>o(842599),It=()=>o(239381),jt=()=>o(519831),Ct=()=>o(798880),Mt=()=>o(201980),Tt=()=>o(500071),kt=()=>o(656476),_t=()=>o(307159),Bt=()=>o(347114),Pt=()=>o(575630),Vt=()=>o(776800),Et=()=>o(359186),Dt=()=>o(217028),Rt=()=>o(383688),Ut=()=>o(880264),Kt=()=>o(112588),Nt=()=>o(477329),Ft=()=>o(27511),Ot=()=>o(214973),Lt=()=>o(133518),Wt=()=>o(798941),zt=()=>o(397785),Ht=()=>o(457050),qt=()=>o(967823),$t=()=>o(71304),Gt=()=>o(798971),Yt=()=>o(423892);const Qt=(0,J().YK)({automationSingleTargetDefault:{defaultMessage:"1 person",id:"database.viewSettings.automationTab.automationSingleTargetDefault"},recurrenceAutomationSummary:{defaultMessage:"Every {frequency}, {actions}",id:"automation.summaryCard.recurrenceCaption"}});function Zt(e){const{intl:t,triggerConfig:o}=e;if(o){if("event"===o.type){const n=function(e){const{collectionStore:t,environment:o,getRecordModel:n,intl:i,schema:a,typecheckResult:r,triggerConfig:s}=e,{event:l}=s,c=t.getSpaceId(),d=[];l.pagesAdded&&d.push(Ot().CH(i));if("none"===l.pagePropertiesEdited.type);else if("any"===l.pagePropertiesEdited.type)d.push(Ot().HG(i));else if("some"===l.pagePropertiesEdited.type||"all"===l.pagePropertiesEdited.type){let e=[];"all"===l.pagePropertiesEdited.type?e=l.pagePropertiesEdited.all??[]:"some"===l.pagePropertiesEdited.type&&(e=l.pagePropertiesEdited.some??[]);for(const s of e){const e=a[s.property];if(!e){d.push(Ot().Pg(i));continue}if(!I().tj[e.type]){d.push((0,Dt().cn)());continue}const{filter:l}=s;if("changes_to_any"===l.operator)d.push(Ot().Od(i,{propertyName:e.name}));else if(E().fZ(l))d.push(Ot().yR(i,{propertyName:e.name}));else if(I().nq(e))if("status"===e.type){if(!E().H$(l)||!E().gc(l)){d.push((0,Yt().zQ)(e));continue}const t=E().V6(l),o=(0,Ft().a)({intl:i,groupValues:t.map((e=>"is_group"===e.type?e.value:void 0)).filter(te().O9),isText:!0,optionValues:t.map((e=>"is_option"===e.type?e.value:void 0)).filter(te().O9),propertySchema:e,tokenFormat:wt().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"});d.push(Ot().Yx(i,{propertyName:e.name,propertyValues:n}))}else if("select"===e.type||"multi_select"===e.type){if(E().fZ(l)||!E().v0(l)&&!E().as(l)||"select"===e.type&&E().as(l)||"multi_select"===e.type&&E().v0(l)){d.push((0,Yt().zQ)(e));continue}const t=Array.isArray(l.value)?l.value:[l.value],o=(0,Nt().$5)({intl:i,isText:!0,optionValues:t.map((e=>e.value)).filter(te().O9),propertySchema:e,tokenFormat:wt().NY.Small}),n=i.formatList(o,{style:"long",type:"disjunction"}),a=(0,Nt().l5)({filter:l,propertySchema:e});if(a){const t=(0,Nt().JI)(a);d.push(t(i,{propertyName:e.name,propertyValues:n}))}}else if("checkbox"===e.type){if(!E().Ui(l)){d.push((0,Yt().zQ)(e));continue}d.push((0,Rt().Hk)({filter:l,propertySchema:e,intl:i}))}else if("person"===e.type){if(!(0,_().I)(l)){d.push((0,Yt().zQ)(e));continue}d.push((0,zt().H)({actorOrGroupModels:(0,Kt().Y)(l,n),operator:l.operator,propertySchema:e,intl:i}))}else if("number"===e.type){if(!M().M(l)){d.push((0,Yt().zQ)(e));continue}d.push((0,Wt().VW)({messageType:"trigger",numberValue:l.value.value,operator:l.operator,propertySchema:e,intl:i}))}else if("email"===e.type||"url"===e.type||"text"===e.type||"phone_number"===e.type||"title"===e.type){if(!V().Y(l)){d.push((0,Yt().zQ)(e));continue}"string_is"!==l.operator&&"string_is_not"!==l.operator&&"string_contains"!==l.operator&&"string_does_not_contain"!==l.operator&&"string_starts_with"!==l.operator&&"string_ends_with"!==l.operator||d.push((0,qt().zl)({messageType:"trigger",textValue:l.value.value,operator:l.operator,propertySchema:e,intl:i}))}else if("relation"===e.type){if(!E().Pq(l)){d.push((0,Yt().zQ)(e));continue}if(D().o2(c,e)){d.push((0,Ut().Mh)({propertySchema:e}));continue}const n=(0,Ht().WE)({collectionStore:t,filter:l}),a=(0,xt().getAllContextValues)(r),s=(0,Ht().eg)({collectionStore:t,filter:l,propertySchema:e});d.push((0,Ht().oE)({availableTokens:s,collectionStore:t,environment:o,operator:l.operator,propertySchema:e,intl:i,relationPages:(0,Ht().Iq)({value:n.value,automationContextValues:a})}))}else(0,te().HB)(e)}}return i.formatList(d,{style:"long",type:"all"===l.pagePropertiesEdited.type?"conjunction":"disjunction"})}({...e,triggerConfig:o}),i=Xt(e);return t.formatMessage({defaultMessage:"When {triggers}, {actions}",id:"automation.summaryCard.caption"},{actions:i,triggers:n})}if("recurrence"===o.type){if(!o.recurrence)return;const n=(0,se().LS)({intl:t,recurrence:o.recurrence}),i=Xt(e);return t.formatMessage(Qt.recurrenceAutomationSummary,{frequency:n,actions:i})}"button"===o.type||(0,te().HB)(o)}}function Xt(e){var t,o,n;const{actionStores:i,collectionStore:a,environment:r,intl:s,schema:l,typecheckResult:c}=e,d=[];for(const w of i)if(w.isType("slack_notification"))d.push((0,Be.jsx)(J().sA,{defaultMessage:"notify {channel}",id:"CollectionSettingsAutomationsView.summaryCard.slackAction",values:{channel:(0,Be.jsx)(Tt().D,{actionStore:w})}}));else if(w.isType("update_pages")){const e=w.getConfig(),t=null==e?void 0:e.properties,o=null==e?void 0:e.values,n=null==e?void 0:e.target;if(!t||0===t.length||!n)continue;if("collection"===n.type)if((0,Z().Z2)(n.collection,a.pointer))d.push((0,Be.jsx)(J().sA,{defaultMessage:"edit pages in this collection",id:"automation.summaryCard.updatePages.sameCollection"}));else{const e=bt().m.createChildStore(a,n.collection),t=(0,$t().tS)({environment:r,intl:s,store:e});d.push((0,Be.jsx)(J().sA,{defaultMessage:"edit pages in {collectionTitle}",id:"automation.summaryCard.updatePages.differentCollection",values:{collectionTitle:t}}))}else if("variable"===n.type){const e=t[0],i=null==o?void 0:o[e],r=ro({collectionSchema:l,propertyId:e,variableId:n.id,typecheckResult:c,actionStore:w});if(!r){d.push(Ot().cC(s));continue}if(!i)continue;if(I().I3(r))if("person"===r.type)d.push((0,Be.jsx)(ao,{collectionStore:a,contextValues:(0,xt().getAllContextValues)(c),propertyActionValue:i,propertySchema:r}));else if("status"===r.type){const e=(0,Be.jsx)(Jt,{propertyActionValue:i,propertySchema:r});e&&d.push(e)}else if("select"===r.type||"multi_select"===r.type)d.push((0,Be.jsx)(eo,{propertyActionValue:i,propertySchema:r}));else if("checkbox"===r.type)d.push((0,Be.jsx)(to,{propertyActionValue:i,propertySchema:r}));else if("relation"===r.type)d.push((0,Be.jsx)(oo,{collectionStore:a,propertyActionValue:i,propertySchema:r}));else if("date"===r.type){const t=(0,Be.jsx)(no,{automationActionId:w.id,collectionStore:a,propertyActionValue:i,propertyId:e,propertySchema:r});t&&d.push(t)}else"number"===r.type||"phone_number"===r.type||"text"===r.type||"title"===r.type||"email"===r.type||"url"===r.type?d.push((0,Be.jsx)(io,{automationActionId:w.id,propertyActionValue:i,propertySchema:r})):(0,te().HB)(r);else d.push((0,Dt().cn)())}}else if(w.isType("create_page")){var u;const e=null===(u=w.getConfig())||void 0===u?void 0:u.collection;if(!e)continue;e.id===a.pointer.id?d.push((0,Be.jsx)(J().sA,{defaultMessage:"create a page in this database",id:"automation.summaryCard.createPageThisDatabase"})):d.push((0,Be.jsx)(J().sA,{defaultMessage:"create a page in another database",id:"automation.summaryCard.createPageAnotherDatabase"}))}else if(w.isType("define_variables")){var p;d.push((0,Be.jsx)(J().sA,{defaultMessage:"define {numVariables} custom {numVariables, plural, one {variable} other {variables}}",values:{numVariables:(null===(p=w.getConfig())||void 0===p||null===(p=p.variableIds)||void 0===p?void 0:p.length)??0},id:"automation.summaryCard.defineVariables"}))}else if(w.isType("send_in_app_notification")){var m;const e=null===(m=w.getConfig())||void 0===m?void 0:m.target;if(!e)continue;const i=e.type;switch(i){case"formula":const r=(0,Mt().Fbh)(null===(t=e.value)||void 0===t?void 0:t.value),l=(0,Mt().FAS)(null===(o=e.value)||void 0===o?void 0:o.value),c=(0,Mt().kNd)(null===(n=e.value)||void 0===n?void 0:n.value),u=e=>{const t=w.getSpaceId()??"";return{table:Ct().oo,id:e,spaceId:t}},p=e=>({table:X().n,id:(0,X().gK)({spacePermissionGroupId:e.groupId,spaceId:e.spaceId}),spaceId:e.spaceId}),m=[...r.map((e=>u(e))),...l.map((e=>p(e)))],g=m.map((e=>e.table===Ct().oo?{type:"actor",model:(0,A().xC)({getRecordModel:a.getRecordModel,pointer:e})}:e.table===X().n?{type:"group",model:a.getRecordModel(e)}:void(0,te().HB)(e))).filter(te().O9).map((e=>(0,Gt().Mn)(s,e)));d.push((0,Be.jsx)(J().sA,{defaultMessage:"{numTargets, plural, one {send a notification to {singleTarget}} other {send a notification to {numTargets} people}}",values:{numTargets:m.length+c.length,singleTarget:m.length>0?g[0]:me().dC.created_by},id:"automation.summaryCard.sendNotificationUserTarget"}));break;case"property":if(!e.propertyId)break;let f;const h=a.getSchema()[e.propertyId];f=h?h.name??me().dC[h.type]:Ot().CV.unknownPropertyTitle.defaultMessage,d.push((0,Be.jsx)(J().sA,{defaultMessage:"send a notification to {propertyDisplayName}",values:{propertyDisplayName:f},id:"automation.summaryCard.sendNotificationPropertyTarget"}));break;default:(0,te().HB)(i)}}else if(w.isType("send_gmail_notification")){var g,f,h,y;const e=w.getConfig()??{},{to:t,cc:o,bcc:n}=e;if(null==t||null===(g=t.value)||void 0===g||!g.value)continue;if("formula"===(null==t||null===(f=t.value)||void 0===f?void 0:f.type)||"formula"===(null==o||null===(h=o.value)||void 0===h?void 0:h.type)||"formula"===(null==n||null===(y=n.value)||void 0===y?void 0:y.type))d.push((0,Be.jsx)(J().sA,{defaultMessage:"send an email to recipients based on a formula",id:"automation.summaryCard.sendGmailNotificationUserFormulaTarget"}));else{var v,S,b,x;const e=[...null===(v=t.value)||void 0===v?void 0:v.value,...(null==o||null===(S=o.value)||void 0===S?void 0:S.value)||[],...(null==n||null===(b=n.value)||void 0===b?void 0:b.value)||[]],i=(0,Mt().Fbh)(e),r=(0,Mt().kNd)(null===(x=t.value)||void 0===x?void 0:x.value),l=(0,Mt().IQD)(e),c=e=>{const t=w.getSpaceId()??"";return{table:Ct().oo,id:e,spaceId:t}},u=i.map((e=>(0,A().xC)({getRecordModel:a.getRecordModel,pointer:c(e)}))).filter(te().O9).map((e=>(0,A().lR)(s,e))),p=(0,At().C3)((0,Mt().k4p)(e));u.push(...p);const m=s.formatMessage(Qt.automationSingleTargetDefault);d.push((0,Be.jsx)(J().sA,{defaultMessage:"{numTargets, plural, one {send an email to {singleTarget}} other {send an email to {numTargets} people}}",values:{numTargets:new Set(u).size+r.length+l.length,singleTarget:m},id:"automation.summaryCard.sendGmailNotificationUserTarget"}))}}else w.isType("http_request")&&d.push((0,Be.jsx)(J().sA,{defaultMessage:"send a webhook",id:"automation.summaryCard.sendWebRequest"}));return s.formatList(d,{style:"long",type:"conjunction"})}function Jt(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,J().tz)(),i=(0,Vt().qC)({intl:n,propertySchema:o,value:t.value});return i||null}function eo(e){const{propertyActionValue:t,propertySchema:o}=e,n=(0,J().tz)();return(0,u().K8)((()=>(0,Pt().cI)({intl:n,limit:Bt().S,propertySchema:o,operator:null==t?void 0:t.action,value:t.value})),[n,null==t?void 0:t.action,t.value,o])}function to(e){const{propertyActionValue:t,propertySchema:o}=e;return(0,kt().rD)({propertySchema:o,value:t.value})}function oo(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n}=e,i=(0,J().tz)(),a=(0,c().v3)(),{typecheckResult:r}=(0,ae().q8)(),s=o.value,l=(0,xt().getAllContextValues)(r),d=(0,Ht().Iq)({automationContextValues:l,limit:n.limit,value:s});return(0,u().K8)((()=>(0,Ht().UW)({collectionStore:t,environment:a,intl:i,operator:null==o?void 0:o.action,propertySchema:n,relationPages:d,value:s})),[t,a,i,null==o?void 0:o.action,n,d,s])}function no(e){const{automationActionId:t,collectionStore:o,propertyActionValue:n,propertyId:a,propertySchema:r}=e,s=(0,J().tz)(),l=n.value,c=(0,Lt().F)({actionId:t}),d=(0,i.useMemo)((()=>({type:"collection",collectionStore:o,property:a})),[o,a]),p=(0,u().K8)((()=>(0,_t().A)({intl:s,propertySchema:r,typecheckContextValues:c,value:l,valueContext:d})),[s,r,c,l,d]);return p||null}function io(e){const{automationActionId:t,propertyActionValue:o,propertySchema:n}=e,i=(0,c().v3)(),a=(0,p().DP)(),{automationStore:r}=(0,ae().q8)(),s=(0,Lt().F)({actionId:t}),l=(0,u().K8)((()=>(0,Et().hF)({automationStore:r,environment:i,propertySchema:n,theme:a,typecheckContextValues:s,value:o.value})),[r,i,o.value,n,a,s]);return l||null}function ao(e){const{collectionStore:t,propertyActionValue:o,propertySchema:n,contextValues:i}=e,a=(0,J().tz)(),r=(0,u().K8)((()=>(0,zt().hs)({getRecordModel:t.getRecordModel,contextValues:i,intl:a,operator:o.action,propertySchema:n,value:o.value})),[t.getRecordModel,a,o.action,o.value,n,i]);return r||null}function ro({collectionSchema:e,propertyId:t,variableId:o,typecheckResult:n,actionStore:i}){const a=(0,It()._H)((0,xt().getAllContextValues)(n),o),r=a?(0,It().XZ)(a.type):void 0;let s=e;if(r&&r.table===jt().Vl){s=bt().m.createChildStore(i,r).getSchema()}return s[t]}var so=()=>o(906745),lo=()=>o(265060),co=()=>o(293529),uo=()=>o(995847),po=()=>o(680977),mo=()=>o(554283),go=()=>o(244828);const fo=(0,J().YK)({tryRepeatingTriggersTitle:{defaultMessage:"Try repeating triggers",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersTitle"},tryRepeatingTriggersBody:{defaultMessage:"Automatically create and edit items on a schedule",id:"database.viewSettings.automationTab.automationWhatsNew.tryRepeatingTriggersBody"},dismissButtonAriaLabel:{defaultMessage:"Close",id:"database.viewSettings.automationTab.automationWhatsNew.dismissButtonAriaLabel"},slackPricingChangeTitle:{defaultMessage:"Notice",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeTitle"},slackPricingChangeBody:{defaultMessage:"A Plus plan will be required to access this feature starting August 13",id:"database.viewSettings.automationTab.automationWhatsNew.slackPricingChangeBody"}}),ho={try_repeating_triggers:{title:fo.tryRepeatingTriggersTitle,body:fo.tryRepeatingTriggersBody,url:"https://www.notion.com/help/database-automations#database-automation-triggers"},slack_pricing_change:{title:fo.slackPricingChangeTitle,body:fo.slackPricingChangeBody,url:"http://notion.com/blog/notion-ai-for-work"}};function yo({collectionStoreId:e,surface:t,type:o,closeable:n}){const[s,l]=(0,i.useState)(!0),[d,m]=(0,mo().B)(),g=(0,c().v3)(),f=(0,J().tz)(),h=(0,u().K8)((()=>{const{currentUserSettingsStore:e}=r().default.state;if(!e||!e.isReady())return!1;const t=e.getSettingsStore().getKeyStore(`has_clicked_${o}_prompt`).getValue(),n=e.getSettingsStore().getKeyStore(`has_clicked_close_${o}_prompt`).getValue();if(t||n)return!1;const i=e.getSettingsStore().getKeyStore(`seen_${o}_prompt_at`).getValue();if((0,te().O9)(i)){const e=so().DateTime.fromMillis(i),t=so().DateTime.fromMillis(so().DateTime.now().toMillis()).diff(e,["weeks"]),o=t.toObject().weeks??0;return(0,te().O9)(t.toObject().weeks)&&o<=5}return go().createAndCommit({userAction:"AutomationsView.markPromptFirstSeen",environment:g,canUndo:!0,perform:t=>{(0,po().m)({userSettingsStore:e,transaction:t,data:{[`seen_${o}_prompt_at`]:so().DateTime.now().toMillis()}})}}),!0}),[g,o]),y=(0,p().eP)(),v=(0,p().IS)((()=>({button:{borderRadius:10,display:"flex",flexDirection:"column",position:"relative",background:ee().Tj.background.tertiaryTranslucent,padding:"9px 12px"},hoveredButton:{background:(0,he().i)({color:ee().Tj.background.tertiaryTranslucent,mode:y})},pressedButton:{backgroundColor:(0,he().yZ)({color:ee().Tj.background.tertiaryTranslucent,mode:y})},title:{fontWeight:oe().Wy.medium,fontSize:oe().J.UIRegular.desktop,alignItems:"center",display:"flex",color:ee().Tj.text.primary,lineHeight:"20px",flexDirection:"row",gap:"2px",marginBottom:6},description:{fontWeight:oe().Wy.regular,color:ee().Tj.text.secondary,fontSize:"14px",lineHeight:"20px"},dismissButton:{position:"absolute",insetInlineEnd:6,top:6,borderRadius:4,display:"flex",height:20,justifyContent:"center",alignItems:"center",width:20,visibility:m?"visible":"hidden"},dismissIcon:{width:He().Ev.xs,height:He().Ev.xs}})),[m,y]),S=(0,i.useCallback)((()=>{if(!e)return;(0,a().u)({environment:g,event:{eventName:"automation_learn_click",eventProperties:{collection_id:e,specific_feature:o,surface:t}}});const{currentUserSettingsStore:i}=r().default.state;i&&i.isReady()&&n&&go().createAndCommit({userAction:"AutomationsView.markPromptLinkClicked",environment:g,canUndo:!0,perform:e=>{(0,po().m)({userSettingsStore:i,transaction:e,data:{[`has_clicked_${o}_prompt`]:!0}})}})}),[e,o,t,g,n]),b=(0,i.useCallback)((i=>{if(!n)return;if(i.preventDefault(),i.stopPropagation(),l(!1),!e)return;(0,a().u)({environment:g,event:{eventName:"automation_close_learn_prompt",eventProperties:{collection_id:e,specific_feature:o,surface:t}}});const{currentUserSettingsStore:s}=r().default.state;s&&s.isReady()&&go().createAndCommit({userAction:"AutomationsView.markPromptDismissed",environment:g,canUndo:!0,perform:e=>{(0,po().m)({userSettingsStore:s,transaction:e,data:{[`has_clicked_close_${o}_prompt`]:!0}})}})}),[e,g,t,o,n]);return s&&h?(0,Be.jsxs)(he().Ay,{style:v.button,hoveredStyle:v.hoveredButton,pressedStyle:v.pressedButton,ref:d,href:ho[o].url,external:!0,onClick:S,children:[(0,Be.jsxs)("div",{style:v.title,children:[(0,Be.jsx)(J().sA,{...ho[o].title}),(0,Be.jsx)(lo().Q,{iconGroup:co().w,variantName:"small",size:"xs",colorVariant:"secondary"})]}),(0,Be.jsx)("div",{style:v.description,children:(0,Be.jsx)(J().sA,{...ho[o].body})}),n?(0,Be.jsx)(Se().A,{size:"sm",style:v.dismissButton,onClick:b,ariaLabel:f.formatMessage(fo.dismissButtonAriaLabel),icon:uo().xMarkSmallIcon,iconStyle:v.dismissIcon}):null]}):null}const vo=(0,J().YK)({automationTabTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.title"},automationNewAutomationTitle:{defaultMessage:"New automation",id:"database.viewSettings.automationTab.newAutomationTitle"},automationUpgradeTitle:{defaultMessage:"Upgrade",id:"database.viewSettings.automationTab.upgradeTitle"},automationLearnAutomationTitle:{defaultMessage:"Learn about automations",id:"database.viewSettings.automationTab.learnAutomationTitle"},automationEmptyViewEditorPublic:{defaultMessage:"Automatically edit properties, create pages, send updates, and more",id:"database.viewSettings.automationTab.automationEmptyViewEditorPublic"},automationEmptyViewReadOnly:{defaultMessage:"You’re a content viewer. Content viewers cannot create automations.",id:"database.viewSettings.automationTab.automationEmptyViewReadOnly"},automationEmptyViewContentEditor:{defaultMessage:"You’re a content editor. Content editors can edit pages, but you need full access to create automations.",id:"database.viewSettings.automationTab.automationEmptyViewContentEditor"},automationSearchPlaceholder:{defaultMessage:"Search automations…",id:"database.viewSettings.automationTab.automationSearchPlaceholder"},automationInvalidPausedCaption:{defaultMessage:"Fix any errors or remove failing steps to enable this automation",id:"database.viewSettings.automationTab.automationInvalidPausedCaption"},automationInvalidActiveCaption:{defaultMessage:"Fix any errors or remove failing steps to prevent this automation from pausing on failure",id:"database.viewSettings.automationTab.automationInvalidActiveCaption"},automationRestartSuccessMessage:{defaultMessage:"Restarted automation successfully",id:"automations.buttonTrigger.restartSuccessMessage"},agentsAndAutomationsTitle:{defaultMessage:"Agents and automations",id:"database.viewSettings.automationTab.agentsAndAutomationsTitle"},agentsSectionTitle:{defaultMessage:"Agents",id:"database.viewSettings.automationTab.agentsSection.title"},automationsSectionTitle:{defaultMessage:"Automations",id:"database.viewSettings.automationTab.automationsSection.title"}});function So(e){var t;const{collectionContextStore:o,collectionSettingsStore:g,fullHeight:y,tabSettings:A}=e,I=(0,c().v3)(),j=(0,J().tz)(),[C,M]=(0,i.useState)(""),T=(0,u().K8)((()=>o.collectionStore()),[o]),k=(0,u().K8)((()=>o.collectionViewBlockStore()),[o]),_=(0,u().K8)((()=>T&&T.id),[T]),B=(0,u().K8)((()=>null==T?void 0:T.getSchema()),[T]),P=(0,u().K8)((()=>null==T?void 0:T.getFormat()),[T]),V=(0,u().K8)((()=>function(e){const{collectionStore:t,collectionViewBlockStore:o}=e;if(!t||!o)return[];const n=t.getAutomationStores(),i=[];for(const a of n){const e=a.getModel();null!=e&&e.getAlive()&&((0,pe().p)(a)&&i.push(a))}return i}({collectionStore:T,collectionViewBlockStore:k})),[T,k]),E=(0,u().K8)((()=>function(e){const{automationStores:t,collectionSchema:o,intl:i}=e,a=new Map,r=[];for(const n of t){var s;if(!n.isDefined())continue;const e=[],t=n.getName();void 0!==t&&e.push(t);const l=null===(s=n.getOwnerStore())||void 0===s?void 0:s.getDisplayName(i);if(void 0!==l&&e.push(l),n.isTriggerType("event")){const t=n.getEventConfiguration(),a=null==t?void 0:t.pagePropertiesEdited;let r;if("some"===(null==a?void 0:a.type)?r=a.some:"all"===(null==a?void 0:a.type)&&(r=a.all),r)for(const n of r){const t=null==o?void 0:o[n.property];t&&e.push(`${t.name} ${me().dC[t.type]}`)}const s=Ao(n.getActionStores(),o,i);e.push(...s)}else if(n.isTriggerType("recurrence")){const t=n.getRecurrence();t&&e.push((0,se().LS)({recurrence:t,intl:i,leadingPhrase:"every"}));const a=Ao(n.getActionStores(),o,i);e.push(...a)}const c=e.join(" ");a.set(n.id,c),r.push(c)}return function(e){const o=new Set(n().filter(e,r).map((({original:e})=>e)));return t.filter((e=>{if(!e.isTriggerType("event")&&!e.isTriggerType("recurrence"))return!1;const t=a.get(e.id);return!(!t||!o.has(t))}))}}({automationStores:V,collectionSchema:B,intl:j})),[V,B,j]),D=(0,u().K8)((()=>E(C)),[E,C]),R=V.find((e=>void 0!==(null==e?void 0:e.getSpaceId()))),U=(0,d().S)(),{spaceId:K,currentUserStoreId:F}=(0,u().K8)((()=>{var e,t;return{spaceId:(null==R?void 0:R.getSpaceId())??(null==U||null===(e=U.spaceStore)||void 0===e?void 0:e.id),currentUserStoreId:null===(t=r().default.state.currentUserStore)||void 0===t?void 0:t.id}}),[R,null==U||null===(t=U.spaceStore)||void 0===t?void 0:t.id]),O=(0,Re().P)({name:"premium_automations",spaceId:K,userId:F}),L=(0,Ue()._)({name:"premium_automations",spaceId:K,userId:F}),W=(0,le().k)({upsell:null==L?void 0:L.upsell,from:"automations_list_upgrade_button"}),[{value:H}]=(0,N().Yb)((async()=>await ue().rc({collectionStore:T})),[T]),$=(0,i.useCallback)((()=>{ce().js({environment:I,collectionSettingsStore:g,collectionContextStore:o})}),[I,g,o]),G=(0,i.useCallback)((e=>M(e.target.value)),[]),Y=(0,i.useCallback)((()=>{_&&(0,a().u)({environment:I,event:{eventName:"automation_learn_click",eventProperties:{collection_id:_}}})}),[I,_]);(0,i.useEffect)((()=>{_&&(0,a().u)({environment:I,event:{eventName:"automation_list_view",eventProperties:{source:A.source,collection_id:_}}})}),[I,_,A]);const[Q,X]=i.useState(!1),te=(0,u().K8)((()=>function(e){var t;const o=null===(t=r().default.state.currentUserStore)||void 0===t?void 0:t.pointer,n=[],i=[];for(const a of e){const e=a.getCreatedByPointer();o&&e&&Z().L3.isEqual(o,e)?n.push(a):i.push(a)}return n.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),i.sort(((e,t)=>t.getLastEditedTime()-e.getLastEditedTime())),{currentUserAutomations:n,otherUserAutomations:i}}(D)),[D]),oe=(0,i.useMemo)((()=>{const{currentUserAutomations:e,otherUserAutomations:t}=te;return Q?[...e,...t]:e.length>0?e:t}),[te,Q]),ne=D.length-oe.length,ie=!Q&&ne>0,ae=oe.length>0,fe=!ae&&!(""!==C),he=(0,u().O$)(m().e),ye=O&&H&&he,{createdByMe:ve,inDatabase:Se}=(0,_e().X)({collectionContextStore:o}),be=(0,s().X)("database_agents")&&(ve.length>0||Se.length>0),xe=(0,p().IS)((()=>({buttonList:{display:"flex",flexDirection:"column",flexShrink:1,gap:12,overflow:"hidden auto",paddingBlockEnd:l().A.isMobile?0:12,paddingBlockStart:l().A.isMobile?12:0,paddingInline:12},emptyViewWrap:{paddingBlockEnd:12,paddingInline:12},menuScrollerStyle:{marginBlockStart:l().A.isMobile?12:8},wrap:{display:"flex",flexDirection:"column"},showMoreButtonContainer:{marginInlineStart:12,marginBottom:12,marginInlineEnd:"auto"},showMoreButtonContent:{fontSize:12},noResultsTitle:{color:ee().Tj.text.secondary,fontSize:12,margin:0},createSection:{paddingBlock:20},createButtonWrapper:{paddingInline:12},createButton:{width:"100%",display:"flex",gap:6},headerContainer:{alignItems:"center",display:"flex",gap:4},whatsNewPrompt:{marginTop:8},agentsSectionTitle:{paddingInline:12,marginTop:4,marginBottom:12},automationsSectionTitle:{paddingInline:12,marginTop:18}})),[]);return T&&B&&P&&k?(0,Be.jsxs)(de().A,{...e,fullHeight:y,header:!fe&&(0,Be.jsx)(w().A,{children:(0,Be.jsx)(ge().Ay,{focusInitial:!l().A.isMobile,onChange:G,placeholder:j.formatMessage(vo.automationSearchPlaceholder),showClearButton:!0,value:C})}),footer:(0,Be.jsxs)(w().A,{style:xe.createSection,topBorder:!1,children:[H?(0,Be.jsx)("div",{style:xe.createButtonWrapper,children:(0,Be.jsxs)(S().A,{colorPalette:"blue",style:xe.createButton,onClick:$,disabled:!he,children:[(0,Be.jsx)(f().I,{icon:z().plusSmallIcon,size:"sm"}),(0,Be.jsx)(J().sA,{...vo.automationNewAutomationTitle})]})}):void 0,!H&&null!=L&&L.upsell?(0,Be.jsx)("div",{style:xe.createButtonWrapper,children:(0,Be.jsx)(Ke().K,{source:"automations_list_upgrade_button",display:"button",upsell:L.upsell,featureFlag:"upgrade_system_db_properties_automations",spaceStore:null==U?void 0:U.spaceStore,children:(0,Be.jsx)(S().A,{colorPalette:"blue",style:xe.createButton,onClick:W,disabled:!he,children:(0,Be.jsx)(J().sA,{...vo.automationUpgradeTitle})})})}):void 0]}),menuScrollerStyle:xe.menuScrollerStyle,title:ae||C?(0,Be.jsxs)("div",{style:xe.headerContainer,children:[(0,Be.jsx)(J().sA,{...be?vo.agentsAndAutomationsTitle:vo.automationTabTitle}),(0,Be.jsx)(x().m,{placement:"right",renderTooltip:()=>(0,Be.jsx)(J().sA,{...vo.automationLearnAutomationTitle}),render:e=>(0,Be.jsx)(h().N,{...e,href:"https://www.notion.so/help/database-automations",external:!0,onClick:Y,children:(0,Be.jsx)(f().I,{icon:q().questionMarkCircleSmallIcon,size:"sm",colorVariant:"secondary"})})})]}):null,children:[be?(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)("div",{style:xe.agentsSectionTitle,children:(0,Be.jsx)(b().D,{styleKey:"captionMedium",colorVariant:"secondary",children:(0,Be.jsx)(J().sA,{...vo.agentsSectionTitle})})}),(0,Be.jsx)(Ve,{collectionContextStore:o})]}):null,(0,Be.jsxs)("div",{style:xe.wrap,children:[be?(0,Be.jsx)("div",{style:xe.automationsSectionTitle,children:(0,Be.jsx)(b().D,{styleKey:"captionMedium",colorVariant:"secondary",children:(0,Be.jsx)(J().sA,{...vo.automationsSectionTitle})})}):null,fe?(0,Be.jsxs)("div",{style:xe.emptyViewWrap,children:[(0,Be.jsx)(bo,{collectionStore:T}),ye?(0,Be.jsx)("div",{style:xe.whatsNewPrompt,children:(0,Be.jsx)(yo,{surface:"empty_automations_view",type:"try_repeating_triggers",collectionStoreId:_,closeable:!0})}):void 0]}):(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsxs)("div",{style:xe.buttonList,children:[ye?(0,Be.jsx)("div",{style:xe.whatsNewPrompt,children:(0,Be.jsx)(yo,{surface:"list_automations_view",type:"try_repeating_triggers",collectionStoreId:_,closeable:!0})}):void 0,oe.length>0?oe.map(((e,t)=>(0,Be.jsx)(re().o,{automationStore:e,children:(0,Be.jsx)(xo,{collectionContextStore:o,collectionStore:T,collectionSettingsStore:g,focused:!1,schema:B})},e.id))):(0,Be.jsx)("p",{style:xe.noResultsTitle,children:(0,Be.jsx)(J().sA,{defaultMessage:"No results",id:"collectionSettings.automationsView.noResults"})})]}),ie?(0,Be.jsx)(v().p,{colorPalette:"gray",size:"xs",style:xe.showMoreButtonContainer,onClick:e=>{e.stopPropagation(),X(!0)},children:(0,Be.jsx)("div",{style:xe.showMoreButtonContent,children:(0,Be.jsx)(J().sA,{id:"collectionSettings.automationsView.showMore",defaultMessage:"Show {number} more",values:{number:ne}})})}):void 0]})]})]}):null}function bo(e){const{collectionStore:t}=e,o=(0,c().v3)(),n=(0,p().IS)((()=>({wrap:{alignItems:"center",display:"flex",flexDirection:"column",gap:7.5,justifyContent:"center",minHeight:250,textAlign:"center"},title:{fontSize:17,fontWeight:oe().Wy.medium,margin:0},copy:{color:ee().Tj.text.secondary,fontSize:14,margin:0,lineHeight:1.5}})),[]),i=(0,u().K8)((()=>t.getRole()),[t]);let a;return a=(0,u().K8)((()=>Boolean((0,De().qb)(o,t,t.getSpaceStore()))),[t,o])||!i||"editor"===i?vo.automationEmptyViewEditorPublic:"reader"===i||"comment_only"===i?vo.automationEmptyViewReadOnly:"content_only_editor"===i||"read_and_write"===i?vo.automationEmptyViewContentEditor:vo.automationEmptyViewEditorPublic,(0,Be.jsxs)("div",{style:n.wrap,children:[(0,Be.jsx)("div",{"aria-hidden":!0,children:(0,Be.jsx)(f().I,{icon:L().v,size:24,colorPalette:"yellow",colorVariant:"accentPrimary"})}),(0,Be.jsx)("p",{style:n.title,children:(0,Be.jsx)(J().sA,{...vo.automationTabTitle})}),(0,Be.jsx)("p",{style:n.copy,children:(0,Be.jsx)(J().sA,{...a})})]})}function xo(e){const{collectionContextStore:t,collectionStore:o,collectionSettingsStore:n,focused:a,schema:r}=e,s=(0,J().tz)(),l=(0,c().v3)(),{automationStore:d}=(0,ae().q8)(),{actionIcons:p,actionStores:m,canUserManageAutomation:f,canUserRemoveAutomation:h,isAutomationEnabled:y,isPersistedStateComplete:v,title:S,triggerConfig:b,triggerIcons:x}=function({collectionStore:e,schema:t}){const o=(0,J().tz)(),{automationStore:n,typecheckResult:i}=(0,ae().q8)(),a=(0,u().K8)((()=>ue().Qn({automationStore:n,collectionStore:e,typecheckResult:i})),[n,e,i]),r=(0,u().K8)((()=>n.getActionStores()),[n]),s=(0,u().K8)((()=>n.getTriggerStore().getValue()),[n]),l=(0,u().K8)((()=>s?function(e){const{automationStore:t,schema:o,triggerConfig:n,collectionStore:i}=e,a=[];if("event"===n.type){n.event.pagesAdded&&a.push({color:"blue",icon:z().plusSmallIcon,type:"page"});const e=n.event.pagePropertiesEdited;if("any"===e.type)a.push({color:"blue",icon:W().pencilLineSmallIcon,type:"misc"});else if("some"===e.type||"all"===e.type){let n=[];"some"===e.type?n=e.some??[]:"all"===e.type&&(n=e.all??[]);for(const e of n){const n=o[e.property],r=e.filter;if(!n)continue;if(!I().tj[n.type]){a.push({color:"gray",icon:wo(n.type),type:"property"});continue}const s=D().DD(n),l=D().lx(n),c=B(n),d=T().A(n),u=(0,R().DY)(n.type),p=D().nC(n);if("changes_to_any"===r.operator)a.push({color:s||l?"gray":"blue",icon:wo(n.type),type:"property"});else if(s&&!E().fZ(r)&&E().H$(r)){const e=E().V6(r);if(e.length>1)a.push({color:"gray",icon:wo(n.type),type:"property"});else if(1===e.length){const t=e[0];if("is_group"===t.type){const e=(n.groups??[]).find((e=>e.name===t.value));e&&a.push({color:e.color??"gray",icon:wo(n.type),type:"property"})}else{const e=(n.options??[]).find((e=>e.value===t.value));e&&a.push({color:e.color??"gray",icon:wo(n.type),type:"property"})}}}else if(l&&(E().v0(r)||E().as(r))){const e=E().fZ(r)?[]:E().v0(r)?E().Zl(r):E().SM(r);if(1===e.length){const t=e[0],o=(n.options??[]).find((e=>e.value===t.value));o&&a.push({color:o.color??"gray",icon:wo(n.type),type:"property"})}else(e.length>1||0===e.length)&&a.push({color:"gray",icon:wo(n.type),type:"property"})}else if(c&&(0,_().I)(r)){const e=E().fZ(r)?[]:(0,k().W)(r);if(1===e.length){if(!E().fZ(r)){const e=(0,k().W)(r)[0];if("exact"===e.type&&e.value)if("space_permission_group"===e.value.table){const o=(0,X().S4)({spacePermissionGroupId:e.value.id,spaceId:e.value.spaceId}),i=t.getRecordModel(o);i?a.push({actorOrGroup:i,type:"person"}):a.push({color:"gray",icon:wo(n.type),type:"property"})}else{const t=(0,A().xC)({pointer:e.value,getRecordValue:i.getRecordValue});a.push({actorOrGroup:t,type:"person"})}}}else(e.length>1||0===e.length)&&a.push({color:"gray",icon:wo(n.type),type:"property"})}else(d&&M().M(r)||u&&V().Y(r)||p&&E().Pq(r))&&a.push({color:"is_empty"===r.operator?"gray":"blue",icon:wo(n.type),type:"property"})}}}else"recurrence"===n.type?a.push({color:"blue",icon:G().Y,type:"misc"}):"button"===n.type||(0,te().HB)(n);return a}({automationStore:n,schema:t,triggerConfig:s,collectionStore:e}):[]),[t,s,e,n]),c=(0,u().K8)((()=>function(e){const{automationStore:t,actionStores:o,collectionStore:n,schema:i}=e,a=[];for(const d of o)if(d.isType("slack_notification"))a.push({icon:Q().slackIcon,type:"app"});else if(d.isType("update_pages")){const e=d.getConfig(),o=(null==e?void 0:e.properties)??[];if(1===o.length){var r,s;const c=o[0],d=i[c],u=null==e||null===(r=e.values)||void 0===r?void 0:r[c];if(!d||!u)continue;if(!I().I3(d)){a.push({color:"gray",icon:wo(d.type),type:"property"});continue}const p=(0,K().fromSimpleFormulaArrayValue)(null===(s=u.value)||void 0===s?void 0:s.value);if(D().DD(d)){const e=(d.options||[]).find((e=>e.value===p[0]));e&&a.push({color:e.color??"gray",icon:wo(d.type),type:"property"})}else if(D().lx(d))if(1===p.length){const e=(d.options||[]).find((e=>e.value===p[0]));e&&a.push({color:e.color??"gray",icon:wo(d.type),type:"property"})}else p.length>1&&a.push({color:"gray",icon:wo(d.type),type:"property"});else if(B(d)){var l;const e=(0,P().e)({textValue:null===(l=u.value)||void 0===l?void 0:l.value,propertySchema:d,blockCreatorPointer:void 0,convertGroupPointersToBeComposite:!0}).map((e=>"space_permission_group"===e.table?t.getRecordModel(e):(0,A().xC)({pointer:e,getRecordValue:n.getRecordValue}))).filter(te().O9);1===e.length?a.push({actorOrGroup:e[0],type:"person"}):a.push({color:"gray",icon:wo(d.type),type:"property"})}else a.push({color:"gray",icon:wo(d.type),type:"property"})}else o.length>1&&a.push({color:"gray",icon:W().pencilLineSmallIcon,type:"misc"})}else if(d.isType("create_page")){var c;(null===(c=d.getConfig())||void 0===c?void 0:c.collection)&&a.push({color:"blue",icon:z().plusSmallIcon,type:"page"})}else d.isType("send_in_app_notification")?a.push({color:"blue",icon:F().k,type:"misc"}):d.isType("define_variables")?a.push({color:"gray",icon:$().H,type:"misc"}):d.isType("send_gmail_notification")?a.push({icon:Y().gmailIcon,type:"app"}):d.isType("http_request")&&a.push({color:"gray",icon:O().C,type:"misc"});return a}({actionStores:r,automationStore:n,collectionStore:e,schema:t})),[t,e,r,n]),d=(0,u().K8)((()=>n.getNameWithDefault(o)),[o,n]),p=(0,u().K8)((()=>n.isActive()),[n]),m=(0,u().K8)((()=>ue().Gz({automationStore:n,collectionStore:e})),[n,e]),[{value:g}]=(0,N().Yb)((async()=>await ue().TT({actionStores:r,automationStore:n,collectionStore:e})),[r,n,e]);return{isPersistedStateComplete:a,actionStores:r,triggerConfig:s,title:d,isAutomationEnabled:p,canUserManageAutomation:g,canUserRemoveAutomation:m,triggerIcons:l,actionIcons:c}}({collectionStore:o,schema:r}),w=function({isPersistedStateComplete:e,isAutomationEnabled:t,collectionStore:o}){const{automationStore:n,typecheckResult:a}=(0,ae().q8)(),r=(0,u().K8)((()=>{if(n.isTriggerType("event")){return!n.getTrigger()||ue().l({automationStore:n,collectionStore:o})}return!1}),[n,o]),s=(0,i.useMemo)((()=>{if(a.error)return!0;const e=a.value.actionValidationFailures;return Object.values(e).flat().length>0}),[a]);return(0,u().K8)((()=>{var o;const i=null===(o=n.getModel())||void 0===o?void 0:o.getLastFailedReason();return s||r||!e?"invalid":!t&&i?"failing":t?"success":(0,se().NH)(n)?"expired":"paused"}),[n,s,r,e,t])}({collectionStore:o,isAutomationEnabled:y,isPersistedStateComplete:v}),{caption:j,tooltipCaption:C}=function({actionStores:e,automationStatus:t,collectionStore:o,isAutomationEnabled:n,schema:i,triggerConfig:a}){const r=(0,c().v3)(),s=(0,J().tz)(),{automationStore:l,typecheckResult:d}=(0,ae().q8)();return(0,u().K8)((()=>{const c=Zt({actionStores:e,collectionStore:o,environment:r,getRecordModel:l.getRecordModel,intl:s,schema:i,triggerConfig:a,typecheckResult:d});return{caption:c,tooltipCaption:"invalid"===t?(0,Be.jsx)(J().sA,{...n?vo.automationInvalidActiveCaption:vo.automationInvalidPausedCaption}):c}}),[n,s,e,o,r,l.getRecordModel,i,a,d,t])}({actionStores:m,automationStatus:w,collectionStore:o,isAutomationEnabled:y,schema:r,triggerConfig:b}),U=(0,u().O$)(t.aliveAutomationCountStore),L=(0,i.useCallback)((async()=>{await Ne().lg({collectionStore:o,environment:l,existingAutomationStore:d,intl:s,onDelete:()=>{1===U&&ce().R8({collectionSettingsStore:n,item:{type:"main"}})}})}),[s,l,o,n,d,U]),H=(0,i.useCallback)((()=>{Ne().WA({automationStore:d,environment:l})}),[l,d]),q=(0,i.useCallback)((()=>{ne().h({environment:l,mode:"edit_automation",collectionSettingsStore:n,collectionContextStore:t,automationId:d.id,source:"collection_settings_automation_view"})}),[l,n,t,d]),Z=(0,i.useCallback)((()=>{Ne().HJ({automationStore:d,environment:l})}),[l,d]),ee=(0,i.useCallback)((()=>{Ne().vH({automationStore:d,collectionStore:o,environment:l})}),[d,o,l]),oe=(0,i.useCallback)((()=>{if(!d.isTriggerType("recurrence"))return;Ne().be({automationStore:d,collectionStore:o,environment:l});const e=s.formatMessage(vo.automationRestartSuccessMessage);g().D6({label:e})}),[d,o,l,s]),re=(0,i.useCallback)((e=>(0,i.createElement)(pt,{...e,key:d.id,actions:p,caption:j,focused:a,status:w,onClick:q,onDelete:h?L:void 0,onDisable:y&&h&&v?H:void 0,onRestart:"expired"===w?oe:void 0,onDuplicate:f?ee:void 0,onEdit:f?q:void 0,onEnable:!y&&h&&v?Z:void 0,title:S,triggers:x})),[p,d.id,f,h,j,a,w,y,v,L,H,ee,q,Z,oe,S,x]);return(0,Be.jsx)(ie().P,{caption:C,renderOrigin:re,title:S,tooltipPlacement:"left",tooltipAlignment:"start"})}function wo(e){const t=(0,te().O9)(e)?U().q6[e]:void 0;return(0,te().O9)(t)?e=>(0,Be.jsx)(y().j,{iconPath:t,color:e.fill,size:"sm"}):H().questionMarkCircleFillSmallIcon}function Ao(e,t,o){const n=[];for(const a of e){const e=a.getType();if(e){const t=(0,j().getActionRegistryItem)(e);(0,C().qe)(t)&&n.push(o.formatMessage(t.display.name))}if(a.isType("create_page")||a.isType("update_pages")){var i;const e=a.getConfig();null==e||null===(i=e.properties)||void 0===i||i.forEach((e=>{const o=null==t?void 0:t[e];o&&n.push(`${o.name} ${me().dC[o.type]}`)}))}}return n}},947086:(e,t,o)=>{o.r(t),o.d(t,{iconDefinition:()=>n,personSlashIcon:()=>i});o(296540);const n={viewBox:"0 0 20 20",fittedViewBox:"3.31 2.31 14.13 16.25",svg:(0,o(474848).jsx)("path",{d:"M3.53 2.463a.626.626 0 0 1 .882.067l.032.038q.008.013.018.025l12.687 14.875q.089.101.203.156a.625.625 0 0 1-1.014.72l-.928-1.08a2.4 2.4 0 0 1-1.26.362h-8.3c-.68 0-1.328-.288-1.74-.768-.43-.501-.591-1.217-.23-1.923C4.899 12.945 7.3 11.63 10 11.63q.3 0 .593.021l-1.001-1.166a3.28 3.28 0 0 1-2.267-1.22c-.536-.669-.825-1.532-.886-2.453L3.463 3.345a.626.626 0 0 1 .067-.882M10 12.88c-2.335 0-4.245 1.138-5.007 2.625-.104.203-.071.379.066.54.157.182.449.33.79.33h8.301c.155 0 .3-.032.426-.082l-2.707-3.154a6.8 6.8 0 0 0-1.87-.26M10 2.375c1.137 0 2.055.469 2.675 1.241.607.757.899 1.766.9 2.824 0 1.058-.292 2.067-.9 2.825q-.213.263-.472.477l-.811-.951q.168-.138.307-.309c.392-.487.625-1.2.625-2.042S12.09 4.887 11.7 4.4c-.38-.473-.936-.775-1.7-.775-.762 0-1.32.302-1.7.774a2.4 2.4 0 0 0-.278.44l-.857-1.004q.076-.113.161-.219c.62-.772 1.538-1.241 2.675-1.241"})},i=(0,o(340498).wt)("personSlash",n,"default")},966759:(e,t,o)=>{o.d(t,{i:()=>a});var n=()=>o(390650),i=()=>o(175213);function a(e){const{environment:t,collectionContextStore:o,property_type:a,from:r,property:s,...l}=e,c=(0,n().sl)(o)||{};(0,i().G)(t,{property:s,property_type:a,from:r,...l,...c})}},970236:(e,t,o)=>{o.d(t,{E:()=>s});o(296540);var n=()=>o(401497),i=()=>o(100622),a=()=>o(284371),r=o(474848);function s(e){const{color:t="gray",style:o,content:s,...l}=e,c=(0,n().IS)((()=>({badge:{alignSelf:"center",padding:"2px 4px",background:i().Tj[t].background.secondaryTranslucent,color:i().Tj[t].text.accentPrimary,borderRadius:4,fontSize:11,fontWeight:a().Wy.medium,lineHeight:1.3,...o}})),[t,o]);return(0,r.jsx)("div",{style:c.badge,...l,children:s})}},994006:(e,t,o)=>{o.d(t,{A:()=>i});o(296540);var n=o(474848);const i=function(e){const t={marginInlineEnd:e.avatarMarginRight??6,alignSelf:"center"},i={display:"flex",alignItems:"center",minWidth:0,...e.style},a=e.inline?{...t,width:"none",minHeight:"none"}:t,{userStore:r,avatarShouldShowShadow:s,avatarSize:l,hasTooltip:c,tooltipHeader:d,hasPersonHoverCard:u,spaceStore:p}=e,m=(0,o(69708).tz)(),g=(0,o(590526).K8)((()=>null==r?void 0:r.getDisplayName(m)),[r,m]),f=(0,n.jsxs)("div",{style:i,children:[(0,n.jsx)("div",{style:a,children:(0,n.jsx)(o(453697).A,{userStore:r,avatarShouldShowShadow:s,size:l,hasTooltip:c&&!u,hasPersonHoverCard:!1,tooltipHeader:d})}),(0,n.jsx)("div",{className:"notranslate",style:{...o(284371).RC},children:g})]});return u?(0,n.jsx)(o(436525).D,{userStore:r,spaceStore:p,children:f}):f}}}]);