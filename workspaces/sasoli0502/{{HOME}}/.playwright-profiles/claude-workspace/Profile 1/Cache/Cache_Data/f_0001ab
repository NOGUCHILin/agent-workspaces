"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[12305,77093,95576],{75544:(e,t,o)=>{o.d(t,{A:()=>g});o(517642),o(658004),o(733853),o(845876),o(432475),o(515024),o(731698),o(898992),o(354520),o(672577);var n=o(296540),r=()=>o(908006),i=()=>o(951500),a=()=>o(590526),l=()=>o(62371),s=()=>o(41174),c=()=>o(336811),d=()=>o(496603),u=()=>o(183558);function p(e){const{reducerId:t,instanceId:o,reducer:n,collectionContextStore:r,groupsPointer:i}=e,a=r.reducersStore.state,s=a[t];let c,u;if(i&&i.length>0&&(c=(0,l().Hm)(i)),n){if(u={instanceIds:d().sb([...(null==s?void 0:s.instanceIds)||[],o]),reducer:n},c){r.reducerDependencies.has(c)||r.reducerDependencies.set(c,new Set);const e=r.reducerDependencies.get(c);null==e||e.add(t)}}else{if(c){const e=r.reducerDependencies.get(c);e&&(e.delete(t),0===e.size&&r.reducerDependencies.delete(c))}const e=d().FF((null==s?void 0:s.instanceIds)||[],o);u=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}d().n4(s,u)||r.reducersStore.setState({...a,[t]:u})}var m=()=>o(418211);function g(e){const{id:t,reducer:o,collectionContextStore:g,groupsPointer:y,debounceWait:f,isDerivedReducer:v,resultLookupFn:S}=e,h=(0,i().l)(y),b=(0,i().l)(o),C=(0,a().K8)((()=>g.collectionViewStore()),[g]),w=(0,a().K8)((()=>g.normalizedFormatStore.state.collection_pointer),[g.normalizedFormatStore]),_=(0,a().K8)((()=>{var e;return null==C||null===(e=C.getFormatStore())||void 0===e?void 0:e.getKeyStore("collection_view_source").getValue()}),[C]),A=(0,n.useRef)(!1),I=(0,c().O)(),[x,R]=(0,n.useReducer)(((e,t)=>d().n4(e,t)?e:t),void 0),k=(0,n.useCallback)((()=>{const e=g.localResultStore.state,o=g.remoteResultStore.state,n=e&&"reducer"===e.type?(null==S?void 0:S(e.reducerResults,h))??e.reducerResults[t]:void 0,r=o&&"reducer"===o.type?(null==S?void 0:S(o.reducerResults,h))??o.reducerResults[t]:void 0;return function(e){const{reducerId:t,localReducerResult:o,remoteReducerResult:n,collectionContextStore:r,reducer:i}=e,a=r.reducersStore.state,c=r.remoteResultStore.state,u=r.isClientModeEnabledStore.state;if(u)return o;const p=r.isCreatingNewChartCollectionStore.state,g=r.wasCreatedThisSessionStore.state;if("aggregation"===i.type){if(p&&g){return Boolean(n&&"aggregation"===n.type&&"number"===n.aggregationResult.type&&0!==n.aggregationResult.value)&&r.isCreatingNewChartCollectionStore.setState(!1),o}if(n)return n;const e=Boolean(c&&"reducer"===c.type&&Object.entries(c.reducerResults).find((([e,t])=>{const o=a[e];return!!o&&Boolean("results"===o.reducer.type&&!o.reducer.searchQuery&&"results"===t.type&&!t.hasMore&&d().n4(i.filter,o.reducer.filter))})));return e?o:n}if("groups"===i.type){if(p&&g){return Boolean(n&&"groups"===n.type&&n.hasMore)&&r.isCreatingNewChartCollectionStore.setState(!1),o}if(o&&"groups"!==o.type)return;if(n&&"groups"!==n.type)return;const e=function(e){var t,o;const{reducerId:n,reducer:r,collectionContextStore:i,wasCreatedThisSession:a,localReducerResult:c,remoteReducerResult:d}=e;if(!r.blockResults&&!n.includes(l().RO))return d;let u;r.aggregation&&(d?u=d.aggregationResults:c&&(u=c.aggregationResults));const p=null===(t=i.collectionViewStore())||void 0===t?void 0:t.getCollectionSource(),m=(0,s().TR)(p)||(0,s().hJ)(p),g=Boolean(d&&d.blockResults),y=(g||a)&&!m;let f;if(r.blockResults){if(y&&c&&c.blockResults){const e=c.blockResults,t=(null==d?void 0:d.blockResults)??{},o=new Set([...Object.keys(e),...Object.keys(t)]),n={};for(const r of o){const o=e[r],i=t[r];let a=[];o?a=o.blockIds:i&&(a=i.blockIds);let l=!1;i?l=i.hasMore:o&&(l=o.hasMore),n[r]={blockIds:a,hasMore:l}}f=n}f||(f=i.forceLocalQueryCollection||m?null==d?void 0:d.blockResults:null==c?void 0:c.blockResults)}let v;c&&c.pinnedResults&&(v=c.pinnedResults);d&&d.pinnedResults&&(v={groupResults:d.pinnedResults.groupResults,...v,aggregationResults:d.pinnedResults.aggregationResults});const S=d?d.hasMore:Boolean(null==c?void 0:c.hasMore),h=d?d.hasMoreSubGroups:null==c?void 0:c.hasMoreSubGroups;let b=m?(null==d?void 0:d.results)??[]:(null==c?void 0:c.results)??(null==d?void 0:d.results)??[],C=m?(null==d?void 0:d.subGroupResults)??[]:(null==c?void 0:c.subGroupResults)??(null==d?void 0:d.subGroupResults);const w=r.groupBy;d&&("relation"===w.type||"formula"===w.type&&"relation"===w.groupBy.type)&&(b=d.results);const _=null===(o=r.subGroup)||void 0===o?void 0:o.groupBy;d&&("relation"===(null==_?void 0:_.type)||"formula"===(null==_?void 0:_.type)&&"relation"===_.groupBy.type)&&(C=d.subGroupResults);i.forceLocalQueryCollection&&(b=(null==d?void 0:d.results)??(null==c?void 0:c.results)??[],C=(null==d?void 0:d.subGroupResults)??(null==c?void 0:c.subGroupResults));return{type:"groups",version:"v2",results:b,subGroupResults:C,pinnedResults:v,hasMore:S,hasMoreSubGroups:h,blockResults:f,aggregationResults:u}}({reducerId:t,collectionContextStore:r,reducer:i,wasCreatedThisSession:g,localReducerResult:o,remoteReducerResult:n});return e}if("results"===i.type){var y;const e=r.wasCreatedThisSessionStore.state,i=Boolean(c&&"reducer"===c.type&&c.reducerResults[t]),a=null===(y=r.collectionViewStore())||void 0===y?void 0:y.getCollectionSource(),l=(0,m().c)({collectionContextStore:r}),d=(0,s().TR)(a)||(0,s().hJ)(a);if((i||e)&&(!d||l)&&o&&"results"===o.type){return{...o,hasMore:n&&"results"===n.type?n.hasMore:o.hasMore}}return n}}({reducerId:t,collectionContextStore:g,reducer:b,localReducerResult:n,remoteReducerResult:r})}),[g,h,b,t,S]),P=(0,n.useCallback)((()=>{A.current=!1,I.current||R(k())}),[k,I]),T=(0,n.useCallback)((()=>{A.current||(A.current=!0,r().default.afterNextFlush(P))}),[P]),[F]=(0,n.useState)((()=>(0,u().Ay)()));return(0,n.useEffect)((()=>{const e=f?(0,d().sg)(T,f,{leading:!0}):T;return g.remoteResultStore.addListener(T),g.localResultStore.addListener(e),()=>{g.remoteResultStore.removeListener(T),g.localResultStore.removeListener(e)}}),[g,T,f]),(0,n.useEffect)((()=>{if(!v)return p({reducerId:t,instanceId:F,reducer:b,collectionContextStore:g,groupsPointer:h}),()=>{p({reducerId:t,instanceId:F,reducer:void 0,collectionContextStore:g,groupsPointer:h})}}),[g,C,w,_,h,b,t,F,v]),(0,n.useEffect)((()=>{T()}),[]),(0,n.useEffect)((()=>(g.timingTracker.mountCollectionReducerRequest(t,b.type),()=>{g.timingTracker.unmountCollectionReducerRequest(t)})),[g,t,b]),x}},124311:(e,t,o)=>{o.d(t,{K:()=>r});var n=()=>o(314529);function r(e){(0,n().DO_NOT_USE_trackLegacy)(e,"inline_collection_load_more_click")}},152077:(e,t,o)=>{o.d(t,{Vs:()=>c,WA:()=>s,YU:()=>d,bO:()=>a,lU:()=>l});var n=o(296540),r=o(474848);const i=n.createContext(void 0);function a(e){return(0,r.jsx)(i.Provider,{value:e.surface,children:e.children})}function l(){return n.useContext(i)}function s(){const e=l();return"TeamHome"===e||"PersonalHome"===e}function c(){return void 0===l()}function d(){return c()?12:0}i.displayName="PostFeedSurfaceContext"},157071:(e,t,o)=>{o.d(t,{PH:()=>C,Un:()=>_,V_:()=>A,hn:()=>k,lY:()=>x,v7:()=>R,zU:()=>I});var n=()=>o(726637),r=()=>o(584262),i=()=>o(37450),a=()=>o(90654),l=()=>o(766854),s=()=>o(714574),c=()=>o(573451),d=()=>o(357643),u=()=>o(390650),p=()=>o(999140),m=()=>o(308195),g=()=>o(862292),y=()=>o(535960),f=()=>o(893665),v=()=>o(518489),S=()=>o(970501),h=()=>o(260850),b=()=>o(372267);function C(e){(0,s().P)({store:e})}function w(e,t,o,n,r){if("title"===e){a().VN({environment:r,blockPropertyValueOverlayStore:o});const e=t.getBlockTitleStore();(0,v().h)({environment:r,store:t}),(0,c().C)({store:t}),(0,h().z)({store:e})}else e?(a().VN({environment:r,blockPropertyValueOverlayStore:o}),a().ho({environment:r,blockPropertyValueOverlayStore:o,store:t,property:e,surface:"list",collectionContextStore:n})):a().VN({environment:r,blockPropertyValueOverlayStore:o});C(t)}async function _(e,t,o,n,r,i,a){const l=await g().T.formulas.load();w((0,b().cO)(e,t,o,n,r,a,l),o,t,i,e)}async function A(e,t,o,n,r,i,a){const l=await g().T.formulas.load();w((0,b().o6)(e,t,o,n,r,a,l),o,t,i,e)}function I(e,t){C(e),t()}function x(e,t,o){a().VN({environment:e,blockPropertyValueOverlayStore:t}),(0,S().L)({environment:e,store:o}),C(o)}function R(e){const{environment:t,newStore:o,previousStore:n}=e;(0,v().h)({environment:t,store:o}),(0,c().C)({store:o}),m().A.setState({store:o,editMode:"new",previousStore:n})}function k(e){var t;const{transaction:o,environment:a,results:s,collectionContextStore:c,isFullScreen:m,groupsPointer:g,insertAtIndex:v,editInPeek:S,from:h}=e;c.searchQueryStore.state&&(0,d().S)({searchQuery:"",collectionContextStore:c,isFullScreen:m});const b=null===(t=c.groupsStore.getGroupState(g))||void 0===t?void 0:t.resultsStore;if(!b)return;let C;v>0&&(C=s[v]);const w=(0,l().Q)({environment:a,collectionContextStore:c,groupsPointer:g,insertAtIndex:v,shouldCoerce:!0,templateStore:c.defaultPageTemplateStore.state,transaction:o,from:{createBlock:h},inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache});if(!w)return;const _=w.coercionSucceeded,A=w.newStore;return n().A.isMobile?(0,y().u)({environment:a,store:A,pageVisitSource:r().y8.Create}):_&&!S?R({environment:a,newStore:A,previousStore:C}):(0,f().V)({environment:a,store:A,peekMode:(0,p().hH)(c),resultsStore:b,collectionContextStore:c,pageVisitSource:r().y8.Create}),i().vH(a,{from:h,type:"page",new_page_id:A.id,creating_block_id:A.id,...(0,u().sl)(c)}),A}},186348:(e,t,o)=>{o.d(t,{h:()=>u});o(898992),o(672577);var n=()=>o(590526),r=()=>o(401497),i=()=>o(785285),a=()=>o(898244),l=()=>o(713998),s=()=>o(254947),c=()=>o(100622),d=()=>o(534177);function u({conditionalColor:e,store:t,schema:o,viewType:c}){const d=(0,n().K8)((()=>{if(t&&null!=e&&e.background&&(0,i().IY)(e.background))return t.getPropertyValue(e.conditional_filter.property)}),[t,e]),u=(0,r().DP)();return(0,r().IS)((()=>{if(null==e||!e.background)return{conditionalColorStyles:{background:void 0}};let t;var n;(0,i().IY)(e.background)?t=function(e){const{propertyValue:t,propertyId:o,schema:n}=e;if(!n)return;const r=n[o];if(!r)return;if(a().DD(r)){const e=l().RZ(t,r);if(!e)return;const o=l().FE(r.options??[],e);if(o)return m(o);const n=r.options??[],i=r.groups??[],a=n.find((t=>t.value===e)),c=a&&i.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(a.id)}));if(c){const e=c.color??s().ml[c.name];return e?m(e):void 0}return}if(a().P8(r)){const e=l().L3(t,r.options??[]);if(!e)return;const o=l().FE(r.options??[],e);return o?m(o):void 0}if(a().Ou(r)){const e=l().o2(t,r.options??[]);if(!e||0===e.length)return;const o=e[0];if(!o)return;const n=l().FE(r.options??[],o);return n?m(n):void 0}return}({propertyValue:d,propertyId:e.conditional_filter.property,schema:o}):t=null==e||null===(n=e.background)||void 0===n?void 0:n.color;return{conditionalColorStyles:p({blockBackgroundColor:t,theme:u,viewType:c})}}),[e,d,o,c,u]).conditionalColorStyles}function p({blockBackgroundColor:e,theme:t,viewType:o}){if("map"===o&&e){var n;const o=c().Ld[e];if(o&&o in t&&null!==(n=t[o])&&void 0!==n&&null!==(n=n.icon)&&void 0!==n&&n.accentPrimary)return{background:t[o].icon.accentPrimary}}return{background:e?(0,c().k5)(e,t).background:void 0}}function m(e){switch(e){case"default":return"default_background";case"gray":return"gray_background";case"brown":return"brown_background";case"orange":return"orange_background";case"yellow":return"yellow_background";case"green":return"teal_background";case"blue":return"blue_background";case"purple":return"purple_background";case"pink":return"pink_background";case"red":return"red_background";default:(0,d().HB)(e)}}},191356:(e,t,o)=>{o.d(t,{C4:()=>h,Nf:()=>C,qM:()=>b});o(16280),o(944114),o(898992),o(430670),o(581454);var n=()=>o(726637),r=()=>o(675133),i=()=>o(792057),a=()=>o(732810),l=()=>o(617871),s=()=>o(388693),c=()=>o(519831),d=()=>o(161479),u=()=>o(534177),p=()=>o(753812),m=()=>o(457583),g=()=>o(384944),y=()=>o(594794),f=()=>o(620791),v=()=>o(661075);const S=(0,o(69708).YK)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function h(e,t,o,a){const l=null==t?void 0:t.getSpaceStore();if(!l)return;const s=(0,f().jw)(o.id).length;if(n().A.isMobile&&a&&!s){const e=r().A.formatMessage(S.mobileAdminError);throw i().f1(e),new Error(e)}if(n().A.isMobile&&!a&&!s){const e=r().A.formatMessage(S.mobileError);throw i().f1(e),new Error(e)}if(!s&&a&&l.canAdmin()||!s&&!a)try{await m().Jq({environment:e,integration:o,spaceId:l.id,from:"collection_settings_property_type"})}catch(c){const e=r().A.formatMessage(S.authError);throw i().f1(e),new Error(e)}if(!(0,f().jw)(o.id).length){const e=r().A.formatMessage(S.authError);throw i().f1(e),new Error(e)}}function b(e){const{environment:t,pattern:o,integration:n,parentCollectionStore:r,transaction:i}=e;if(!o.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const l=new(a().m)(t,(0,y().zP)({environment:t,table:c().Vl,spaceId:r.pointer.spaceId})),s={};o.connected_relation_sub_schemas&&(0,u().WP)(o.connected_relation_sub_schemas).map((([e,o])=>{const n=new(a().m)(t,(0,y().zP)({environment:t,table:c().Vl,spaceId:r.pointer.spaceId})),u={bot_id:void 0,external_object_id:void 0,uri:e,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:o,sync_state:void 0,pattern_name:void 0},p={id:n.id,version:0,space_id:(0,d().e)(r.pointer.spaceId),parent_table:c().Vl,parent_id:l.id,alive:!0,format:u,schema:{}};s[e]=n.id,g().zv({store:n,data:p,transaction:i})}));const p={id:l.id,version:0,space_id:(0,d().e)(r.pointer.spaceId),parent_table:c().Vl,parent_id:r.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,v().Fe)({pattern:o,integration:n})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${n.id}/${o.name}`,integration_id:n.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:o.connected_relation_properties,sync_state:void 0,pattern_name:o.name,related_external_object_uris_to_instance_ids:s},schema:{}};return g().zv({store:l,data:p,transaction:i}),l}async function C(e){const{bot:t,connected_relation_properties:o}=e;if(t.integration_id===l().Iy||t.integration_id===l().mn)return await async function(e){var t,o,n;const{environment:r,objectName:i,spaceId:a,bot:l}=e,c=await p().callApi({eventName:"describeSalesforceObject",environment:r,data:{spaceId:a,objectName:i,botId:l.id}});if("success"!==(null==c?void 0:c.type))return{error:s().qh.FAILED_TO_FETCH_SALESFORCE_PROPERTIES};var d,u;if((null===(t=c.data)||void 0===t?void 0:t.responseStatus)===s().qh.REAUTHENTICATION_REQUIRED||(null===(o=c.data)||void 0===o?void 0:o.responseStatus)===s().qh.NO_USER_API_ACCESS)return{error:`${null===(d=c.data)||void 0===d?void 0:d.responseStatus}:${null===(u=c.data)||void 0===u?void 0:u.userType}`};const m=null==c||null===(n=c.data)||void 0===n?void 0:n.properties;if(m){return{value:m.flatMap((e=>{const t=e.custom?e.label:e.relationshipName||e.label;return"User"===e.referenceTo||"Group"===e.referenceTo?[{id:e.name,name:t,isSelected:!1,type:e.type,metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible},{id:`mapped_${e.name}`,name:`${t} (Notion User)`,isSelected:!1,type:"person",metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible}]:[{id:"Name"===e.name?"title":e.name,name:"relation"===e.type?t:e.label,isSelected:!1,type:e.type,metadata:e,isAlreadySynced:e.isAlreadySynced,isAdminNotAccessible:e.isAdminNotAccessible}]}))}}return{error:s().qh.NO_PROPERTIES_FOUND}}(e);const n=[],r=o;for(const i in r){const e=r[i];null!=e&&e.name&&null!=e&&e.type&&n.push({id:i,name:e.name,isSelected:!1,type:e.type,metadata:{name:e.name,label:e.name,type:e.type,custom:!1},isAlreadySynced:!1})}return{value:n}}},253447:(e,t,o)=>{o.d(t,{F:()=>r});var n=()=>o(963575);function r(e,t){if(e)return e;switch(t){case"large":return n().A.card.desktop.large.height;case"small":return n().A.card.desktop.small.height;default:return n().A.card.desktop.medium.height}}},271232:(e,t,o)=>{o.d(t,{t:()=>i});var n=o(296540),r=o(474848);const i=n.memo((function(e){const{coverHeight:t,coverSizeFormat:n,emptyGalleryCoverStyle:i}=e,a=(0,o(401497).IS)((()=>({container:{height:(0,o(253447).F)(t,n),...i}})),[t,n,i]);return(0,r.jsx)("div",{style:a.container})}))},316369:(e,t,o)=>{o.d(t,{w:()=>A});o(581454),o(296540);var n=()=>o(726637),r=()=>o(484714),i=()=>o(590526),a=()=>o(127833),l=()=>o(250910),s=()=>o(695115),c=()=>o(546926),d=()=>o(890492),u=()=>o(81068),p=()=>o(663639),m=()=>o(736847),g=()=>o(45941),y=()=>o(126617),f=()=>o(69708),v=()=>o(496603),S=()=>o(436696),h=()=>o(896628),b=()=>o(244828),C=o(474848);function w(e){const{limit:t}=e;return(0,C.jsx)(f().sA,{defaultMessage:"{limit} pages",values:{limit:t.limit},id:"database.FirstLoadLimitSelectOption.limitPagesTitle"})}const _=(0,f().YK)({firstLoadLimitActionButtonAriaLabel:{defaultMessage:"Load limit settings menu",id:"database.firstLoadLimitActionButton.ariaLabel"}});function A({format:e,collectionContextStore:t}){const o=(0,r().v3)(),c=(0,f().tz)(),d=(0,i().K8)((()=>{var e;return(null===(e=t.collectionViewStore())||void 0===e?void 0:e.getType())??"unknown"}),[t]);return n().A.isMobile?null:(0,C.jsx)(l().A,{popupType:a().nl.Popup,renderOrigin:e=>(0,C.jsx)(s().A,{icon:y().ellipsisSmallIcon,style:{marginInlineStart:4,marginInlineEnd:4},ariaLabel:c.formatMessage(_.firstLoadLimitActionButtonAriaLabel),...e}),alignmentToOrigin:"end",placementToOrigin:"bottom",originGap:8,render:n=>(0,C.jsx)(x,{currentLimit:I({format:e,viewType:d}),onAccept:e=>function(e,t,o){const n=t.collectionViewStore();if(!n)return;if(!n.getType())return;b().createAndCommit({userAction:"FirstLoadLimitActionButton.handleFirstLoadLimitAccept",environment:o,canUndo:!0,perform:t=>{h().zA({stores:[n],update:{inline_collection_first_load_limit:e},transaction:t})}}),t.groupsStore.resetAllLimits(),(0,S().X)({environment:o,collectionContextStore:t,action:"set_first_load_limit"})}(e,t,o),onClose:n.close,showTitle:!0})})}function I(e){const{format:t,viewType:o}=e;return(0,g().i3)({limit:t.inline_collection_first_load_limit,isGrouped:Boolean(t.collection_group_by),viewType:o})}function x(e){const{currentLimit:t,onAccept:o,onClose:r,showTitle:i}=e,a=(0,v().oE)(g().X9.map(((e,n)=>{const r={key:n,render:o=>(0,C.jsx)(u().A,{...o,disabled:!1,title:(0,C.jsx)(w,{limit:e}),isChecked:(0,v().n4)(t,e)}),action:()=>o(e)};return r}))),l=[{key:0,render:e=>(0,C.jsx)(m().A,{enableActionSheetTitle:!0,title:i&&(0,C.jsx)(f().sA,{defaultMessage:"Show on first load",id:"database.firstLoadLimitSelectMenu.firstLoadLimitSetting"}),...e}),items:a}];let s;return s=n().A.isMobile?{menuType:c().gu.ActionSheet}:{menuType:c().gu.Popup,width:200},(0,C.jsx)(d().A,{...s,children:(0,C.jsx)(p().A,{type:p().O.Vertical,sections:l,onAccept:r,initialFocus:void 0})})}},358006:(e,t,o)=>{o.d(t,{z:()=>a});o(296540);var n=()=>o(79926),r=o(474848);const i=new(n().O2)("CollectionItemCover",(async()=>{const{CollectionItemCover:e}=await o.e(79883).then(o.bind(o,873718));return{CollectionItemCover:e}})),a=(0,n()._h)(i,(e=>e.CollectionItemCover),{renderLoading:(e,t)=>{const{coverHeight:n,coverSizeFormat:i,emptyGalleryCoverStyle:a,showEmptyGalleryCover:l}=t;return l?(0,r.jsx)(o(271232).t,{coverHeight:n,coverSizeFormat:i,emptyGalleryCoverStyle:a}):null}})},372267:(e,t,o)=>{o.d(t,{NK:()=>v,cO:()=>C,nq:()=>y,o6:()=>b,uM:()=>S});o(898992),o(354520),o(672577);var n=()=>o(907258),r=()=>o(242422),i=()=>o(675133),a=()=>o(584262),l=()=>o(726317),s=()=>o(416504),c=()=>o(496603),d=()=>o(468882),u=()=>o(89053),p=()=>o(999140),m=()=>o(842076),g=()=>o(492414);function y(e){return{display:"flex",flexGrow:1,textDecoration:"none",overflow:"hidden",borderRadius:6,..."single"===e?{height:30}:{minHeight:30}}}function f(e,t){return(0,d().B2)(t[e])}function v(e){const{environment:t,store:o,collectionContextStore:r}=e,{mainEditorCurrentBlockStore:i}=n().default.state;return p().wy({environment:t,store:o,mainEditorCurrentBlockStore:i,collectionContextStore:r,fullyQualified:!1})}function S(e){return(0,g().Ay)({store:e,fullyQualified:!1,pageVisitSource:a().y8.LinkInPage})}function h(e,t,o,n,a,c){return t.isDefined()?n.filter((n=>{const d="title"!==n&&a;return!l().r({property:n,schema:o,block:t.getModel(),getRecordModel:t.getRecordModel,userId:e.currentUser.id,userTimeZone:(0,s().P)(),intl:i().A.getIntl(),experimentService:r().default,collectionFeatureGates:(0,u().i)(),formulasModule:c,spaceIdCreator:e.idCreator.getSpaceIdCreatorSync(t.getModel().space_id),getRelationEdgeList:(0,m().Y)({environment:e,spaceId:t.getSpaceId()})})||d})):[]}function b(e,t,o,n,r,i,a){const l=t.state,s=l.isOpen?l.property:"title",d=h(e,o,n,r,i,a),u=d.findIndex((e=>e===s)),p=c().Uk(d,((e,t)=>t<u&&f(e,n)));return p||(i?"title":function(e,t){return c().Uk(e,(e=>f(e,t)))}(d,n))}function C(e,t,o,n,r,i,a){const l=t.state,s=l.isOpen?l.property:"title",c=h(e,o,n,r,i,a),d=c.findIndex((e=>e===s)),u=c.find(((e,t)=>t>d&&f(e,n)));return u||(i?"title":function(e,t){return e.find((e=>f(e,t)))}(c,n))}},375555:(e,t,o)=>{function n(e,t){const{device:o}=e;o.isAndroid&&t.focus(),t.select()}o.d(t,{G:()=>n})},377093:(e,t,o)=>{o.d(t,{XO:()=>G,h3:()=>K,nZ:()=>z,pG:()=>U});o(944114),o(898992),o(823215),o(354520),o(803949),o(581454);var n=()=>o(314529),r=()=>o(564884),i=()=>o(907258),a=()=>o(365917),l=()=>o(675133),s=()=>o(295633),c=()=>o(732810),d=()=>o(433337),u=()=>o(716016),p=()=>o(898244),m=()=>o(617871),g=()=>o(165358),y=()=>o(388693),f=()=>o(792071),v=()=>o(179034),S=()=>o(332393),h=()=>o(96689),b=()=>o(854150),C=()=>o(496603),w=()=>o(534177),_=()=>o(935664),A=()=>o(753812),I=()=>o(896628),x=()=>o(799427),R=()=>o(567700),k=()=>o(928213),P=()=>o(339798),T=()=>o(254497),F=()=>o(312296),M=()=>o(999140),E=()=>o(191356),B=()=>o(601734),D=()=>o(395963),L=()=>o(838038),j=()=>o(244828),N=()=>o(155269);const V=(0,o(69708).YK)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});function O(e){const{environment:t,collectionContextStore:o,collectionUri:r,feature:i,transaction:a,addFeatureFrom:l,createFeatureStartTime:s}=e;if("dependencies"in i)for(const n of i.dependencies)"property"===n.type&&n.collectionUri===r&&(0,_().Z)({environment:t,collectionContextStore:o,from:"view_settings",property:n.uri,property_type:n.propertySchema.type,is_suggested_property:!0,property_id:n.uri,feature:{id:n.uri,from:l,type:i.uri}});if("dependencies"in i&&i.dependencies.map((e=>e.type)).every((e=>"property"===e))){const e=o.collectionViewStore(),t=o.getPropertyFormatKey(),n=o.normalizedFormatStore.state;if(t&&e){const o=n[t]||[],r=[...o];i.dependencies.forEach((e=>{const t=o.findIndex((t=>t.property===e.uri));-1===t?r.push({visible:!0,property:e.uri}):r[t]={...o[t],visible:!0}})),I().zA({stores:[e],update:{[t]:r},transaction:a})}}if(void 0!==i.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:i.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:o.getPropertyFormatKey()};P().a2({collectionSettingsStore:o.settingsStore,item:e})}a.postSubmitCallbacks.push((e=>{(0,n().DO_NOT_USE_trackLegacy)(t,"collection_create_suggested_property_latency",{collection_uri:i.collectionUri,feature_uri:i.uri,time:Date.now()-s,status:Boolean(e)?"fail":"success"})}))}async function K(e){var t;const{appTemplatesSetupActions:o,appTemplatesSprintBoardActions:n,appConfigs:r}=await B().Aw.load(),{environment:l,collectionContextStore:c,feature:p,addFeatureFrom:f,customPropertyName:C}=e,{sidebarSpaceViewStore:w}=i().default.state,_=c.collectionStore(),P=null==_?void 0:_.getParentBlockStore(),T={},F=e=>{(0,g().log)({level:"error",from:"collectionSettingsCreatePropertyActions",type:"handleCreateNewSuggestedProperty",data:{collectionId:null==_?void 0:_.id,miscDataToConvertToString:{featureUri:p.uri,addFeatureFrom:f,...T,...e}}})};if(!_||!P)return void F({hasCollectionStore:Boolean(_),hasCollectionViewBlockStore:Boolean(P)});if((0,R().u)(p))return async function(e){const{environment:t,collectionContextStore:o,feature:n,addFeatureFrom:r}=e,{untypedFeaturesSetupActions:i}=await B().Aw.load(),a=o.collectionStore(),l=null==a?void 0:a.getParentBlockStore();if(!a||!l)return;const s=Date.now();j().createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewUntypedFeature",canUndo:!0,perform:e=>{i.applyUntypedFeature({environment:t,collectionStore:a,collectionViewBlockStore:l,feature:n,transaction:e}),O({environment:t,collectionContextStore:o,collectionUri:d().iH,feature:n,transaction:e,addFeatureFrom:r,createFeatureStartTime:s})}})}({environment:l,collectionContextStore:c,feature:p,addFeatureFrom:f});const M=c.collectionViewStore(),D=null==P?void 0:P.getParentStore(),L=null==_||null===(t=_.getFormat())||void 0===t?void 0:t.app_config_uri,N=L&&(0,x().l)(r(),L);if(T.appConfigUri=N&&N.uri,!D||D.table!==h().NX&&D.table!==v().ev&&D.table!==b().yK||!N)return void F({hasAppParentStore:Boolean(D),appParentStoreTable:null==D?void 0:D.table,appConfigUri:N?N.uri:void 0});const V=_.getSchema(),K=P.getFormat().app_id;T.appId=K;const U=K?await A().callApi({eventName:"getCollectionViewBlocksByAppId",environment:l,data:{spaceId:P.getSpaceId(),appId:K}}):void 0,z="success"===(null==U?void 0:U.type)&&U.data.result.length?U.data.result.map((e=>s().B.createChildStore(D,{table:v().ev,id:e.blockId,spaceId:P.getSpaceId()}))):[P],G=p.integrationId;if(G){const e=a().A.getIntegrationsAsRecordMap().getValue({table:S().Li,id:G});if(!e||!(0,y().v_)(e))return void F({hasIntegration:Boolean(e)});await E().C4(l,_,e,Boolean(p.canOnlyAdminAuth))}G===m().ob&&V&&0===(0,u().yP)(V).length&&await k().c({environment:l,collectionStore:_});const H=Date.now();j().createAndCommit({environment:l,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",canUndo:!0,perform:e=>{var t;if(!w)return void F({hasCurrentSpaceViewStore:!1});const r=null===(t=_.getFormat())||void 0===t?void 0:t.app_config_uri;if(!r)return void F({hasCollectionUri:!1});const i=o.applyTypedFeatures({environment:l,spaceViewStore:w,appParentStore:D,appUri:N.uri,features:[{type:"simple",featureUri:p.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:z,customPropertyName:C});n.createSprintPage({environment:l,spaceViewStore:w,appParentStore:D,transaction:e,blockStores:i,creationEntryPoint:{type:"sprint_relation"}}),"notion://tasks/sub_task_feature"===p.uri&&I().zA({stores:[_],update:{subitem_property:d().yx.SubTaskRelation},transaction:e}),"notion://tasks/task_dependencies_feature"===p.uri&&(I().zA({stores:[_],update:{collection_default_arrows_by:d().yx.BlockingRelation},transaction:e}),M&&I().zA({stores:[M],update:{timeline_arrows_by:{property:d().yx.BlockingRelation}},transaction:e})),O({environment:l,collectionContextStore:c,collectionUri:r,feature:p,transaction:e,addFeatureFrom:f,createFeatureStartTime:H}),e.isEmpty()&&F({isEmptyTransaction:!0})}})}function U({propertyType:e,collectionContextStore:t,propertyId:o}){const n=t.normalizedSchemaStore.state[o];if(n)switch(e){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return P().a2({collectionSettingsStore:t.settingsStore,item:{type:"propertyAiAutofill",propertySchema:n,property:o}});case"ai_keywords":return P().a2({collectionSettingsStore:t.settingsStore,item:{type:"property",property:o,formatKey:t.getPropertyFormatKey()}});default:(0,w().HB)(e)}}function z(e){const{environment:t,collectionContextStore:n,propertyType:r,isSuggestedProperty:i,propertyName:a,propertyIcon:s,selectOptions:c,from:d,shouldOpenEditMenu:u=!0,newPropertyFormat:m}=e,g=n.collectionStore(),y=n.collectionViewStore(),f=n.getPropertyFormatKey(),v=n.normalizedFormatStore.state;if(!g)return;if("relation"===r)return void P().a2({collectionSettingsStore:n.settingsStore,item:{type:"selectRelationSource",property:void 0,initialPropertyName:a,formatKey:f,newPropertyFormat:m}});let S=a;"ai_custom_prompt"===r&&(S=l().A.formatMessage(V.aiCustomPromptDefaultPropertyName));const h=m&&f?{...v,[f]:m}:v,{performResult:b}=j().createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,canUndo:!0,perform:e=>(0,N().createProperty)({environment:t,collectionStore:g,collectionViewArgs:y&&f?{collectionViewStore:y,format:h,formatKey:f}:void 0,propertyName:S,propertyIcon:s,propertyType:r,selectOptions:c,transaction:e})});u&&((0,p().hN)(r)?U({propertyType:r,propertyId:b,collectionContextStore:n}):P().n1({collectionSettingsStore:n.settingsStore,property:b,formatKey:f,selectNameInitial:!0}));const C="view_settings"===d?{feature:{id:b,from:"new_property",type:r}}:{};(0,_().Z)({environment:t,collectionContextStore:n,from:d,property_type:(0,p().v2)(r),property:(0,p().hN)(r)?r:void 0,is_suggested_property:i,property_id:b,...C}),i||n.userAddedPropertyStore.update((()=>!0)),b&&!(0,p().hN)(r)&&o.e(52315).then(o.bind(o,830213)).then((e=>{e.maybeTriggerDatabaseViewNudgeOnCreateProperty({environment:t,collectionContextStore:n,propertyId:b,propertyType:(0,p().v2)(r)})}))}async function G(e){const{environment:t,collectionContextStore:o,intl:n,connectedRelationProperty:i,from:a,untypedFeatureArgs:l,propertyGroupId:s,propertyLimit:c,skipDatabaseActions:d,propertyName:y}=e,v=o.collectionStore(),S=o.collectionViewStore(),h=o.getPropertyFormatKey();if(!v||!h)return;const b=i.integration.id;(0,m().XO)(b)||await E().C4(t,v,i.integration,Boolean(i.canOnlyAdminAuth));const A=v.getSchema();let I;b===m().ob&&A&&0===(0,u().yP)(A).length&&(I=await k().c({environment:t,collectionStore:v}));const x=v.getDeletedSchema(),R=(0,w().WP)(x).map((([e,t])=>{if(t&&p().UU(t)&&t.connectedRelation.integration_id===m().ob)return{propertyId:e,propertySchema:t}})).filter(w().O9);let M;if(!C().Im(R)){const e=R[0];M={propertyId:e.propertyId,update:await H({collectionStore:v,property:e})}}j().createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",canUndo:!0,perform:e=>{const{shouldCreateNewProperty:u,restoredPropertyId:p}=function(e){const{environment:t,generatedPrefix:o,integrationId:n,propertyGroupId:r,collectionStore:i,collectionContextStore:a,collectionViewStore:l,formatKey:s,transaction:c,maybeRestoreDeletedProperty:d}=e;o&&(0,N().createProperty)({environment:t,collectionStore:i,collectionViewArgs:l?{collectionViewStore:l,format:l.getFormat(),formatKey:s}:void 0,propertyType:"auto_increment_id",transaction:c,propertyGroupId:r});if(null!=d&&d.propertyId){if(d.update){r&&(0,D().En)({collectionStore:i,groupId:r,propertyId:d.propertyId,transaction:c}),(0,F().F)({environment:t,collectionStore:i,update:d.update.updateSchema,transaction:c}),(0,T().E)({collectionStore:i,update:d.update.updateDeletedSchema,transaction:c});const e={type:"property",property:d.propertyId,formatKey:s};return P().a2({collectionSettingsStore:a.settingsStore,item:e}),{shouldCreateNewProperty:!1,restoredPropertyId:d.propertyId}}return(0,g().log)({level:"error",from:"collectionSettingsCreatePropertyActions",type:"handleCreateNewConnectedRelationProperty",data:{message:"Invalid property found in deleted_schema",collectionId:null==i?void 0:i.id,miscDataToConvertToString:{integration:n,maybeRestoreDeletedProperty:d}}}),(0,T().E)({collectionStore:i,update:{[d.propertyId]:null},transaction:c}),{shouldCreateNewProperty:!0}}return{shouldCreateNewProperty:!0}}({environment:t,generatedPrefix:I,transaction:e,propertyGroupId:s,collectionStore:v,collectionViewStore:S,collectionContextStore:o,integrationId:b,formatKey:h,maybeRestoreDeletedProperty:M});if(!u&&p)return p;const m=function(e){const{environment:t,transaction:o,collectionStore:n,collectionViewStore:r,collectionContextStore:i,intl:a,connectedRelationProperty:l,untypedFeatureArgs:s,propertyLimit:c,propertyName:d,formatKey:u}=e,p=l.integration.id,m=f().Bj6.fromIntegration(l.integration),g=E().qM({environment:t,pattern:l.pattern,integration:m,parentCollectionStore:n,transaction:o}),y=(0,N().createProperty)({environment:t,collectionStore:n,collectionViewArgs:r&&u?{collectionViewStore:r,format:r.getFormat(),formatKey:u}:void 0,propertyType:"relation",transaction:o,propertyId:null==s?void 0:s.propertyId});return L().cT({environment:t,collectionContextStore:i,collectionStore:n,property:y,propertyName:d&&d.length>0?d:l.name,propertyIcon:l.integration.info.icon,propertyLimit:c??"no_limit",targetCollectionStore:g,hasInverseRelation:!0,autoRelate:void 0,intl:a,connectedRelation:{integration_id:p},transaction:o}),y}({environment:t,transaction:e,collectionStore:v,collectionViewStore:S,collectionContextStore:o,intl:n,connectedRelationProperty:i,untypedFeatureArgs:l,propertyLimit:c,propertyName:y,formatKey:h});if((0,_().Z)({environment:t,collectionContextStore:o,from:"view_settings",property_id:m,property_type:"relation",integration_id:b,feature:{id:m,from:a,type:`notion://feature/connection_${b}`}}),!l)if(d){const e=v.getSchema(),n=null==e?void 0:e[m];P().a2({collectionSettingsStore:o.settingsStore,item:{type:"connectedRelationDatabaseActions",source:"connectedRelationAddProperties",rootPropertyId:m,integrationId:b,rootPropertySchema:n,skipDatabaseActions:!0,eventSource:"first_time_setup"}}),(0,r().u)({environment:t,event:{eventName:"salesforce_actions",eventProperties:{actionType:"add_properties_clicked",details:{source:"first_time_setup"},integrationId:b,collectionId:null==v?void 0:v.id}}})}else{const e={type:"property",property:m,formatKey:h};P().a2({collectionSettingsStore:o.settingsStore,item:e})}return m}})}async function H(e){const{property:{propertyId:t,propertySchema:o},collectionStore:n}=e,r=(0,p().Nv)(o);if((null==r?void 0:r.spaceId)!==n.getSpaceId())return;const i=c().m.createChildStore(n,r);if(await i.load(),null==i||!i.isDefined())return;if(i.getParentId()!==n.id)return;return(0,M().KA)({deletedSchema:n.getDeletedSchema(),property:t})}},403733:(e,t,o)=>{o.r(t),o.d(t,{arrowStraightDownSmallIcon:()=>r,iconDefinition:()=>n});o(296540);const n={viewBox:"0 0 16 16",fittedViewBox:"3.05 2.12 9.9 11.76",svg:(0,o(474848).jsx)("path",{d:"M8 2.125a.61.61 0 0 0-.625.599v9.017L4.122 8.488a.625.625 0 1 0-.884.884l4.32 4.32c.244.244.64.244.884 0l4.32-4.32a.625.625 0 0 0-.884-.884l-3.253 3.253V2.724A.61.61 0 0 0 8 2.125"})},r=(0,o(340498).wt)("arrowStraightDownSmall",n,"small")},419357:(e,t,o)=>{o.d(t,{Ay:()=>b,KF:()=>h,LG:()=>f,Zf:()=>S,yD:()=>v});var n=o(296540),r=()=>o(484714),i=()=>o(401497),a=()=>o(718827),l=()=>o(695115),s=()=>o(31511),c=()=>o(546926),d=()=>o(424400),u=()=>o(340498),p=()=>o(100622),m=()=>o(496603),g=()=>o(284371),y=o(474848);const f=30,v=28;function S(e){const{icon:t}=e;return t({fill:p().Tj.icon.secondary,width:u().Ev.sm,height:u().Ev.sm,flexGrow:0,flexShrink:0})}function h(e){const t=(0,r().WS)(),o=(0,i().eP)(),n=(0,i().IS)((()=>({outlineButton:{...(0,a().qq)({shape:"default",size:"sm",hasIconOnly:!0,isButtonGapEnabled:!0}),fontWeight:g().Wy.medium,lineHeight:1.2,border:`1px solid ${p().Tj.border.primaryTranslucent}`,background:e.hasBackground?p().Tj.background.primary:void 0},outlineButtonHovered:{background:p().Tj.background.secondary},outlineButtonPressed:{background:(0,a().yZ)({color:p().Tj.background.primary,mode:o})}})),[e.hasBackground,o]);return(0,y.jsx)(l().A,{size:"xs",colorVariant:"primary",...e,ariaLabel:e.ariaLabel,style:{...n.outlineButton,...e.style,height:t?f:v,width:t?f:v},hoveredStyle:n.outlineButtonHovered,pressedStyle:n.outlineButtonPressed})}const b=n.forwardRef((function({preventCaptureArrowShortcuts:e,preventCaptureDeleteWhenEmpty:t,preventCaptureClipboardShortcuts:r,preventCaptureSpacebarWhenEmpty:i,...a},l){const{left:s,right:u,inputLeft:p,inputRight:g,inputRightStyle:f,disableInput:v,inputOuterStyle:S,rightMobileEditLabel:h,mobileKeyboardOnDismiss:b,style:C,value:A,onChange:I,autosize:x,autosizeMinHeight:R,autosizeMaxHeight:k,customElementAttributes:P,disabled:T,format:F,id:M,placeholder:E,type:B,autoFocus:D,focus:L,focusInitial:j,focusAfterAnimation:N,forceShowClearButton:V,ignoreKeyboardMode:O,inputElementAttributes:K,inputStyle:U,isRightLastElementOfInput:z,maxlength:G,min:H,max:W,selectAll:Y,showClearButton:$,suppressFocusRing:q,textarea:Z,textareaSubmitOnEnter:Q,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:re,...ie}=a,[ae,le]=(0,n.useState)((()=>Boolean(L||j)));(0,n.useEffect)((()=>{void 0!==L&&le(L)}),[L]);const se=e?void 0:m().D_,ce=!t||A.length>0?m().D_:void 0,de=r?void 0:m().D_,ue=!i||A.length>0?m().D_:void 0,pe=(0,c().Tf)(),me=(0,n.useContext)(c().xu),ge=(0,n.useRef)(null),ye={value:A,onChange:I,autosize:x,autosizeMinHeight:R,autosizeMaxHeight:k,customElementAttributes:P,disabled:T,format:F,id:M,placeholder:E,type:B,autoFocus:D,focus:L,focusInitial:j,focusAfterAnimation:N,forceShowClearButton:V,ignoreKeyboardMode:O,inputElementAttributes:K,inputStyle:U,isRightLastElementOfInput:z,maxlength:G,min:H,max:W,selectAll:Y,showClearButton:$,suppressFocusRing:q,textarea:Z,textareaSubmitOnEnter:Q,onBlur:X,onCancel:J,onClearButtonClick:ee,onClick:te,onFocus:oe,onKeyDown:ne,onSubmit:re};return(0,y.jsx)(o(782482).N,{debugName:"InputMenuItem",capture:!0,onUntab:m().D_,onTab:m().D_,onSelectAll:m().D_,onRedo:m().D_,onUndo:m().D_,onToggleBold:m().D_,onToggleItalics:m().D_,onToggleCode:m().D_,onCut:de,onCopy:de,onPaste:de,onKeypress:m().D_,onLeft:se,onRight:se,onDelete:ce,onBackspace:ce,onSpace:ue,children:o(726637).A.isMobile?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(d().Ay,{ref:l,...ie,itemMarginLeft:pe?8:void 0,style:C,title:(0,y.jsx)(_,{ref:ge,left:s,right:u,inputLeft:p,inputRight:g,inputRightStyle:f,disableInput:v,inputOuterStyle:S,rightMobileEditLabel:h,isFocused:ae,setIsFocused:le,...ye})}),(0,y.jsx)(o(797324).A,{show:ae&&me.menuType!==c().gu.ActionSheet,onDismiss:b,inputRef:ge})]}):(0,y.jsx)(d().Ay,{ref:l,...ie,left:s,right:u,isTokenTitle:!0,title:(0,y.jsx)(w,{ref:ge,disableInput:v,inputOuterStyle:S,inputRight:g,inputRightStyle:f,inputLeft:p,...ye}),style:{paddingTop:4,paddingBottom:4,...C}})})}));function C({rightMobileEditLabel:e,inputRef:t}){const i=(0,r().v3)(),l=(0,n.useCallback)((e=>{e.preventDefault();const n=t.current;n&&(0,o(375555).G)(i,n)}),[i,t]);return(0,y.jsx)(a().Ay,{onClick:l,style:{color:p().Tj.text.secondary},children:e})}const w=n.forwardRef((function(e,t){const{disabled:o,disableInput:n,inputOuterStyle:r,inputRight:i,inputRightStyle:a,inputLeft:l,min:c,textarea:d,...u}=e;return(0,y.jsx)(s().A,{...u,ref:t,disabled:o||n,style:{height:d?void 0:28,padding:"3px 6px",...r},left:l,right:i,rightStyle:a,min:c,textarea:d})})),_=n.forwardRef((function(e,t){const{left:r,right:i,inputLeft:a,inputRight:l,inputRightStyle:c,disableInput:d,inputOuterStyle:u,rightMobileEditLabel:p,isFocused:m,setIsFocused:g,disabled:f,showClearButton:v,onBlur:S,onFocus:h,...b}=e,w=(0,n.useCallback)((e=>{g(!1),S&&S(e)}),[S,g]),_=(0,n.useCallback)((e=>{g(!0),h&&h(e)}),[h,g]),A=(0,n.useRef)(null),I=(0,o(93583).A)(A,t),x=p&&!m?(0,y.jsx)(C,{rightMobileEditLabel:p,inputRef:A}):null;return(0,y.jsx)(s().A,{...b,ref:I,format:"transparent",style:{fontSize:16,...u},onFocus:_,onBlur:w,showClearButton:!1!==v,disabled:f||d,left:a||r,right:x||l||i,rightStyle:c})}))},495576:(e,t,o)=>{o.d(t,{d:()=>R});var n=o(296540),r=()=>o(968578),i=()=>o(484714),a=()=>o(590526),l=()=>o(69708),s=()=>o(896628),c=()=>o(401497),d=()=>o(534177),u=()=>o(738471),p=o(474848);function m({src:e,placeholderSrc:t,placeholderBehavior:o,imageStyle:r,containerStyle:i,onLoadComplete:a,testId:l}){const[s,m]=(0,n.useState)(!0);let g;switch(o){case"force-show-placeholder":g=!0;break;case"force-show-src":g=!1;break;case"show-placeholder-if-loading-src":g=!!t&&(s||void 0===e);break;default:(0,d().HB)(o)}const y=(0,c().IS)((()=>{const e={gridColumn:1,gridRow:1};return{container:{display:"grid",...i},srcWrapper:{...g&&{display:"none"},...e},placeholderWrapper:{pointerEvents:"none",...e}}}),[i,g]);(0,n.useEffect)((()=>{void 0!==e&&m(!0)}),[e]);const f=(0,n.useCallback)((e=>{m(!1),null==a||a()}),[a]);return(0,p.jsxs)("div",{style:y.container,children:[(0,p.jsx)(u().A,{src:e,onLoad:f,style:r,placeholderStyle:y.srcWrapper,placeholderLoadedStyle:y.srcWrapper,testId:l}),t?(0,p.jsx)(u().A,{src:t,style:r,placeholderStyle:y.placeholderWrapper,placeholderLoadedStyle:y.placeholderWrapper}):void 0]})}var g=()=>o(19771),y=()=>o(360083),f=()=>o(801678),v=()=>o(984007),S=()=>o(504023),h=()=>o(821507),b=()=>o(568365),C=()=>o(77246),w=()=>o(244828),_=()=>o(79926);const A=new(_().O2)("AnimatedCoverImageActionBar",(async()=>Promise.all([o.e(75134),o.e(35530),o.e(36556),o.e(55373),o.e(36192),o.e(27992),o.e(63452),o.e(66249),o.e(87249),o.e(79022),o.e(34877),o.e(59218),o.e(40454)]).then(o.bind(o,166913)))),I=(0,_()._h)(A,(e=>e.AnimatedCoverImageActionBar)),x=280;function R(e){const{store:t,disabled:o,paddingRight:c,paddingLeft:d,height:u,proxyWidth:_}=e,A=(0,l().tz)(),R=(0,i().v3)(),P=(0,i().Y0)(),T=(0,a().uB)(void 0,r().A),F=(0,a().K8)((()=>o||"suggest"===C().Uv.getMode(t)||(0,h().aD)(P)),[o,t,P]),M=(0,a().K8)((()=>t.getCover()),[t]),E=(0,a().O$)(b().M),B=(0,S().x)(t.id),[D,L]=(0,n.useState)(void 0);if(!M)return null;const j=E.loadingMode!==v().pF&&E.loadingMode!==v().Wc;return(0,p.jsx)(f().A,{mouseStore:T,onFlushTemporaryPosition:e=>function(e,t,o){const{imagePosition:n,reset:r}=e;w().createAndCommit({userAction:"PageCover.handleFlushTemporaryPosition",environment:o,canUndo:!0,perform:e=>{s().yY({store:t,coverPosition:n,transaction:e}),r()}})}(e,t,R),renderControl:({handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:n,isVisible:r,isRepositioning:i})=>F?null:(0,p.jsx)(I,{store:t,mouseStore:T,imageUrl:D,handleRepositionClick:e,handleSavePositionClick:o,handleCancelClick:n,visible:r||B,isRepositioning:i,paddingLeft:d,paddingRight:c}),source:"page",store:t,style:{display:"flex",flexDirection:"column",alignItems:"center",height:u,maxHeight:x,cursor:"default"},preventClickPropagation:!0,render:e=>(0,p.jsxs)(n.Fragment,{children:[(0,p.jsx)(y().A,{url:M.cover,isAuthenticated:!0,permissionRecord:M.pointer,width:_,onFinishedLoadingProxyUrl:L,render:(t,o)=>{const n={width:"100%",height:u,maxHeight:x,objectFit:"cover",opacity:j?.5:1,objectPosition:`center ${100*(1-(e.imagePosition||0))}%`,borderRadius:0},r={width:"100%",height:u,maxHeight:x};return(0,p.jsx)(m,{src:o,placeholderSrc:j?E.dataURL:void 0,placeholderBehavior:j?"force-show-placeholder":"show-placeholder-if-loading-src",containerStyle:r,imageStyle:n,onLoadComplete:k,testId:"pageCover"})}},M.pointer.id),j?(0,p.jsx)(g().X,{variant:"spinner",percentage:E.uploadProgress,text:void 0!==E.uploadProgress?void 0:E.progressText}):B?(0,p.jsx)(g().X,{variant:"dots",text:A.formatMessage({id:"CoverImageActionBar.generatingCover",defaultMessage:"Generating..."})}):void 0]})})}function k(){b().M.reset()}},508390:(e,t,o)=>{o.d(t,{LA:()=>I,jJ:()=>x});o(296540);var n=()=>o(484714),r=()=>o(590526),i=()=>o(401497),a=()=>o(718827),l=()=>o(807449),s=()=>o(98126),c=()=>o(584262),d=()=>o(403733),u=()=>o(69708),p=()=>o(100622),m=()=>o(124311),g=()=>o(571628),y=()=>o(316369),f=()=>o(152077),v=()=>o(635462),S=()=>o(888643),h=()=>o(519200),b=()=>o(535960),C=()=>o(440024),w=()=>o(540355),_=o(474848);const A=30,I=33;function x(e){const{style:t,iconStyle:o,store:I,format:x,collectionContextStore:R,groupsPointer:k,incrementLimitsInRelatedGroups:P,isFullScreen:T}=e,F=(0,n().v3)(),M=(0,r().K8)((()=>R.groupsStore.getGroupState(k)),[R,k]),E=(0,r().K8)((()=>(0,g().Kk)({collectionContextStore:R,groupsPointer:k})),[R,k]),B=(0,r().O$)(R.isInHomeWidgetStore),D=(0,f().lU)(),L="PersonalHome"===D||"TeamHome"===D,j=(0,i().IS)((()=>({homeContainer:{display:"flex",alignItems:"center",justifyContent:"center"},button:{display:"flex",alignItems:"center",justifyContent:"center",height:A,borderRadius:6,whiteSpace:"break-spaces",fontSize:14,...B?{textAlign:"center",width:"fit-content",marginInlineStart:12,marginBottom:0,padding:4}:{},...t},loadingContainer:{marginTop:1,marginInlineStart:8,marginInlineEnd:8},icon:{marginInlineEnd:6,...o},text:{color:p().Tj.text.tertiary,width:"100%",fontSize:B?14:void 0},...E&&{hoveredStyle:{background:p().Tj.whiteButtonBackground}}})),[B,t,o,E]),N=(0,r().K8)((()=>I.canEdit()),[I]);return M?B||L?(0,_.jsx)("div",{style:j.homeContainer,children:(0,_.jsx)(a().Ay,{onClick:e=>function(e,t,o){const n=e.metaKey||e.ctrlKey?"tab":void 0,r=(0,v().s)(o.id)?c().y8.PersonalHomeTileTasks:c().y8.PersonalHomeTileCustomDb;(0,b().u)({environment:t,store:o,pageVisitSource:r,openInNew:n})}(e,F,I),onMouseDown:h().t,style:j.button,children:(0,_.jsx)("div",{style:j.text,children:(0,_.jsx)(u().sA,{id:"database.viewAllButtonTitle",defaultMessage:"View all"})})})}):(0,_.jsxs)(a().Ay,{onClick:e=>function(e,t,o,n,r,i){const a=o.groupsStore.getGroupState(n);if(!a)return;const l=a.reducerResultStore.state;(0,S().k)(e),(0,C().I)({environment:t}),l&&(0,w().H)({collectionContextStore:o,environment:t,incrementLimitArgs:{isFullScreen:i,currentResultCount:l.blockIds.length,groupsPointer:a.groupsPointer,incrementLimitsInRelatedGroups:r}});(0,m().K)(t)}(e,F,R,k,P,T),onMouseDown:h().t,disabled:E,...E&&{hoveredStyle:j.hoveredStyle}||{},style:j.button,children:[(0,_.jsx)(l().I,{icon:d().arrowStraightDownSmallIcon,size:"sm",colorVariant:"tertiary",style:j.icon}),(0,_.jsx)("div",{style:j.text,children:(0,_.jsx)(u().sA,{id:"database.loadMoreButtonTitle",defaultMessage:"Load more"})}),E?(0,_.jsx)("div",{style:j.loadingContainer,children:(0,_.jsx)(s().A,{size:"sm"})}):N&&(0,_.jsx)(y().w,{collectionContextStore:R,format:x})]}):null}},540355:(e,t,o)=>{o.d(t,{H:()=>r});var n=()=>o(314529);function r(e){const{collectionContextStore:t,environment:o,incrementLimitArgs:r}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetailsStore.setState({type:"load_more_blocks",group:r.groupsPointer}),(0,n().DO_NOT_USE_trackLegacy)(o,"collection_load_more_blocks")}},568365:(e,t,o)=>{o.d(t,{M:()=>n});const n=new(o(984007).Ay)},654774:(e,t,o)=>{o.d(t,{x:()=>d});var n=()=>o(115438),r=()=>o(906536),i=()=>o(232615),a=()=>o(355110),l=()=>o(184033),s=()=>o(238121),c=()=>o(718957);function d(e){var t;(0,n().l)();const{environment:o,store:d,canSelectAllBlocks:u}=e,p=(0,l().s)(d),m={startIndex:0,endIndex:p?p.endIndex:0};u&&"empty"!==i().default.state.mode&&(0,s().G)(null===(t=(0,c().cR)("textSelectionActions",i().default.state.multiSelection))||void 0===t?void 0:t.selection,m)?(0,a().U)(o):(0,r().t)({store:d,selection:m})}},736986:(e,t,o)=>{o.d(t,{V:()=>i});var n=()=>o(59226),r=()=>o(590526);function i(e){const t=(0,n().X)("can_create_pages_in_collection_permission"),o=(0,r().K8)((()=>!e.isFullyNonInteractiveStore.state&&e.permissionScopesStore.state.canCreatePagesInCollection),[e]);return t&&o}},777045:(e,t,o)=>{o.d(t,{w:()=>s});o(296540);var n=()=>o(590526),r=()=>o(489242),i=()=>o(69708),a=()=>o(665738),l=o(474848);function s(e){const{collectionContextStore:t}=e,o=(0,i().tz)(),s=(0,n().K8)((()=>{var e;const n=(0,r().ZV)({intl:o,itemNameConfig:null===(e=t.collectionStore())||void 0===e||null===(e=e.getModel())||void 0===e?void 0:e.getItemNameConfigV2()}).singular;return n?o.formatMessage(a().B.addTypedItemTitle,{singleItemName:n}):t.databaseTypeFromStoreState?(0,r().Mw)(o,t.databaseTypeFromStoreState):(0,r()._o)(o,null===(i=t.collectionStore())||void 0===i?void 0:i.getModel());var i}),[t,o]);return(0,l.jsx)(l.Fragment,{children:s})}},780863:(e,t,o)=>{o.d(t,{p:()=>s});var n=o(296540),r=()=>o(40845),i=()=>o(496603),a=()=>o(440024);const l={isRepositioning:!1};function s(e){const{currentPosition:t,imageUrl:o,onSavePosition:s,onPositionChange:c,rootRef:d,environment:u}=e,[p,m]=(0,n.useState)(l),{isRepositioning:g}=p,y=(0,n.useCallback)((()=>{m(l)}),[]),f=(0,n.useMemo)((()=>void 0!==p.temporaryPosition?p.temporaryPosition:t),[p.temporaryPosition,t]);(0,n.useEffect)((()=>{c&&c(f)}),[f,c]);const v=(0,n.useCallback)((e=>{(0,a().I)({environment:u});const t=new Image;t.onload=()=>{m((e=>({...e,isRepositioning:!0,image:t})))};const n=e||o;n&&(t.src=n)}),[u,o]),S=(0,n.useCallback)((()=>{s(f),y()}),[s,f,y]),h=(0,n.useCallback)((()=>{y()}),[y]);(0,n.useEffect)((()=>{const e=e=>{const t=d.current;t&&e.target instanceof Node&&!t.contains(e.target)&&g&&S()};return g&&window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}}),[g,S,d]);const b=(0,n.useCallback)((e=>{const{image:t}=p;if(!t||!g)return;const o=d.current;if(o&&o instanceof Element){const e=o.getBoundingClientRect().width/t.width*t.height;m((t=>({...t,startDragImageScreenHeight:e,startDragRenderedPosition:f})))}}),[p,g,f,d]),C=(0,n.useCallback)((e=>{if(!g)return;const{startDragImageScreenHeight:t,startDragRenderedPosition:o}=p,n=e.diffY/(t||0)+(o||0);m((e=>({...e,temporaryPosition:(0,i().LI)((0,r().A)(n,0,1),4)})))}),[g,p]),w=(0,n.useCallback)((()=>{m((e=>({...e,startDragImageScreenHeight:void 0,startDragRenderedPosition:void 0})))}),[]),_=(0,n.useMemo)((()=>g?"ns-resize":"default"),[g]);return{isRepositioning:g,currentImagePosition:f,handleDragStart:b,handleDragMove:C,handleDragEnd:w,handleStartReposition:v,handleSavePosition:S,handleCancelReposition:h,repositioningCursor:_}}},797324:(e,t,o)=>{o.d(t,{A:()=>y});var n=o(296540),r=()=>o(560520),i=()=>o(484714),a=()=>o(790748),l=()=>o(581010),s=()=>o(69708),c=()=>o(100622),d=()=>o(284371),u=()=>o(396406),p=()=>o(718827),m=()=>o(843798),g=o(474848);function y(e){const{onDismiss:t,inputRef:o}=e,y=(0,i().Y0)(),f=(0,n.useRef)(null),v=y.isMobileNative&&y.isIOS,S=v&&e.show;(0,a().b)(l().A,(()=>({getNode:()=>f.current,isShown:()=>S})),[S]);const h=(0,r().n)(),b=(0,n.useCallback)((()=>{var e;null==o||null===(e=o.current)||void 0===e||e.focus(),t&&t();const n=document.activeElement;n instanceof HTMLElement&&n.blur()}),[o,t]);if(!v)return null;const C=S?-(m().j+h):0;return(0,g.jsx)(u().O,{open:!0,children:(0,g.jsx)("div",{style:{position:"fixed",top:"100vh",width:"100%",height:m().j,display:S?"flex":"none",alignItems:"center",justifyContent:"flex-end",backgroundColor:c().Tj.keyboardDoneBarBackground,transform:`translateY(${C}px)`,transition:S?"ease-out":"ease-in",boxShadow:S?`\n\t\t\t\t\t\t\t\t0 -1px 0 ${c().Tj.border.primaryTranslucent}\n\t\t\t\t\t\t\t`:void 0},ref:f,children:(0,g.jsx)(p().Ay,{style:{display:"flex",alignItems:"center",marginInlineEnd:16,color:c().oZ.blue,fontWeight:d().Wy.semibold},onTouchEnd:()=>{b()},children:(0,g.jsx)(s().sA,{defaultMessage:"Done",id:"mobile.dismissKeyboardBar.button.label"})})})})}},801678:(e,t,o)=>{o.d(t,{A:()=>y});var n=o(296540),r=()=>o(756117),i=()=>o(590526),a=()=>o(609679),l=()=>o(69708),s=()=>o(100622),c=()=>o(496603),d=()=>o(806080),u=()=>o(284371),p=()=>o(720665),m=()=>o(46986),g=o(474848);const y=function(e){const t=(0,n.useRef)(null),r=(0,o(484714).v3)(),{renderControl:a,onFlushTemporaryPosition:l,style:s,source:u,store:y}=e,v=(0,i().K8)((()=>0===o(206051).default.state.stores.length),[]),[S,h]=(0,n.useState)(!1),b=(0,i().uB)(e.mouseStore,o(968578).A),C=(0,i().K8)((()=>b.state.mouseEntered),[b]),w=(0,i().K8)((()=>function(e,t){if("gallery"===e||"board"===e){const e=t.getFormat().card_cover_position;if((0,d().Et)(e))return e}const o=.5;var n;if((0,m().V)())return(null===(n=t.getCover())||void 0===n?void 0:n.cover_position)??o;if(t.isCollectionView()){const e=t.getCollectionStoreIfSingleSource();if(e){const t=e.getFormat().collection_cover_position;return(0,p().pN)(t)?o:t}}const r=t.getFormat(),i=r.page_cover_position;if((0,d().Et)(i))return i;return o}(u,y)),[u,y]),{isRepositioning:_,currentImagePosition:A,handleDragStart:I,handleDragMove:x,handleDragEnd:R,handleStartReposition:k,handleSavePosition:P,handleCancelReposition:T,repositioningCursor:F}=(0,o(780863).p)({currentPosition:w,onSavePosition:e=>{l({imagePosition:e,reset:()=>{b.reset()}})},rootRef:t,environment:r}),M=(0,o(401497).IS)((()=>({dragContainer:{width:"100%",cursor:F},container:{position:"relative",width:"100%",zIndex:1}})),[F]);_&&!v&&T();const E=(0,n.useMemo)((()=>(0,c().nF)((e=>{b.setState({...b.state,mouseEntered:!0})}),100)),[b]),B=(0,n.useMemo)((()=>(0,c().sg)((e=>{b.setState({...b.state,mouseEntered:!1})}),100)),[b]),D=(0,n.useCallback)(((e,t)=>{k(t)}),[k]),L=(0,n.useCallback)((e=>{P()}),[P]),j=(0,n.useCallback)((e=>{const t=e.target;void 0!==t&&t instanceof HTMLElement&&(0,o(819121).p)(t)&&h(!0)}),[]),N=(0,n.useCallback)((()=>{h(!0)}),[]),V=(0,i().K8)((()=>a({handleRepositionClick:D,handleSavePositionClick:L,handleCancelClick:T,isVisible:C||S||_,isRepositioning:_})),[D,L,T,S,_,C,a]),O=(0,o(870956).A)(Boolean(e.preventClickPropagation));return(0,g.jsxs)("div",{ref:t,onFocus:j,onBlur:N,onMouseEnter:E,onMouseMove:E,onMouseLeave:B,...O,...(0,o(451306).ow)(M.container,s),children:[(0,g.jsx)(o(222321).A,{onDraggableDragStart:I,onDraggableDragMove:x,onDraggableDragEnd:R,onDraggableDragCancel:R,disabled:!_,render:t=>(0,g.jsx)("div",{style:M.dragContainer,...t,children:e.render({imagePosition:A,isRepositioning:_})})}),(0,g.jsx)(f,{small:e.small,isRepositioning:_}),V]})};function f({small:e,isRepositioning:t}){if(e)return null;const o={background:s().IF.blackWithAlpha(.4),borderRadius:4,color:s().oZ.white,fontSize:12,fontFamily:u().vc(a().locale).sans,width:180,insetInlineStart:"calc(50% - 90px)",padding:"0.3em 1.5em 0.3em",pointerEvents:"none",position:"absolute",top:"calc(50% - 10px)",textAlign:"center"};return(0,g.jsx)(r().A,{visible:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:o,children:(0,g.jsx)(l().sA,{defaultMessage:"Drag image to reposition",id:"withImageRepositioning.dragImage.text"})})}},825225:(e,t,o)=>{o.d(t,{y:()=>u});var n=()=>o(484714),r=()=>o(590526),i=()=>o(79926),a=()=>o(89053),l=()=>o(908201),s=()=>o(842076),c=()=>o(862292),d=()=>o(186348);function u(e){const t=(0,l().Ks)(),{schema:o,viewType:u}=(0,r().K8)((()=>({schema:null==t?void 0:t.normalizedSchemaStore.state,viewType:null==t?void 0:t.getViewType()})),[t]),{value:p}=(0,i().fJ)(c().T.formulas),m=(0,n().v3)(),g=(0,r().K8)((()=>{var o,n;if(!e||!t)return;const r=null===(o=t.conditionalColorStore((0,a().i)()))||void 0===o||null===(o=o.state)||void 0===o?void 0:o.getBlockConditionalColor({blockStore:e,propertyMapping:null===(n=t.collectionStore())||void 0===n?void 0:n.getPropertyMapping(),shouldReturnAllMatchingColorRules:!1,formulasModule:p,getRelationEdgeList:(0,s().Y)({environment:m,spaceId:e.getSpaceId()})});return r&&r.length>0?r[0]:void 0}),[e,t,p,m]);return(0,d().h)({conditionalColor:g,store:e,schema:o,viewType:u})}},928213:(e,t,o)=>{o.d(t,{c:()=>a});var n=()=>o(165358),r=()=>o(519831),i=()=>o(753812);async function a(e){const{environment:t,collectionStore:o}=e,a={id:o.id,table:r().Vl,spaceId:o.getSpaceId()},l=await i().callApi({eventName:"suggestRecordKey",environment:t,data:{...a,shouldSetSuccessfullySuggestedRecord:!0}});if("success"===l.type)return l.data.key;n().log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:l.error.message}})}},984007:(e,t,o)=>{o.d(t,{Ay:()=>s,Gi:()=>i,Wc:()=>n,pF:()=>a,vS:()=>r});const n="loadingLocalImage",r="uploading",i="downloading",a="loaded";class l extends(()=>o(757695))().Store{getInitialState(){return{loadingMode:a}}}const s=l}}]);