"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[78217],{22102:(e,t,n)=>{n.d(t,{k:()=>r});const r=new(n(79926).O2)("isTemplate",(async()=>await n.e(6993).then(n.bind(n,826880))))},26947:(e,t,n)=>{n.d(t,{t:()=>s});var r=()=>n(907258),o=()=>n(242422),i=()=>n(726637),a=()=>n(262661);function s(){if(i().A.isMobile)return!1;const{currentUserSettingsStore:e}=r().default.state;if(!e)return!1;const t=(0,a().i)(e);return!("number"==typeof t&&t>7)&&"on"===o().default.getEligibleGroup({experimentId:"slash_menu_tooltip",defaultGroup:"control"})}},74464:(e,t,n)=>{n.d(t,{i:()=>i});n(296540);var r=()=>n(416783),o=n(474848);function i(e,t){return(0,o.jsx)(r().V,{href:e,children:t})}},80157:(e,t,n)=>{n.d(t,{A:()=>m});n(296540);var r=()=>n(907258),o=()=>n(484714),i=()=>n(590526),a=()=>n(75435),s=()=>n(526323),c=()=>n(100622),l=()=>n(696746),d=()=>n(665579),u=()=>n(427984),p=n(474848);function m({children:e}){const t=(0,o().v3)(),n=(0,i().K8)((()=>{var e;const{mainEditorCurrentBlockStore:n}=r().default.state,o=(0,l().lU)(n),i=t.device.isPhone;return{width:"100vw",height:"100%",position:"relative",display:"flex",flex:1,background:Boolean(null===(e=a().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)||(0,s().Em)(t.RouterStore.state.route.name)?"rgba(0, 0, 0, 0)":o?(0,d().Lu)({isPhone:i}):c().Tj.background.primary}}),[t]);return(0,p.jsx)(u().A,{style:n,children:e})}},98444:(e,t,n)=>{n.d(t,{T:()=>o});var r=()=>n(763884);function o({RouterStore:e,currentUserId:t}){const n=e.state.id;r().K.remove({userId:t,key:n})}},107461:(e,t,n)=>{n.d(t,{H:()=>o});var r=()=>n(44551);function o(e){var t;null===r().electronApi||void 0===r().electronApi||null===(t=r().electronApi.setWindowTitle)||void 0===t||t.call(r().electronApi,e)}},110573:(e,t,n)=>{n.d(t,{E:()=>o});n(898992),n(354520),n(737550);var r=()=>n(365917);const o=new(n(140934).ComputedStore)((()=>{var e;const{sidebarSpaceViewStore:t}=n(907258).default.state;if(!t||!t.isReady())return{loading:!0,botId:void 0,botSpaceId:void 0,botUserId:void 0};const o=t.getSelectedCalendarBotId();if(o&&!r().A.state.loaded)return{loading:!1,botId:o,botSpaceId:t.getSpaceId(),botUserId:t.getUserId()};const{spaceId:i,userId:a}=r().A.state.loaded?r().A.state:{spaceId:void 0,userId:void 0},s=r().A.bots.state.filter((e=>e.integration_id===n(617871).io)),c=null===(e=s[0])||void 0===e?void 0:e.id,l=o&&s.some((e=>e.id===o))?o:c;return{loading:!r().A.state.loaded||r().A.state.loading,botId:l,botSpaceId:i,botUserId:a}}),{debugName:"CalendarBotIdStore"})},137493:(e,t,n)=>{new(n(29923).R)({key:"SimulateOffline",namespace:"Offline",important:!0,trackingType:"necessary"})},160778:(e,t,n)=>{n.r(t),n.d(t,{AppRoot:()=>fo});var r=n(296540),o=()=>n(884780),i=()=>n(366326),a=()=>n(59226),s=()=>n(726637),c=()=>n(136590),l=()=>n(312788),d=()=>n(560198),u=()=>n(609679),p=()=>n(69708),m=(n(898992),n(354520),()=>n(591779)),f=()=>n(496603),v=()=>n(106959),g=n(474848);function h(e){const t=(0,r.useRef)(new Map),n=(0,r.useCallback)((()=>{const n=Array.from(t.current.values()).filter((e=>e.isSpawned)),r=n.length-e.maxPreferredIFrames;if(r<=0)return;const o=n.filter((e=>!e.isVisible));o.sort(((e,t)=>e.latestTimestamp-t.latestTimestamp));for(const e of o.slice(0,r))e.isSpawned=!1,e.onVisibilityChange(!1)}),[e.maxPreferredIFrames]),o=(0,r.useCallback)((e=>{for(const n of e){if(!(n.target instanceof HTMLElement))continue;const e=t.current.get(n.target);e&&(e.isVisible=n.isIntersecting,e.latestTimestamp=n.time,e.isVisible&&!e.isSpawned&&(e.isSpawned=!0,e.onVisibilityChange(!0)))}n()}),[n]),i=(0,r.useRef)(void 0!==window.IntersectionObserver?new IntersectionObserver(o):null);(0,r.useEffect)((()=>()=>{i.current&&(i.current.disconnect(),i.current=null)}),[]);const a=(0,m().ZC)(e.maxPreferredIFrames);(0,r.useEffect)((()=>{a&&e.maxPreferredIFrames<a&&n()}),[n,e.maxPreferredIFrames,a]);const s=(0,r.useMemo)((()=>({track:(e,n)=>{i.current?(t.current.set(e,{isVisible:!1,isSpawned:!1,latestTimestamp:0,onVisibilityChange:f().sg(n,50)}),i.current.observe(e)):v().mm.track(e,n)},untrack:e=>{i.current?(i.current.unobserve(e),t.current.delete(e)):v().mm.untrack(e)}})),[]);return(0,g.jsx)(v().jq.Provider,{value:s,children:e.children})}function b(e){let t=s().A.isMobile?10:50;return e.ramSizeInGB&&(t=Math.floor(2*e.ramSizeInGB)),{maxPreferredIFrames:t}}var S=()=>n(314529),y=()=>n(242422),w=()=>n(17022),_=()=>n(484714),k=()=>n(785082),A=()=>n(745875);function I({id:e,targetRenderPhase:t="all",samplePercent:n=1,children:o}){const i=(0,_().v3)(),a=(0,r.useCallback)(((e,r,o,a,s,c)=>{(0,A().rQ)(n)&&("all"!==t&&r!==t||(0,S().DO_NOT_USE_trackLegacy)(i,`${k().PX}.${e}`,{time:o,render_phase:r}))}),[i,t,n]),[s]=(0,r.useState)(w().e.withListenerIgnored((()=>y().default.checkGate({gateName:"client-performance-profiler"}))));return s?(0,g.jsx)(r.Profiler,{id:e,onRender:a,children:o}):(0,g.jsx)(g.Fragment,{children:o})}var E=()=>n(590526),C=()=>n(401497),T=()=>n(631524),P=()=>n(607567),x=()=>n(100622);class L extends(()=>n(757695))().Store{getInitialState(){return{enabled:!1}}toggle(){this.setState({enabled:!this.state.enabled})}setEnabled(e){this.setState({enabled:e})}}const R=new L;function U(e){const{children:t}=e,n=(0,a().X)("string_id_debug_mode"),o=(0,E().K8)((()=>R.state.enabled),[]),i=(0,p().tz)(),s=(0,r.useMemo)((()=>{if(!o)return;const e=(0,p().MT)(),t=(0,p().EY)({locale:i.locale,messages:{}},e),n=t.formatMessage.bind(t);return Object.assign({},t,{formatMessage:(e,t)=>n({...e,defaultMessage:void 0},t)})}),[o,i.locale]),c=o&&s?s:i;return(0,g.jsxs)(g.Fragment,{children:[n?(0,g.jsx)(D,{isEnabled:o,onToggle:()=>R.toggle()}):void 0,(0,g.jsx)(p().Lq,{value:c,children:t})]})}function D(e){const{isEnabled:t,onToggle:n}=e,o=(0,p().tz)(),[i,a]=(0,r.useState)(!1),s=(0,C().IS)((()=>({container:{position:"fixed",bottom:8,insetInlineEnd:8,zIndex:1e4,padding:4},plainButton:{color:t?x().Tj.blue.text.primary:x().Tj.text.primary,opacity:i?1:0,transition:"opacity 0.2s ease-in-out",pointerEvents:i?"auto":"none"}})),[i,t]);return(0,g.jsx)("div",{style:s.container,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:(0,g.jsx)(T().p,{colorPalette:t?"blue":"gray",style:s.plainButton,iconLeading:{icon:P().Z,colorPalette:t?"blue":void 0,colorVariant:t?"accentPrimary":"primary"},onClick:n,children:o.formatMessage({id:"stringIdDebug.toggle",defaultMessage:"String ID Debug"})})})}var M=()=>n(346);function N(){return(0,M().kg)()?(0,g.jsx)(M().MG,{}):null}var O=()=>n(907258),j=()=>n(852507),B=()=>n(723085),q=()=>n(554279),W=()=>n(172385),z=()=>n(590265),F=()=>n(651784),$=()=>n(427704),K=()=>n(854150),V=()=>n(802149),H=()=>n(734459),G=()=>n(530199),J=()=>n(496703),Z=()=>n(939768),Q=()=>n(946141),X=()=>n(561503),Y=()=>n(209660),ee=()=>n(942906),te=(n(944114),()=>n(244828)),ne=()=>n(680977);var re=()=>n(79926);const oe=(0,re()._h)(new(re().O2)("Admin",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,214397)))),(e=>e.Admin)),ie=(0,re()._h)(new(re().O2)("AdminSectionPage",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,784111)))),(e=>e.AdminSectionPage)),ae=(0,re()._h)(new(re().O2)("AdminListData",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,284290)))),(e=>e.default)),se=(0,re()._h)(new(re().O2)("AdminObjectRedirect",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,814740)))),(e=>e.AdminObjectRedirect)),ce=(0,re()._h)(new(re().O2)("AdminPermissionsPage",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,545175)))),(e=>e.AdminPermissionsPage)),le=(0,re()._h)(new(re().O2)("AdminSingleRecord",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,638677)))),(e=>e.AdminSingleRecord)),de=(0,re()._h)(new(re().O2)("AdminWorkersDetailPage",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,838165)))),(e=>e.AdminWorkersDetailPage)),ue=(0,re()._h)(new(re().O2)("AdminWorkersHomePage",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,349875)))),(e=>e.AdminWorkersHomePage)),pe=(0,re()._h)(new(re().O2)("AdminWorkersListPage",(()=>Promise.all([n.e(75134),n.e(44711),n.e(53321),n.e(64038),n.e(96193),n.e(91793),n.e(76690),n.e(59218),n.e(26135),n.e(23930),n.e(19884)]).then(n.bind(n,302834)))),(e=>e.AdminWorkersListPage));var me=()=>n(267956),fe=()=>n(26947),ve=()=>n(650829),ge=()=>n(383070),he=()=>n(557297),be=()=>n(770160);const Se=new(re().O2)("HelpButton",(async()=>await n.e(31638).then(n.bind(n,934112)))),ye=(0,re()._h)(Se,(e=>e.default)),we=new(re().O2)("ForkPageModalWrapper",(async()=>await Promise.all([n.e(44590),n.e(37384),n.e(27761)]).then(n.bind(n,493913)))),_e=(0,re()._h)(we,(e=>e.ForkPageModalWrapper));var ke=()=>n(682497);const Ae=new(re().O2)("SecondarySidebar",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(77754),n.e(13023),n.e(45277),n.e(31478),n.e(95281)]).then(n.bind(n,191097)))),Ie=(0,re()._h)(Ae,(e=>e.SecondarySidebar)),Ee=new(re().O2)("SpaceSettings",(async()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(62475),n.e(3151),n.e(98629),n.e(22926),n.e(22900),n.e(42838),n.e(85128),n.e(49889),n.e(20108),n.e(46174),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(69785),n.e(77754),n.e(29357),n.e(64242),n.e(39986),n.e(22585),n.e(47160),n.e(76677),n.e(68609),n.e(37384),n.e(15553),n.e(77345),n.e(79340),n.e(72659),n.e(37759),n.e(41423),n.e(42056),n.e(41751),n.e(41714),n.e(5181),n.e(19456),n.e(3261),n.e(23371),n.e(17729),n.e(32116),n.e(65375),n.e(94995),n.e(98339),n.e(51240),n.e(54219),n.e(20029),n.e(68395),n.e(81803),n.e(96654),n.e(68643),n.e(32625),n.e(79231),n.e(63687),n.e(95885),n.e(27083),n.e(11424),n.e(40119),n.e(54742),n.e(88522),n.e(90880),n.e(49175),n.e(69668),n.e(5331),n.e(92924),n.e(71381),n.e(92192),n.e(96385),n.e(80326),n.e(53352),n.e(2373),n.e(73069),n.e(995),n.e(76690),n.e(60713),n.e(31106),n.e(63248),n.e(54719),n.e(48570),n.e(78862),n.e(54234),n.e(85160),n.e(15381),n.e(77149),n.e(86036),n.e(68466),n.e(77651),n.e(51204),n.e(57105),n.e(3759),n.e(44128),n.e(95103),n.e(58071),n.e(75681)]).then(n.bind(n,774896)))),Ce=(0,re()._h)(Ee,(e=>e.SpaceSettings)),Te=new(re().O2)("StopDictationButtonMobile",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,810914)))),Pe=(0,re()._h)(Te,(e=>e.StopDictationButtonMobile)),xe=new(re().O2)("StopDictationListener",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,842351)))),Le=(0,re()._h)(xe,(e=>e.StopDictationListener)),Re=new(re().O2)("TranscriptionBlockDemoVideoModal",(async()=>await Promise.all([n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(40992),n.e(88455),n.e(49021),n.e(71136),n.e(86341),n.e(13131),n.e(14889)]).then(n.bind(n,448529)))),Ue=(0,re()._h)(Re,(e=>e.TranscriptionBlockDemoVideoModal)),De=(0,re()._h)(new(re().O2)("TranscriptionUsageFetcher",(()=>n.e(30879).then(n.bind(n,403966)))),(e=>e.TranscriptionUsageFetcher)),Me=new(re().O2)("InPageFind",(async()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(40992),n.e(88455),n.e(33893),n.e(48486),n.e(28958)]).then(n.bind(n,907015)))),Ne=(0,re()._h)(Me,(e=>e.InPageFind));var Oe=()=>n(753035),je=()=>n(614949),Be=()=>n(38554),qe=()=>n(877051);const We=new(re().O2)("MaybeInAppActivityRenderer",(async()=>await Promise.all([n.e(44711),n.e(53321),n.e(49021),n.e(6039),n.e(13131),n.e(39005),n.e(48854),n.e(30673)]).then(n.bind(n,212137)))),ze=(0,re()._h)(We,(e=>e.MaybeInAppActivityRenderer));var Fe=()=>n(762014);function $e(e){return(0,g.jsx)("div",{id:"test-customer-io",style:{width:334,height:200,position:"absolute",bottom:64,insetInlineEnd:21,zIndex:1,display:e?void 0:"none"}})}const Ke=function(){const e=(0,_().v3)(),{currentUser:t}=e,o=(0,E().K8)((()=>t.isLoggedIn()),[t]),i=(0,n(404694).V)(),a="light"===(0,C().eP)();(0,r.useEffect)((()=>{o&&(i.getCalloutVisibility("customer_io").canShow?a?Fe().A.state.suppressReason===Fe().e.IN_APP_CALLOUT_CONFLICT?Fe().A.setState({...Fe().A.state,isVisible:!0,suppressReason:void 0}):Fe().A.setState({...Fe().A.state,suppressReason:void 0}):Fe().A.setState({isVisible:!1,suppressReason:Fe().e.DARK_MODE}):Fe().A.setState({isVisible:!1,suppressReason:Fe().e.IN_APP_CALLOUT_CONFLICT}))}),[i,o,a]);const s=(0,E().K8)((()=>Fe().A.state.isVisible&&i.getCalloutVisibility("customer_io").canShow),[i]);return(0,r.useEffect)((()=>{if(s)return i.updateCalloutStatus({calloutId:"customer_io",visible:!0}),()=>{i.updateCalloutStatus({calloutId:"customer_io",visible:!1})}}),[i,s]),o?$e(!!s):null};var Ve=()=>n(532688),He=()=>n(449789);const Ge=new(re().O2)("KeyboardShortcutsModal",(()=>n.e(19512).then(n.bind(n,65881)))),Je=(0,re()._h)(Ge,(e=>e.KeyboardShortcutsModal));var Ze=()=>n(965142);const Qe=new(re().O2)("Marketplace",(async()=>{const{Marketplace:e}=await Promise.all([n.e(35530),n.e(9773),n.e(37353),n.e(22926),n.e(74728),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(14578),n.e(87017),n.e(46414),n.e(47668),n.e(52871),n.e(48486),n.e(37384),n.e(20029),n.e(49175),n.e(27991),n.e(2373),n.e(52598),n.e(54719),n.e(94882),n.e(20657),n.e(19434),n.e(79239)]).then(n.bind(n,615215));return{Marketplace:e}})),Xe=(0,re()._h)(Qe,(e=>e.Marketplace));var Ye=()=>n(148297),et=()=>n(357731);const tt=(0,p().YK)({pressSlashHeader:{id:"EducationTooltips.pressSlash.header",defaultMessage:"Press {slashkey} for commands"}});function nt(e){return(0,g.jsx)("div",{style:{background:x().IF.whiteWithAlpha(.1),padding:3,paddingInlineEnd:8,paddingInlineStart:8,marginInlineEnd:6,marginInlineStart:6,borderRadius:4},children:e.char})}function rt(){const e=(0,_().v3)(),t=et().U();return(0,E().K8)((()=>{const{currentUserSettingsStore:e}=O().default.state;var t;return!e||!e.isReady()||Boolean(null===(t=e.getSettings())||void 0===t?void 0:t.pressed_slash_tooltip)}),[])||s().A.isMobile||!t?null:(0,g.jsx)(Ye().k,{hideCloseButton:!0,origin:()=>t.getNode(),placementToOrigin:"bottom",header:(0,g.jsx)(p().sA,{...tt.pressSlashHeader,values:{slashkey:(0,g.jsx)(nt,{char:"/"})}}),content:null,onCloseClick:()=>et().P(e)})}var ot=()=>n(255824),it=()=>n(761309),at=()=>n(869562);const st=(0,re()._h)(new(re().O2)("SlipperySlopeChatTrigger",(async()=>Promise.all([n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(22777),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(40992),n.e(88455),n.e(33893),n.e(36437),n.e(17729),n.e(41998)]).then(n.bind(n,984097)))),(e=>e.SlipperySlopeChatTrigger));var ct=()=>n(644914),lt=()=>n(749687),dt=()=>n(482813),ut=()=>n(539412),pt=(n(16280),()=>n(906745)),mt=()=>n(755531),ft=()=>n(852832),vt=()=>n(753812);async function gt(e,t){const n=await vt().callApi({eventName:"stripeGetTestClock",environment:t,data:{spaceId:e}});if("success"===n.type){if("advancing"===n.data.status)throw new Error("Test clock is advancing. Please try again in a few seconds.");return n.data.epochSeconds}}async function ht(e){const{environment:t,spaceId:n,advanceTestClockArgument:r}=e;if(r)return"number"==typeof r?r:"function"==typeof r?await async function(e){const{environment:t,spaceId:n,callback:r}=e,o=await gt(n,t);if(o)return r(o)}({environment:t,spaceId:n,callback:r}):"object"==typeof r?await async function(e){const{environment:t,spaceId:n,durationLike:r}=e,o=await gt(n,t);if(!o)return;const i=pt().DateTime.fromSeconds(o),a=pt().dw.fromDurationLike(r);return i.plus(a).toSeconds()}({environment:t,spaceId:n,durationLike:r}):void 0}const bt={WorkersPage:new(re().O2)("WorkersPage",(async()=>await n.e(56213).then(n.bind(n,304304)))),WorkerDetailPage:new(re().O2)("WorkerDetailPage",(async()=>await Promise.all([n.e(26135),n.e(92151)]).then(n.bind(n,576866))))},St=(0,re()._h)(bt.WorkersPage,(e=>e.WorkersPage)),yt=(0,re()._h)(bt.WorkerDetailPage,(e=>e.WorkerDetailPage));var wt=()=>n(563615);const _t={WorkflowTemplatesBuilderNotInProd:new(re().O2)("WorkflowTemplateBuilderNotInProd",(async()=>await Promise.all([n.e(75134),n.e(9773),n.e(64756),n.e(92845),n.e(46414),n.e(67494),n.e(48486),n.e(94611)]).then(n.bind(n,246186)))),CollectionItemNameConfigMenuItemNotInProd:new(re().O2)("CollectionItemNameConfigMenuItemNotInProd",(async()=>await n.e(12062).then(n.bind(n,120364))))};(0,re()._h)(_t.WorkflowTemplatesBuilderNotInProd,(e=>e.WorkflowTemplatesBuilderNotInProd)),(0,re()._h)(_t.CollectionItemNameConfigMenuItemNotInProd,(e=>e.CollectionItemNameConfigMenuItemNotInProd));var kt=()=>n(726562);const At={FullPageAIChatLoader:new(re().O2)("FullPageAIChatLoader",(()=>Promise.all([n.e(35530),n.e(55373),n.e(36192),n.e(27992),n.e(63452),n.e(66249),n.e(87249),n.e(79022),n.e(34877),n.e(11676),n.e(58596)]).then(n.bind(n,116882))))},It=(0,re()._h)(At.FullPageAIChatLoader,(e=>e.FullPageAIChatLoader));var Et=()=>n(80157),Ct=()=>n(44551),Tt=()=>n(929219),Pt=()=>n(201794),xt=()=>n(165358),Lt=()=>n(229833);var Rt=()=>n(807054),Ut=()=>n(269183),Dt=()=>n(466088),Mt=()=>n(311337);const Nt=(0,re()._h)(n(852851).p,(e=>e.Sidebar));var Ot=()=>n(577701);const jt=(0,re()._h)(new(re().O2)("SidebarMobile",(async()=>await Promise.all([n.e(51220),n.e(22926),n.e(22900),n.e(85128),n.e(38293),n.e(55162),n.e(91793),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(12452),n.e(18825),n.e(22370),n.e(42056),n.e(32116),n.e(65375),n.e(13023),n.e(54742),n.e(51224),n.e(20592),n.e(71381),n.e(57418),n.e(68108),n.e(995),n.e(76100),n.e(91511),n.e(61505),n.e(9701),n.e(67947)]).then(n.bind(n,997556)))),(e=>e.SidebarMobile));var Bt=()=>n(923455),qt=()=>n(82648),Wt=()=>n(479349);const zt=r.memo(Ft);function Ft(){const e=(0,_().v3)(),{isPhone:t,isTablet:o}=(0,_().Y0)(),i=(0,E().K8)((()=>(0,ct().KB)(e)),[e]),a=(0,Pt().T)("supportsNativeHome"),s=(0,E().K8)((()=>(0,Mt().y)(e)),[e]);(0,r.useEffect)((()=>{(0,qt().yd)("sidebar_loader_mounted")}),[]);const c=function({isPhone:e,isTablet:t,isViewingAsPublicShareLink:n}){return e||t&&n}(l={isPhone:t,isTablet:o,isViewingAsPublicShareLink:s,supportsMobileNativeHome:a})?function({supportsMobileNativeHome:e}){return e}(l)?"native-home":"mobile-sidebar":"browser-sidebar";var l;(0,r.useEffect)((()=>{const{enableStrictRenderCompletion:t,deferSidebarLoadingWhenCollapsed:n}=(0,Ut().b8)(e.currentUser.id);t&&"browser-sidebar"===c&&(i||!n)&&O().default.addPendingCriticalRender("sidebar")}),[c,e.currentUser.id,i]);return(0,g.jsx)(Bt().Lp,{children:(()=>{switch(c){case"native-home":return(0,g.jsx)(n(824622).As,{});case"mobile-sidebar":return(0,g.jsx)(jt,{});case"browser-sidebar":return(0,g.jsx)($t,{isExpanded:i});default:return null}})()})}function $t({isExpanded:e}){const t=(0,_().v3)(),n=t.device.isElectronMac,{deferSidebarLoadingWhenCollapsed:o}=(0,Ut().b8)(t.currentUser.id),i=!e&&o,a=(0,qe().V)(),s=i&&a,c=(0,Bt().Rx)(),l=Boolean(c);(0,r.useEffect)((()=>{}),[s,e,o,a]);const d=(0,r.useRef)(!1),u=(0,r.useRef)(s);(0,r.useEffect)((()=>{s||d.current||(d.current=!0,u.current)}),[s]),(0,r.useEffect)((()=>{}),[c]),(0,Wt().Jf)({sidebarState:c});const p=(0,E().K8)((()=>(0,Dt().w)(t)),[t]),m=(0,E().K8)((()=>(0,Mt().y)(t)),[t]);!function(e){const{isLoaded:t,isExpanded:n,isOnPublicPage:o,isOnPublicShareLinkPage:i}=e,a=(0,_().v3)(),s=(0,E().K8)((()=>(0,Rt().isPrewarmedTabInitialRender)(a)),[a]);(0,r.useEffect)((()=>{if(t||s)return;const e=setTimeout((()=>{var e;const t={level:"error",from:"SidebarContentContainer",type:"sidebarLoadingTimeout",error:{message:`Sidebar took longer than ${Kt/1e3} seconds to load.`},data:{miscDataToConvertToString:{isOnline:Tt().A.state.online,hasCurrentSpaceStore:Boolean((0,mt().S)()),hasCurrentSpaceViewStore:Boolean(O().default.state.sidebarSpaceViewStore),hasCurrentUserRootStore:Boolean(O().default.state.currentUserRootStore),hasCurrentUserSettingsStore:Boolean(O().default.state.currentUserSettingsStore),documentVisibilityState:document.visibilityState,isOnPublicPage:o,isOnPublicShareLinkPage:i}}};var r,s;Ct().electronApi?(r=t,null===Ct().electronApi||void 0===Ct().electronApi||null===(s=Ct().electronApi.logErrorForOffline)||void 0===s||s.call(Ct().electronApi,{...r,data:r.data?(0,Lt().stringifyMiscData)(r.data):void 0})):xt().log(t),(0,qt().Sz)({environment:a,reason:"client_deadline_exceeded",is_expanded:n,spaceId:null===(e=(0,mt().S)())||void 0===e?void 0:e.id})}),Kt);return()=>{clearTimeout(e)}}),[t,n,o,i,a,s])}({isLoaded:l,isExpanded:e,isOnPublicPage:p,isOnPublicShareLinkPage:m});const f=(0,r.useCallback)((()=>(0,g.jsx)(Ot().A,{skipFadeinDelay:!0})),[]),{isTablet:v}=(0,_().Y0)();return s?null:(0,g.jsx)(Nt,{isElectronMac:n,isTablet:v,isExpanded:e,renderLoading:f,forceRenderLoading:!l&&!p&&!m})}const Kt=9e4;var Vt=()=>n(793007);const Ht=(0,re()._h)(new(re().O2)("NotionBanners",(()=>Promise.all([n.e(54892),n.e(58507)]).then(n.bind(n,214769)))),(e=>e.default)),Gt=new(re().O2)("NotionModals",(()=>Promise.all([n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(50397),n.e(22926),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(61165),n.e(47668),n.e(24587),n.e(67494),n.e(10522),n.e(38293),n.e(88455),n.e(63515),n.e(55162),n.e(91793),n.e(97989),n.e(7914),n.e(55113),n.e(25588),n.e(23640),n.e(72252),n.e(93134),n.e(18825),n.e(29351),n.e(77754),n.e(49175),n.e(29121)]).then(n.bind(n,490874)))),Jt=(0,re()._h)(Gt,(e=>e.default));function Zt({routerState:e}){const t=(0,_().v3)();(0,r.useEffect)((()=>{var e;if(null!==(e=t.mobileNative)&&void 0!==e&&e.api.appComponentMountState)return t.mobileNative.api.appComponentMountState(!0),()=>{var e;null!==(e=t.mobileNative)&&void 0!==e&&e.api.appComponentMountState&&t.mobileNative.api.appComponentMountState(!1)}}),[t]);const{route:n}=e,o=(0,E().O$)(O().AppStoreMainEditorCurrentBlockStore),i=(0,E().K8)((()=>me().A.state.publicPageData),[]),{shouldShowSidebar:a,shouldShowFrame:c,shouldShowError:l,shouldRedirectFromHome:d}=(0,E().K8)((()=>(0,je().X)(t)),[t]),u=(0,E().K8)((()=>"page"===n.name&&Oe().A.state.open&&(0,it().K1)(Oe().A.state.blockStore)),[n.name]),p=(0,ut().x9)(),m=(0,E().K8)((()=>{const{sidebarSpaceStore:e}=O().default.state,t=null==e?void 0:e.getModel();return void 0===t||t.isTranscriptionEnabled()}),[]),f=(0,E().K8)((()=>{if(!(0,be().shouldAllowOpeningAgentOnSpecifiedRoute)(n))return!1;if(kt().eX.state)return!1;if(kt().tA.state)return!1;if(kt().Zl.state)return!1;if(p)return!1;const{device:e}=t;return ge().zD.shouldShowAssistantInCorner(e)}),[t,p,n]),v=(0,E().K8)((()=>{if(s().A.isMobile)return!1;if(f)return!1;if(kt().eX.state)return!1;if(kt().tA.state)return!1;if(kt().Zl.state)return!1;if(!t.currentUser.isLoggedIn())return!1;const{mainEditorCurrentBlockStore:e,sidebarSpaceStore:n}=O().default.state;return!(!e||!n)&&!(0,it().qb)(t,e,n)}),[t,f]),h=(0,Be().U)(),b=(0,E().K8)((()=>{const{device:e}=t;return!!e.isMobileNative&&("page"===n.name?ge().zD.isXMLAssistantEnabled():void 0)}),[t,n.name]),S=(0,E().K8)((()=>a&&!(0,ct().tv)(t)&&lt().sidebarOpenStore.state),[t,a]),y=(0,E().K8)((()=>(0,fe().t)()),[]),w=(0,E().K8)((()=>O().default.isInitialRenderComplete()),[]),k=(0,ot().a)(),A=(0,qe().V)();return function(){const e=["local","staging","development"].includes("production"),t=(0,_().v3)();(0,r.useEffect)((()=>{e&&((0,ft().exposeDebugValue)("refreshTestClock",(async()=>{var e;const n=null===(e=(0,mt().S)())||void 0===e?void 0:e.id;if(n){const e=await gt(n,t);if(e){const t=pt().DateTime.fromSeconds(e);console.log(`Test clock time is ${t.toString()} (${e} seconds)`)}}})),(0,ft().exposeDebugValue)("advanceTestClock",(async e=>{var n;if(!e)throw new Error("advanceTestClock requires an argument. You can pass an epoch timestamp in seconds, a relative DurationLike object like { months: 2 }, or a function that takes the current epoch seconds and returns the new epoch seconds.");const r=null===(n=(0,mt().S)())||void 0===n?void 0:n.id;if(!r)return;const o=await ht({environment:t,spaceId:r,advanceTestClockArgument:e});o&&await vt().callApi({eventName:"stripeAdvanceTestClock",environment:t,data:{spaceId:r,epochSeconds:o}})})))}),[e,t])}(),(0,g.jsxs)(Et().A,{children:[(0,g.jsx)(Vt().o,{}),a?(0,g.jsx)(zt,{}):void 0,c&&(o||k||"team"===n.name||"meet"===n.name||"posts"===n.name)?(0,g.jsx)(kt().Ay,{routerState:e}):void 0,k||"chat"!==n.name?void 0:(0,g.jsx)(It,{route:n}),k||"agent"!==n.name?void 0:(0,g.jsx)(wt().Di,{routerState:e}),k||"ai"!==n.name?void 0:(0,g.jsx)(wt().Xq,{routerState:e}),k||"workers"!==n.name?void 0:(0,g.jsx)(St,{routerState:e}),k||"worker"!==n.name?void 0:(0,g.jsx)(yt,{routerState:e}),"marketplace"===n.name?(0,g.jsx)(Xe,{}):void 0,!A&&a?(0,g.jsx)(Ie,{}):void 0,A||h?void 0:(0,g.jsx)(he().lz,{}),u?(0,g.jsx)(_e,{}):void 0,!l&&!d||u?void 0:(0,g.jsx)(ke().o,{route:e.route,publicPageData:i,shouldRedirectFromHome:d}),S?(0,g.jsx)(Xt,{}):void 0,(0,g.jsx)(Ke,{}),!A&&s().A.isMobile?(0,g.jsx)(Pe,{}):void 0,!A&&m?(0,g.jsx)(De,{}):void 0,!A&&b?(0,g.jsx)(ve().LazyMobileAssistantPendingOperationsCollapsedElement,{}):void 0,A||!f||h?void 0:(0,g.jsx)(ve().LazyAssistantOriginElement,{}),v?(0,g.jsx)(ye,{}):void 0,!A&&h?(0,g.jsx)(st,{}):void 0,A?void 0:(0,g.jsx)(Ne,{}),y?(0,g.jsx)(rt,{}):void 0,w&&!s().A.isMobile?(0,g.jsx)(Ve().RK,{}):null,h?(0,g.jsx)(ze,{}):void 0,A?void 0:(0,g.jsx)(Le,{}),A?void 0:(0,g.jsx)(Ht,{}),A?void 0:(0,g.jsx)(Jt,{}),A?void 0:(0,g.jsx)(Ue,{}),void 0,(0,g.jsx)(Yt,{}),(0,g.jsx)(en,{})]})}function Qt(){at().close()}function Xt(){const e=(0,_().v3)(),t=(0,E().K8)((()=>function(e){return{position:"absolute",top:0,insetInlineStart:(0,ct().r6)(e),insetInlineEnd:0,bottom:0,zIndex:2}}(e)),[e]);return(0,g.jsx)("div",{style:t,onClick:Qt})}function Yt(){const{currentSpaceStore:e,currentUserStore:t,isInitialRenderComplete:n}=(0,E().K8)((()=>{const{sidebarSpaceStore:e,currentUserStore:t}=O().default.state;return{currentSpaceStore:e,currentUserStore:t,isInitialRenderComplete:O().default.isInitialRenderComplete()}}),[]),o=(0,E().K8)((()=>dt().Ay.state.open),[]),[i,a]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{o&&a(!0)}),[o]),e&&t&&n&&i?(0,g.jsx)(Ce,{spaceStore:e,userStore:t},`${e.id}-${null==t?void 0:t.id}`):null}function en(){const e=(0,E().K8)((()=>He().W({store:Ze().V})),[]),t=(0,r.useCallback)((()=>{He().j({store:Ze().V})}),[]);return(0,g.jsx)(Je,{open:e,onDismiss:t})}var tn=()=>n(555267);const nn=(0,re()._h)(new(re().O2)("ConfirmUnsubscribePage",(()=>n.e(75417).then(n.bind(n,890451)))),(e=>e.ConfirmUnsubscribePage)),rn=new(re().O2)("desktopEmailConfirmPage",(()=>n.e(32568).then(n.bind(n,386428)))),on=(0,re()._h)(rn,(e=>e.default)),an=(0,re()._h)(new(re().O2)("OauthPostLogin",(()=>Promise.all([n.e(75134),n.e(20592),n.e(64949),n.e(76865)]).then(n.bind(n,312242)))),(e=>e.default));const sn=function(e){const t={position:"absolute",top:0,left:0,bottom:0,right:0};return(0,_().v3)().currentUser.isLoggedIn()?(0,g.jsx)("div",{style:t,children:(0,g.jsx)(n(378765).A,{style:{width:"100%",height:"100%"},legacySpinnerSize:n(648526).K,showSpinnerTimeout:500})}):null},cn=(0,re()._h)(new(re().O2)("McpOAuthCallback",(()=>n.e(51487).then(n.bind(n,410790)))),(e=>e.McpOAuthCallback)),ln=(0,re()._h)(new(re().O2)("OauthAuthorization",(()=>Promise.all([n.e(75134),n.e(35530),n.e(55373),n.e(36192),n.e(44711),n.e(53321),n.e(27992),n.e(63452),n.e(66249),n.e(87249),n.e(79022),n.e(34877),n.e(38293),n.e(63515),n.e(91793),n.e(44590),n.e(55113),n.e(85071),n.e(20592),n.e(78862),n.e(51204),n.e(64949),n.e(83119)]).then(n.bind(n,59186)))),(e=>e.OauthAuthorization)),dn=(0,re()._h)(new(re().O2)("OpenExternal",(()=>n.e(62370).then(n.bind(n,947248)))),(e=>e.OpenExternal)),un=(0,re()._h)(new(re().O2)("WorkersCliLoginPage",(()=>n.e(48432).then(n.bind(n,579225)))),(e=>e.WorkersCliLoginPage)),pn=new(re().O2)("CreatorProfile",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(42838),n.e(74728),n.e(78205),n.e(79086),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(77754),n.e(37384),n.e(5181),n.e(98426),n.e(87287),n.e(78862),n.e(15381),n.e(33756),n.e(94882),n.e(6571),n.e(40200)]).then(n.bind(n,200101)))),mn=(0,re()._h)(pn,(e=>e.CreatorProfile)),fn={CreatorProgram:new(re().O2)("CreatorProgram",(()=>Promise.all([n.e(72509),n.e(54807),n.e(58251)]).then(n.bind(n,115147))))},vn=(0,re()._h)(fn.CreatorProgram,(e=>e.CreatorProgram));var gn=()=>n(969339);const hn=new(re().O2)("Onboarding",(async()=>Promise.all([n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(22926),n.e(22900),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(46414),n.e(61165),n.e(47668),n.e(24587),n.e(67494),n.e(10522),n.e(38293),n.e(63515),n.e(55162),n.e(91793),n.e(97989),n.e(7914),n.e(18825),n.e(64242),n.e(37384),n.e(72659),n.e(19456),n.e(23371),n.e(32116),n.e(79231),n.e(45016)]).then(n.bind(n,864335)))),bn=(0,re()._h)(hn,(e=>e.Onboarding)),Sn=new(re().O2)("settingsConsole",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(42838),n.e(49889),n.e(20108),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(77754),n.e(64242),n.e(47160),n.e(76677),n.e(15553),n.e(42056),n.e(5181),n.e(40119),n.e(54742),n.e(5331),n.e(76690),n.e(54234),n.e(15381),n.e(68466),n.e(33756),n.e(19596)]).then(n.bind(n,846634)))),yn=(0,re()._h)(Sn,(e=>e.OrganizationSettingsConsole)),wn=new(re().O2)("RequiredSamlErrorPage",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(49418),n.e(5331),n.e(89696),n.e(40794)]).then(n.bind(n,224045)))),_n=(0,re()._h)(wn,(e=>e.RequiredSamlErrorPageWrapper));var kn=()=>n(987954);let An="lastProtocolUrlDeduplicationId";(0,re()._h)(new(re().O2)("ExportPreview",(()=>n.e(62927).then(n.bind(n,808832)))),(e=>e.ExportPreview));var In=()=>n(236005),En=()=>n(369026);function Cn(e){const{preventFrontRedirect:t}=e,n=(0,_().v3)(),{pathname:r,search:o,hash:i}=window.location;if(!t&&(0,En().D8)(n,r)){const e=o.length>0?`${o}&${In().Kr}=1`:`?${In().Kr}=1`;return window.location.href=r+e+i,null}return(0,g.jsx)(gn().C6,{isSignup:!n.currentUser.isLoggedIn()})}const Tn=new(re().O2)("githubStudentPack",(()=>Promise.all([n.e(72509),n.e(54807),n.e(54564)]).then(n.bind(n,708682)))),Pn=(0,re()._h)(Tn,(e=>e.default));var xn=()=>n(182805),Ln=()=>n(710144);const Rn=(0,re()._h)(new(re().O2)("InitiateExternalAuthentication",(()=>n.e(35287).then(n.bind(n,452347)))),(e=>e.default)),Un=(0,re()._h)(new(re().O2)("InitiateExternalAuthenticationFromDesktop",(()=>n.e(42945).then(n.bind(n,449177)))),(e=>e.default)),Dn=new(re().O2)("LocalizedTemplates",(async()=>{const{default:e}=await Promise.all([n.e(35530),n.e(9773),n.e(37353),n.e(22926),n.e(74728),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(14578),n.e(87017),n.e(46414),n.e(47668),n.e(52871),n.e(48486),n.e(37384),n.e(20029),n.e(49175),n.e(27991),n.e(2373),n.e(52598),n.e(54719),n.e(94882),n.e(20657),n.e(19434),n.e(79239)]).then(n.bind(n,881532));return{LocalizedTemplates:e}})),Mn=(0,re()._h)(Dn,(e=>e.LocalizedTemplates)),Nn={AddAnotherAccountLoginPage:new(re().O2)("AddAnotherAccountLoginPage",(async()=>await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(20488)]).then(n.bind(n,140862))))},On=(0,re()._h)(Nn.AddAnotherAccountLoginPage,(e=>e.default)),jn=(0,re()._h)(new(re().O2)("AddPasskeyRedirectPage",(()=>n.e(67045).then(n.bind(n,114392)))),(e=>e.AddPasskeyRedirectPage)),Bn=(0,re()._h)(new(re().O2)("VerifyPasskeyRedirectPage",(()=>n.e(38101).then(n.bind(n,751554)))),(e=>e.VerifyPasskeyRedirectPage)),qn=new(re().O2)("meetingNotification",(()=>Promise.all([n.e(44711),n.e(53321),n.e(6039),n.e(58427)]).then(n.bind(n,469886)))),Wn=(0,re()._h)(qn,(e=>e.MeetingNotificationRoute)),zn=((0,re()._h)(new(re().O2)("MinimalPage",(()=>n.e(26097).then(n.bind(n,381931)))),(e=>e.MinimalPage)),new(re().O2)("noseyDesktop",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(77754),n.e(18422),n.e(17341)]).then(n.bind(n,694445))))),Fn=(0,re()._h)(zn,(e=>e.NoseyDesktopRoute)),$n=(0,re()._h)(new(re().O2)("NotionCalendarAuthorization",(()=>n.e(67801).then(n.bind(n,271761)))),(e=>e.default)),Kn=(0,re()._h)(new(re().O2)("QuickSearchRoute",(()=>n.e(55687).then(n.bind(n,437804)))),(e=>e.QuickSearchRoute));var Vn=()=>n(171510);const Hn=new(re().O2)("StartupsApplication",(async()=>Promise.all([n.e(72509),n.e(54807),n.e(47057)]).then(n.bind(n,141933)))),Gn=new(re().O2)("StartupsApplicationLoading",(async()=>n.e(52055).then(n.bind(n,255980)))),Jn=(0,re()._h)(Hn,(e=>e.default)),Zn=(0,re()._h)(Gn,(e=>e.StartupsApplicationLoading)),Qn={LennyApplication:new(re().O2)("LennyApplication",(()=>n.e(86279).then(n.bind(n,599059))))},Xn=(0,re()._h)(Qn.LennyApplication,(e=>e.LennyApplication)),Yn=new(re().O2)("StudentGroupSignup",(async()=>Promise.all([n.e(72509),n.e(54807),n.e(84969)]).then(n.bind(n,544719)))),er=(0,re()._h)(Yn,(e=>e.default));var tr=()=>n(391767);const nr=(0,re()._h)(new(re().O2)("TeamInviteLinkPage",(()=>n.e(20894).then(n.bind(n,932001)))),(e=>e.default));var rr=()=>n(468941),or=()=>n(427082),ir=()=>n(391400),ar=()=>n(361242),sr=()=>n(502492),cr=()=>n(843801),lr=()=>n(272006),dr=()=>n(98444);function ur({url:e,clearHistory:t,showWeb:n,environment:r,loadOrigin:o,navigate:i}){const{RouterStore:a}=r;let c=e;if(r.device.isMobileNative&&r.device.isPhone){const e=(0,Z().bk)(c);e&&e.searchParams.has(G().P5)&&(e.searchParams.delete(G().P5),c=e.toString())}const l=sr().Q1({url:c,protocol:s().A.protocol,baseUrl:s().A.domainBaseUrl}),d=sr().kb({schemeUrl:l,baseUrl:s().A.domainBaseUrl}),u=F().parseRoute({url:d,baseUrl:s().A.domainBaseUrl,publicDomainName:s().A.publicDomainName,isMobile:s().A.isMobile,protocol:s().A.protocol,currentUrl:window.location.href}),p=Z().qn(e,ar().Sn),m=o||p,f=Z().qn(e,ar().p2);if(ir().A.setDesktopLoadContext({loadOrigin:m,wasLoadedAtLogin:f}),(r.device.isAndroid||t)&&(0,dr().T)({RouterStore:a,currentUserId:r.currentUser.id}),r.mobileNative&&r.mobileNative.closeInAppBrowser(),"googleAuthCallback"===u.name){const{didHandle:e}=(0,lr().b)(u);if(e)return}if("mcpOAuthComplete"===u.name){const{didHandle:e}=(0,cr().H)(u);if(e)return}if("externalAuthCallback"===u.name){if(y().default.checkGate({gateName:"skip_navigation_for_external_auth_callback"})&&window.location.pathname.startsWith("/agent"))return}"googleAuthCallback"!==u.name&&"samlAuthCallback"!==u.name&&"passkeyAuthCallback"!==u.name?i({environment:r,url:d,redirect:t,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:n},queryId:"page"===u.name?u.queryId:void 0}):i({environment:r,url:d,redirect:!0})}var pr=()=>n(996332),mr=()=>n(217753),fr=()=>n(549721);function vr({redirect:e,callbackType:t}){const n=(0,_().v3)();return(0,r.useEffect)((()=>{gr({redirect:e,environment:n,callbackType:t})}),[n,e,t]),(0,g.jsxs)(mr().A,{children:[(0,g.jsx)("div",{style:{color:x().Tj.text.primary},children:"nativemailredirect"===t?(0,g.jsx)(p().sA,{id:"webApp.redirectingToMailDesktop.message",defaultMessage:"Redirecting to your Notion Mail app…"}):"nativecalendarredirect"===t?(0,g.jsx)(p().sA,{id:"webApp.redirectingToCalendarDesktop.message",defaultMessage:"Redirecting to your Notion Calendar app…"}):(0,g.jsx)(p().sA,{defaultMessage:"Redirecting to your Notion app…",id:"webApp.redirectingToDesktop.message"})}),(0,g.jsx)(pr().Q,{onClick:()=>gr({redirect:e,environment:n,callbackType:t}),style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:x().Tj.text.tertiary},children:(0,g.jsx)(p().sA,{defaultMessage:"If you weren’t redirected, click here.",id:"webApp.redirectingToDesktop.directLink.message"})}),(0,g.jsx)(pr().Q,{href:e,style:{maxWidth:300,textAlign:"center",textDecoration:"underline",color:x().oZ.uiGray},children:(0,g.jsx)(p().sA,{defaultMessage:"Or, continue in your browser",id:"webApp.redirectingToDesktop.continueInBrowser.message"})})]})}function gr({redirect:e,environment:t,callbackType:n}){(0,fr().e)({url:e,environment:t,callbackType:n})}var hr=()=>n(160723);function br({url:e,queryParams:t}){const{navigate:n}=(0,r.useContext)(l().E),o=(0,_().v3)(),i=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{i.current||(i.current=!0,t&&(0,hr().I)({currentUserId:void 0,params:t}),n({environment:o,url:e,redirect:!0}))}),[o,t,e,n]),(0,g.jsx)(tn().A,{})}function Sr(){const{navigate:e}=(0,r.useContext)(l().E),t=(0,_().v3)(),n=(0,E().O$)(t.RouterStore),{isStatsigReady:o,isFeatureEnabled:i}=(0,Ln().O)("workers"),{isStatsigReady:a,isFeatureEnabled:c}=(0,Ln().O)("meeting_notes_page");(0,r.useEffect)((()=>{!s().A.isAdminMode&&t.currentUser.isLoggedIn()&&O().default.waitUntil((()=>{const e=O().default.state.currentUserSettingsStore,n=(null==e?void 0:e.isDefined())??!1;if(e&&n){const n=e.getSettings(),r=null==n?void 0:n.disable_auto_set_timezone;n&&!r&&ee().xw({environment:t,userSettingsStore:e})}return n}))}),[t]),(0,r.useEffect)((()=>{function e(){const{RouterStore:e,currentUser:n}=t,r=n.id;(0,or().z)({environment:t,historyId:e.state.id,currentUserId:r}),(0,kn().u)(!1)}return window.addEventListener("beforeunload",e),()=>window.removeEventListener("beforeunload",e)}),[t]),(0,r.useEffect)((()=>{function e(e){var n,r,o;(0,rr().a)({currentUserId:null===(n=e.state)||void 0===n?void 0:n.currentUserId,id:null===(r=e.state)||void 0===r?void 0:r.id,url:null===(o=e.state)||void 0===o?void 0:o.url},t)}return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[t]),(0,j().l)((()=>{var n,r,o;n=n=>function({url:e,environment:t,navigate:n}){ur("string"==typeof e?{url:e,clearHistory:!1,showWeb:!1,environment:t,navigate:n}:{url:e.url,clearHistory:!1,showWeb:!1,environment:t,loadOrigin:e.loadOrigin,navigate:n})}({url:n,environment:t,navigate:e}),null===Ct().electronApi||void 0===Ct().electronApi||null===(r=Ct().electronApi.onNavigate)||void 0===r||null===(o=r.addListener)||void 0===o||o.call(r,((e,t)=>{if("string"!=typeof t&&t.deduplicationID){const e=t.deduplicationID;if(An===e)return void xt().log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});An=e}n(t)})),function(e){var t,n;null===Ct().electronApi||void 0===Ct().electronApi||null===(t=Ct().electronApi.onOpenSettings)||void 0===t||null===(n=t.addListener)||void 0===n||n.call(t,((t,n)=>e(n)))}(yr),(0,kn().u)(!0),function(e){var t,n;null===Ct().electronApi||void 0===Ct().electronApi||null===(t=Ct().electronApi.newWindow)||void 0===t||null===(n=t.addListener)||void 0===n||n.call(t,e)}(((n,r)=>{e({environment:t,url:r,openInNew:"tab"})}))})),function(e,t){(0,r.useEffect)((()=>{e.mobileNative&&e.mobileNative.subscribeToOpenLink(((n,r,o)=>ur({url:n,clearHistory:r,showWeb:o,environment:e,navigate:t})))}),[e,t])}(t,e),(0,r.useEffect)((()=>{var e;if("root"===n.route.name||"page"===n.route.name||"space"===n.route.name||"posts"===n.route.name)return;"blank"===n.route.name&&0===(null===(e=n.historyState)||void 0===e?void 0:e.index)?(0,xn().isPrewarmedTabLoadSidebarEnabled)()&&O().default.setPageRendered():(X().setInitialRenderCompleted(),O().default.setPageRendered())}),[n]),(0,r.useEffect)((()=>{t.currentUser.isLoggedIn()||"page"===n.route.name||"space"===n.route.name||q().u4({device:t.device,event:{facebook:{eventName:"PageView",data:{content_name:window.location.href}},google:{eventName:"pageView",path:window.location.pathname}},cookieService:t.cookieService})}),[t.cookieService,t.currentUser,t.device,n.route.name]),(0,r.useEffect)((()=>{const e=O().default.state.currentUserSettingsStore;t.currentUser.isLoggedIn()&&e&&function(e,t){const n=(0,q().zD)(),r=(0,q().mS)();if(!n||!r)return;const o={};r&&(o.fbp=r),n&&(o.click_ids=n),te().createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,canUndo:!0,cellTarget:"main",perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,q().uK)(),(0,q().fq)())})),(0,ne().m)({userSettingsStore:t,data:o,transaction:e})}})}(t,e)}),[t]);const d=(0,_().Y0)();if(d.isNative&&F().L7[n.route.name])return(0,g.jsx)(dn,{});if("front"===n.route.name)return(0,g.jsx)(Cn,{preventFrontRedirect:n.route.alreadyRedirected});if("root"===n.route.name)return(0,g.jsx)(sn,{route:n.route});if("nativeRedirect"===n.route.name||"nativeMailRedirect"===n.route.name||"nativeCalendarRedirect"===n.route.name)return(0,g.jsx)(vr,{redirect:n.route.redirect,callbackType:"nativeMailRedirect"===n.route.name?"nativemailredirect":"nativeCalendarRedirect"===n.route.name?"nativecalendarredirect":"nativeredirect"});if("login"===n.route.name)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Vn().Q,{}),(0,g.jsx)(gn().HQ,{isSignup:!1,email:n.route.email,redirectURL:n.route.redirectURL})]});if("login/calendar"===n.route.name||"login/mail"===n.route.name)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Vn().Q,{}),(0,g.jsx)(gn().HQ,{isSignup:!1,email:n.route.email,redirectURL:n.route.redirectURL,addAnotherAccount:Boolean(n.route.addAnotherAccount)})]});if("addAnotherAccount"===n.route.name)return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Vn().Q,{}),(0,g.jsx)(On,{redirectURL:n.route.redirectURL})]});if("desktopEmailConfirm"===n.route.name)return(0,g.jsx)(on,{});if("teamsInvite"===n.route.name){const{teamId:e}=n.route;return Q().WO(t,{teamId:e}),(0,g.jsx)(nr,{teamId:e,renderLoading:()=>(new(B().h)(t,{table:K().yK,id:e}).load(),null)})}if("signup"===n.route.name)return(0,g.jsx)(gn().HQ,{isSignup:!0,email:n.route.email,referrer:n.route.referrer});if("signup/calendar"===n.route.name||"signup/mail"===n.route.name)return(0,g.jsx)(gn().HQ,{isSignup:!0,email:n.route.email,referrer:n.route.referrer,redirectURL:n.route.redirectURL,addAnotherAccount:Boolean(n.route.addAnotherAccount)});if("unsubscribe"===n.route.name){const e=n.route.payload;return(0,g.jsx)(nn,{payload:e})}if("onboarding"===n.route.name)return(0,g.jsx)(bn,{});if("upcomingInvoice"===n.route.name)return(0,g.jsx)(tr().Y,{route:n.route});if("invoiceById"===n.route.name)return(0,g.jsx)(tr().Y,{route:n.route});if("settingsConsoleOrganization"===n.route.name){if(t.currentUser.isLoggedIn())return(0,g.jsx)(yn,{organizationId:n.route.organizationId,tabRoute:n.route.tabRoute,properties:n.route.properties,params:n.route.params});{const e=(0,H().re)({organizationId:n.route.organizationId,tabRoute:n.route.tabRoute,properties:n.route.properties,queryParams:n.route.params}),t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}}if(n.route.name,n.route.name,"admin"===n.route.name&&s().A.isAdminMode)return(0,g.jsx)(oe,{});if("adminSection"===n.route.name&&s().A.isAdminMode){const{section:e}=n.route;return(0,g.jsx)(ie,{section:e})}if("adminWorkersHome"===n.route.name&&s().A.isAdminMode)return(0,g.jsx)(ue,{});if("adminWorkersList"===n.route.name&&s().A.isAdminMode){const{spaceId:e,email:t}=n.route;return(0,g.jsx)(pe,{spaceId:e,email:t})}if("adminWorkersDetail"===n.route.name&&s().A.isAdminMode){const{spaceId:e,workerId:t}=n.route;return(0,g.jsx)(de,{spaceId:e,workerId:t})}if("adminListData"===n.route.name){const{category:e}=n.route;if(s().A.isAdminMode)return(0,g.jsx)(ae,{category:e})}if("adminPermissions"===n.route.name&&s().A.isAdminMode)return(0,g.jsx)(ce,{});if("adminSingleRecord"===n.route.name&&s().A.isAdminMode){const{id:e,table:t}=n.route;return(0,g.jsx)(le,{table:t,id:e})}if("adminObject"===n.route.name&&s().A.isAdminMode){const{id:e}=n.route;return(0,g.jsx)(se,{objectId:e})}if("oauthAuthorization"===n.route.name){const{responseType:e,redirectUri:t,integrationId:r,state:o,owner:i,userId:a,spaceId:s}=n.route;return(0,g.jsx)(ln,{responseType:e,redirectUri:t,integrationId:r,state:o,owner:i,userId:a,spaceId:s})}if("passkeyAuthVerify"===n.route.name){const{callbackType:e}=n.route;return(0,g.jsx)(Bn,{callbackType:e})}if("notionCalendarAuthorization"===n.route.name){const{csrf:e,calendarCsrf:t,redirectUri:r,spaceId:o,state:i}=n.route;return(0,g.jsx)($n,{csrf:e,calendarCsrf:t,redirectUri:r,spaceId:o,state:i})}if("globalOauthPostLogin"===n.route.name){const{clientId:e,redirectUri:t,state:r,responseType:o,scope:i}=n.route;return(0,g.jsx)(an,{clientId:e,redirectUri:t,csrfState:r,responseType:o,scope:i})}if("mcpOAuthCallback"===n.route.name){const{code:e,state:t,error:r,error_description:o,error_uri:i}=n.route;return(0,g.jsx)(cn,{route:{name:"mcpOAuthCallback",code:e,state:t,error:r,error_description:o,error_uri:i}})}if("passkeyRegistrationVerification"===n.route.name){const{callbackType:e,csrfToken:r,attemptId:o,options:i}=n.route;return(0,g.jsx)(jn,{environment:t,callbackType:e,csrfToken:r,attemptId:o,options:i})}if("initiateExternalAuthentication"===n.route.name){const{notion_user_id:e,notion_workspace_id:t,notion_last_visited_url:r,notion_authorization_code:o,external_object_instance_block_id:i,callback_type:a,integration_id:s,redirectToAuth:c}=n.route;return(0,g.jsx)(Rn,{notion_user_id:e,notion_workspace_id:t,notion_last_visited_url:r,notion_authorization_code:o,external_object_instance_block_id:i,callback_type:a,integration_id:s,redirectToAuth:c})}if("initiateExternalAuthenticationFromDesktop"===n.route.name){const{redirectUri:e}=n.route;if(t.currentUser.isLoggedIn())return(0,g.jsx)(Un,{redirectUri:e});{const t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:e}}),n=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:t}});return V().TR(),(0,g.jsx)(br,{url:n})}}if("myIntegrations"===n.route.name)return(0,g.jsx)(br,{url:$().JZ.creatorProfileIntegrations});if("inAppTemplateSubmission"===n.route.name)return(0,g.jsx)(br,{url:$().JZ.creatorProfileTemplates});if("inAppTemplateCreatorSubmission"===n.route.name)return(0,g.jsx)(br,{url:$().JZ.creatorProfile});if("creatorProfile"===n.route.name||"creatorProfileTemplates"===n.route.name||"creatorProfileCustomAgents"===n.route.name||"creatorProfileIntegrations"===n.route.name||"creatorProfileAnalytics"===n.route.name||"creatorProfileCoupons"===n.route.name||"creatorProfileServices"===n.route.name||"creatorProfileLearn"===n.route.name||"creatorProfileSettings"===n.route.name){if(t.currentUser.isLoggedIn())return"pointer"in n.route?(0,g.jsx)(mn,{publish:Boolean(n.route.publish),lab:Boolean(n.route.lab),botOrIntegrationPointer:n.route.pointer}):(0,g.jsx)(mn,{publish:!1,lab:!1,botOrIntegrationPointer:void 0});{const e=Z().Gm({url:`${$().JZ[n.route.name]}`}),t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}}if("localizedTemplates"===n.route.name){if(t.currentUser.isLoggedIn())return(0,g.jsx)(Mn,{});{const e=Z().Gm({url:`${$().JZ[n.route.name]}`}),t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}}if("studentGroupSignup"===n.route.name)return(0,g.jsx)(er,{});if("startupsApplication"===n.route.name)return(0,g.jsx)(Zn,{});if("startupsApplicationForm"===n.route.name)return(0,g.jsx)(Jn,{formType:"startups"});if("smbsApplication"===n.route.name)return(0,g.jsx)(Jn,{formType:"smb"});if("lennyApplication"===n.route.name)return(0,g.jsx)(Xn,{});if("creatorProgramApplication"===n.route.name)return(0,g.jsx)(vn,{});if("githubStudentPackHome"===n.route.name)return(0,g.jsx)(Pn,{});if("notFound"===n.route.name)return(0,g.jsx)(ke().o,{route:n.route,publicPageData:void 0});if("modal"===n.route.name&&!t.currentUser.isLoggedIn()&&(n.route.templateGalleryItem||n.route.projectManagementLaunch)){const e={};return n.route.projectManagementLaunch?e.tg="gallery":n.route.templateGalleryItem&&(e.tg=n.route.templateGalleryItem),(0,g.jsx)(br,{url:$().JZ.login,queryParams:e})}if("ekmError"===n.route.name)return t.currentUser.isLoggedIn()?(0,g.jsx)(ke().o,{route:n.route,publicPageData:void 0}):(0,g.jsx)(br,{url:$().JZ.login});if("requiredSamlError"===n.route.name)return t.currentUser.isLoggedIn()?(0,g.jsx)(_n,{}):(0,g.jsx)(br,{url:$().JZ.login});if("chat"===n.route.name&&!t.currentUser.isLoggedIn()){const e=(0,W().X_)(n.route),t=(0,Z().Gm)({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}if("meet"===n.route.name){if(!t.currentUser.isLoggedIn()){const e=$().JZ.meet,t=(0,Z().Gm)({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}if(!c&&a)return(0,g.jsx)(br,{url:"/?target=create_meeting_note"})}if("agent"===n.route.name&&!t.currentUser.isLoggedIn()){const e=(0,J().L)({workflowId:n.route.workflowId,params:{workflowViewType:n.route.workflowViewType,workflowViewId:n.route.workflowViewId,workflowPrompt:n.route.workflowPrompt,chatThreadId:n.route.chatThreadId,agentChatThreadId:n.route.agentChatThreadId}}),t=(0,Z().Gm)({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}if("marketplace"===n.route.name&&!t.currentUser.isLoggedIn()){const e=(0,z().YD)(s().A,n.route),t=(0,Z().Gm)({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}if("quickSearch"===n.route.name)return(0,g.jsx)(Kn,{});if("meetingNotification"===n.route.name)return(0,g.jsx)(Wn,{});if("desktopNosey"===n.route.name)return(0,g.jsx)(Fn,{});if("agent"===n.route.name||"ai"===n.route.name){if(!t.currentUser.isLoggedIn()){const e="agent"===n.route.name?$().JZ.login:(0,Z().Gm)({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:$().JZ.ai}});return(0,g.jsx)(br,{url:e})}if("ai"===n.route.name&&d.isPhone){const e=(0,Z().Gm)({url:$().JZ.home,query:{[G().P5]:be().NEW_CHAT_THREAD_ID}});return(0,g.jsx)(br,{url:e})}}if("workers"===n.route.name||"worker"===n.route.name){if(!t.currentUser.isLoggedIn()){const e=Z().Gm({url:window.location.pathname+window.location.search}),t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}if(!i&&o)return(0,g.jsx)(br,{url:"notFound",queryParams:void 0})}if("workersCliLogin"===n.route.name){if(!t.currentUser.isLoggedIn()){const e=Z().Gm({url:window.location.pathname+window.location.search}),t=Z().Gm({url:`${s().A.domainBaseUrl}${$().JZ.login}`,query:{redirectURL:e}});return(0,g.jsx)(br,{url:t})}const{sessionId:e}=n.route;return(0,g.jsx)(un,{sessionId:e})}return n.route.name,"page"===n.route.name||"space"===n.route.name||"nativeTab"===n.route.name||"modal"===n.route.name||"chat"===n.route.name||"meet"===n.route.name||"agent"===n.route.name||"ai"===n.route.name||"marketplace"===n.route.name||"team"===n.route.name||"posts"===n.route.name||"blank"===n.route.name||"workers"===n.route.name||"worker"===n.route.name?(0,g.jsx)(Zt,{routerState:n}):(0,g.jsx)(tn().A,{})}function yr(e){Y().Ow({currentTab:e})}const wr=(0,re()._h)(new(re().O2)("AppError",(()=>n.e(27326).then(n.bind(n,507228)))),(e=>e.AppError));var _r=()=>n(75435),kr=()=>n(526323),Ar=()=>n(693257),Ir=()=>n(882722),Er=()=>n(397526),Cr=()=>n(799954),Tr=()=>n(750468),Pr=()=>n(21560),xr=()=>n(98126),Lr=()=>n(575650),Rr=()=>n(401539);const Ur=function(){const e=(0,E().O$)(Pr().A);return(0,g.jsx)(n(107975).a,{open:e.open,render:()=>(0,g.jsx)(Dr,{}),overlayZIndex:9999})};function Dr(){const e=(0,E().O$)(Pr().A),{targetRecordId:t}=e,n=(0,E().K8)((()=>function(e){return void 0!==e&&Boolean(Rr().A.state[e])}(t)),[t]);return e.open?(0,g.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minWidth:180,padding:"18px 24px 20px",textAlign:"center",maxWidth:s().A.isMobile?"300px":"100%"},children:[(0,g.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:14,color:x().Tj.text.secondary},children:[e.message,(0,g.jsx)(xr().A,{style:{marginInlineStart:6}})]}),n&&t?(0,g.jsx)(Lr().A,{targetRecordId:t,style:{marginTop:10}}):void 0]}):null}var Mr=()=>n(49210),Nr=()=>n(567121),Or=()=>n(128933),jr=()=>n(94484),Br=()=>n(699143),qr=()=>n(670);function Wr(){const e=(0,E().K8)((()=>qr().PM.state.isDuplicating),[]),t=(0,r.useRef)(void 0);return(0,r.useEffect)((()=>{var n,r;if(e)return Or().D6({label:(0,g.jsxs)(Br().Y1,{direction:"horizontal",gap:12,align:"center",children:[(0,g.jsx)(p().sA,{defaultMessage:"Creating agent",id:"workflows.creatingAgentSnackbar.label"}),(0,g.jsx)(xr().k,{size:"default",onDarkBackground:!0})]}),durationMs:"keep",persistAcrossNavigation:!0}),void(t.current=null===(r=jr().Ay.state.currentItem)||void 0===r?void 0:r.key);t.current&&(null===(n=jr().Ay.state.currentItem)||void 0===n?void 0:n.key)===t.current&&Or().N2(),t.current=void 0}),[e]),null}var zr=()=>n(379887),Fr=()=>n(440024);function $r(e){const{children:t}=e,n=(0,_().v3)(),o=(0,r.useCallback)((()=>{!function(e){(0,Fr().I)({environment:e})}(n)}),[n]),i=(0,r.useMemo)((()=>({clearSelection:o})),[o]);return(0,g.jsx)(zr().j.Provider,{value:i,children:t})}var Kr=()=>n(390736),Vr=()=>n(230062);function Hr(e){const{children:t}=e,n=(0,E().O$)(Vr().A);return(0,g.jsx)(Kr().j.Provider,{value:n,children:t})}var Gr=()=>n(560520),Jr=()=>n(988083),Zr=()=>n(469874);function Qr(e){const{children:t}=e,n=(0,_().v3)(),r=(0,E().K8)((()=>(0,Zr().y)(n,Jr().A.state.estimatedKeyboardWebViewOverlap,Jr().A.state.nativeBottomBarHeight)),[n]);return(0,g.jsx)(Gr().r.Provider,{value:r,children:t})}var Xr=()=>n(45105),Yr=()=>n(721253),eo=()=>n(661179);const to=20;function no(e){const{children:t}=e,[n,o]=(0,r.useState)(0),i=(0,r.useRef)(null),a=(0,C().eP)(),s=(0,C().IS)((()=>({container:{display:"block",position:"fixed",visibility:"hidden",overflowY:"scroll",width:to,height:to}})),[]);return(0,r.useEffect)((()=>{const e=i.current;if(!e)return;const t=new ResizeObserver((e=>{const[t]=e,n=to-t.contentRect.width;o(n),n!==eo().A.state&&(eo().A.setState(n),Yr().u7(a))}));return t.observe(e),()=>{t.unobserve(e)}}),[a]),(0,g.jsxs)(Xr().w.Provider,{value:n,children:[t,(0,g.jsx)("div",{style:s.container,ref:i})]})}n(672577);var ro=()=>n(581010),oo=()=>n(804339),io=()=>n(843798),ao=()=>n(926564),so=()=>n(865153);function co(e){const{children:t}=e,n=(0,_().v3)(),o=(0,r.useCallback)((e=>function(e,t){if(Jr().A.state.phase===Jr().i.hidden&&!(0,Pt().T)("supportsNativeBottomBarOverlappingWebView"))return;const{WindowSizeStore:n}=e,r=t.state.clientRect;if(!r)return;const o=n.state.height,i=o-(0,Zr().y)(e,Jr().A.state.estimatedKeyboardWebViewOverlap,Jr().A.state.nativeBottomBarHeight),a=(0,so().T)(t.state.elementRef)&&(0,ao().z)(e)?r.height:0,s=ro().A.getSize()>0&&ro().A.find((e=>e.isShown()))?io().j+16:0;return Math.max(Math.min(r.bottom,o)-i,a,0)+s}(n,e)),[n]);return(0,g.jsx)(oo().f.Provider,{value:o,children:t})}function lo({children:e}){const t=(0,_().v3)(),n=(0,C().eP)();(0,r.useEffect)((()=>{const{mobileNative:e}=t;null==e||e.markTransitionReady({environment:t,type:"mount"})}),[t]);const o="light"===n?Ir().fRh:Ir().Rsl,i=(0,M().kg)(),a=(0,M().n_)(),c=(0,M().lC)(),l=(0,E().K8)((()=>{var e;const n=t.RouterStore.state.route;return Boolean(null===(e=_r().A.state.preferences)||void 0===e?void 0:e.isVibrancyEnabled)||(0,kr().Em)(n.name)}),[t]),d={inert:(0,E().K8)((()=>!s().A.isMobile&&Ar().A.state.openModals.size>0),[])?"true":null},p=(0,C().IS)((()=>({root:{...(0,Cr().xH)(u().locale),color:x().Tj.text.primary,WebkitFontSmoothing:"auto",backgroundColor:l?"rgba(0, 0, 0, 0)":x().Tj.background.primary,transition:"height 0.1s ease",...i&&a&&c&&{height:`calc(100% - ${Nr().ls}px)`}},content:{height:"100%"}})),[i,a,c,l]);return(0,g.jsx)("div",{style:p.root,className:["notion-app-inner",o].join(" "),children:(0,g.jsx)($r,{children:(0,g.jsx)(co,{children:(0,g.jsx)(Qr,{children:(0,g.jsx)(no,{children:(0,g.jsx)(Hr,{children:(0,g.jsxs)(Er()._b,{children:[(0,g.jsx)("div",{style:p.content,...d,children:e}),(0,g.jsx)(Tr().A,{}),(0,g.jsx)(Ur,{}),(0,g.jsx)(Mr().b,{}),(0,g.jsx)(Wr,{})]})})})})})})})}var uo=()=>n(647181);const po=!1,mo={navigate:n(246766).navigate,navigateToExternalUrl:n(752860).L};function fo({environment:e,onMount:t}){const n=(0,r.useRef)(!1);(0,r.useEffect)((()=>{n.current||(n.current=!0,null==t||t())}),[t]),(0,r.useEffect)((()=>{s().A.isAdminMode||console.log("%c\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnn                         nnnn\n\tnnnnnnn                          nnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnn                           nnn\n\tnnnnnnnn    nnnnnnnn     nnnnnnn   nnn\n\tnnnnnnnn      nnnnnnn      nnn     nnn\n\tnnnnnnnn      nnnnnnnn     nnn     nnn\n\tnnnnnnnn      nnnnnnnnnn   nnn     nnn\n\tnnnnnnnn      nnn nnnnnnn  nnn     nnn\n\tnnnnnnnn      nnn  nnnnnnnnnnn     nnn\n\tnnnnnnnn      nnn   nnnnnnnnnn     nnn\n\tnnnnnnnn      nnn     nnnnnnnn     nnn\n\tnnnnnnnn      nnn      nnnnnnn     nnn\n\tnnnnnnnn    nnnnnnnn    nnnnnn     nnn\n\t  nnnnnn                           nnn\n\t\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tWe're hiring!\n\t\t  nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tnotion.so/careers\n\n\t“yeah, I would probably eat a lemon for one hundred dollars” --Abraham Lincoln (2023-07-14)\n\t\t\t\t ","font-family: monospace")}),[]);const a=po?r.StrictMode:r.Fragment,m=(0,g.jsx)(Sr,{});return(0,g.jsx)(a,{children:(0,g.jsx)(c().aw,{value:e,children:(0,g.jsx)(i().k,{children:(0,g.jsxs)(d().wX,{children:[(0,g.jsx)(p().Dk,{defaultLocale:"en-US",locale:u().locale,messages:u().D,children:(0,g.jsx)(U,{children:(0,g.jsx)(l().a,{value:mo,children:(0,g.jsx)(h,{...b(e.device),children:(0,g.jsx)(o().K,{fallback:e=>(0,g.jsx)(wr,{...e}),from:"Router",type:"AppCrash",children:(0,g.jsxs)(I,{id:"app",targetRenderPhase:"mount",children:[(0,g.jsx)(uo().T,{}),(0,g.jsx)(lo,{children:m})]})})})})})}),(0,g.jsx)(N,{})]})})})})}},171510:(e,t,n)=>{n.d(t,{Q:()=>b});n(898992),n(354520);var r=n(296540),o=()=>n(726637),i=()=>n(484714),a=()=>n(590526),s=()=>n(849255);const c="initial_handshake";var l=()=>n(798880),d=()=>n(69708),u=()=>n(496603),p=()=>n(763824),m=()=>n(498212),f=()=>n(179534),v=()=>n(214006),g=n(474848);const h=1;function b(){const e=(0,i().v3)(),t=(0,d().tz)(),n=`${o().A.identity.domainBaseUrl}/authSync`,b=e.currentUser.isLoggedIn(),[S,y]=(0,r.useState)(null),[w,_]=(0,r.useState)({value:!1,count:0}),k=(0,a().K8)((()=>f().A.getTotalUnreadMentionsCount()),[]),A=(0,a().K8)((()=>v().A.getAllSpaceViewStores(e)),[e]);(0,r.useEffect)((()=>{const e=t=>{const n=o().A.identity.domainBaseUrl;t.origin===n&&t.ports&&t.ports[0]&&(y(t.ports[0]),window.removeEventListener("message",e))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,r.useEffect)((()=>{b&&(w.value||0===w.count||null==S||S.postMessage({version:h,name:"unreadCount",source:"notion",unreadCount:k}))}),[b,w.count,w.value,S,k]);const I=(0,r.useCallback)((async()=>{const e=u().hS(A,"userId"),n=await(0,p().lX)(e,10,(async e=>{if(!e.userId)return;const n=s().L.createChildStore(e,{table:l().oo,id:e.userId});await n.load();const r=n.getEmail()??"",o=n.getDisplayName(t)??"",i=n.getProfilePhoto()??"";return{id:e.userId,displayName:o,emailAddress:r,profilePicture:i}}));null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:n.filter((e=>void 0!==e)),persistCookie:!0})}),[t,S,A]);(0,r.useEffect)((()=>{b&&S&&(w.value||0===w.count)&&I()}),[b,I,w.count,w.value,S]),(0,r.useEffect)((()=>{e.currentUser.id&&!(0,m().uj)(e.currentUser.id)||null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:e.currentUser.id?e.currentUser.id:"",type:"mutation"})}),[e.currentUser.id,S]),(0,r.useEffect)((()=>{b||(null==S||S.postMessage({version:h,name:"setNotionUserID",source:"notion",notionUserID:"",type:"mutation"}),null==S||S.postMessage({version:h,name:"accountSwitcher",source:"notion",accounts:[],persistCookie:!0}))}),[b,S]);const E=(0,r.useCallback)((e=>{if(e.data.version!==h)return;const{source:t}=e.data;if("notion"!==t&&"mailLoaded"===e.data.name)_((e=>({value:!0,count:e.count+1})))}),[]);return(0,r.useEffect)((()=>(y((e=>(e&&(e.onmessage=E),e))),()=>{y((e=>(e&&(e.onmessage=null),e)))})),[E,S]),(0,g.jsx)("iframe",{src:n,style:{display:"none"},onLoad:e=>function(e){const t=e.currentTarget;setTimeout((()=>{var e;null===(e=t.contentWindow)||void 0===e||e.postMessage(c,o().A.identity.domainBaseUrl)}),50)}(e),title:"Notion Identity"})}},196286:(e,t,n)=>{let r;function o(e){r=e}function i(){return r}n.d(t,{D:()=>i,g:()=>o})},204252:(e,t,n)=>{n.d(t,{K:()=>i});var r=()=>n(44551),o=()=>n(973647);async function i(){if(!r().electronApi||!r().electronApi.getProcessesAccessingMicrophoneDebouncedWithResult)return o().Q.fail({message:"API not available"});try{return await r().electronApi.getProcessesAccessingMicrophoneDebouncedWithResult()}catch(e){return o().Q.fail({message:"Failed to get debounced microphone processes",error:e})}}},205338:(e,t,n)=>{var r=n(440961);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},217753:(e,t,n)=>{n.d(t,{A:()=>o});n(296540);var r=n(474848);const o=function(e){const t=(0,n(401497).eP)(),o={width:42,height:42,flexShrink:0,flexGrow:0};return(0,r.jsxs)("div",{style:{width:"100vw",height:"90vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,r.jsx)(n(996332).Q,{href:n(427704).JZ.root,innerStyle:{padding:8,borderRadius:4,marginBottom:2},children:"light"===t?(0,n(182183).notionTintableIcon)(o):(0,n(558687).notionIcon)(o)}),(0,r.jsx)("div",{style:{maxWidth:320,paddingInlineStart:18,paddingInlineEnd:18},children:e.children})]})}},224741:(e,t,n)=>{n.d(t,{initializeElectron:()=>h});n(811558),n(898992),n(354520),n(581454),n(814603),n(147566),n(198721);var r=()=>n(20022),o=()=>n(44551),i=()=>n(751629),a=()=>n(609679),s=()=>n(361242),c=()=>n(165358),l=()=>n(651170),d=()=>n(711059),u=()=>n(496603),p=()=>n(229833),m=()=>n(763824);function f(e=navigator.userAgent){const t=function(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)));return}(e);return!!t&&(10===t[0]&&t[1]<15)}var v=()=>n(534606),g=()=>n(787804);async function h(e){var t;const{device:n,electronSqlite:h,routerStore:b}=e;if(!o().electronApi)return;await(0,i().getAndCacheDesktopVersionAsync)();const S=await(0,v().a)();if(/WantsServiceWorker/i.test(navigator.userAgent)&&"serviceWorker"in navigator){var y,w;if((null===(y=o().electronApi.isEphemeralSession)||void 0===y?void 0:y.call(o().electronApi))??!1){const e=await navigator.serviceWorker.getRegistration();return void(e&&await e.unregister())}S&&navigator.serviceWorker.register(`${window.location.origin}/sw.js`,{type:"classic",scope:"/"}).catch((async e=>{await m().nQ(2e3,b.waitUntil((()=>{var e;return void 0!==(null==b||null===(e=b.state)||void 0===e||null===(e=e.route)||void 0===e?void 0:e.name)&&"root"!==b.state.route.name})));if(!("login"===b.state.route.name))if(null!==o().electronApi&&void 0!==o().electronApi&&o().electronApi.logErrorForOffline){var t;const n="blank"===b.state.route.name?"prewarmedTab":"quickSearch"===b.state.route.name?"quickSearchWindow":"page";null===o().electronApi||void 0===o().electronApi||null===(t=o().electronApi.logErrorForOffline)||void 0===t||t.call(o().electronApi,{level:"error",from:"electronActions",type:`${n}ServiceWorkerRegistrationError`,error:(0,p().convertErrorToLog)(e)})}else c().log({level:"error",from:"electronActions",type:"serviceWorkerRegistrationError",error:(0,p().convertErrorToLog)(e)})})),navigator.serviceWorker.addEventListener("controllerchange",(()=>{const e=new URL(window.location.href);e.searchParams.set(s().Sn,"service_worker_change"),window.location.replace(e.toString())})),null!==o().electronApi&&void 0!==o().electronApi&&null!==(w=o().electronApi.relayMessageToServiceWorker)&&void 0!==w&&w.addListener&&o().electronApi.relayMessageToServiceWorker.addListener(((e,t)=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((e=>{var n;null===(n=e.active)||void 0===n||n.postMessage(t)}))})),o().electronApi.relayMessageFromServiceWorker&&navigator.serviceWorker.addEventListener("message",(e=>{o().electronApi&&o().electronApi.relayMessageFromServiceWorker&&o().electronApi.relayMessageFromServiceWorker(e.data)}))}if(null!==(t=o().electronApi.zoom)&&void 0!==t&&t.get&&await o().electronApi.zoom.get(),h&&h.sqliteConnection&&(h.sqliteConnection.ensureMigrated().catch((e=>{c().log({level:"error",from:"electronActions",type:"sqliteConnectionEnsureMigratedError",error:(0,p().convertErrorToLog)(e),data:(0,l().CS)(e,{isBrowser:!1})})})),h.sqliteConnection.optimize().catch((e=>{c().log({level:"error",from:"electronActions",type:"sqliteConnectionOptimizeError",error:(0,p().convertErrorToLog)(e),data:(0,l().CS)(e,{isBrowser:!1})})}))),o().electronApi.getSubstitutions&&n.isElectronMac){const e=await o().electronApi.getSubstitutions();(0,r().zu)(e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${u().Nt(e.replace)} $`),with:`${e.with} `}))))}n.isElectronMac&&(f()&&r().Zq.setPreference("isAutoUpdaterDisabled",!0),await async function(e){const t=e.device.desktopAppVersion;if(!t)return;const n=(0,d().parseVersion)(t);if(!n)return;const o=await r().Zq.get(),i=null==o?void 0:o.preferences;i&&((0,g().o)(n)?!1===i.isUniversalLinksEnabled&&(r().Zq.setPreference("isUniversalLinksEnabled",!0),r().Zq.setPreference("isUniversalLinksEnabledBackup",!1)):!1===i.isUniversalLinksEnabledBackup&&(r().Zq.setPreference("isUniversalLinksEnabledBackup",void 0),r().Zq.setPreference("isUniversalLinksEnabled",!1)))}(e)),o().electronApi.setLocale&&o().electronApi.setLocale(a().locale)}},233124:(e,t,n)=>{n.d(t,{D_:()=>s,E_:()=>a,Im:()=>c,K_:()=>d,rP:()=>l,uB:()=>i});var r=()=>n(314529),o=()=>n(564884);function i(e,t){e&&(0,r().DO_NOT_USE_trackLegacy)(e,"dictation_modal_open",t)}function a(e,t){e&&(0,r().DO_NOT_USE_trackLegacy)(e,"dictation_modal_close",t)}function s(e,t){e&&(0,o().u)({environment:e,event:{eventName:"dictation_start",eventProperties:t}})}function c(e,t){e&&(0,r().DO_NOT_USE_trackLegacy)(e,"dictation_end",t)}function l(e,t){e&&(0,r().DO_NOT_USE_trackLegacy)(e,"dictation_error",t)}function d(e,t){e&&(0,r().DO_NOT_USE_trackLegacy)(e,"update_dictation_language",t)}},250084:(e,t,n)=>{n.d(t,{m:()=>m});n(16280),n(944114),n(898992),n(430670),n(803949),n(581454);var r=()=>n(564884),o=()=>n(711339),i=()=>n(165358),a=()=>n(388821),s=()=>n(651170),c=()=>n(445120),l=()=>n(330013),d=()=>n(496603),u=()=>n(229833);let p=1;class m{constructor(e){this.connection=void 0,this.maxSize=void 0,this.getEnvironment=void 0,this.getLatency=new(n(293596).B),this.batchReadWorkers=15,this.pendingWrites=a().RecordMapPolymorphic.create(),this.getManyFromDisk=async e=>{const t=a().RecordMapPolymorphic.create();e.forEach((({pointer:e},n)=>{t.set(e,n)}));const n=await l().getRecords(this.connection,e),r=a().RecordMapPolymorphic.create();for(const o of n)this.setCachedRecordMap(r,o);return e.map((({pointer:e,userId:t})=>{const n=this.getInMemory(e,t);if(n)return n;const o=r.get(e);return o&&o[t]}))},this.diskReadQueue=new(n(56322).A)({batchSize:Math.floor(n(430476).Zj/3)-1,maxWorkers:this.batchReadWorkers>0?this.batchReadWorkers:1,performRequests:this.getManyFromDisk}),this.flushWrites=async()=>{const e=this.pendingWrites;this.pendingWrites=a().RecordMapPolymorphic.create();const t=Array.from(e).flatMap((({value:e})=>e?Object.values(e):[])),i=o().default.mark("sqlite_record_cache.flush_writes.duration");try{await l().applyRecordCacheOperations(this.connection,t),o().default.measure(i,{environment:this.getEnvironment(),data:{status:"success"},shouldExcludeFromTimeline:!0})}catch(s){(0,r().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.flush_writes.error",eventProperties:{error_name:s instanceof Error?s.name:"unknown",error_message:s instanceof Error?s.message:"unknown"}}}),o().default.measure(i,{environment:this.getEnvironment(),data:{status:"error"},shouldExcludeFromTimeline:!0})}n(242422).default.checkGate({gateName:"download_for_offline"})||navigator.locks.request("sqliteRecordCacheEviction",{mode:"exclusive",ifAvailable:!0},(async e=>{if(!e)return;const t=await this.getTablesThatNeedEviction();if(0===t.length)return;const r=await(0,n(968913).w3)({environment:this.getEnvironment()});await this.evictTables({tables:t,offlineRecordIds:r})}))},this.debouncedFlushWrites=d().sg(this.flushWrites,500,{maxWait:3e3}),this.connection=e.connection,this.maxSize=e.maxSize,this.getEnvironment=e.getEnvironment}getDedicatedWorkerConnection_DEBUG_ONLY(){var e,t;return null===(e=(t=this.connection).getDedicatedWorkerConnection_DEBUG_ONLY)||void 0===e?void 0:e.call(t)}set(e){const{pointer:t,value:r,importance:o,maybeStaleRecordMap:a}=e;if(void 0===t||void 0===t.id){const e=new Error("Attempting to set a record with an invalid pointer.");return i().log({level:"error",from:"SqliteRecordCache",type:"SqliteRecordCache.setBadPointer",error:{message:"Attempting to set a record with an invalid pointer.",stack:e.stack},data:{pointer:t}}),void n(449412).Fg(e)}const s=e.userId||c().LOGGED_OUT_USER_ID,l={pointer:t,userId:s,value:r,timestamp:Date.now(),importance:o};this.removePendingWrite(t,s,"delete"),this.enqueueWrite({type:"set",record:l,maybeStaleRecord:a})}async get(e){const{pointer:t,skipAccessWrites:i}=e,a=`get ${p}`,l=e.userId||c().LOGGED_OUT_USER_ID;let d;p++,this.getLatency.start(a);try{const e=this.getInMemory(t,l);if(e)return i||this.enqueueWrite({type:"access",record:e}),this.getLatency.end(a,"memory"),e.value;d=o().default.mark("sqlite_record_cache.get_record.duration");const n=await(this.batchReadWorkers>0?this.diskReadQueue.enqueue({pointer:t,userId:l}):this.getFromDiskUnbatched(t,l));if(n)return i||this.enqueueWrite({type:"access",record:n}),this.getLatency.end(a,"disk"),o().default.measure(d,{environment:this.getEnvironment(),data:{status:"success"},shouldExcludeFromTimeline:!0}),n.value}catch(u){if(u instanceof s().PW||u instanceof s().lh){(0,n(678293).aH)({gateName:"recover_from_sqlite_corruption"})||this.getEnvironment().defaultRecordCache.disablePersistedRecordCache()}return(0,r().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.get_record.error",eventProperties:{error_name:u instanceof Error?u.name:"unknown",error_message:u instanceof Error?u.message:"unknown",sqlite_code:(0,s().xY)(u)?u.debugInfo.sqliteCode:void 0}}}),void(d&&o().default.measure(d,{environment:this.getEnvironment(),data:{status:"error",sqlite_code:(0,s().xY)(u)?u.debugInfo.sqliteCode:void 0},shouldExcludeFromTimeline:!0}))}finally{this.getLatency.end(a,"miss")}}deleteRecord(e,t){t=t||c().LOGGED_OUT_USER_ID,this.removePendingWrite(e,t,"set"),this.enqueueWrite({type:"delete",record:{pointer:e,userId:t}})}async getBlocksWithParent(e){const t=Date.now(),r=e.userId||c().LOGGED_OUT_USER_ID,o=await l().getBlocksWithParent(this.connection,{...e,timestamp:t,userId:r}),i=a().RecordMapPolymorphic.create(),s=d().oE(Array.from(this.pendingWrites).map((o=>{const a=o&&o.value&&r&&o.value[r];if(!a||"set"!==a.type)return;const s=a.record.value?a.record.value.value:void 0;if(!s)return;if(a.record.pointer.table!==n(179034).ev)return;const c=s;return c.parent_id===e.parent.id&&c.parent_table===e.parent.table?(i.set(a.record.pointer,!0),a.record.timestamp<t&&(a.record.timestamp=t),a.record.value):void 0})));for(const n of o)i.get(n.pointer)||this.getInMemory(n.pointer,n.userId)||s.push(n.value);return s}async getPageBlocksByParent(e){const t=Date.now(),n=e.userId||c().LOGGED_OUT_USER_ID,r=await l().getPageBlocksByParent(this.connection,{...e,timestamp:t,userId:n});return r.forEach((e=>{this.enqueueWrite({type:"access",record:{pointer:e.pointer,timestamp:t,userId:n,importance:void 0,value:e.value}})})),r}async reset(){this.pendingWrites=a().RecordMapPolymorphic.create(),await this.deleteAllRecordTables()}async deleteAllRecordTables(){try{await l().deleteAllCachedRecords(this.connection),await l().vacuum(this.connection)}catch(e){i().log({level:"error",from:"SqliteRecordCache",type:"deleteAllRecordTablesError",error:(0,u().convertErrorToLog)(e)})}}setEnvironment(e){this.getEnvironment=()=>e}async flushPendingWrites(){await this.flushWrites()}enqueueWrite(e){this.debouncedFlushWrites();const{pointer:t,userId:n}=e.record,r=this.pendingWrites.get(t),o=r&&r[n];if(o){if("set"===o.type&&"access"===e.type){const t={type:"set",record:{...o.record,timestamp:e.record.timestamp}};return void this.setCacheOperationMap(this.pendingWrites,t)}const t="set"===o.type&&!o.maybeStaleRecord&&o.record.value&&o.record.value.value?o.record.value.value.version:void 0,n="set"===e.type&&e.maybeStaleRecord&&e.record.value&&e.record.value.value?e.record.value.value.version:void 0;if("number"==typeof t&&"number"==typeof n&&t>=n)return}this.setCacheOperationMap(this.pendingWrites,e)}async getFromDiskUnbatched(e,t){const[n]=await this.getManyFromDisk([{pointer:e,userId:t}]);return n}getInMemory(e,t){const n=this.pendingWrites.get(e),r=n&&n[t];if(r&&"set"===r.type)return r.record}setCacheOperationMap(e,t){const n=t,{pointer:r,userId:o}=n.record,i=e.get(r)||{};e.set(r,{...i,[o]:n})}setCachedRecordMap(e,t){const{pointer:n,userId:r}=t,o=e.get(n)||{};e.set(n,{...o,[r]:t})}removePendingWrite(e,t,n){const r=this.pendingWrites.get(e);r&&r[t]&&r[t].type===n&&this.pendingWrites.delete(e)}async getTablesThatNeedEviction(){try{return await l().getTablesThatNeedEviction({connection:this.connection,maxSize:this.maxSize})}catch(e){return(0,r().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"get_tables_failed"}},opts:{preboot:!0}}),i().log({level:"warning",from:"SqliteRecordCache",type:"getTablesThatNeedEvictionFailed",error:(0,u().convertErrorToLog)(e)}),[]}}async evictTables(e){const{tables:t,offlineRecordIds:n}=e;try{await l().evictTables({connection:this.connection,tables:t,maxSize:this.maxSize,offlineRecordIds:n}),(0,r().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction",eventProperties:{}},opts:{preboot:!0}})}catch(o){(0,r().u)({environment:this.getEnvironment(),event:{eventName:"sqlite_record_cache.eviction.error",eventProperties:{type:"eviction_failed"}},opts:{preboot:!0}}),i().log({level:"warning",from:"SqliteRecordCache",type:"evictionFailed",error:(0,u().convertErrorToLog)(o)})}}}},253849:(e,t,n)=>{n.d(t,{H:()=>o,S:()=>i});var r=()=>n(79926);const o=new(r().O2)("AppComponents",(async()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(62475),n.e(3151),n.e(98629),n.e(22926),n.e(22900),n.e(42838),n.e(85128),n.e(49889),n.e(20108),n.e(46174),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(69785),n.e(77754),n.e(29357),n.e(64242),n.e(39986),n.e(22585),n.e(47160),n.e(76677),n.e(68609),n.e(37384),n.e(15553),n.e(77345),n.e(79340),n.e(72659),n.e(37759),n.e(41423),n.e(42056),n.e(41751),n.e(41714),n.e(5181),n.e(19456),n.e(3261),n.e(23371),n.e(17729),n.e(32116),n.e(65375),n.e(94995),n.e(98339),n.e(51240),n.e(54219),n.e(20029),n.e(68395),n.e(81803),n.e(96654),n.e(68643),n.e(32625),n.e(79231),n.e(63687),n.e(95885),n.e(27083),n.e(11424),n.e(40119),n.e(54742),n.e(88522),n.e(90880),n.e(49175),n.e(69668),n.e(5331),n.e(92924),n.e(71381),n.e(92192),n.e(96385),n.e(80326),n.e(53352),n.e(2373),n.e(73069),n.e(995),n.e(76690),n.e(60713),n.e(31106),n.e(63248),n.e(54719),n.e(48570),n.e(78862),n.e(54234),n.e(85160),n.e(15381),n.e(77149),n.e(86036),n.e(68466),n.e(77651),n.e(51204),n.e(57105),n.e(3759),n.e(44128),n.e(95103),n.e(58071),n.e(75681)]).then(n.bind(n,968682)))),i=(0,r()._h)(o,(e=>e.AppComponents))},263943:(e,t,n)=>{n.d(t,{iT:()=>f,iZ:()=>m,rs:()=>v,t1:()=>g});n(944114),n(581454);var r=n(296540),o=()=>n(59226),i=()=>n(248140),a=()=>n(420802),s=()=>n(546926),c=()=>n(890492),l=()=>n(81068),d=()=>n(663639),u=()=>n(736847),p=n(474848);const m={id:"slippery_slope_full_screen_sidebar",label:"Toggle sidebar to full width"},f={id:"slippery_slope_recents_with_chats",label:"Recents include chats"};function v(){const e=(0,o().X)(m.id),t=(0,o().X)(f.id);return r.useMemo((()=>[{...m,isEnabled:e},{...f,isEnabled:t}]),[e,t])}function g({featureFlagStates:e}){const t=(0,r.useCallback)((e=>{i().A.updateLocalOverrideGate(e.id,!e.isEnabled)}),[]);if(0===e.length)return null;const n=[];return n.push({key:"other",render:e=>(0,p.jsx)(u().A,{...e,title:"Other"}),items:e.map((e=>({key:e.id,render:(t,n)=>(0,p.jsx)(l().A,{...t,role:"menuitemcheckbox",title:e.label,right:(0,p.jsx)(a().S,{checked:e.isEnabled,size:16,disallowTabbing:!0,onClick:e=>{e.preventDefault(),e.stopPropagation(),t.onClick(e)}}),dontShrinkRight:!0}),action:()=>{t(e)}})))}),(0,p.jsx)(c().A,{menuType:s().gu.Popup,width:280,children:(0,p.jsx)(d().A,{type:d().O.Vertical,initialFocus:void 0,sections:n})})}},273915:(e,t,n)=>{n.d(t,{L:()=>l});var r=()=>n(92697),o=()=>n(59226),i=()=>n(484714),a=()=>n(590526),s=()=>n(110573),c=()=>n(472150);function l(){const e=(0,i().v3)(),t=(0,o().X)("app_level_calendar_event_subscription");return(0,a().K8)((()=>!!t&&(!!s().E.getState().botId&&(e.device.isElectron?r().A.state.isActiveTab??!1:c().l.state.hasWebLock))),[e,t])}},276324:(e,t,n)=>{n.r(t),n.d(t,{mainApp:()=>r});n(16280);async function r(e){var t;const{minimalEnvironment:r,mainStartTime:o,prefetchInitiatedTime:i,prefetchCache:a,initializeStatsigPromise:s,currentUserId:c}=e,{device:l}=r,[d,{setupOnBeforeUnload:u},p,{createClientEnvironment:m},{setupTransactionQueue:f},{default:v},g,h,{setCurrentUserId_FOR_LOGGING_ONLY:b}]=await Promise.all([Promise.resolve().then(n.bind(n,293294)),Promise.resolve().then(n.bind(n,840125)),Promise.resolve().then(n.bind(n,165358)),Promise.resolve().then(n.bind(n,783068)),Promise.resolve().then(n.bind(n,129286)),Promise.resolve().then(n.bind(n,767537)),Promise.resolve().then(n.bind(n,74110)),Promise.resolve().then(n.bind(n,813974)),Promise.resolve().then(n.bind(n,846249))]);h.initializeKeyboardShortcutsStore(r);const S=await m({minimalEnvironment:r,prefetchCache:a,currentUserId:c}),y=await d.initialize({environment:S,currentUserId:c});b(c);const[{CurrentUser:w},{getGhostAdminUserId:_}]=await Promise.all([Promise.resolve().then(n.bind(n,590966)),Promise.resolve().then(n.bind(n,463832))]);y.updateCurrentUserId=async e=>{const t=await _(y),n={...e.environment,currentUser:new w({id:e.currentUserId,loggedInUserIds:e.userIds,adminUserId:t})};b(c),await ae(n),n.idCreator.updateCurrentUserId(e.currentUserId)};const{isPrewarmedTabLoadSidebarEnabled:k}=await Promise.resolve().then(n.bind(n,182805)),A="/blank"===window.location.pathname&&k();if(null!==(t=y.bootData)&&void 0!==t&&t.spaceId||A){var I;const[{default:e},{SpaceStore:t},{SpaceViewStore:r},{getLastVisitedSpaceId:o,getLastVisitedSpaceViewId:i}]=await Promise.all([Promise.resolve().then(n.bind(n,907258)),Promise.resolve().then(n.bind(n,302996)),Promise.resolve().then(n.bind(n,475543)),Promise.resolve().then(n.bind(n,878667))]);let a,s=null===(I=y.bootData)||void 0===I?void 0:I.spaceId;if(A&&(s??=o(),a??=i()),s){const n=new t(y,{table:"space",id:s}),o=a?r.createChildStore(n,{id:a,table:"space_view",spaceId:s}):void 0;e.setState({...e.state,sidebarSpaceStore:n,...o&&{sidebarSpaceViewStore:o}})}}const{ElectronSqlite:E,RouterStore:C}=y;g.setupRecordCacheDebugging(l);const T=await f(y);u({device:l,TransactionQueue:T,AppUpdateStore:y.AppUpdateStore,GlobalFileUploadStore:v});const[P,{default:x}]=await Promise.all([Promise.resolve().then(n.bind(n,652393)),Promise.resolve().then(n.bind(n,711339))]);if(P.initialize(y),l.isMobileNative){const e=x.DO_NOT_USE_markLegacy("mobilenative.initialize_from_js"),[t,r,o]=await Promise.all([Promise.resolve().then(n.bind(n,541585)),Promise.resolve().then(n.bind(n,268716)),Promise.resolve().then(n.bind(n,584440))]);await t.initializeMobileNativeApp(y),Object.assign(p.clientLogglyEnvironmentData,r.getMobileNativeDeviceInfo(),o.getMobileNativeSessionInfo()),x.DO_NOT_USE_measureLegacy(e,{environment:y,data:{}})}if(l.isElectron){const e=x.mark("desktop.initialize_from_js"),{initializeElectron:t}=await Promise.resolve().then(n.bind(n,224741));await t({device:l,electronSqlite:E,routerStore:C});const r=await Promise.resolve().then(n.bind(n,647987)),o=await r.getDesktopDeviceInfo();Object.assign(p.clientLogglyEnvironmentData,o,{desktopVersion:l.desktopAppVersion}),x.measure(e,{environment:y})}const[L,R,U,D,M,N,O]=await Promise.all([Promise.resolve().then(n.bind(n,869562)),Promise.resolve().then(n.bind(n,86159)),Promise.resolve().then(n.bind(n,287601)),Promise.resolve().then(n.bind(n,244828)),Promise.resolve().then(n.bind(n,626819)),Promise.resolve().then(n.bind(n,779975)),Promise.resolve().then(n.bind(n,907258))]),[{AppRoot:j},B,q,W,{default:z}]=await Promise.all([Promise.resolve().then(n.bind(n,160778)),Promise.resolve().then(n.t.bind(n,296540,19)),Promise.resolve().then(n.t.bind(n,440961,19)),Promise.resolve().then(n.t.bind(n,205338,19)),Promise.resolve().then(n.bind(n,242422))]);R.startListeners(l);const{mobileNative:F}=y;if(F&&F.sqliteConnection){const[e,{LOGGED_OUT_USER_ID:t},{convertErrorToLog:r}]=await Promise.all([Promise.resolve().then(n.bind(n,330013)),Promise.resolve().then(n.bind(n,445120)),Promise.resolve().then(n.bind(n,229833))]);try{await e.backfillRecordsWithUserId(F.sqliteConnection,c||t)}catch(ce){p.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:r(ce),data:{}})}}M.initializeDefaultEventPropertiesFetcher(),N.provideDependencies({defaultStableParentStore:O.AppStoreMainEditorCurrentBlockStore}),U.initialize(y),T.startLoop();const[{refreshNotionCookies:$,validateHasPermissionArgs:K,clearNotionCookiesWithNoPermission:V,clearThirdPartyCookiesAndLocalStorageWithNoPermission:H},{clearNotionLocalStorageWithNoPermission:G},J,Z,Q,X,{default:Y},ee]=await Promise.all([Promise.resolve().then(n.bind(n,463832)),Promise.resolve().then(n.bind(n,422920)),Promise.resolve().then(n.bind(n,14307)),Promise.resolve().then(n.bind(n,561503)),Promise.resolve().then(n.bind(n,410690)),Promise.resolve().then(n.bind(n,807054)),Promise.resolve().then(n.bind(n,88728)),Promise.resolve().then(n.bind(n,943494))]);Promise.all([V(y),H(y)]).then((()=>$(y))),G(),K(y);const[{TransactionQueueDependenciesImpl:te},{waitForStatsigInitialization:ne},{isPrewarmedTabInitialRender:re}]=await Promise.all([Promise.resolve().then(n.bind(n,447065)),Promise.resolve().then(n.bind(n,546369)),Promise.resolve().then(n.bind(n,807054))]);let oe,ie;async function ae(e){const t=performance.now(),{didStatsigBootupTimeout:n}=await ne({environment:y,initializeStatsigResult:await s});oe??=z.checkGate({gateName:"react_18_concurrent_rendering"});const r=performance.now(),a=document.querySelector("#notion-app");if(!a)throw new Error('Could not find element with id "notion-app"');T.updateDependencies(new te(e)),D.updateConnectionState(e),J.updateEnvironment(e),p.clientLogglyEnvironmentData.userId=e.currentUser.id;const c=()=>{const e=document.getElementById("initial-loading-spinner"),a=document.getElementById("skeleton");e&&e.remove(),a&&a.remove();const s=performance.now();Z.setSubMetricsAtRenderCallback({mainStartTime:o,prefetchInitiatedTime:i,statsigBootupBlockingStartTime:t,renderStartTime:r,renderEndTime:s});const c=Q.getAppStartTime();c&&x.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_app_start",startTime:0,endTime:c},{environment:y,data:{sub_metrics:X.getTimeOriginToAppStartSubMetrics()}}),x.DO_NOT_USE_measureLegacy({metricName:"time_origin_to_prefetch_initiated",startTime:0,endTime:i},{environment:y}),Y.state&&x.measure({metricName:"client.migrate_sqlite",startTime:Y.state.startTime,endTime:Y.state.endTime},{environment:y}),x.measure({metricName:"statsig_bootup_blocking",startTime:t,endTime:r},{environment:y,data:{timed_out:n,is_prewarmed_tab:re(y)}})},l=B.createElement(j,{environment:e,onMount:oe?c:void 0});oe?(ie??=W.createRoot(a),ie.render(l)):q.render(l,a,c)}L.initialize(y),await ae(y);const{startFlushing:se}=await Promise.resolve().then(n.bind(n,998191));return se(((e,t)=>{x.measure(e,{environment:y,preboot:!0,shouldSendIfStatsigNotInitialized:!0,shouldExcludeFromTimeline:!0,data:t})})),{transactionQueue:T,environment:y}}},287601:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>p});var r=()=>n(201794),o=()=>n(584262),i=()=>n(183558),a=()=>n(917908),s=()=>n(807054),c=()=>n(993130),l=()=>n(573070),d=()=>n(409065),u=()=>n(230115);async function p(e){const t=window.history.state&&window.history.state.id||(0,i().Ay)(),n=e.currentUser.id;window.history.state||(window.history.replaceState({id:t,currentUserId:n},"",window.location.href),(0,d().k)({historyId:t,historyIndex:0,currentUserId:n})),(0,c().A)(e)&&e.TabbedRouterStore.setUp({nativeInboxEnabled:(0,r().T)("supportsNativeInbox")}),e.device.isElectron&&(s().setDesktopLoadContext(),a().H.pushEntry({historyId:t,currentUserId:n,url:window.location.href}));const p=window.location.href;await(0,u().Y)({environment:e,id:t,action:"pop",href:p,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0,pageVisitSourceOverride:(0,o().Q5)(p)?void 0:o().y8.Initialization});const m=(0,l().w)(n);if(!m||"undefined"===m){const e=window.location.pathname;e&&(0,l().E)({currentUserId:n,value:e})}}},313633:(e,t,n)=>{n.d(t,{A:()=>d});n(296540);var r=()=>n(401497),o=()=>n(695115),i=()=>n(563692),a=()=>n(340498),s=()=>n(69708),c=()=>n(100622),l=n(474848);function d(e){const{top:t,right:n,onClick:d}=e,u=(0,s().tz)(),p=(0,r().IS)((()=>({buttonBackground:{position:"absolute",top:t??12,insetInlineEnd:n??12,width:22,height:22,borderRadius:"100%",background:c().Tj.background.elevated},button:{width:"100%",height:"100%",borderRadius:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:"transparent"},buttonHovered:{background:c().Tj.buttonHoveredBackground},icon:{width:a().Ev.xs,height:a().Ev.xs}})),[t,n]);return(0,l.jsx)("div",{style:p.buttonBackground,children:(0,l.jsx)(o().A,{ariaLabel:u.formatMessage({id:"closeButton.ariaLabel",defaultMessage:"Close"}),style:p.button,hoveredStyle:p.buttonHovered,onClick:d,icon:i().xMarkFillSmallIcon,iconStyle:p.icon})})}},323914:(e,t,n)=>{n.d(t,{c:()=>i,y:()=>o});var r=()=>n(118307);const o=new(r().A),i=new(r().A)},329418:(e,t,n)=>{n.d(t,{C:()=>i,g:()=>a});var r=()=>n(625750),o=()=>n(763884);function i(e){return o().K.get({userId:e.userId,key:`${e.spaceId}:analytics_session`})}function a(e){const t=e.storedSession??i(e);if(!(t&&Date.now()-t.lastFocusedTime>r().o))return t}},330013:(e,t,n)=>{n.r(t),n.d(t,{EvictableTables:()=>m,PersistedRecordColumns:()=>f,applyRecordCacheOperations:()=>I,backfillRecordsWithUserId:()=>v,batchUpsertRecordStatements:()=>h,deleteAllCachedRecords:()=>T,evictTables:()=>E,getBlocksWithParent:()=>k,getPageBlocksByParent:()=>A,getRecords:()=>_,getTablesThatNeedEviction:()=>P,vacuum:()=>C});n(16280),n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(672577),n(803949),n(581454);var r=()=>n(212547),o=()=>n(277153),i=()=>n(179034),a=()=>n(292588),s=()=>n(105652),c=()=>n(927827),l=()=>n(430476),d=()=>n(68336),u=()=>n(496603),p=()=>n(534177);const m={Records:{tableName:"records",idColumn:"record_id",priorityColumns:"importance, timestamp",priorityColumnsOrderBy:"importance DESC, timestamp DESC"},Block:{tableName:"block",idColumn:"id",priorityColumns:"meta_last_access_timestamp",priorityColumnsOrderBy:"meta_last_access_timestamp DESC"}},f=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function v(e,t){await(0,l().G2)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function g(e){const t=u().$z(e.records,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((([t,r])=>{const o=c().M.find((e=>e.table===t));if(!o)return;const i=(0,p().uv)(o.recordColumnTypes),a=(0,p().uv)(o.metaColumnTypes),s=[...i,...a];u().iv(r,Math.floor(l().Zj/s.length)).forEach((r=>{const o=`(${s.join(",")})`,c=Array(r.length).fill(`(${"?, ".repeat(s.length-1)}?)`).join(",");let l;l=e.maybeStaleRecords&&s.includes("version")?`INSERT INTO ${t} ${o} VALUES ${c}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(s.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${t}.version`):`INSERT OR REPLACE INTO ${t} ${o} VALUES ${c}`;const d=u().Bq(r.map((({value:e,timestamp:t,userId:n})=>{if(!e)return[];const r=e.value;if(!r)return[];const o=i.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}((0,p().O)(r,e)?r[e]:void 0))),s=a.map((r=>{switch(r){case"meta_user_id":return n;case"meta_role":return e.role;case"meta_last_access_timestamp":return t;default:throw new Error(`Unknown meta column ${r}`)}}));return o.concat(s)})));n.push({sql:l,args:d})}))})),n}function h(e){const[t,n]=u().jB(e.records,(e=>x(e))),o=g({records:t,maybeStaleRecords:e.maybeStaleRecords}),i=function(e){const{records:t,maybeStaleRecords:n}=e;return u().iv(t,Math.floor(l().Zj/f.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=n?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:u().Bq(e.map((({pointer:e,value:t,timestamp:n,importance:o,userId:i})=>{let a=null,s=null;return t&&t.value&&(0,r().ob)(t.value)&&(a=t.value.parent_id,s=t.value.parent_table),[e.table,e.id,(0,l().Fm)(t),n,s,a,"number"==typeof o?o:null,i,e.spaceId||null]})))}}))}({records:n,maybeStaleRecords:e.maybeStaleRecords});return[...b(t),...S(n.filter((e=>c().z.has(e.pointer.table)))),...o,...i]}function b(e){return u().iv(e,Math.floor(l().Zj/(2*e.length))).map((e=>{const t=d().F4.or(e.map((e=>d().F4`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return d().F4`DELETE FROM records WHERE ${t}`.asWrite()}))}function S(e){const t=u().$z(e,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((([e,t])=>{u().iv(t,Math.floor(l().Zj/(2*t.length))).forEach((t=>{const r=d().F4.or(t.map((e=>d().F4`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));n.push(d().F4`DELETE FROM ${d().F4.ident(e)} WHERE ${r}`.asWrite())}))})),n}async function y(e,t){if(0===t.length)return[];const n=u().$z(t,(e=>e.pointer.table)),r=[];Object.entries(n).forEach((([t,n])=>{const i=c().M.find((e=>e.table===t));if(!i)return;const a=Array(n.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),s=u().qI(n,(({pointer:{table:e,id:t},userId:n})=>[t,n]));r.push(async function(){const[n]=await(0,l().G2)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${t}\n\t\t\t\tWHERE ${a}`,args:s,getData:!0}],queryName:"getRecordsFromSeparateTables"});return n.data.map((e=>function(e,t,n){return{pointer:o().L3.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:w(t,n)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(t,e,i)))}())}));const i=await Promise.all(r);return u().Bq(i)}function w(e,t){const n={};return(0,p().uv)(t.recordColumnTypes).forEach((r=>{const o=t.recordColumnTypes[r];if(null!==e[r])switch(o){case a().A.UUID:case a().A.String:case a().A.Number:n[r]=e[r];break;case a().A.StringArray:case a().A.JSON:n[r]=JSON.parse(e[r]);break;case a().A.XML:n[r]=e[r];break;case a().A.UUIDArray:n[r]=JSON.parse(e[r]);break;case a().A.Boolean:n[r]=1===e[r];break;case a().A.CIDR:n[r]=e[r];break;case a().A.NumberArray:n[r]=JSON.parse(e[r]);break;case a().A.Blob:n[r]=e[r];break;case a().A.CIDRArray:n[r]=JSON.parse(e[r]);break;default:(0,p().HB)(o)}})),n}async function _(e,t){const[n,r]=u().jB(t,(e=>c().z.has(e.pointer.table))),i=await y(e,n),a=new Set(i.map((e=>o().tr.toKey({pointer:e.pointer,userId:e.userId})))),s=n.filter((e=>!a.has(o().tr.toKey(e)))),d=await async function(e,t){if(0===t.length)return[];const n=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),r=u().qI(t,(({pointer:{table:e,id:t},userId:n})=>[e,t,n])),[i]=await(0,l().G2)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${n}`,args:r,getData:!0}],queryName:"getRecordsFromRecordsTable"});return i.data.map((e=>({pointer:o().L3.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,r.concat(s)),p=d.filter((e=>!x(e)));return i.concat(p)}async function k(e,t){const n=d().F4`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),r=d().F4`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[a]=await(0,l().G2)({connection:e,statements:[n,r],queryName:"getBlocksWithParent"});return a.data.map((e=>({pointer:o().L3.fromPointerLike({table:i().ev,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:w(e,s().J)},userId:t.userId})))}async function A(e,t){const n=d().F4`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,r=await n.all(e,"getPageBlocksByParent");return 0===r.length?[]:r.map((e=>({pointer:o().L3.fromPointerLike({table:i().ev,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:w(e,s().J)},userId:t.userId})))}async function I(e,t){const n=t.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),r=t.filter((e=>"set"===e.type&&e.maybeStaleRecord)),o=t.filter((({type:e})=>"access"===e)),a=t.filter((({type:e})=>"delete"===e)),s=[];if(o.forEach((e=>{const t=e.record.pointer.table;x(e.record)?t===i().ev&&s.push(d().F4`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):s.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),n.length>0||r.length>0){if(n.length>0){const e=n.map((e=>e.record));s.push(...h({records:e,maybeStaleRecords:!1}))}if(r.length>0){const e=r.map((e=>e.record));s.push(...h({records:e,maybeStaleRecords:!0}))}}if(a.length>0){const e=a.map((e=>e.record));s.push(...function(e){const t=S(e.filter((e=>c().z.has(e.pointer.table)))),n=b(e);return t.concat(n)}(e))}0!==s.length&&await(0,l().G2)({connection:e,statements:s,queryName:"applyRecordCacheOperations"})}async function E(e){const{connection:t,tables:n,maxSize:r,offlineRecordIds:o}=e;if(0===n.length)return;const i=n.map((e=>function(e){const{table:t,maxSize:n,offlineRecordIds:r}=e,{tableName:o,idColumn:i,priorityColumns:a,priorityColumnsOrderBy:s}=m[t],c=`\n\t\tWITH offline_record_ids(id) AS (\n\t\t\t${r.length>0?`VALUES ${r.map((()=>"(?)")).join(", ")}`:"SELECT 1 WHERE false"}\n\t\t)\n\n\t`,l=`\n\t\t\n\t\tSELECT\n\t\t\t${i},\n\t\t\t0 as preservation_priority,\n\t\t\t${a}\n\t\tFROM ${o}\n\t\tWHERE ${i} IN (SELECT id FROM offline_record_ids)\n\t\n\t\tUNION\n\t\t\n\t\tSELECT\n\t\t\t${i},\n\t\t\t1 as preservation_priority,\n\t\t\t${a}\n\t\tFROM ${o}\n\t\tWHERE ${i} NOT IN (SELECT id FROM offline_record_ids)\n\t\n\t\tORDER BY preservation_priority ASC, ${s}\n\t\tLIMIT ${Math.max(n,r.length)}\n\t`;return{sql:`\n\t\t\t${c}\n\t\t\tDELETE FROM ${o}\n\t\t\tWHERE ${i} NOT IN (\n\t\t\t\tSELECT ${i} FROM (\n\t\t\t\t\t${l}\n\t\t\t\t)\n\t\t\t)\n\t\t`,args:r}}({table:e,maxSize:r,offlineRecordIds:o})));await(0,l().G2)({connection:t,statements:i,queryName:"evictTables"})}async function C(e){await(0,l().fi)({connection:e})}async function T(e){await async function(e){const t=[];c().z.forEach((e=>{t.push(d().F4`DELETE FROM ${d().F4.ident(e)}`.asWrite())})),await(0,l().G2)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,l().G2)({connection:e,statements:[{sql:"DELETE FROM records"}],queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}async function P(e){const{connection:t,maxSize:n}=e,r={Records:{sql:`SELECT COUNT(*) FROM ${m.Records.tableName}`,getData:!0},Block:{sql:`SELECT COUNT(*) FROM ${m.Block.tableName}`,getData:!0}},o=await(0,l().G2)({connection:t,statements:Object.values(r),queryName:"getTablesThatNeedEviction"}),i=u().Jt(o,"[0][data][0][COUNT(*)]"),a=u().Jt(o,"[1][data][0][COUNT(*)]");if("number"!=typeof i||"number"!=typeof a)throw new Error("getTablesThatNeedEviction query returned malformed results.");return[...i>n?["Records"]:[],...a>n?["Block"]:[]]}function x(e){return c().z.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},353195:(e,t,n)=>{n.d(t,{J:()=>r});const r=[[2,1,3,1],[1,0,2,0],[0,2,0,3],[3,3,0,2],[1,1,2,2]]},356853:(e,t,n)=>{n.r(t),n.d(t,{bootWasmSqliteWorkersEarlier:()=>c,consumePrewarmedWorkers:()=>s,isBootWasmSqliteEarlierEnabled:()=>i,isBootWasmSqliteLaterEnabled:()=>a});n(814603),n(147566),n(198721);const r={worker:void 0,sharedWorker:void 0},o=(0,n(965456).X4)("prewarm_wasm_sqlite_worker");function i(){return"earlier"===o}function a(){return"later"===o}function s(){const e={worker:r.worker,sharedWorker:r.sharedWorker};return r.worker=void 0,r.sharedWorker=void 0,e}function c(){if("undefined"==typeof window||window.__isElectron||/ReactNative|MobileNative/.test(navigator.userAgent)||"undefined"==typeof navigator||void 0===(null===(e=navigator.locks)||void 0===e?void 0:e.request)||"undefined"==typeof SharedWorker||navigator.userAgent.includes("Android"))return;var e;performance.now();r.worker=new Worker(new URL(n.p+n.u(75528),n.b)),r.sharedWorker=new SharedWorker(new URL(n.p+n.u(33429),n.b))}},357731:(e,t,n)=>{n.d(t,{P:()=>m,U:()=>p});var r=()=>n(907258),o=()=>n(590526),i=()=>n(465628),a=()=>n(232615),s=()=>n(680977),c=()=>n(301421),l=()=>n(559241),d=()=>n(244828);function u(){const e=a().default.state;if("editing"===e.mode){const t=(0,i().H)(e.multiSelection);if(t&&(0,l().g)(t.selection)){const e=t.store,n=c().n.findEditableWithStore(e);if(n){return e.getValue()?void 0:n}}}}function p(){return(0,o().K8)(u,[])}function m(e){const{currentUserSettingsStore:t}=r().default.state;t&&d().createAndCommit({userAction:"educationTooltipsActions.completePressSlashTooltip",environment:e,perform:e=>{(0,s().m)({userSettingsStore:t,transaction:e,data:{pressed_slash_tooltip:!0}})},canUndo:!0,userId:t.id})}},370136:(e,t,n)=>{n.d(t,{p:()=>a});var r=()=>n(165358),o=()=>n(763884),i=()=>n(914649);function a(e){const{userId:t,from:n,additionalLogData:a}=e,s=o().K.get({userId:t,key:i().XK});if(s)return o().K.remove({userId:t,key:i().XK}),r().log({level:"info",from:n,type:"localStorageMigrationSuccess",data:{miscDataToConvertToString:{userId:t,previousLocalStorageValue:s,...a}}}),s}},379887:(e,t,n)=>{n.d(t,{g:()=>a,j:()=>i});var r=n(296540);const o={clearSelection:()=>{}},i=(0,r.createContext)(o);function a(){return(0,r.useContext)(i)}i.displayName="ClearSelectionContext"},391767:(e,t,n)=>{n.d(t,{Y:()=>i});var r=()=>n(79926);const o=new(r().O2)("Invoice",(async()=>await n.e(60896).then(n.bind(n,427423)))),i=(0,r()._h)(o,(e=>e.Invoice))},417924:(e,t,n)=>{n.d(t,{AK:()=>l,Em:()=>u,Ns:()=>d});var r=()=>n(135168),o=()=>n(295633),i=()=>n(179034),a=()=>n(129522),s=()=>n(250452),c=()=>n(836724);function l(e){var t;const n=null===(t=a().K.findBlockFromId(e))||void 0===t?void 0:t.getBlockStore();if(n)return n;const s=(0,r().f)(n);return s?o().B.createChildStore(s,{id:e,table:i().ev}):void 0}function d(e){return{start:{blockStoreId:e.start.store.id,index:e.start.index},end:{blockStoreId:e.end.store.id,index:e.end.index}}}function u(e){const t=e.start.blockStoreId,n=e.end.blockStoreId,[r,o]=c().T.findSelectablesFromIds([t,n]),i=(null==r?void 0:r.props.store)&&(0,s().aI)(null==r?void 0:r.props.store),a=t===n?i:(null==o?void 0:o.props.store)&&(0,s().aI)(null==o?void 0:o.props.store);if(i&&a)return{start:{store:i,index:e.start.index},end:{store:a,index:e.end.index}}}},422920:(e,t,n)=>{n.r(t),n.d(t,{clearNotionLocalStorageWithNoPermission:()=>i});var r=()=>n(901801),o=()=>n(948450);function i(){r().A.removeAllIfNoPermission(),o().A.removeAllIfNoPermission()}},424127:(e,t,n)=>{n.d(t,{uW:()=>u});n(16280);var r=n(296540),o=()=>n(726637),i=()=>n(484714),a=()=>n(79926),s=()=>n(763824),c=()=>n(615234),l=()=>n(534177);const d=100;function u(e,t,n,u=!1){const f=function(e){var t,n;const s=(0,i().v3)(),c=null===(t=s.sqliteConnection)||void 0===t||null===(n=t.getObserver)||void 0===n?void 0:n.call(t),l=c?m.get(c):void 0,[u,f]=(0,r.useState)(l),v=(0,a().fJ)(p,{disabled:!e});return(0,r.useEffect)((()=>{if(u||!c||!e)return;const t=m.get(c);if(t)return void f(t);if("resolved"!==v.status||!c)return;const{TabSqliteSubscriptionBackend:n,SqliteSubscriptionManager:r}=v.value,i=new r(new n({observer:c,debounceMs:d,broadcastWritesChannel:new BroadcastChannel("sqlite-writes"),config:o().A}));m.set(c,i),f(i)}),[c,v,u,e]),e?u:void 0}(Boolean(t)),v=function(e,t,n,o,a){const s=(0,i().v3)().currentUser.id,c=t?function(e,t,n,r,o,i){var a,s;if(!n&&null!==(a=r.rowType)&&void 0!==a&&a.singleton)throw new Error(`Must use useSqliteSingleton for singleton row type: ${r.rowType.name}`);const c=t.sql();let d=r.readTables;if(!d){const e=null==o?void 0:o.parseQuery(c);var u;if(e)switch(e.type){case"unknown":d=e.tables;break;case"error":throw e.error;case"crud":if(e.writeTables.length>0)throw new Error(`useSqliteQuery: cannot subscribe to query that writes to tables: ${e.writeTables.join(", ")}`);d=e.readTables;break;default:(0,l().HB)(e)}else d=null===(u=r.rowType)||void 0===u?void 0:u.readTables}const p={_key:`sqlite:KeyCreatorNotLoaded:${e}`,_options:r,singleton:n,sql:c,args:t.args,queryName:e,readTables:d,primaryKey:r.primaryKey??(null===(s=r.rowType)||void 0===s?void 0:s.primaryKey),rowType:r.rowType,userId:i||"guest"};o&&(p._key=o.keyCreator.getKeyUncached(p));return p}(e,t,n,o,a,s):void 0,[d,u]=(0,r.useState)(c);if((null==c?void 0:c._key)!==(null==d?void 0:d._key))return u(c),c;return d}(e,t,u,n,f),h=v?null==f?void 0:f.createQuery(v._key,v):void 0,b=h??g,S=(0,r.useSyncExternalStore)(b.subscribe,b.getSnapshot),y=function(e,t,n){var o;const i=null===(o=(0,a().fJ)(p,{disabled:!e}).value)||void 0===o?void 0:o.OptimisticUpdateComposer;return(0,r.useCallback)(((r,o)=>e&&n&&i&&e?async function(e,t,n,r,o,i){const a=r.rowType;if(!a)throw new Error(`Optimistic updates not supported for queries without a RowType or primaryKey: ${r.key}`);const l=new i(a,n);let d;try{t(l)}finally{d=l.done()}const{queryUpdate:u,rowTypeUpdate:p}=d;if(!u&&!p)return e();let m,f;const v=()=>{var e,t;null===(e=m)||void 0===e||e(),null===(t=f)||void 0===t||t()};p&&(o.dispatchRowTypeUpdate(r.userId,a,{type:"put",update:p}),m=()=>{o.dispatchRowTypeUpdate(r.userId,a,{type:"del",id:p.id})});u&&(r.dispatch({type:"put",update:u}),f=()=>{r.dispatch({type:"del",id:u.id})});const g=(0,s().nQ)(10*c().TD,r.waitForRerun()),h=e();return Promise.all([h,g]).finally(v),await h}(r,o,t,e,n,i):r()),[e,n,i,t])}(h,Boolean(null==v?void 0:v.singleton),f),w=Boolean(t),_=(0,r.useMemo)((()=>({...S,withOptimistic:y,enabled:w})),[S,y,w]);if(_.error&&(null==v||!v._options.allowError))throw _.error;return _}const p=new(a().O2)("SqliteSubscriptions",(async()=>{const[{TabSqliteSubscriptionBackend:e},{SqliteSubscriptionManager:t},{OptimisticUpdateComposer:r}]=await Promise.all([Promise.all([n.e(14208),n.e(93199)]).then(n.bind(n,384233)),Promise.all([n.e(14208),n.e(93199)]).then(n.bind(n,316878)),Promise.all([n.e(14208),n.e(93199)]).then(n.bind(n,415123))]);return{TabSqliteSubscriptionBackend:e,SqliteSubscriptionManager:t,OptimisticUpdateComposer:r}})),m=new WeakMap;function f(){}const v=Object.freeze({loading:!0,seq:-1,value:void 0,valueSeq:void 0,error:void 0,errorSeq:void 0}),g={subscribe:()=>f,getSnapshot:()=>v,dispatch:f}},427984:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(296540),o=()=>n(590526),i=()=>n(497597),a=n(474848);const s=function(e){const t=(0,n(484714).Y0)(),s=(0,o().K8)((()=>({initiator:n(664748).A.state.initiator,isDragging:n(568891).Ay.state.isDragging})),[]),c=(0,o().K8)((()=>i().default.state.isActive),[]),l=(0,o().K8)((()=>!!i().default.state.isActive&&i().default.state.moved?"default":s.isDragging?"-webkit-grabbing":"text"),[s.isDragging]),d=(0,r.useMemo)((()=>{let e="notion-cursor-listener";return"-webkit-grabbing"===l&&(e+=" notion-disable-local-cursor"),e}),[l]);return(0,r.useEffect)((()=>{t.isIOS&&("touch"===s.initiator||s.isDragging||c?document.body.classList.add("notion-disable-webkit-user-select"):document.body.classList.remove("notion-disable-webkit-user-select"))}),[t.isIOS,s.initiator,s.isDragging,c]),(0,a.jsx)("div",{style:{...e.style,cursor:l},className:d,children:e.children})}},428614:(e,t,n)=>{n.d(t,{A:()=>I});n(581454);var r=n(296540),o=()=>n(484714),i=()=>n(590526),a=()=>n(882722),s=()=>n(250910),c=()=>n(546926),l=()=>n(631524),d=()=>n(287188),u=()=>n(302501),p=()=>n(890492),m=()=>n(81068),f=()=>n(663639),v=()=>n(736847),g=()=>n(75756),h=()=>n(839816),b=()=>n(69708),S=()=>n(100622),y=()=>n(363496),w=()=>n(512793),_=n(474848);function k({hasDismissButton:e,onDismiss:t}){const n=(0,o().v3)(),i=(0,b().tz)(),[s,d]=(0,r.useState)(!1);(0,r.useEffect)((()=>()=>{e||s&&y().wB()}),[i,s,e]);const m=[{key:"trackingTypes",render:e=>(0,_.jsx)(v().A,{...e,topBorder:0!==e.index}),items:h().dc.map((e=>({key:e,render:t=>(0,_.jsx)(A,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:d,isNativeiOSApp:n.device.isMobileNative&&n.device.isIOS}),action:()=>y().Ef(n,e)})))}];return(0,_.jsxs)(p().A,{className:a().Qm5,menuType:c().gu.Popup,width:260,children:[(0,_.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:e?4:0},children:e?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(u().A,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingInlineStart:14},children:(0,_.jsx)("b",{children:(0,_.jsx)(b().sA,{...g().LS.customizeCookiesHeader})})}),(0,_.jsx)(l().p,{style:{float:"inline-end",marginInlineStart:-8,paddingInlineStart:8,paddingInlineEnd:8,color:S().Tj.blue.text.accentPrimary},onClick:()=>{y().gz(n,w().A.getPermission()),t&&t()},children:(0,_.jsx)(b().sA,{...g().LS.cookieDismissButtonLabel})})]}):void 0}),(0,_.jsx)(f().A,{type:f().O.Vertical,initialFocus:void 0,sections:m})]})}function A(e){const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:r,isNativeiOSApp:a}=e,{title:s,caption:c,subtitle:l}=(0,g().ID)(n,a),[{permission:u}]=(0,i().$y)(w().A),p=(0,o().v3)();return(0,_.jsx)(m().A,{...t,title:(0,_.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,_.jsx)("div",{style:{marginInlineEnd:0},children:(0,_.jsx)(b().sA,{...s})})}),caption:(0,_.jsxs)("div",{children:[l?(0,_.jsx)("div",{children:(0,_.jsx)("span",{style:{color:S().Tj.red.text.accentPrimary},children:(0,_.jsx)(b().sA,{...l})})}):void 0,(0,_.jsx)("div",{children:(0,_.jsx)("span",{style:{color:S().Tj.text.secondary},children:(0,_.jsx)(b().sA,{...c})})})]}),shouldWrapCaption:!0,right:(0,_.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,_.jsx)(d().A,{on:u[n],disabled:"necessary"===n,onClick:()=>{r(!0),y().Ef(p,n)}})})})}const I=function({renderOrigin:e,hasDismissButton:t,onDismiss:n}){return(0,_.jsx)(s().A,{popupType:s().z.Popup,placementToOrigin:"bottom",alignmentToOrigin:"start",renderOrigin:e,render:()=>(0,_.jsx)(k,{hasDismissButton:t,onDismiss:n})})}},449789:(e,t,n)=>{function r(e){const{store:t,toggleSource:n}=e;t.update((e=>{const t=!e.isKeyboardShortcutsOpen;return{...e,isKeyboardShortcutsOpen:t,toggleSource:t?n:e.toggleSource,openCount:t?e.openCount+1:e.openCount}}))}function o(e){const{store:t}=e;return t.state.isKeyboardShortcutsOpen}n.d(t,{W:()=>o,j:()=>r})},467135:(e,t,n)=>{n.r(t),n.d(t,{BroadcastChannel:()=>O,OPEN_BROADCAST_CHANNELS:()=>M,beLeader:()=>Z,clearNodeFolder:()=>j,createLeaderElection:()=>Y,enforceOptions:()=>B});var r=Promise.resolve(!1),o=Promise.resolve(!0),i=Promise.resolve();function a(e,t){return e||(e=0),new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))}function s(){return Math.random().toString(36).substring(2)}var c=0;function l(){var e=1e3*Date.now();return e<=c&&(e=c+1),c=e,e}var d={create:function(e){var t={time:l(),messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),i}catch(n){return Promise.reject(n)}},canBeUsed:function(){if("undefined"!=typeof globalThis&&globalThis.Deno&&globalThis.Deno.args)return!0;if("undefined"==typeof window&&"undefined"==typeof self||"function"!=typeof BroadcastChannel)return!1;if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0},type:"native",averageResponseTime:function(){return 150},microSeconds:l};class u{ttl;map=new Map;_to=!1;constructor(e){this.ttl=e}has(e){return this.map.has(e)}add(e){this.map.set(e,p()),this._to||(this._to=!0,setTimeout((()=>{this._to=!1,function(e){const t=p()-e.ttl,n=e.map[Symbol.iterator]();for(;;){const r=n.next().value;if(!r)return;const o=r[0];if(!(r[1]<t))return;e.map.delete(o)}}(this)}),0))}clear(){this.map.clear()}}function p(){return Date.now()}function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var f="pubkey.broadcast-channel-0-",v="messages",g={durability:"relaxed"};function h(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function b(e){e.commit&&e.commit()}function S(e,t){var n=e.transaction(v,"readonly",g),r=n.objectStore(v),o=[],i=IDBKeyRange.bound(t+1,1/0);if(r.getAll){var a=r.getAll(i);return new Promise((function(e,t){a.onerror=function(e){return t(e)},a.onsuccess=function(t){e(t.target.result)}}))}return new Promise((function(e,a){var s=function(){try{return i=IDBKeyRange.bound(t+1,1/0),r.openCursor(i)}catch(e){return r.openCursor()}}();s.onerror=function(e){return a(e)},s.onsuccess=function(r){var i=r.target.result;i?i.value.id<t+1?i.continue(t+1):(o.push(i.value),i.continue()):(b(n),e(o))}}))}function y(e){return(t=e.db,n=e.options.idb.ttl,r=Date.now()-n,o=t.transaction(v,"readonly",g),i=o.objectStore(v),a=[],new Promise((function(e){i.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var i=n.value;i.time<r?(a.push(i),n.continue()):(b(o),e(a))}else e(a)}}))).then((function(t){return function(e,t){if(e.closed)return Promise.resolve([]);var n=e.db.transaction(v,"readwrite",g).objectStore(v);return Promise.all(t.map((function(e){var t=n.delete(e);return new Promise((function(e){t.onsuccess=function(){return e()}}))})))}(e,t.map((function(e){return e.id})))}));var t,n,r,o,i,a}function w(e){e.closed||_(e).then((function(){return a(e.options.idb.fallbackInterval)})).then((function(){return w(e)}))}function _(e){return e.closed?i:e.messagesCallback?S(e.db,e.lastCursorId).then((function(t){var n=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return n.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),i})):i}var k={create:function(e,t){return t=m(t),function(e){var t=h(),n=f+e,r=t.open(n);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(v,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}(e).then((function(n){var r={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:s(),eMIs:new u(2*t.idb.ttl),writeBlockPromise:i,messagesCallback:null,readQueuePromises:[],db:n};return n.onclose=function(){r.closed=!0,t.idb.onclose&&t.idb.onclose()},w(r),r}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t,_(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,n){var r={uuid:t,time:Date.now(),data:n},o=e.transaction([v],"readwrite",g);return new Promise((function(e,t){o.oncomplete=function(){return e()},o.onerror=function(e){return t(e)},o.objectStore(v).add(r),b(o)}))}(e.db,e.uuid,t)})).then((function(){var t,n;0===(t=0,n=10,Math.floor(Math.random()*(n-t+1)+t))&&y(e)})),e.writeBlockPromise},canBeUsed:function(){return!!h()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:l},A="pubkey.broadcastChannel-";function I(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(t){}return e}function E(e){return A+e}function C(){var e=I();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(n){return!1}return!0}var T={create:function(e,t){if(t=m(t),!C())throw new Error("BroadcastChannel: localstorage cannot be used");var n=s(),r=new u(t.localstorage.removeTimeout),o={channelName:e,uuid:n,eMIs:r};return o.listener=function(e,t){var n=E(e),r=function(e){e.key===n&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",r),r}(e,(function(e){o.messagesCallback&&e.uuid!==n&&e.token&&!r.has(e.token)&&(e.data.time&&e.data.time<o.messagesCallbackTime||(r.add(e.token),o.messagesCallback(e.data)))})),o},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,n){e.messagesCallbackTime=n,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){a().then((function(){var r=E(e.channelName),o={token:s(),time:Date.now(),data:t,uuid:e.uuid},i=JSON.stringify(o);I().setItem(r,i);var a=document.createEvent("Event");a.initEvent("storage",!0,!0),a.key=r,a.newValue=i,window.dispatchEvent(a),n()}))}))},canBeUsed:C,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:l},P=l,x=new Set;var L={create:function(e){var t={time:P(),name:e,messagesCallback:null};return x.add(t),t},close:function(e){x.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(n){return setTimeout((function(){Array.from(x).forEach((function(n){n.name===e.name&&n!==e&&n.messagesCallback&&n.time<t.time&&n.messagesCallback(t)})),n()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:P},R=[d,k,T];function U(e){var t=[].concat(e.methods,R).filter(Boolean);if(e.type){if("simulate"===e.type)return L;var n=t.find((function(t){return t.type===e.type}));if(n)return n;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||(t=t.filter((function(e){return"idb"!==e.type})));var r=t.find((function(e){return e.canBeUsed()}));if(r)return r;throw new Error("No usable method found in "+JSON.stringify(R.map((function(e){return e.type}))))}var D,M=new Set,N=0,O=function(e,t){var n,r,o;this.id=N++,M.add(this),this.name=e,D&&(t=D),this.options=m(t),this.method=U(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,r=(n=this).method.create(n.name,n.options),(o=r)&&"function"==typeof o.then?(n._prepP=r,r.then((function(e){n._state=e}))):n._state=r};function j(e){var t=U(e=m(e));return"node"===t.type?t.clearNodeFolder().then((function(){return!0})):r}function B(e){D=e}function q(e,t,n){var r={time:e.method.microSeconds(),type:t,data:n};return(e._prepP?e._prepP:i).then((function(){var t=e.method.postMessage(e._state,r);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function W(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function z(e,t,n){e._addEL[t].push(n),function(e){if(!e._iL&&W(e)){var t=function(t){e._addEL[t.type].forEach((function(e){t.time>=e.time&&e.fn(t.data)}))},n=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,n)})):(e._iL=!0,e.method.onMessage(e._state,t,n))}}(e)}function F(e,t,n){e._addEL[t]=e._addEL[t].filter((function(e){return e!==n})),function(e){if(e._iL&&!W(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}O._pubkey=!0,O.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed "+JSON.stringify(e));return q(this,"message",e)},postInternal:function(e){return q(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};F(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,z(this,"message",t)):this._onML=null},addEventListener:function(e,t){z(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){F(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){M.delete(this),this.closed=!0;var t=this._prepP?this._prepP:i;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var $="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?function(e){process.on("exit",(function(){return e()})),process.on("beforeExit",(function(){return e().then((function(){return process.exit()}))})),process.on("SIGINT",(function(){return e().then((function(){return process.exit()}))})),process.on("uncaughtException",(function(t){return e().then((function(){console.trace(t),process.exit(101)}))}))}:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){var t=self.close.bind(self);self.close=function(){return e(),t()}}else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}},K=new Set,V=!1;function H(e){if(V||(V=!0,$(G)),"function"!=typeof e)throw new Error("Listener is no function");return K.add(e),{remove:function(){return K.delete(e)},run:function(){return K.delete(e),e()}}}function G(){var e=[];return K.forEach((function(t){e.push(t()),K.delete(t)})),Promise.all(e)}function J(e,t){var n={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(n)}function Z(e){e.isLeader=!0,e._hasLeader=!0;var t=H((function(){return e.die()}));e._unl.push(t);var n=function(t){"leader"===t.context&&"apply"===t.action&&J(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),J(e,"tell"))};return e.broadcastChannel.addEventListener("internal",n),e._lstns.push(n),J(e,"tell")}var Q=function(e,t){var n=this;this.broadcastChannel=e,e._befC.push((function(){return n.die()})),this._options=t,this.isLeader=!1,this.isDead=!1,this.token=s(),this._lstns=[],this._unl=[],this._dpL=function(){},this._dpLC=!1,this._wKMC={},this.lN="pubkey-bc||"+e.method.type+"||"+e.name};Q.prototype={hasLeader:function(){var e=this;return navigator.locks.query().then((function(t){var n=t.held?t.held.filter((function(t){return t.name===e.lN})):[];return!!(n&&n.length>0)}))},awaitLeadership:function(){var e=this;if(!this._wLMP){this._wKMC.c=new AbortController;var t=new Promise((function(t,n){e._wKMC.res=t,e._wKMC.rej=n}));this._wLMP=new Promise((function(n){navigator.locks.request(e.lN,{signal:e._wKMC.c.signal},(function(){return e._wKMC.c=void 0,Z(e),n(),t})).catch((function(){}))}))}return this._wLMP},set onduplicate(e){},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.isLeader=!1),this.isDead=!0,this._wKMC.res&&this._wKMC.res(),this._wKMC.c&&this._wKMC.c.abort("LeaderElectionWebLock.die() called"),J(this,"death")}};var X=function(e,t){var n=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this._hasLeader=!1,this.isDead=!1,this.token=s(),this._aplQ=i,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var r=function(e){"leader"===e.context&&("death"===e.action&&(n._hasLeader=!1),"tell"===e.action&&(n._hasLeader=!0))};this.broadcastChannel.addEventListener("internal",r),this._lstns.push(r)};function Y(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var n="undefined"!=typeof navigator&&void 0!==navigator.locks&&"function"==typeof navigator.locks.request?new Q(e,t):new X(e,t);return e._befC.push((function(){return n.die()})),e._leaderElector=n,n}X.prototype={hasLeader:function(){return Promise.resolve(this._hasLeader)},applyOnce:function(e){var t=this;if(this.isLeader)return a(0,!0);if(this.isDead)return a(0,!1);if(this._aplQC>1)return this._aplQ;return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return function(){if(t.isLeader)return o;var n,r=!1,i=new Promise((function(e){n=function(){r=!0,e()}})),s=function(e){"leader"===e.context&&e.token!=t.token&&("apply"===e.action&&e.token>t.token&&n(),"tell"===e.action&&(n(),t._hasLeader=!0))};t.broadcastChannel.addEventListener("internal",s);var c=e?4*t._options.responseTime:t._options.responseTime;return J(t,"apply").then((function(){return Promise.race([a(c),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return J(t,"apply")})).then((function(){return Promise.race([a(c),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",s),!r&&Z(t).then((function(){return!0}))}))}()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return i;return new Promise((function(t){var n=!1;function r(){n||(n=!0,e.broadcastChannel.removeEventListener("internal",o),t(!0))}e.applyOnce().then((function(){e.isLeader&&r()})),function t(){return a(e._options.fallbackInterval).then((function(){if(!e.isDead&&!n)return e.isLeader?void r():e.applyOnce(!0).then((function(){e.isLeader?r():t()}))}))}();var o=function(t){"leader"===t.context&&"death"===t.action&&(e._hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&r()})))};e.broadcastChannel.addEventListener("internal",o),e._lstns.push(o)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this._hasLeader=!1,this.isLeader=!1),this.isDead=!0,J(this,"death")}}},472150:(e,t,n)=>{n.d(t,{l:()=>s});n(898992),n(354520),n(672577),n(737550);var r=()=>n(907258),o=()=>n(391400),i=()=>n(763824);class a extends(()=>n(769985))().u{constructor(){super({getInitialState:()=>({hasWebLock:!1}),effect:()=>(r().AppStoreSidebarSpaceIdStore.addListener(e),e(),()=>{r().AppStoreSidebarSpaceIdStore.removeListener(e),this.cleanupLastLock()})}),this.abortController=void 0,this.isAcquiringWebLock=!1,this.isAcquiringVisibleTabLock=!1,this.hasVisibleTabLock=!1,this.lockRequestId=0,this.visibilityChangeHandler=void 0;const e=this.setupCalendarBrowserSubscriptionLock.bind(this);this.visibilityChangeHandler=async()=>{document.hasFocus()&&await(0,i().wR)(100),"visible"===document.visibilityState&&(this.requestWebLock({steal:document.hasFocus()}),this.maybeRequestSecondaryVisibleTabLock()),"hidden"===document.visibilityState&&this.maybeRelinquishLock()}}cleanupLastLock(){var e;null===(e=this.abortController)||void 0===e||e.abort("cleanup_last_lock"),document.removeEventListener("visibilitychange",this.visibilityChangeHandler),window.removeEventListener("focus",this.visibilityChangeHandler)}async maybeRelinquishLock(){await(0,i().wR)(100),"visible"===document.visibilityState||document.hasFocus()||this.state.hasWebLock&&this.getSecondaryVisibleTabShouldStealChannel().postMessage("relinquish")}async setupCalendarBrowserSubscriptionLock(){this.cleanupLastLock(),this.requestWebLock({steal:!1}),this.maybeRequestSecondaryVisibleTabLock(),await(0,i().lG)([this.waitUntil((()=>this.state.hasWebLock)),o().A.waitUntil((()=>o().A.state.initialRenderCompleted))]),this.requestWebLock({steal:"visible"===document.visibilityState&&document.hasFocus()}),document.addEventListener("visibilitychange",this.visibilityChangeHandler),window.addEventListener("focus",this.visibilityChangeHandler)}getLockName(){const e=r().AppStoreSidebarSpaceIdStore.getState();return e?`app_level_calendar_event_subscription_leader-${e}`:"app_level_calendar_event_subscription_leader"}getSecondaryVisibleTabLockName(){return`${this.getLockName()}-secondary_visible_tab`}getSecondaryVisibleTabShouldStealChannel(){return new BroadcastChannel(`${this.getSecondaryVisibleTabLockName()}-should_steal`)}async maybeRequestSecondaryVisibleTabLock(){if("visible"!==document.visibilityState)return;if(this.state.hasWebLock)return;if(this.isAcquiringVisibleTabLock||this.hasVisibleTabLock)return;this.isAcquiringVisibleTabLock=!0;const e=new AbortController;document.addEventListener("visibilitychange",(()=>e.abort("became_hidden")),{once:!0,signal:e.signal}),this.waitUntil((()=>this.state.hasWebLock),{signal:e.signal}).then((()=>e.abort("became_leader"))).catch((()=>{}));try{await navigator.locks.request(this.getSecondaryVisibleTabLockName(),{mode:"exclusive",signal:e.signal},(async()=>{this.isAcquiringVisibleTabLock=!1,this.hasVisibleTabLock=!0,e.signal.aborted||await new Promise((t=>{this.getSecondaryVisibleTabShouldStealChannel().addEventListener("message",(()=>{this.requestWebLock({steal:!0}),t()}),{once:!0,signal:e.signal}),e.signal.addEventListener("abort",t,{once:!0})}))}))}catch{}this.isAcquiringVisibleTabLock=!1,this.hasVisibleTabLock=!1,e.signal.aborted||e.abort("cleanup")}async visibleTabAwaitingLockExists(){var e,t;const n=await navigator.locks.query(),r=null===(e=n.held)||void 0===e||null===(e=e.find((e=>e.name===this.getSecondaryVisibleTabLockName())))||void 0===e?void 0:e.clientId,o=null===(t=n.pending)||void 0===t?void 0:t.filter((e=>e.name===this.getLockName()));return r&&(null==o?void 0:o.some((e=>e.clientId===r)))}async requestWebLock(e){var t;const{steal:n}=e;if(!r().AppStoreSidebarSpaceIdStore.getState())return;if(this.state.hasWebLock)return;if(this.isAcquiringWebLock&&!n)return;const o=++this.lockRequestId;this.isAcquiringWebLock=!0,null===(t=this.abortController)||void 0===t||t.abort("new_request");const a=new AbortController;this.abortController=a;try{await navigator.locks.request(this.getLockName(),{mode:"exclusive",steal:n,signal:n?void 0:a.signal},(async()=>{this.isAcquiringWebLock=!1,"visible"!==document.visibilityState&&await this.visibleTabAwaitingLockExists()&&(await(0,i().wR)(100),this.getSecondaryVisibleTabShouldStealChannel().postMessage("should_steal")),a.signal.aborted||(this.setState({hasWebLock:!0}),await new Promise((e=>{a.signal.addEventListener("abort",(()=>e()),{once:!0})})))}))}catch{}o===this.lockRequestId&&(this.setState({hasWebLock:!1}),this.isAcquiringWebLock=!1,a.signal.aborted||this.requestWebLock({steal:!1})),a.signal.aborted||a.abort("cleanup"),this.maybeRequestSecondaryVisibleTabLock()}}const s=new a;(0,n(852832).exposeDebugGetter)("InAppActivitySubscriptionLeaderStore",(()=>s.state))},529649:(e,t,n)=>{n.d(t,{A:()=>r});const r=new(n(118307).A)},532688:(e,t,n)=>{n.d(t,{RK:()=>i,uC:()=>a});var r=()=>n(79926);const o={Toaster:new(r().O2)("Toaster",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(71562),n.e(96346),n.e(44711),n.e(53321),n.e(51220),n.e(16471),n.e(37353),n.e(37571),n.e(29151),n.e(40118),n.e(50397),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(47668),n.e(94522),n.e(24587),n.e(44584),n.e(67494),n.e(10522),n.e(38293),n.e(40992),n.e(88455),n.e(63515),n.e(33893),n.e(55162),n.e(91793),n.e(71003),n.e(32370),n.e(26264),n.e(97989),n.e(36437),n.e(93963),n.e(44590),n.e(7914),n.e(55113),n.e(85071),n.e(25588),n.e(6769),n.e(23640),n.e(72252),n.e(93134),n.e(12452),n.e(18825),n.e(52871),n.e(29351),n.e(22370),n.e(93049),n.e(22582),n.e(18636),n.e(87289),n.e(16060),n.e(16529),n.e(34281),n.e(35279),n.e(77754),n.e(47381)]).then(n.bind(n,968228)))),PerfmarkTrialIneligibleToast:new(r().O2)("PerfmarkTrialIneligibleToast",(()=>Promise.all([n.e(75134),n.e(58790)]).then(n.bind(n,585731))))},i=(0,r()._h)(o.Toaster,(e=>e.Toaster)),a=(0,r()._h)(o.PerfmarkTrialIneligibleToast,(e=>e.PerfmarkTrialIneligibleToast))},534606:(e,t,n)=>{n.d(t,{a:()=>o});var r=()=>n(44551);async function o(){return r().electronApi&&r().electronApi.isMainTab?r().electronApi.isMainTab():!r().electronApi||!r().electronApi.isMainWindow||r().electronApi.isMainWindow()}},577701:(e,t,n)=>{n.d(t,{A:()=>p});n(581454),n(296540);var r=()=>n(484714),o=()=>n(590526),i=()=>n(401497),a=()=>n(75435),s=()=>n(874832),c=()=>n(353195),l=()=>n(100622),d=()=>n(749687),u=n(474848);function p({skipFadeinDelay:e}){const{isElectronMac:t,isTablet:n,isAndroid:p}=(0,r().Y0)(),f=(0,r().v3)(),v=(0,o().O$)(a().b),g=t&&!v,h=(0,o().O$)(d().sidebarExpandedStore),{paddingTop:b,paddingLeft:S}=(0,o().K8)((()=>{const{WindowSizeStore:e}=f;return{paddingTop:e.getSafePaddingTopPx(0),paddingLeft:e.getSafePaddingLeftPx(0)}}),[f]),y=(0,o().K8)((()=>h?d().sidebarWidthStore.state:0),[h]),w=(0,i().IS)((()=>{const e={width:20,height:20,borderRadius:4},t={height:10,minHeight:10,borderRadius:10};return{sidebar:{backgroundColor:l().Tj.background.secondary,boxShadow:l().Tj.sidebarBoxShadow,display:h?"flex":"none",minWidth:y,flexDirection:"column",padding:"12px 14px",paddingInlineStart:Math.max(S,14),...n&&p?{paddingTop:b+10}:{},overflow:"hidden"},heroSection:{paddingTop:g?36:0,marginBottom:22,display:"flex",alignItems:"center"},heroSectionIcon:{padding:"1px",...e,width:22,height:22},heroSectionTitle:{width:177,marginInlineStart:8,...t},toplevelMenu:{marginBottom:20,width:78,...t},toplevelMenuLast:{marginBottom:36,width:135,...t},sectionHeader:{marginBottom:14,width:56,...t},pageRow:{display:"flex",alignItems:"center",marginBottom:11},pageIcon:{...e},pageTitle:{marginInlineStart:8,...t}}}),[h,y,g,b,S,n,p]),_=(0,u.jsxs)("div",{style:w.heroSection,children:[(0,u.jsx)(s().P,{style:w.heroSectionIcon,emphasized:!0}),(0,u.jsx)(s().P,{style:w.heroSectionTitle,emphasized:!0})]}),k=(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s().P,{style:w.toplevelMenu,emphasized:!0}),(0,u.jsx)(s().P,{style:w.toplevelMenu,emphasized:!0}),(0,u.jsx)(s().P,{style:w.toplevelMenu,emphasized:!0}),(0,u.jsx)(s().P,{style:w.toplevelMenuLast,emphasized:!0})]}),A=(0,u.jsx)(s().P,{style:w.sectionHeader,emphasized:!0}),I=c().J.map(((t,n)=>t.map(((t,r)=>(0,u.jsxs)("div",{style:{...!e&&m(n),...w.pageRow},children:[(0,u.jsx)(s().P,{style:w.pageIcon,emphasized:!0}),(0,u.jsx)(s().P,{style:{...w.pageTitle,width:80+20*t},emphasized:!0})]},`${n}-${r}`)))));return(0,u.jsxs)("div",{style:w.sidebar,children:[_,k,A,I]})}function m(e){return 0===e?{}:{animation:`1s ease-in ${e}s 1 normal both running fadein`}}},584440:(e,t,n)=>{n.r(t),n.d(t,{getMobileNativeSessionInfo:()=>o,mobileNativeSessionInfoKey:()=>r});const r="__mobileNativeSessionInfo";function o(){return window[r]??{}}},626819:(e,t,n)=>{n.r(t),n.d(t,{initializeDefaultEventPropertiesFetcher:()=>B});n(944114),n(898992),n(354520),n(672577),n(581454),n(737550);var r=()=>n(528981),o=()=>n(625750),i=()=>n(907258),a=()=>n(755531),s=()=>n(242422),c=()=>n(647987),l=()=>n(295633),d=()=>n(371722),u=()=>n(74351),p=()=>n(267956),m=()=>n(983610),f=()=>n(885443),v=()=>n(945610),g=()=>n(68263),h=()=>n(802149),b=()=>n(496603),S=()=>n(498212),y=()=>n(534177),w=()=>n(329418),_=()=>n(924608),k=()=>n(637440),A=()=>n(449918),I=()=>n(42772),E=()=>n(599824),C=()=>n(576727),T=()=>n(196286),P=()=>n(463832),x=()=>n(22102),L=()=>n(486674),R=()=>n(747100),U=()=>n(651113),D=()=>n(268716),M=()=>n(584440),N=()=>n(761309),O=()=>n(237321),j=()=>n(712505);function B(){r().h.setDefaultEventPropertiesFetcher(q)}async function q(e,t,n){const r=await(0,_().w)(e),{preboot:s,dontWait:u}=n||{},h="currentUser"in e;u||s||!h||await async function(e){e.currentUser.isLoggedIn()&&i().default.state.mainEditorCurrentBlockStore&&(0,a().S)()&&await m().subscriptionDataStoreInstance.waitUntilLoaded();C().default.shouldRefresh(e.currentUser.id)&&await(0,E().E)(e)}(e);const w=!u&&h?await(0,U().F)(e):void 0,T=(0,A().e)(),{currentUserStore:O,sidebarSpaceStore:B}=i().default.state,q=(0,D().getMobileNativeDeviceInfo)(),K=(0,M().getMobileNativeSessionInfo)(),Z=await(0,c().getDesktopDeviceInfo)(),Q=await async function(e,t){const n=await(0,P().hasPermissionForThirdPartyService)("amplitude",e),r=(0,f().B6)(t);return{is_user_consent_to_track:n,tid:r}}(e,t),X=await async function(){const e=j().default.state,t=R().m3(),n=(0,L().a)();if(n){const r=N().i0(n).map((({permissionItem:e})=>e)),o=r.find((e=>"public_permission"===e.type)),a=r.find((e=>"space_permission"===e.type)),s=r.filter((e=>J(e)&&(0,g().h9)(e.role))),c=r.filter((e=>J(e)&&(0,g().p2)(e.role))),u=await async function(e){const t=await x().k.load(),n=(0,d().f)(e,{includeTeamHomeFeed:!1,includeDataSources:!1}),r=[],o=b().Bq(n.map((e=>{if(!(e instanceof l().B))return;const n=e.getCopiedFromPointer();return n&&t.isTemplate(n)&&r.push(n.id),r})).filter(y().O9));return o}(n),m=Boolean(u)&&u.length>0,f=e.open?void 0:i().default.state.currentCollectionViewStore,{publicPageData:h}=p().A.state,w=await x().k.load(),_=n.getCopiedFromPointer();let k;return k=r.some(g().Ny)?"deleted_from_trash":n.pathIsDead()?"in_trash":"live",{page_id:n.id,page_public_role:o?o.role:v().v,page_space_role:a?a.role:v().v,page_all_collaborator_count:c.length+s.length,page_editor_collaborator_count:c.length,page_read_only_collaborator_count:s.length,page_content_count:n.getContentLength(),page_current_user_role:n.getRole(),page_is_peek:t,page_copied_from:_?(0,S().ot)(_.id):void 0,page_is_notion_template:!!_&&w.isTemplate(_),page_is_public_share_link:o?o.is_public_share_link:void 0,page_is_site:o?o.is_site:void 0,page_is_template:n.isTemplate(),page_is_prepopulated:m,page_prepopulated_template_ids:u,page_is_database:n.isCollectionView(),page_view_type:f?f.getType():void 0,page_user_has_explicit_access:h?h.userHasExplicitAccess:v().v,page_deletion_status:k}}}(),Y=await async function(e){const t=await(0,P().getExperimentDeviceId)(e),n=await(0,P().getCookie)(e,"notion_experiment_device_id");return{experiment_device:{id:t,cookie_value:n}}}(e),ee=(null==w?void 0:w.space_id)||void 0;return{data:{...F(),...r,...w,...X,...(0,k().U)(),...$(),...z(),client_initialization_id:o().d,...W({userId:null==O?void 0:O.id,spaceId:null==B?void 0:B.id}),...Z,...q,...K,...T,...Q,...H(),...(te={spaceId:ee,userId:(0,I().m)(),deviceId:r.device_id,eventName:t},{unique_event_marker:V(te)}),...G(),hardware_concurrency:navigator.hardwareConcurrency,hardware_memory:navigator.deviceMemory,...Y,default_event_properties_initialized:!0},spaceId:null==w?void 0:w.space_id};var te}function W(e){const{userId:t,spaceId:n}=e;if(!t||!n)return;const r=(0,w().g)({userId:t,spaceId:n});return r?{notion_session_id:r.id,notion_session_start_ts:r.sessionStartTime,tab_id:(0,h().x0)(),tab_count:(0,T().D)()}:void 0}function z(){const e=O().A.state;if(e)return{queryId:e.queryId}}function F(){const{sidebarSpaceViewStore:e}=i().default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}}function $(){const{mainEditorCurrentBlockStore:e}=i().default.state;if(e){const t=(0,u().U)(e);if(t)return{team_id:(0,S().Xw)(t.id)}}return{}}const K={};function V(e){const{spaceId:t,userId:n,deviceId:r,eventName:o}=e,i=(0,S().gB)(`${t}:${n}:${r}:${o}`),a=K[i],s=Date.now();if(!a)return K[i]=s,!0;const c=new Date(a),l=new Date(s);return c.getUTCDate()!==l.getUTCDate()?(K[i]=s,!0):void 0}function H(){let e;return s().default.state.isLoaded&&(e=s().default.getStatsigExperimentsMap()),{experiments:e,experimentStoreLoaded:s().default.state.isLoaded}}function G(){if(navigator.connection)return{net_downlink:navigator.connection.downlink,net_effective_type:navigator.connection.effectiveType,net_rtt:navigator.connection.rtt,net_save_data:navigator.connection.saveData}}function J(e){return"user_permission"===e.type}},647181:(e,t,n)=>{n.d(t,{T:()=>fs});var r=n(296540),o=()=>n(907258),i=()=>n(92697),a=()=>n(884780),s=()=>n(59226),c=()=>n(726637),l=()=>n(484714),d=()=>n(956250),u=()=>n(91076),p=()=>n(275144),m=()=>n(852507),f=()=>n(590526),v=()=>n(79926),g=()=>n(609679),h=()=>n(882722),b=()=>n(711339),S=()=>n(846087);var y=()=>n(554279),w=()=>n(885443),_=()=>n(939768),k=()=>n(720665);const A="personalization";let I;function E(e){if(!function(e){return!I&&!!(0,_().qn)(e,A)}(e))return;const t=(0,_().qn)(e,A);if(t){const e=decodeURIComponent(t),n=(0,k().$l)(e);n&&(I=n)}const n=(0,_().qm)(e,A);window.history.replaceState(window.history.state,"",n)}var C=()=>n(402390),T=()=>n(572857),P=()=>n(824772);const x=new(v().O2)("AgentWriterGlobalUndoListener",(async()=>await Promise.all([n.e(35530),n.e(55373),n.e(36192),n.e(27992),n.e(63452),n.e(66249),n.e(87249),n.e(79022),n.e(34877),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(40992),n.e(88455),n.e(34038)]).then(n.bind(n,879253)))),L=(0,v()._h)(x,(e=>e.AgentWriterGlobalUndoListener));var R=()=>n(314529),U=()=>n(755531),D=()=>n(206267),M=()=>n(526905),N=()=>n(329418),O=()=>n(763884);function j(e){O().K.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}const B=6e4;async function q(e){var t,n;void 0!==o().default.state.currentUserStore&&void 0!==(0,U().S)()||await o().default.waitUntil((()=>void 0!==o().default.state.currentUserStore&&void 0!==(0,U().S)()));const r=null===(t=o().default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(n=(0,U().S)())||void 0===n?void 0:n.id;if(!document.hasFocus())return;if(!r||!i)return;const a=(0,N().C)({userId:r,spaceId:i}),s=(0,N().g)({userId:r,spaceId:i,storedSession:a}),c=Date.now();M().xA({environment:e,userId:r,spaceId:i}),j(s?{userId:r,spaceId:i,session:{...s,lastFocusedTime:c}}:{userId:r,spaceId:i,session:{id:D().JW(),sessionStartTime:c,lastFocusedTime:c}})}var W=()=>n(678293),z=()=>n(242422),F=()=>n(187174),$=()=>n(267785),K=()=>n(463832);function V(e,t){const n=(0,l().v3)();(0,F().Yb)((async()=>{if(!(await(0,K().hasPermissionForTrackingType)("performance",n)))return;if(await z().default.waitUntilStatsigReadyAsync(),W().StatsigInitializer.error||!W().StatsigInitializer.isComplete)return;const r=z().default.getEligibleGroup({experimentId:e,defaultGroup:t}),o=`boot:exp:${e}`,i=JSON.stringify(r);try{window.localStorage.setItem(o,i)}catch(a){(0,$().x)(o,i,"PersistStatsigExperiment",a)}}),[e,t,n])}const H=new(v().O2)("thirdPartyScripts",(()=>n.e(1978).then(n.bind(n,63620)))),G=(0,v()._h)(H,(e=>e.InjectThirdPartyScripts));n(410838),n(898992),n(354520),n(581454);var J=()=>n(564884),Z=()=>n(20022),Q=()=>n(165358),X=()=>n(496603),Y=()=>n(229833),ee=()=>n(615234),te=()=>n(534177),ne=()=>n(534606);const re=new(v().O2)("audioProcessDetectionActions",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,299903))));var oe=()=>n(973647),ie=()=>n(204252),ae=()=>n(44551);var se=()=>n(929871);async function ce(e){if(z().default.checkGate({gateName:"meeting_notes_detection_process_result"})){const t=await(0,ie().K)();if(oe().Q.isFail(t))return!0;if(t.value.processes.map(se().v).filter(te().O9).includes(e))return!0;const n=await async function(){if(!ae().electronApi||!ae().electronApi.getProcessesAccessingSpeakersWithResult)return oe().Q.fail({message:"API not available"});try{return await ae().electronApi.getProcessesAccessingSpeakersWithResult()}catch(e){return oe().Q.fail({message:"Failed to get speaker processes",error:e})}}();if(oe().Q.isFail(n)){const e=n.error;return"API not available"!==(null==e?void 0:e.message)}return n.value.processes.map((e=>(0,se().v)(e.processName))).filter(te().O9).includes(e)}{const t=await async function(){if(!ae().electronApi||!ae().electronApi.getRunningInputAudioProcesses)return oe().Q.fail({message:"API not available"});try{return await ae().electronApi.getRunningInputAudioProcesses()}catch(e){return oe().Q.fail({message:"Failed to get audio processes",error:e})}}();if(oe().Q.isFail(t))return!0;return t.value.map(se().v).filter(te().O9).includes(e)}}var le=()=>n(328194);var de=()=>n(192359);function ue(e,t){var n;null===ae().electronApi||void 0===ae().electronApi||null===(n=ae().electronApi.initializeRunningInputAudioProcessDetection)||void 0===n||n.call(ae().electronApi,e,t)}var pe=()=>n(249696);function me(e){const{isElectron:t,isActiveTab:n}=e,i=(0,pe().W)(),a=(0,f().K8)((()=>{const e=o().AppStoreSidebarSpaceViewStore.getState();return(null==e?void 0:e.isAiMeetingNotesAudioProcessDetectionMonitoringEnabled())??!1}),[]),s=t&&i&&a,c=(0,r.useRef)(void 0);(0,r.useEffect)((()=>{let e=!1;return async function(){if(!n)return;const t=await(0,ne().a)();if(!e&&t){if(void 0===c.current)return c.current=s,void(s&&ue(1e3,!1));var r;if(c.current!==s)c.current=s,s?ue(1e3,!1):null===ae().electronApi||void 0===ae().electronApi||null===(r=ae().electronApi.stopRunningInputAudioProcessDetection)||void 0===r||r.call(ae().electronApi)}}(),()=>{e=!0}}),[s,n])}n(944114),n(430670);var fe=()=>n(295633),ve=()=>n(964345);function ge(){const e=(0,f().O$)(o().AppStoreSidebarSpaceStore);return(0,f().K8)((()=>{const t=i().A.state.tabs,n=ve().ei.state,r=[];return null!=n&&n.isTranscriptionBlock()&&r.push(n),r.push(...t.flatMap((e=>e.activeBlocks)).flatMap((t=>{if(!t)return[];if(!e)return[];const n=fe().B.createChildStore(e,t.pointer);return n.isTranscriptionBlock()&&r.push(n),[]}))),X().hS(r,"id")}),[e])}async function he({environment:e,activeTranscriptionBlockStore:t,currentlyRunningAudioProcessNames:n,previouslyDetectedProcessNames:r}){if(void 0!==t){const i=function(e,t){for(const n of t)if(!e.includes(n))return{shouldStop:!0,processName:n};return{shouldStop:!1}}(n,r);if(i.shouldStop&&i.processName)try{if(await ce(i.processName))return void Q().log({level:"info",from:"meetingNotesDetection",type:"process_still_running_after_debounce_check",data:{miscDataToConvertToString:{processName:i.processName,currentlyRunningAudioProcessNames:n,previouslyDetectedProcessNames:r}}});await async function(e){var t;const{environment:n,processName:r,currentlyRunningAudioProcessNames:o,previouslyDetectedProcessNames:i,activeTranscriptionBlockStore:a}=e,s=(0,de().by)(a);if("transcribing"!==s.state)return;const c=null===(t=a.getFormat())||void 0===t||null===(t=t.transcription_state_history)||void 0===t?void 0:t.findLast((e=>"transcribing"===e.state)),l=null!=c&&c.timestamp?Date.now()-c.timestamp:void 0;if(c&&void 0!==l&&l<30*ee().TD)return void Q().log({level:"info",from:"meetingNotesDetection",type:"stop_transcription_too_soon",data:{miscDataToConvertToString:{timeSinceLastStateChange:l}}});(0,J().u)({environment:n,event:{eventName:"system_audio_process_stopped",eventProperties:{process_name:r,currently_running_audio_processes:o,previously_running_audio_processes:i,block_id:a.id}}});const d=await le().w.load();await d.stopTranscription({environment:n,blockStore:a,from:"audio_process_detection"})}({environment:e,processName:i.processName,currentlyRunningAudioProcessNames:n,previouslyDetectedProcessNames:r,activeTranscriptionBlockStore:t})}catch(o){Q().log({level:"error",from:"meetingNotesDetection",type:"error_stopping_transcription_for_audio_process",error:(0,Y().convertErrorToLog)(o),data:{miscDataToConvertToString:{processName:i.processName,currentlyRunningAudioProcessNames:n,previouslyDetectedProcessNames:r,activeTranscriptionBlockId:t.id}}})}}else{const t=function(e,t){for(const n of e)if(!t.includes(n))return{shouldNotify:!0,processName:n};return{shouldNotify:!1}}(n,r);if(t.shouldNotify&&t.processName)try{(await re.load()).sendNotificationForRunningAudioProcess(e,t.processName)}catch(o){Q().log({level:"error",from:"meetingNotesDetection",type:"error_sending_notification_for_audio_process",error:(0,Y().convertErrorToLog)(o),data:{miscDataToConvertToString:{processName:t.processName,currentlyRunningAudioProcessNames:n,previouslyDetectedProcessNames:r}}})}}}function be({isActiveTab:e}){return function(e){const t=(0,l().v3)();me({isElectron:t.device.isElectron,isActiveTab:e});const n=(0,f().K8)((()=>{const e=o().AppStoreSidebarSpaceViewStore.getState();return(null==e?void 0:e.isAiMeetingNotesAudioProcessDetectionMonitoringEnabled())??!1}),[]),i=(0,pe().W)(),a=t.device.isElectron&&e&&i&&n,s=ge(),c=(0,r.useRef)(s);c.current=s;const d=(0,r.useRef)(void 0),u=(0,r.useCallback)((async e=>{const n=d.current??[];d.current=void 0;const r=c.current;await he({environment:t,activeTranscriptionBlockStore:r[0],currentlyRunningAudioProcessNames:e,previouslyDetectedProcessNames:n})}),[t]),p=(0,r.useMemo)((()=>(0,X().sg)(u,4*ee().TD,{trailing:!0})),[u]),m=(0,r.useCallback)((async(e,t,n)=>{if(a)try{if(!(await(0,ne().a)()))return;const e=n.map(se().v).filter(te().O9),r=t.map(se().v).filter(te().O9);if(Q().log({level:"info",from:"meetingNotesDetection",type:"microphone_process_changed_detected",data:{miscDataToConvertToString:{oldProcessCount:r.length,newProcessCount:e.length,oldProcesses:r,newProcesses:e,oldProcessesUnfiltered:t,newProcessesUnfiltered:n}}}),(0,X().n4)(e,r))return;void 0===d.current&&(d.current=r),0===c.current.length?await u(e):await p(e)}catch(r){Q().log({level:"error",from:"meetingNotesDetection",type:"error_in_audio_process_listener",error:(0,Y().convertErrorToLog)(r),data:{miscDataToConvertToString:{oldProcesses:t,newProcesses:n}}})}}),[a,p,u]);(0,r.useEffect)((()=>Z().bH.addListener(m)),[m]),(0,r.useEffect)((()=>()=>{p.cancel(),d.current=void 0}),[p])}(e),null}function Se(e){const{fn:t,processName:n,delayMs:r}=e;setTimeout((async()=>{await ce(n)||t()}),r)}async function ye(e){var t;const{environment:n,processName:r,currentlyRunningAudioProcessNames:o,previouslyDetectedProcessNames:i,activeTranscriptionBlockStore:a}=e;if("transcribing"!==(0,de().by)(a).state)return;const s=null===(t=a.getFormat())||void 0===t||null===(t=t.transcription_state_history)||void 0===t?void 0:t.findLast((e=>"transcribing"===e.state)),c=null!=s&&s.timestamp?Date.now()-s.timestamp:void 0;if(s&&void 0!==c&&c<30*ee().TD)return void Q().log({level:"info",from:"meetingNotesDetection",type:"stop_transcription_too_soon",data:{miscDataToConvertToString:{timeSinceLastStateChange:c}}});(0,J().u)({environment:n,event:{eventName:"system_audio_process_stopped",eventProperties:{process_name:r,currently_running_audio_processes:o,previously_running_audio_processes:i,block_id:a.id}}});(await le().w.load()).stopTranscription({environment:n,blockStore:a,from:"audio_process_detection"})}function we({isActiveTab:e}){return function(e){const t=(0,l().v3)();me({isElectron:t.device.isElectron,isActiveTab:e});const n=(0,f().K8)((()=>{const e=o().AppStoreSidebarSpaceViewStore.getState();return(null==e?void 0:e.isAiMeetingNotesAudioProcessDetectionMonitoringEnabled())??!1}),[]),i=(0,pe().W)(),a=t.device.isElectron&&e&&i&&n,s=ge(),c=(0,r.useCallback)((async(e,n,r)=>{if(!a)return;if(!(await(0,ne().a)()))return;const o=r.map(se().v).filter(te().O9),i=n.map(se().v).filter(te().O9);Q().log({level:"info",from:"meetingNotesDetection",type:"microphone_process_changed_detected",data:{miscDataToConvertToString:{oldProcessCount:i.length,newProcessCount:o.length,oldProcesses:i,newProcesses:o,oldProcessesUnfiltered:n,newProcessesUnfiltered:r}}});for(const a of o){if(s.length>0)break;if(!i.includes(a)){(await re.load()).sendNotificationForRunningAudioProcess(t,a);break}}const c=s[0];for(const a of i)if(!o.includes(a)&&c){Se({fn:()=>ye({environment:t,processName:a,currentlyRunningAudioProcessNames:o,previouslyDetectedProcessNames:i,activeTranscriptionBlockStore:c}),processName:a,delayMs:2*ee().TD});break}}),[t,a,s]);(0,r.useEffect)((()=>Z().bH.addListener(c)),[c])}(e),null}var _e=()=>n(680977),ke=()=>n(244828),Ae=()=>n(914649),Ie=()=>n(370136),Ee=()=>n(172707);var Ce=()=>n(182805),Te=()=>n(477293),Pe=()=>n(877051);const xe={GlobalInAppMessageListener:new(v().O2)("GlobalInAppMessageListener",(()=>n.e(94869).then(n.bind(n,793383))))},Le=(0,v()._h)(xe.GlobalInAppMessageListener,(e=>e.GlobalInAppMessageListener)),Re=new(v().O2)("jamRecordingLinks",(async()=>await n.e(98213).then(n.bind(n,129961))));var Ue=()=>n(187780);var De=()=>n(475553),Me=()=>n(224392),Ne=()=>n(424127),Oe=()=>n(644852),je=()=>n(564321);function Be(){const e=(0,De().K)(),t=function(e){const t=(0,l().v3)(),{spaceId:n,orderBy:r,limit:o}=e??{},i=t.currentUser.id,a=i?(0,je().m)({userId:i,spaceId:n,orderBy:r,limit:o}):void 0,{value:s}=(0,Ne().uW)("useOfflinePages",a,{allowError:!0,rowType:Oe().m});return s}();(0,r.useEffect)((()=>{e&&t&&(0,Me().e)(t)}),[e,t])}n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698);var qe=()=>n(300474),We=()=>n(391400),ze=()=>n(99895),Fe=()=>n(68336);const $e=5*k().Xb;function Ke(){const e=(0,l().v3)(),t=(0,qe().r)(),n=(0,De().y)(),o=(0,f().K8)((()=>We().A.state.initialRenderCompleted),[]),i=function(e){const t=(0,l().v3)().currentUser.id,n=t&&e?Fe().F4`
				SELECT *
				FROM offline_action
				JOIN offline_page ON offline_action.impacted_page_id = offline_page.id
					AND offline_action.meta_user_id = offline_page.meta_user_id
				WHERE offline_action.meta_user_id = ${t}
					AND offline_page.space_id = ${e}
			`:void 0,{value:r}=(0,Ne().uW)("useAllOfflineActionsForSpace",n,{allowError:!0,rowType:Oe().q});return r}(t),a=(0,f().K8)((()=>i?function(e){const t=new(ze().G)((()=>new Set));for(const i of e)t.get(i.impacted_page_id).add(i.autosync_type);let n=0,r=0,o=0;for(const i of t.values())i.has("frecent")?r++:i.has("not_autosynced")?n++:i.has("created_offline")&&o++;return{all_offline_pages:n+r+o,manual_offline_pages:n,autosynced_offline_pages:r,created_offline_offline_pages:o}}(i):void 0),[i],{useDeepEqual:!0}),s=(0,r.useRef)(!1),c=(0,r.useRef)(!0);(0,r.useEffect)((()=>{a&&(c.current=!0)}),[a]),(0,r.useEffect)((()=>{if(!n)return;if(!o)return;if(!a)return;const t=()=>{!function(e){const{environment:t,counts:n}=e;(0,J().u)({environment:t,event:{eventName:"offline_pages_counts",eventProperties:n}})}({environment:e,counts:a}),c.current=!1};s.current||(t(),s.current=!0);const r=setInterval((()=>{c.current&&t()}),$e);return()=>{clearInterval(r)}}),[e,t,n,o,a])}var Ve=()=>n(430476),He=()=>n(25025);function Ge(){const e=(0,l().v3)(),t=(0,qe().r)(),n=(0,De().y)(),i=(0,f().K8)((()=>We().A.state.initialRenderCompleted),[]),a=(0,f().K8)((()=>{var e;return null===(e=o().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.id}),[]);(0,r.useEffect)((()=>{if(!(n&&a&&t&&i))return;const r=e.sqliteConnection;if(!r)return;const o=e.currentUser.id;o&&(async()=>{const n=await async function(e){const{connection:t,userId:n,spaceId:r,pageId:o}=e,i=Fe().F4`
		SELECT DISTINCT offline_action.autosync_type
		FROM offline_action
		JOIN offline_page ON offline_action.impacted_page_id = offline_page.id
			AND offline_action.meta_user_id = offline_page.meta_user_id
		WHERE offline_action.meta_user_id = ${n}
			AND offline_page.space_id = ${r}
			AND offline_action.impacted_page_id = ${o}
	`;return(await(0,Ve().G2)({connection:t,statements:[i.asRead()],queryName:"getPageOfflineAutosyncTypes"}))[0].data.map((e=>e.autosync_type)).filter(He().O8)}({connection:r,userId:o,spaceId:t,pageId:a});!function(e){const{environment:t,status:n}=e;(0,J().u)({environment:t,event:{eventName:"page_offline_status",eventProperties:n}})}({environment:e,status:Je(n)})})()}),[e,n,t,a,i])}function Je(e){return{manual:e.includes("not_autosynced"),autosynced:e.includes("frecent"),created_offline:e.includes("created_offline")}}var Ze=()=>n(12314),Qe=()=>n(99040),Xe=()=>n(929219),Ye=()=>n(128933),et=()=>n(69708),tt=()=>n(100622),nt=()=>n(284371),rt=()=>n(288782),ot=()=>n(968913),it=()=>n(959462),at=n(474848);function st(){const e=(0,et().tz)(),t=!(0,f().O$)(Xe().e),n=(0,f().K8)((()=>(0,rt().s)()),[]),o=(0,r.useRef)(t),i=(0,r.useRef)(n);(0,r.useEffect)((()=>{!t||o.current&&n===i.current||function(e){var t;const{isOffline:n,currentPageId:r,intl:o}=e;if(!(it().A.state.offlinePages&&z().default.checkGate({gateName:"download_for_offline"})&&n&&r&&(0,ot().Bd)(r)))return;const i=null===(t=it().A.state.offlinePages[r])||void 0===t?void 0:t.last_downloaded_at,a=i?o.formatDate(i,{day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):void 0;Ye().D6({label:(0,at.jsxs)("div",{children:[(0,at.jsx)("div",{style:{fontWeight:nt().Wy.medium},children:(0,at.jsx)(et().sA,{defaultMessage:"Working offline",id:"offlinePages.snackbar.title"})}),i?(0,at.jsx)("div",{style:{color:tt().Tj.text.secondary},children:(0,at.jsx)(et().sA,{defaultMessage:"Last sync on {lastDownloadedAtFormatted}.",id:"offlinePages.snackbar.description",values:{lastDownloadedAtFormatted:a}})}):void 0]})})}({isOffline:t,currentPageId:n,intl:e}),o.current=t,i.current=n}),[t,n,e])}var ct=()=>n(664594),lt=()=>n(870991);const dt=5*ee().Xb;var ut=()=>n(865085);function pt(){const e=function(){const[e,t]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{z().default.waitUntilStatsigReadyAsync().then((()=>{t(!0)}))}),[]),e}();(0,r.useEffect)((()=>{if(!e)return;const t="on"===z().default.getEligibleGroup({experimentId:"opfs_page_cache",defaultGroup:"control"}),n=z().default.getConfig({configName:"opfs_recordmap_cache_options"}),r="on"===z().default.getEligibleGroup({experimentId:"opfs_page_cache_pre_process_first_chunk",defaultGroup:"control",enableEventTrailLogging:!0});ut().OPFSBootupRegistry.updateLocalStorageFromStatsig({isEnabled:t,options:n,preProcessFirstChunk:r})}),[e])}var mt=()=>n(346),ft=()=>n(273915);const vt=new(v().O2)("LazyNotionCalendarListener",(()=>Promise.all([n.e(63515),n.e(49021),n.e(51761),n.e(16704)]).then(n.bind(n,4455)))),gt=(0,v()._h)(vt,(e=>e.default));function ht(){return(0,ft().L)()?(0,at.jsx)(gt,{}):null}var bt=()=>n(591779);const St=function(){};var yt=()=>n(250084),wt=()=>n(356853),_t=()=>n(859312);const kt=(0,n(583835).Dv)("extractWebClipperContent");var At=()=>n(578194),It=()=>n(753812),Et=()=>n(539803),Ct=()=>n(357625),Tt=()=>n(805667),Pt=()=>n(569427);const xt=new(n(29923).R)({key:"rateLimitedEvernoteImports",namespace:n(553737).Bq,important:!0,trackingType:"necessary"}),Lt=new(n(752196).A);var Rt=()=>n(721253),Ut=()=>n(595939),Dt=()=>n(20822);var Mt=()=>n(613848),Nt=()=>n(710515),Ot=()=>n(457395),jt=()=>n(636725),Bt=()=>n(381195);function qt(){const e=(0,l().v3)(),t=(0,f().K8)((()=>o().default.state.currentUserRootStore),[]);(0,r.useEffect)((()=>{t&&async function(e,t){await Ot().y();const n=t.getSpaceViewStores();for(const r of n){const t=r.getBookmarkedPageStores();for(const e of t)Wt(e);const n=r.getSharedPages();if(n)for(const e of n)Wt(e);const o=(0,Nt().r)(r);for(const e of o){const t=(0,Bt().O)({teamStore:e});for(const e of t)Wt(e)}const i=r.getSpaceStore();if(i){Mt().A.getData(e,{spaceId:i.id,userId:e.currentUser.id});const t=(0,jt().I)(e,i);for(const e of t)Wt(e)}}}(e,t)}),[t,e])}function Wt(e){e.load();const t=e.getOwnedAndLinkedCollectionStores();for(const n of t)n.load()}var zt=()=>n(751629),Ft=()=>n(755222),$t=()=>n(792057),Kt=()=>n(994310),Vt=()=>n(711059),Ht=()=>n(217811),Gt=()=>n(934839),Jt=()=>n(135552),Zt=()=>n(761309),Qt=()=>n(150193),Xt=(n(413611),()=>n(807054));const Yt="hello";function en(e){const t=e.currentUser.isLoggedIn(),{device:n}=e;return"serviceWorker"in navigator&&t&&n.isBrowser&&!n.isSafari}const tn=6e4,nn=6e5;function rn(){const e=(0,l().v3)(),t=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"checking"}})}(e)),[e]),n=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n;r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"error",error:t}})}(0,n,e)),[e]),o=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;t.setState({appUpdate:t.state.appUpdate,electronUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),i=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n,o=(0,Vt().parseVersion)(t.version),i=(0,zt().getDesktopVersion)(),a=(0,Vt().getUpdateType)({currentVersion:i,nextVersion:o,app:"desktop"});r.setState({appUpdate:r.state.appUpdate,electronUpdate:{state:"downloading",type:a,version:o,timestamp:Date.now(),progress:0}})}(0,n,e)),[e]),a=(0,r.useCallback)(((t,n)=>function(e,t,n){const{AppUpdateStore:r}=n,o=r.state;o.electronUpdate&&"downloading"===o.electronUpdate.state&&r.setState({appUpdate:o.appUpdate,electronUpdate:{...o.electronUpdate,progress:t.transferred/t.total}})}(0,n,e)),[e]),s=(0,r.useCallback)(((t,n)=>function(e,t,n){const{device:r}=n,{AppUpdateStore:o}=n,i=Kt().A.get(Ht().wp),a=t.version;if(i===a){if(r.isMac)return o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:Vt().UpdateType.Major,version:void 0,versionCreatedTime:0}}),void $t().ui({message:(0,at.jsx)(et().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.prompt",defaultMessage:"Please move the Notion app into the Applications folder for the auto-updater to work."}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ht().K0(n),items:[{label:(0,at.jsx)(et().sA,{id:"desktopAppUpdater.moveNotionToApplicationsFolderDialog.dismissButton.label",defaultMessage:"OK"}),onAccept:()=>Ht().K0(n)}]});Q().log({level:"error",from:"AppUpdateListener",type:"electronUpdateFailed",data:{miscDataToConvertToString:{previousUpdateReady:i,nextUpdateReady:a}}})}const s=(0,zt().getDesktopVersion)(),c=(0,Vt().parseVersion)(t.version),l=(0,Vt().getUpdateType)({currentVersion:s,nextVersion:c,app:"desktop"});o.setState({appUpdate:o.state.appUpdate,electronUpdate:{state:"ready",type:l,version:c,versionCreatedTime:0}})}(0,n,e)),[e]),d=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"checking"}})}(e)),[e]),u=(0,r.useCallback)(((t,n)=>sn(n,e)),[e]),p=(0,r.useCallback)((()=>function(e){const{AppUpdateStore:t}=e;if(t.state.appUpdate&&"ready"===t.state.appUpdate.state)return;t.setState({electronUpdate:t.state.electronUpdate,appUpdate:{state:"no-update",timestamp:Date.now()}})}(e)),[e]),m=(0,r.useCallback)(((t,n)=>cn(n,e)),[e]),f=(0,r.useCallback)(((t,n)=>ln(n,e)),[e]),v=(0,r.useCallback)(((t,n)=>dn(n,e)),[e]),g=(0,r.useCallback)((()=>function(e){const t=e.AppUpdateStore;if(Xe().A.getState().online&&t.isSilentUpdate()){const n=t.state.appUpdate;Ht().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}(e)),[e]);(0,r.useEffect)((()=>{const{device:r}=e;if(r.isElectron){const e=Z().Lz.addListener(s),r=Z().Gc.addListener(n),c=Z().WV.addListener(t),l=Z().L9.addListener(i),h=Z().n3.addListener(a),b=Z().Sn.addListener(o),S=Z().m0.addListener(v),y=Z().t0.addListener(u),w=Z().nT.addListener(d),_=Z().AX.addListener(m),k=Z().oF.addListener(g),A=Z().IC.addListener(f),I=Z().b7.addListener(p);return()=>{null==e||e(),null==r||r(),null==c||c(),null==l||l(),null==h||h(),null==b||b(),null==S||S(),null==y||y(),null==w||w(),null==_||_(),null==k||k(),null==A||A(),null==I||I()}}}),[e,d,p,m,u,g,f,v,i,t,n,o,a,s]),(0,r.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(n&&n.updateReceiveApiHandlers({appUpdateReady:t=>dn(t,e),appUpdateError:t=>sn(t,e),appUpdateChecking:d,appUpdateAvailable:t=>cn(t,e),appUpdateProgress:t=>ln(t,e),appUpdateNotAvailable:p}),function(e){const t=Ht().Cv(),n=Ht().B0();if(!(0,Vt().isEqualVersion)(t,n)){0;an((0,Vt().getUpdateType)({currentVersion:t,nextVersion:n,app:"client"}),n,Ht().bg(),!1,e)}}(e),t.isMobileNative&&n&&n.api.openUpdateSettings){const n=t.osVersion,r=t.isAndroid&&(0,Vt().isLessThanVersion)(n,[7,0]),o=t.isIOS&&(0,Vt().isLessThanVersion)(n,[17,0]);(r||o)&&function(e){const{mobileNative:t}=e;if(!t)return;Gt().HQ({bannerStore:Qt().A,id:"PlatformUpdateWarning",contentKey:"mobile_platform_unsupported",styleKey:Jt().q.Red})}(e)}}),[e,d,p]);const h=(0,r.useRef)("");(0,r.useEffect)((()=>{const{device:t,mobileNative:n}=e;if(!n&&!t.isElectron&&!c().A.isAdminMode){async function r(){if(Ft().A.state.isVisible)try{const t=Ht().Cv(),n=await It().callApi({eventName:"getAssetsJsonV2",environment:e,data:{hash:h.current}});if("success"===n.type){const r=n.data;if(r.version){const n=r,o=(0,Vt().parseVersion)(n.version);o&&((0,Vt().isEqualVersion)(o,t)||(dn(n,e),function(e){const t=en(e),n=z().default.checkGate({gateName:"service_worker_in_browser"});t&&n&&navigator.serviceWorker.getRegistration().then((e=>{e&&e.update()}))}(e))),h.current=r.hash}}}catch(t){}}const o=setInterval(r,tn);return()=>clearInterval(o)}}),[e]),(0,r.useEffect)((()=>{const{device:t,mobileNative:n,AppUpdateStore:r}=e;if(!n&&!t.isElectron&&!c().A.isAdminMode){function o(){const e=r.state.appUpdate;"ready"===(null==e?void 0:e.state)&&null!=e&&e.isRollback&&!Ft().A.state.isVisible&&Xe().A.getState().online&&window.location.reload()}const i=setInterval(o,nn);return()=>clearInterval(i)}}),[e])}async function on(e,t){const n=await async function(e){await o().default.waitUntilRendered();const{mainEditorCurrentBlockStore:t,currentUserStore:n}=o().default.state;return!(!n||!t||(0,Zt().qb)(e,t,t.getSpaceStore()))}(e);n&&(Ht().Dv(e,t,"banner"),Gt().HQ({bannerStore:Qt().A,id:"AppUpdate",contentKey:"minor_app_update",styleKey:Jt().q.Blue}))}function an(e,t,n,r,o){e===Vt().UpdateType.Major||e===Vt().UpdateType.Minor||Ht().wT()||r?(t&&Ht().fC(t)&&Ht().qr(t,n),on(o,e)):Ht().KD()?function(e,t){Ht().Dv(e,t,"modal"),$t().ui({message:(0,at.jsx)(et().sA,{defaultMessage:"We just launched new features!",id:"breakingUpdateDialog.title"}),showCancel:!1,keepFocus:!1,handleCancel:()=>Ht().K0(e),items:[{label:(0,at.jsx)(et().sA,{defaultMessage:"Update and see what’s new",id:"breakingUpdateDialog.updateButtonTitle"}),color:"blue",onAccept:()=>Ht().K0(e)}],innerStyle:{width:380}})}(o,e):t&&Ht().fC(t)&&Ht().qr(t,n)}function sn(e,t){const{AppUpdateStore:n}=t;n.state.appUpdate&&"ready"===n.state.appUpdate.state||n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"error",error:e}})}function cn(e,t){const{AppUpdateStore:n}=t;if(n.state.appUpdate&&"ready"===n.state.appUpdate.state)return;const r=(0,Vt().parseVersion)(e.version),o=Ht().Cv(),i=(0,Vt().getUpdateType)({currentVersion:o,nextVersion:r,app:"client"});n.setState({electronUpdate:n.state.electronUpdate,appUpdate:{state:"downloading",type:i,version:r,timestamp:Date.now(),progress:0}})}function ln(e,t){const{AppUpdateStore:n}=t,r=n.state;r.appUpdate&&"downloading"===r.appUpdate.state&&n.setState({electronUpdate:r.electronUpdate,appUpdate:{...r.appUpdate,progress:e.downloaded/e.total}})}function dn(e,t){const{AppUpdateStore:n}=t,r=(0,Vt().parseVersion)(e.version),o=Ht().Cv(),i=(0,Vt().getUpdateType)({currentVersion:o,nextVersion:r,app:"client"}),a=(0,Vt().isLessThanVersion)(r,o),s=e.createdTime;if(!Ht().fC(r)){const e={state:"ready",type:i,version:r,versionCreatedTime:s,isRollback:a};n.setState({electronUpdate:n.state.electronUpdate,appUpdate:e})}an(i,r,s,a,t)}var un=()=>n(383070),pn=()=>n(916275);var mn=()=>n(651784);var fn=()=>n(179034),vn=()=>n(763824),gn=()=>n(666144),hn=()=>n(866654),bn=()=>n(683395),Sn=()=>n(369763),yn=()=>n(851240);var wn=()=>n(14307);async function _n(e){if(e.device.isBrowser&&document.hidden)return;if(e.device.isElectron&&!(await async function(){return ae().electronApi&&ae().electronApi.windowIsVisible?ae().electronApi.windowIsVisible():"visible"===document.visibilityState}()))return;if(e.device.isMobileNative&&"none"===Xe().A.state.mobileConnectivityType)return void kn(!1);if(wn().isConnected())return void kn(!0);if(!1===navigator.onLine)return void kn(!1);"success"===(await It().callApi({eventName:"ping",environment:e,data:{}})).type?kn(!0):kn(!1)}function kn(e){Xe().A.setState({...Xe().A.state,online:e,lastOfflineTimestamp:e?Xe().A.state.lastOfflineTimestamp:Date.now()})}const An=5e3;var In=()=>n(466103);n(672577);var En=()=>n(401497),Cn=()=>n(451306),Tn=()=>n(201980),Pn=()=>n(643707),xn=()=>n(751735),Ln=()=>n(928739),Rn=()=>n(667019),Un=()=>n(737230),Dn=()=>n(372154),Mn=()=>n(94953);function Nn(){var e,t;return null!==(e=Dn().A.state)&&void 0!==e&&e.open?(null===(t=Dn().A.state)||void 0===t?void 0:t.discussionIds)||[]:Un().Ay.state.activeDiscussionStore?[Un().Ay.state.activeDiscussionStore.id]:[]}function On(){var e;return null!==(e=Mn().A.state)&&void 0!==e&&null!==(e=e.discussionIds)&&void 0!==e&&e.length?Mn().A.state.discussionIds:Un().Ay.state.activeDiscussionStore?[Un().Ay.state.activeDiscussionStore.id]:[]}var jn=()=>n(555776),Bn=()=>n(116008),qn=()=>n(807990),Wn=()=>n(141465);function zn(e){const{discussionId:t,level:n}=e;return`\n\t\t.${(0,Cn().EJ)({level:n})}.${(0,Cn().wV)({discussionId:t})}.${Pn().Do} {\n\t\t\tbackground: ${(0,tt().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,tt().JG)(e)} !important;\n\t\t}\n\t`}function Fn(e){const{level:t}=e;return`\n\t\t.${(0,Cn().EJ)({level:t})}.${Pn().uU}.${Pn().Do} {\n\t\t\tbackground: ${(0,tt().aO)(e)} !important;\n\t\t\topacity: unset !important;\n\t\t\tborder-bottom: 2px solid ${(0,tt().JG)(e)} !important;\n\t\t}\n\t`}function $n(e){const t=(0,tt().aO)({level:1,mode:e,hovered:!1,selected:!1}),n=(0,xn().Mj)(t).alpha()/2,r=(0,xn().Mj)(t).alpha(n).toRgbString(),o=(0,tt().JG)({level:1,mode:e,hovered:!1,selected:!1}),i=(0,xn().Mj)(o).alpha()/2,a=(0,xn().Mj)(o).alpha(i).toRgbString();return`\n\t\t.${Pn().K6}.${Pn().Do} {\n\t\t\tbox-shadow: unset !important;\n\t\t\tpadding-bottom: 2px;\n\t\t\tbackground: ${r} !important;\n\t\t\tborder-bottom: 2px solid ${a} !important;\n\t\t\tanimation: commentFadeIn 500ms ease-in;\n\t\t}\n\t`}function Kn(e){const{themeMode:t,selected:n,hovered:r}=e;return`background: ${(0,tt().FK)({annotationType:"update",type:"background",selected:n,hovered:r,overlapping:!1,mode:t})} !important;\n\t\t\tborder-bottom: 2px solid ${(0,tt().FK)({annotationType:"update",type:"underline",selected:!1,hovered:!0,overlapping:!1,mode:t})} !important;`}function Vn(e){const{discussionId:t,themeMode:n,selected:r,hovered:o}=e;return`\n\t\t.${(0,Cn().ED)({type:"update"})}.${(0,Cn().wV)({discussionId:t})}.${Pn().Do} {\n\t\t\t${Kn({themeMode:n,selected:r,hovered:o})}\n\t\t}\n\t\t.${(0,Cn().ED)({type:"remove"})}.${(0,Cn().wV)({discussionId:t})}.${Pn().Do} {\n\t\t\t${function(e){const{themeMode:t,selected:n,hovered:r}=e,o=(0,tt().FK)({annotationType:"remove",type:"background",selected:n,hovered:r,overlapping:!1,mode:t}),i=(0,tt().FK)({annotationType:"remove",type:"underline",selected:n,hovered:r,overlapping:!1,mode:t});return`background: ${o} !important;\n\t\t\tcolor: ${tt().Tj.text.secondary} !important;\n\t\t\ttext-decoration: none !important;\n\t\t\tborder-bottom: 2px solid ${i} !important;`}({themeMode:n,selected:r,hovered:o})}\n\t\t}\n\t`}function Hn(e){const t=On(),n=Nn();return[...t.flatMap((t=>X().Hn(Cn().DS).map((n=>zn({discussionId:t,level:n+1,hovered:!0,selected:!1,mode:e}))))),...n.flatMap((t=>X().Hn(Cn().DS).map((n=>zn({discussionId:t,level:n+1,hovered:!1,selected:!0,mode:e})))))].join("\n")}function Gn(e){const t=On(),n=Nn();return[...t.map((t=>Vn({themeMode:e,discussionId:t,selected:!1,hovered:!0}))),...n.map((t=>Vn({themeMode:e,discussionId:t,selected:!0,hovered:!1})))].join("\n")}function Jn(e){let t="";const n=Ln().A.getHoveredEdit();n&&(t=`\n\t\t\t.${(0,Cn().K3)({type:"insert",editId:n.editId})} {\n\t\t\t\t${Kn({themeMode:e,selected:!1,hovered:!0})}\n\t\t\t}\n\t\t\t.${(0,Cn().K3)({type:"remove",editId:n.editId})} {\n\t\t\t\t${function(e){return`background: ${(0,tt().FK)({annotationType:"remove",type:"background",selected:!1,hovered:!0,overlapping:!1,mode:e})} !important;\n\t\t\tcolor: ${tt().Tj.text.secondary} !important;\n\t\t\ttext-decoration-color: rgba(0, 0, 0, 0) !important;`}(e)}\n\t\t\t}\n\t\t`);return`\n\t\t${t}\n\t\t${`\n\t\t.${h()._Qb} .${(0,Cn().h_)("insert")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${tt().Tj.text.primary} !important;\n\t\t}\n\n\t\t.${h()._Qb} .${(0,Cn().h_)("remove")} {\n\t\t\tbackground: initial !important;\n\t\t\tborder-bottom: initial !important;\n\t\t\tcolor: ${tt().Tj.text.disabled} !important;\n\t\t}\n\t`}\n\t`}function Zn(e){const t=Rn().W.getHoveredEditId();return t?function(e){const{editId:t,themeMode:n,selected:r,hovered:o}=e;return`\n\t\t.${(0,Cn().rI)({editId:t})}.${Pn().Do} {\n\t\t\t${Kn({themeMode:n,selected:r,hovered:o})}\n\t\t}\n\t`}({editId:t,themeMode:e,selected:!1,hovered:!0}):""}function Qn(){const e=(0,En().eP)(),t=(0,f().K8)((()=>[Hn(e),Gn(e)].join("\n")),[e]),n=(0,f().K8)((()=>function(){var e,t,n;const r="token"===(null===(e=Wn().A.state)||void 0===e?void 0:e.type)?null===(t=Wn().A.state)||void 0===t||null===(t=t.annotations)||void 0===t?void 0:t.find(Tn().sh$):void 0;if(!r)return"";const o="token"===(null===(n=Wn().A.state)||void 0===n?void 0:n.type)?Wn().A.state.store:void 0,i=(0,Tn().cQR)(r);return"block"!==(null==o?void 0:o.table)?"":`\n\t\t\t.${(0,Cn().re)({href:i,blockId:o.id})}.${Pn().Do} {\n\t\t\t\ttransition: border-color 100ms ease-in, opacity 100ms ease-in;\n\t\t\t\tborder-color: currentColor !important;\n\t\t\t\topacity: 1 !important;\n\t\t\t}\n\t\t`}()),[]),o=(0,f().K8)((()=>Jn(e)),[e]),i=(0,f().K8)((()=>function(e){var t,n,r;if(!(null===(t=Bn().A.state)||void 0===t?void 0:t.open))return"";let o=[],i=[];return null!==(n=jn().A.state)&&void 0!==n&&n.isHovered&&(o=X().Hn(Cn().DS).map((t=>Fn({level:t+1,hovered:!0,selected:!1,mode:e})))),null!==(r=jn().A.state)&&void 0!==r&&r.isActivelyComposing&&(i=X().Hn(Cn().DS).map((t=>Fn({level:t+1,hovered:!1,selected:!0,mode:e})))),[...o,...i].join("\n")}(e)),[e]),a=(0,f().K8)((()=>function(e){return qn().default.isRightMarginCommentHovered()?[$n(e)].join("\n"):""}(e)),[e]),s=(0,f().K8)((()=>Zn(e)),[e]),c=(0,r.useMemo)((()=>[t,n,o,i,a,s].filter(Boolean).join("\n")),[o,t,n,i,a,s]),l=(0,r.useRef)(null);(0,r.useLayoutEffect)((()=>{if(!l.current){const e=document.createElement("style");l.current=e,document.head.appendChild(e)}l.current.innerHTML=c}),[c])}var Xn=()=>n(522419),Yn=()=>n(825237),er=()=>n(278238),tr=()=>n(945778),nr=()=>n(107461),rr=()=>n(712030),or=()=>n(162864),ir=()=>n(363686),ar=()=>n(674627),sr=()=>n(110750),cr=()=>n(993130);var lr=()=>n(977390),dr=()=>n(129286),ur=()=>n(648088);function pr(){const e=(0,l().v3)(),t=(0,et().tz)(),n=(0,En().eP)(),i=(0,r.useRef)(),a=(0,f().r6)((()=>{const{RouterStore:t}=e,r=t.state.route;return(0,ur().Z)({environment:e,store:o().default.state.mainEditorCurrentBlockStore,route:r,themeMode:n})}),[e,n],{useDeepEqual:!0});(0,f().O$)(a),(0,r.useEffect)((()=>{const t=X().sg((function(){const{device:t}=e,r=a.state;if(!r)return;const{url:o,title:s,icon:l,assetPath:d,isNonverified:u,hasBypassedContentClassification:p,isMemberOfSpace:m,description:f,shouldNoIndex:v,spaceNameForMetaTag:g,authorName:h,coverImage:b,isPublicSite:S}=r,{iconDefinition:y}=r;let w,k,A,I;l&&(0,er().T8)(l.icon)?A=l.icon:l&&(0,tr().A)(l.icon)?w=l.icon:l&&Xn().GM(l.icon)?k=l.icon:d&&Xn().Du(d)&&(I=d);const E=u&&!p&&!m,C=(0,ur().EL)(e,r);C&&document.title!==C&&(document.title=C,(0,nr().H)(C)),o&&_().ZO(o)!==_().ZO(window.location.href)&&(window.history.replaceState(window.history.state,"",o),function(e){var t;const{environment:n,url:r}=e;if(!(0,cr().A)(n))return;const{TabbedRouterStore:o}=n,i=(0,sr().Xz)(o.state);if("web"!==i.type)return;const a=mn().parseRoute({url:r,baseUrl:c().A.domainBaseUrl,publicDomainName:c().A.publicDomainName,isMobile:c().A.isMobile,protocol:c().A.protocol,currentUrl:window.location.href}),s=(null===(t=i.redirectedTo)||void 0===t?void 0:t.route)??i.route;if(a.name!==s.name)return;const l=_().ZO(e.url);i.redirectedTo?(i.redirectedTo.route=a,i.redirectedTo.url=l):(i.route=a,i.url=l)}({environment:e,url:window.location.href}));const T=document.querySelector("link[rel='shortcut icon']");if(T){const r={linkEl:T,environment:e,device:t,themeMode:n,config:c().A,lastSetIconStringRef:i},o=(0,ur().oo)("production");E?(T.href=o,i.current=o):w?function(e,t){const{linkEl:n,environment:r,lastSetIconStringRef:o}=e;if(t===o.current)return;o.current=t,(0,or().A)(t,(0,rr().FN)(r)).then((async e=>{await Xt().waitForInitialPageRenderToComplete(),await lr().A.waitUntil((()=>!lr().A.state.isMeasuring)),n.href=(null==e?void 0:e.toDataURL("image/png"))||""}))}(r,w):A?function(e,t){const{linkEl:n,device:r,themeMode:o,lastSetIconStringRef:i}=e;if(t===i.current)return;i.current=t;const a=`${t}?mode=${o}`;r.isFirefox?n.href=a:(0,ir().A)(a).then((e=>{n.href=e}))}(r,A):l&&k?function(e,t,n){const{linkEl:r,environment:o,config:i,lastSetIconStringRef:a}=e,{...s}=t,c=window.location.origin!==i.domainBaseUrl,l=Yn().wY({url:n,permissionRecord:s.pointer,baseUrl:i.domainBaseUrl,fullyQualified:!1,userId:o.currentUser.id,...c?{favicon:!0}:{width:100}});if(l===a.current)return;a.current=l,dr().transactionQueue.awaitRecordTransaction(s.pointer).then((()=>{if(!c)return(0,ir().A)(l);r.href=l})).then((e=>{!c&&e&&(r.href=e)}))}(r,l,k):y?function(e,t){const{linkEl:n,themeMode:r,lastSetIconStringRef:o}=e,i=`nds-icon-${t.viewBox}-${r}`;if(i===o.current)return;o.current=i;const a=(0,ar().M)(t,r);n.href=a.toDataURL("image/png")}(r,y):I?function(e,t){const{linkEl:n,environment:r,config:o,lastSetIconStringRef:i}=e,a=Yn().x8({url:t,width:100,baseUrl:o.domainBaseUrl,fullyQualified:!1,userId:r.currentUser.id});if(a===i.current)return;i.current=a,(0,ir().A)(a).then((e=>{n.href=e}))}(r,I):o!==i.current&&(T.href=o,i.current=o)}if(S){!function({title:e,description:t,url:n,icon:r,image:o,shouldNoIndex:i,author:a,spaceName:s}){function c(e,t){const n=`meta[property="${t}"], meta[name="${e}"]`,r=document.querySelector(n);if(r&&r instanceof HTMLMetaElement)return r;const o=document.createElement("meta");return t?o.setAttribute("property",t):o.setAttribute("name",e),document.head.appendChild(o),o}function l(e){const t=document.querySelector(`link[rel="${e}"]`);if(t&&t instanceof HTMLLinkElement)return t;const n=document.createElement("link");return n.setAttribute("rel",e),document.head.appendChild(n),n}['meta[name="twitter:site"]'].forEach((e=>{const t=document.querySelector(e);t&&t instanceof HTMLMetaElement&&t.remove()}));c("twitter:title").setAttribute("content",e);if(c("og:title","og:title").setAttribute("content",e),t){c("description").setAttribute("content",t);c("twitter:description").setAttribute("content",t);c("og:description","og:description").setAttribute("content",t)}if(n){c("twitter:url").setAttribute("content",n);c("og:url","og:url").setAttribute("content",n);l("canonical").setAttribute("href",n)}if(o){c("twitter:image").setAttribute("content",o);c("og:image","og:image").setAttribute("content",o)}if(a){c("article:author","article:author").setAttribute("content",a)}if(s){c("og:site_name","og:site_name").setAttribute("content",s)}if(r){l("shortcut icon").setAttribute("href",r)}if(i){c("robots").setAttribute("content","noindex")}else{const e=document.querySelector('meta[name="robots"]');e&&e instanceof HTMLMetaElement&&e.remove()}}({title:s??"",description:f,url:o,icon:null==T?void 0:T.href,image:b,shouldNoIndex:v,author:h,spaceName:g});const e=document.querySelector('script[type="application/ld+json"]');e&&e.remove();const t=document.createElement("script");t.type="application/ld+json",t.textContent=JSON.stringify({"@context":"https://schema.org","@type":"WebSite",name:g,url:window.location.href}),document.head.appendChild(t)}}),500,{leading:!0}),r=document.title;return a.state&&t(),a.addListener(t),()=>{a.removeListener(t),document.title=r}}),[e,t,a,n])}n(803949);var mr=()=>n(359995),fr=()=>n(75435),vr=()=>n(380745),gr=()=>n(17247),hr=()=>n(574359),br=()=>n(821062),Sr=()=>n(812182);var yr=()=>n(896922),wr=()=>n(564704),_r=()=>n(800140),kr=()=>n(520342),Ar=()=>n(840125),Ir=()=>n(281740);var Er=()=>n(441467),Cr=()=>n(404783),Tr=()=>n(295304),Pr=()=>n(718957),xr=()=>n(417924);var Lr=()=>n(779315),Rr=()=>n(806080),Ur=()=>n(391214),Dr=()=>n(98444);var Mr=()=>n(917908);var Nr=()=>n(232615);const Or={"editor:textSelection":{saveState:function(){const e=Nr().default.state;if("empty"===e.mode)return;const t=(0,xr().Ns)(e.multiSelection);return{version:1,data:{...e,multiSelection:t}}},restoreState:function({savedState:e}){const{data:t}=e,{multiSelection:r,mode:o}=t,i=(0,xr().Em)(r);return!!i&&((0,n(547033).setMultiSelection)({multiSelection:i,readOnly:"readOnly"===o}),!0)}},"editor:historyState":{saveState:function(){var e,t;const r=null===(e=window.history.state)||void 0===e?void 0:e.id,o=null===(t=window.history.state)||void 0===t?void 0:t.currentUserId;if(r&&o)return(0,n(427082).z)({historyId:r,currentUserId:o}),{version:1,data:{historyId:r,userId:o}}},restoreState:function({environment:e,savedState:t}){var n,r;const{data:{historyId:o,userId:i}}=t,a=null===(n=window.history.state)||void 0===n?void 0:n.id,s=null===(r=window.history.state)||void 0===r?void 0:r.currentUserId;if(s!==i)return!0;if(a===o)return!0;const c=function({historyId:e,currentUserId:t}){return O().K.get({userId:t,key:e})}({historyId:o,currentUserId:s});if(!c)return!0;!function({environment:e,historyState:t}){var n;const{PageScroller:r}=Lr().A;if(!t)return;if(null!==(n=t.blockIds)&&void 0!==n&&n.length)return void Ur().Wj(e,{blockId:t.blockIds[0],animate:!1});r&&(0,Rr().Et)(t.scrollTop)&&setTimeout((()=>{var e;null===(e=r.getNode())||void 0===e||e.scrollTo({top:t.scrollTop})}),500)}({environment:e,historyState:c});const l=e.RouterStore;return(0,Dr().T)({RouterStore:l,currentUserId:s}),window.history.replaceState({id:o,currentUserId:s},""),l.update((e=>({...e,id:o,historyState:c}))),!0}},"collaboration:discussion":{saveState:function(){const e=Bn().A.state;let t;if(!e.open)return;return"block"===e.type&&"reaction"===e.content||("comment"===e.content&&(t=function(e){const t=e.discussionInputStore.getState(),n=t.textStore.getValue();if(!n)return;const r={open:e.open,blockId:e.blockId,content:e.content,rectBounds:{left:e.rect.left,top:e.rect.top,width:e.rect.width,height:e.rect.height},property_id:e.property_id,lastKnownBlockStoreId:e.lastKnownBlockStore.id,discussionInputStoreState:{textValue:n,showAttachFileIntro:t.showAttachFileIntro,renderFileAttachIntro:t.renderFileAttachIntro},spaceId:t.textStore.pointer.spaceId};if("inline"===e.type)return{...r,type:"inline",multiSelection:(0,xr().Ns)(e.multiSelection)};if("block"===e.type)return{...r,type:"block"}}(e)),"reaction"===e.content&&(t=function(e){if("inline"===e.type)return{open:e.open,blockId:e.blockId,content:e.content,emoji:e.emoji,rectBounds:{left:e.rect.left,top:e.rect.top,width:e.rect.width,height:e.rect.height},type:"inline",multiSelection:(0,xr().Ns)(e.multiSelection)}}(e)),!t)?void 0:{version:1,data:t}},restoreState:function({environment:e,savedState:t}){const{data:n}=t;return"comment"===n.content?function(e,t){const{rectBounds:n,discussionInputStoreState:r,spaceId:o,lastKnownBlockStoreId:i,...a}=t;if(!o)return!1;const s=new DOMRect(n.left,n.top,n.width,n.height),c=(0,xr().AK)(i);if(!c)return!1;const l=new(Cr().A)(e,o);if(ke().createAndCommit({userAction:"DiscussionInput.willMount",environment:e,canUndo:!0,perform:t=>{Tr().R9({environment:e,store:l.state.textStore,value:r.textValue,transaction:t})}}),"inline"===t.type){const e=(0,xr().Em)(t.multiSelection);if(!e)return!1;Bn().A.setState({...a,rect:s,lastKnownBlockStore:c,blockStore:c,type:"inline",discussionInputStore:l,lastEditables:(0,Pr().$W)(e),multiSelection:e})}else"block"===t.type&&Bn().A.setState({...a,rect:s,lastKnownBlockStore:c,blockStore:c,type:"block",discussionInputStore:l});return!0}(e,n):"reaction"!==n.content||function(e,t){const{rectBounds:n,...r}=t,o=new DOMRect(n.left,n.top,n.width,n.height),i=(0,xr().AK)(t.blockId);if(!i)return!1;if("inline"===t.type){const n=(0,xr().Em)(t.multiSelection);if(!n)return!1;Bn().A.setState({...r,rect:o,blockStore:i,type:"inline",multiSelection:n}),Er().of({environment:e,blockStore:i,multiSelection:n,formulasModule:void 0,rect:o})}return!0}(e,n)}},"collaboration:discussionMenuInteraction":{saveState:function(){const e=jn().A.state;if(e.isActivelyComposing||e.isHovered)return{version:1,data:e}},restoreState:function({savedState:e}){const{data:t}=e;return jn().A.setState(t),!0}},"desktop:navigationHistory":{saveState:function(){const e=Mr().H.getState();if(void 0!==e.activeIndex)return{version:1,data:e}},restoreState:function({savedState:e}){const{data:t}=e;return Mr().H.setState(t),(0,kr().N)(),!0}}},jr=new Map;function Br(e,t){jr.has(e)||jr.set(e,t)}function qr(e){jr.delete(e)}function Wr(){const e=function(){const e=(0,Ar().getCloseConfirmationDialogReason)();if(e)return[{reason:e,providerId:"UnloadBlockerFromBeforeUnload"}];for(const t of jr.values()){const e=t.getUnloadBlockers;if(!e)continue;const n=e();if(n.length>0)return n}return[]}();if(e.length>0)return[{blockers:e}];return[{tabClientStates:zr()}]}function zr(){const e={};for(const[r,o]of jr.entries())try{var t;const n=null===(t=o.saveState)||void 0===t?void 0:t.call(o);if(!n)continue;e[r]=n}catch(n){}return e}function Fr(){return[zr()]}var $r=()=>n(757747),Kr=()=>n(72234),Vr=()=>n(737022);var Hr=()=>n(551253),Gr=()=>n(706250),Jr=()=>n(267724),Zr=()=>n(184136),Qr=()=>n(180252),Xr=()=>n(614949);const Yr=(0,et().YK)({have_local_draft_unsaved_changes:{defaultMessage:"Changes you made to the layout may not be saved.",id:"closeConfirmationMessages.haveLocalDraftUnsavedChanges"},dictation_in_progress:{defaultMessage:"Transcription is in progress.",id:"closeConfirmationMessages.dictationInProgress"}});var eo=()=>n(38554),to=()=>n(535960),no=()=>n(869562),ro=()=>n(263943),oo=()=>n(749687),io=()=>n(320460),ao=()=>n(863642),so=(n(814603),n(147566),n(198721),()=>n(312788));function co(){const{tabStates:e,isFrameReady:t}=(0,f().O$)(Ir().f),n=(0,l().v3)();(0,r.useEffect)((()=>{e&&t&&function(e){for(const[n,r]of jr.entries())try{const t=r.restoreState,o=Ir().f.getStateForProvider(n);if(!t||!o)continue;t({environment:e,savedState:o})&&Ir().f.consumeState(n)}catch(t){}}(n)}),[e,t,n])}function lo(){const e=(0,l().v3)(),t=(0,et().tz)(),n=(0,f().O$)(o().AppStoreSidebarSpaceStore);!function(e){const{navigate:t}=(0,r.useContext)(so().E),n=(0,s().X)("desktop_navigation_interceptor");(0,r.useEffect)((()=>{if(!e.device.isElectron||!n)return;if(!("navigation"in window))return void Q().log({level:"info",from:"navigationInterceptor",type:"navigationApiNotSupported"});const r=n=>{const r=new URL(n.destination.url),o=new URL(window.location.href);!n.userInitiated||!n.canIntercept||r.origin!==o.origin||n.hashChange||n.destination.sameDocument||n.downloadRequest||n.formData||n.intercept({handler:()=>{try{t({environment:e,url:n.destination.url}),Q().log({level:"debug",from:"navigationInterceptor",type:"navigationIntercepted",data:{miscDataToConvertToString:{fromUrl:o.href,toUrl:n.destination.url}}})}catch(r){throw Q().log({level:"error",from:"navigationInterceptor",type:"navigationInterceptionError",error:(0,Y().convertErrorToLog)(r),data:{miscDataToConvertToString:{fromUrl:o.href,toUrl:n.destination.url}}}),r}}})};return window.navigation.addEventListener("navigate",r),Q().log({level:"info",from:"navigationInterceptor",type:"navigationInterceptorInitialized"}),()=>{window.navigation.removeEventListener("navigate",r)}}),[e,n,t])}(e);const a=(0,eo().U)(),d=(0,f().K8)((()=>i().A.state.tabs),[]),u=(0,f().K8)((()=>({observedWidth:oo().sidebarSizeObserver.rect.state.width,targetWidth:oo().sidebarWidthStore.state,isExpanded:oo().sidebarExpandedStore.state,resizing:oo().sidebarResizingStore.state,isMouseEntered:oo().sidebarMouseEnteredStore.state})),[]),p=(0,f().K8)((()=>Jr().A.state.open),[]),m=(0,f().K8)((()=>Hr().I.state.open),[]),v=(0,f().K8)((()=>i().A.state.isActiveTab),[]),g=(0,f().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),[h,S]=(0,r.useState)(!1),y=e.currentUser.isLoggedIn(),w=a,_=(0,f().K8)((()=>{if(n&&w)return(0,hr().G)(e,n)}),[e,n,w]),k=(0,f().K8)((()=>{if(n&&w)return n.getIcon()}),[n,w]),[A,I]=(0,r.useState)(void 0),E=(0,Vt().formatVersion)((0,Z().B7)()),C=(0,f().K8)((()=>(0,Xr().X)(e).shouldShowSidebar),[e]),T=(0,s().X)(ro().iZ.id)&&a;(0,r.useEffect)((()=>{let t=!1;return async function(){if(k)try{const n=(0,ur().ih)({environment:e,state:{icon:k}}),r=await(0,ur().kL)({environment:e,iconInfo:n,size:128});t||I(r||void 0)}catch(n){t||I(void 0)}else I(void 0)}(),()=>{t=!0}}),[e,k]),(0,r.useEffect)((()=>{v&&h&&Z().uY.set({isLoggedIn:y,shouldShowSidebar:C,workspaceName:_,workspaceIcon:A,isWorkspaceSwitcherInHeaderEnabled:w,...u,slipperySlopeFullScreenSidebarEnabled:T})}),[u,y,v,h,C,T,_,A,w]),(0,r.useEffect)((()=>{v&&(0,kr().N)()}),[v]);const P=(0,f().K8)((()=>{var e,t;const n="transcription"===(null===(e=ve().Ay.state.rootBlock)||void 0===e?void 0:e.getType())?null===(t=ve().Ay.state.rootBlock)||void 0===t?void 0:t.pointer:void 0;return n?[{type:"transcription",pointer:n}]:[]}),[],{equalityFn:br().k});(0,r.useEffect)((()=>{var e,t;e=P,null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.setActiveBlocks)||void 0===t||t.call(ae().electronApi,e)}),[P]);const x=(0,f().K8)((()=>ve().Ay.getState().enabled),[]);(0,r.useEffect)((()=>{var e,t;e=x,null!==ae().electronApi&&void 0!==ae().electronApi&&ae().electronApi.setIsRecording?ae().electronApi.setIsRecording(e):null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.setIsMediaActive)||void 0===t||t.call(ae().electronApi,e)}),[x]),(0,r.useEffect)((()=>{let e;e=y?u.isExpanded?"expanded":"collapsed":"disabled",Z().Oq.set(e)}),[u.isExpanded,y]);const L=(0,f().K8)((()=>{var e,t,r;return{currentUserId:null===(e=o().default.state.currentUserStore)||void 0===e?void 0:e.id,currentUserEmail:null===(t=o().default.state.currentUserStore)||void 0===t?void 0:t.getEmail(),currentSpaceId:null==n?void 0:n.getSpaceId(),currentPageId:null===(r=o().default.state.mainEditorCurrentBlockStore)||void 0===r?void 0:r.id}}),[n]);(0,r.useEffect)((()=>{var e,t;e=L,null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.setAppStoreState)||void 0===t||t.call(ae().electronApi,e)}),[L]);const R=(0,f().K8)((()=>{var t;return!!(null===(t=fr().A.state.preferences)||void 0===t?void 0:t.isZenModeEnabled)&&((0,Qr().$o)(e).state&&"page"===e.RouterStore.state.route.name)}),[e]);(0,r.useLayoutEffect)((()=>{!function(e){var t;null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.setZenMode)||void 0===t||t.call(ae().electronApi,e)}(R)}),[R]),(0,r.useEffect)((()=>{v||vr().A.setKeyboardMode(!1)}),[v]);const U=(0,r.useCallback)(((t,n)=>{n.forEach((t=>{(0,J().u)({environment:e,event:t})}))}),[e]);(0,r.useEffect)((()=>Z().HT.addListener(U)),[U]);const D=(0,r.useCallback)(((e,t)=>{g||(t&&Gr().D.setState({startTime:b().default.mark("tab_switch_render").startTime}),i().A.updateIsActive(t))}),[g]),M=(0,s().X)("tab_unloading"),N=(0,f().K8)((()=>z().default.getConfigKey("tab_unload_threshold","thresholdInMs")),[]);(0,r.useEffect)((()=>{var e;e=M,Z().Zq.setPreference("isTabUnloadingEnabled",e)}),[M]),(0,r.useEffect)((()=>{var e;M&&(e=N,Z().Zq.setPreference("tabUnloadThreshold",e))}),[N,M]);const O=(0,f().K8)((()=>"on"===z().default.getEligibleGroup({experimentId:"desktop_unload_tabs_before_refresh",defaultGroup:"control",enableEventTrailLogging:!0})),[]);(0,r.useEffect)((()=>{var e;e=O,Z().Zq.setPreference("shouldUnloadTabsBeforeRefresh",e)}),[O]);const j=(0,s().X)("prewarmed_tab_disable_throttling");(0,r.useEffect)((()=>{var e;e=!j,Z().Zq.setPreference("isPrewarmedTabThrottlingEnabled",e)}),[j]);const B="on"===(0,Te().r)("prewarmed_tab_load_sidebar_exp",{enableEventTrailLogging:!0}),q=(0,s().X)("prewarmed_tab_hidden_behind",{disableExposureLogging:!B,enableEventTrailLogging:!0}),W=B&&q;(0,r.useEffect)((()=>{var e;e=W,Z().Zq.setPreference("isPrewarmedTabHiddenBehindEnabled",e)}),[W]),(0,r.useEffect)((()=>{if(!M||g)return;const e=function(){for(const[e,t]of(0,te().WP)(Or))Br(e,t);return()=>{for(const e of(0,te().uv)(Or))qr(e)}}();(async function(){var e;return null===ae().electronApi||void 0===ae().electronApi||null===(e=ae().electronApi.getRestoredClientState)||void 0===e?void 0:e.call(ae().electronApi)})().then((e=>{e&&Ir().f.setTabStates(e)}));const t=(n=Wr,null===ae().electronApi||void 0===ae().electronApi||null===(r=ae().electronApi.addUnloadTabHandler)||void 0===r?void 0:r.call(ae().electronApi,n));var n,r;return()=>{e(),null==t||t()}}),[g,M]),(0,r.useEffect)((()=>{return e=Fr,null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.addGetClientStateHandler)||void 0===t?void 0:t.call(ae().electronApi,e);var e,t}),[]),co();const F=(0,r.useCallback)(((e,t)=>{!async function(){const e=await Zr().i.load();await e.updateActiveBlocks(t)}()}),[]),$=(0,f().K8)((()=>{const{tabs:e}=i().A.state;return e.flatMap((e=>e.activeBlocks??[]))}),[]);(0,r.useEffect)((()=>{$.length>0&&F(void 0,$)}),[F,$]),(0,r.useEffect)((()=>{if(void 0===v||g)return;const t=()=>{Ft().A.update((e=>({...e,isVisible:!document.hidden&&v})))};return t(),v&&We().A.state.initialRenderCompleted&&(b().default.measure("tab_switch_render",{environment:e,data:{was_loaded:!0}}),Gr().D.reset()),document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}}),[v,g,e]),(0,r.useEffect)((()=>{if(!g)return Z().Wt.get().then((e=>{i().A.updateIsActive(e),e&&"new_inactive_tab"===(0,Xt().getDesktopLoadOrigin)()&&Gr().D.setState({startTime:b().default.mark("tab_switch_render").startTime})})),Z().Wt.addListener(D)}),[D,g]);const K=(0,r.useCallback)(((e,t)=>{void 0===t.isShowingTabBar&&(t.isShowingTabBar=!0),fr().A.setState(t)}),[]);(0,r.useEffect)((()=>{var e;return null===(e=Z().Zq.get())||void 0===e||e.then((e=>{fr().A.setState(e)})),Z().Zq.addListener(K)}),[K]);const V=(0,r.useCallback)(((e,t)=>{i().A.update((e=>({...e,tabs:t})))}),[]);(0,r.useEffect)((()=>Z().Hy.addListener(V)),[V]);const H=(0,r.useCallback)(((e,t)=>{i().A.update((e=>({...e,currentTab:t})))}),[]);(0,r.useEffect)((()=>Z().$Q.addListener(H)),[H]);const G=(0,r.useCallback)(((e,t)=>{i().A.update((e=>{const n=new Set(e.unauthorizedIframeUrls??[]);n.add(t);const r=Array.from(n);return{...e,unauthorizedIframeUrls:r}}))}),[]);(0,r.useEffect)((()=>Z().Bl.addListener(G)),[G]);const X=(0,r.useCallback)((t=>{no().setExpand({environment:e,isExpanded:!u.isExpanded,from:"electron_listener",saveDetailsSidebarPreference:!1})}),[e,u.isExpanded]),ee=(0,r.useCallback)((t=>{const n=e=>{var t;null===(t=Z().Oq.notifySlipperySlopeFullScreenSidebarResult)||void 0===t||t.call(Z().Oq,{handled:e})};if(!T)return void n(!1);const r=e.WindowSizeStore.state.width;if(r<=0)return void n(!1);const o=oo().sidebarWidthStore.state;if(!(r>0&&o>=r-1))return no().setWidth({width:r,environment:e}),void n(!0);const i=ao().f.state??oo().SIDEBAR_MIN_WIDTH,a=Math.abs(i-r)<1?oo().SIDEBAR_MIN_WIDTH:i,s=Math.min(Math.max(a,oo().SIDEBAR_MIN_WIDTH),r);no().setWidth({width:s,environment:e}),n(!0)}),[e,T]);(0,r.useEffect)((()=>Z().Oq.addToggleListener(X)),[X]),(0,r.useEffect)((()=>{var e;return null===(e=Z().Oq.addSlipperySlopeFullScreenToggleListener)||void 0===e?void 0:e.call(Z().Oq,ee)}),[ee]);const ne=(0,r.useCallback)(((e,t)=>{t?no().open({fromElectron:!0}):no().close()}),[]);(0,r.useEffect)((()=>Z().Oq.addSetSidebarOpenListener(ne)),[ne]);const re=(0,r.useCallback)(((e,t)=>{oo().sidebarExpandedStore.setState(t.isExpanded),oo().sidebarWidthStore.setState(t.targetWidth)}),[]),oe=(0,r.useCallback)((()=>{w&&io().A.setState({...io().A.state,open:!io().A.state.open})}),[w]),ie=(0,r.useCallback)(((e,t)=>{let n;Jr().A.update((e=>(n=!e.open,{...e,open:n,buttonBounds:t}))),n&&m&&Hr().I.update((e=>({...e,open:!1})))}),[m]);(0,r.useEffect)((()=>Z().uS.setTabSpacesMenuOpenState(p)),[p]),(0,r.useEffect)((()=>{if(Z().d0.addToggleListener)return Z().d0.addToggleListener(oe)}),[oe]),(0,r.useEffect)((()=>Z().uS.addToggleMenuListener(ie)),[ie]);const se=(0,r.useCallback)(((e,t)=>{Jr().A.update((e=>({...e,tabSpacesState:{...e.tabSpacesState,...t}})))}),[]);(0,r.useEffect)((()=>Z().uS.addListener(se)),[se]);const ce=(0,r.useCallback)(((e,t)=>{Jr().A.update((e=>({...e,open:!0,createOrUpdateMenuState:{...t,action:"create"}})))}),[]);(0,r.useEffect)((()=>Z().uS.addOpenCreateMenuListener(ce)),[ce]),(0,r.useEffect)((()=>{!v&&p&&Jr().A.update((e=>({...e,open:!1})))}),[v,p]),(0,r.useEffect)((()=>{Jr().A.update((e=>({...e,open:!1})))}),[u.isExpanded]),(0,r.useEffect)((()=>{!v&&m&&Hr().I.update((e=>({...e,open:!1})))}),[v,m]);const le=(0,r.useCallback)(((e,t)=>{Ye().D6({label:t})}),[]);(0,r.useEffect)((()=>Z().uS.addSnackBarMessageListener(le)),[le]),(0,r.useEffect)((()=>(g||Z().uY.get().then((e=>{e&&(oo().sidebarExpandedStore.setState(e.isExpanded),oo().sidebarWidthStore.setState(e.targetWidth),oo().sidebarSizeObserver.rect.update((t=>({...t,width:e.observedWidth})))),S(!0)})),Z().uY.addListener(re))),[re,g]),(0,r.useEffect)((()=>{!async function(){if(void 0===E)return;const t=await It().callApi({eventName:"isDesktopVersionCompatible",environment:e,data:{desktopVersion:E}});"success"!==t.type||t.data.compatible||window.location.replace(c().A.domainBaseUrl+t.data.redirect)}()}),[E,e]),(0,r.useEffect)((()=>Z().Er.addListener(((t,n)=>{mr().N6(e,n)}))),[e]);const de=(0,f().K8)((()=>{const e=(0,Ar().getUserControlledCloseConfirmationDialogReason)();if(e){return{analytics_id:e,localized_message:t.formatMessage(Yr[e])}}}),[t]);(0,r.useEffect)((()=>{var e,t;e=de,null===ae().electronApi||void 0===ae().electronApi||null===(t=ae().electronApi.setCloseConfirmationDialogReason)||void 0===t||t.call(ae().electronApi,e)}),[de]);const ue=(0,r.useCallback)(((t,r)=>{if(!n)return;const o=fe().B.createChildStore(n,r.pointer);(0,to().u)({environment:e,store:o,pageVisitSource:r.source})}),[e,n]);(0,r.useEffect)((()=>Z().uK.addListener(ue)),[ue]);const pe=(0,r.useCallback)(((t,n)=>{$r().v[n.toastId](e,n)}),[e]);(0,r.useEffect)((()=>null===Z().Iz||void 0===Z().Iz?void 0:Z().Iz.addListener(pe)),[pe]);const me=(0,r.useCallback)(((e,t)=>{Sr().UW(t.id)}),[]);(0,r.useEffect)((()=>null===Z().UW||void 0===Z().UW?void 0:Z().UW.addListener(me)),[me]);const ge=(0,r.useCallback)(((t,n)=>{"back"===n?(0,yr().a)(e):"forward"===n&&(0,_r().s)(e)}),[e]);(0,r.useEffect)((()=>Z().M.addListener(ge)),[ge]);const he=(0,r.useCallback)(((t,n)=>{(0,wr().Y)(e,n)}),[e]);(0,r.useEffect)((()=>Z().fK.addListener(he)),[he]);const be=(0,r.useCallback)(((e,t)=>{Hr().I.setState({direction:t,open:!0}),p&&Jr().A.update((e=>({...e,open:!1})))}),[p]);(0,r.useEffect)((()=>Z()._$.addListener(be)),[be]);const Se=(0,r.useCallback)(((e,t,r)=>{const o=i().A.state.tabs.find((e=>e.id===t)),a=gr().j.state.open;if(!o||!o.pagePointer||!n||a)return;const s=fe().B.createChildStore(n,o.pagePointer);Wn().A.setState({type:"tab",store:s,domRect:{...r,y:0,height:0},tabId:t,spaceStore:n})}),[n]);(0,r.useEffect)((()=>Z().nP.addListener(Se)),[Se]);const ye=(0,r.useCallback)((e=>{Wn().A.setState(void 0)}),[]);(0,r.useEffect)((()=>Z().M9.addListener(ye)),[ye]);const we=(0,f().K8)((()=>{var e;return"tab"===(null===(e=Wn().A.state)||void 0===e?void 0:e.type)?Wn().A.state.tabId:void 0}),[]);(0,r.useEffect)((()=>{R&&we&&Wn().A.setState(void 0)}),[we,R]),(0,r.useEffect)((()=>{!v&&we&&Wn().A.setState(void 0)}),[we,v]),(0,r.useEffect)((()=>{const e=d.find((e=>e.id===we));we&&!e&&Wn().A.setState(void 0)}),[we,d]);const _e=(0,r.useCallback)(((t,n)=>{!async function(e){(await Vr().i.load()).meetingNotificationClicked(e)}({environment:e,notification:n})}),[e]);(0,r.useEffect)((()=>Z().in.addListener(_e)),[_e]);const ke=(0,r.useCallback)(((t,n)=>{!function(e,t){const n=(null==t?void 0:t.type)||"audioProcessDetection";switch(n){case"audioProcessDetection":Kr().AC(e,!0,"notification");break;case"upcomingMeeting":Kr().Tj(e,!0,"notification");break;default:(0,te().HB)(n)}}(e,n)}),[e]);(0,r.useEffect)((()=>Z().gQ.addListener(ke)),[ke]);const Ae="use_watchdog"===(0,Te().r)("stuck_tab_watchdog_desktop",{enableEventTrailLogging:!0});(0,r.useEffect)((()=>{var e;e=Ae,Z().Zq.setPreference("isStuckTabWatchdogEnabled",e)}),[Ae]);const Ie=(0,f().K8)((()=>"use_heuristic"===z().default.getEligibleGroup({experimentId:"desktop_prewarmed_tab_heuristic",defaultGroup:"no_heuristic",enableEventTrailLogging:!0})),[]);(0,r.useEffect)((()=>{var e;e=Ie,Z().Zq.setPreference("shouldUsePrewarmedTabHeuristic",e)}),[Ie])}var uo=()=>n(247584);function po(){(0,uo().httpRequest)({url:`${c().A.secureFileConfig.rootPath}/refresh`,method:"GET",format:"text"})}n(823215),n(737550);var mo=()=>n(983610),fo=()=>n(979340),vo=()=>n(498212);var go=()=>n(418247);function ho(){const e=(0,l().v3)(),t=(0,l().Y0)(),n=(0,f().K8)((()=>{const{currentUserStore:n,currentUserSettingsStore:r,currentUserRootStore:i}=o().default.state;if(!(e.currentUser.id&&n&&r&&i))return e.publicDomainUserId?{user_id:e.publicDomainUserId}:void 0;const a=i.getSpaceViewStores(),s=a.length>0&&a.every((e=>e.isReady()));if(!n.isDefined()||!r.isDefined()||!s)return;const c=X().oE(a.map((e=>e.getSpaceId()))).map((t=>Mt().A.getData(e,{spaceId:t,userId:e.currentUser.id}))),l=a.map((e=>e.getModel())).filter((e=>(0,te().O9)(e))).filter((e=>!e.getNotifyEmail())).map((e=>e.getSpaceId())).map(vo().ot);if(!c.every((e=>Boolean(e)||null===e)))return;const d=function(e){const t=e.map((e=>(0,go().G)(e))),n=new Set(X().oE(t));if(n.has("enterprise"))return"enterprise";if(n.has("business"))return"business";if(n.has("plus"))return"plus";if(n.has("personal"))return"personal_pro";if(n.has("team_free"))return"team_free";if(n.has("personal_free"))return"personal_free";if(n.has("free"))return"free";return"none"}(c),u=r.getSettings();if(!u)return;if(void 0===mo().subscriptionDataStoreInstance.state)return;const p={user_id:n.id,email:n.getEmail(),user_persona:u.persona,user_team_role:u.team_role,user_use_cases:u.use_cases,user_company_size:u.company_size,user_source:u.source,user_plan_type:d,user_subscription_tier:mo().subscriptionDataStoreInstance.state.subscriptionTier,user_has_at_least_one_free_tier_space:So(c),time_zone:u.time_zone,locale:u.locale,preferred_locale:u.preferred_locale,signup_time:u.signup_time,app_version:t.version,workspace_email_opt_out:l};return u.signup_time&&(p.created_at=Math.floor(u.signup_time/1e3)),t.desktopAppVersion&&(p.desktop_app_version=t.desktopAppVersion),t.mobileAppVersion&&(p.mobile_app_version=t.mobileAppVersion),u.used_desktop_web_app&&(p.used_desktop_web_app=u.used_desktop_web_app),u.used_mobile_web_app&&(p.used_mobile_web_app=u.used_mobile_web_app),u.used_mac_app&&(p.used_mac_app=u.used_mac_app),u.used_windows_app&&(p.used_windows_app=u.used_windows_app),u.used_ios_app&&(p.used_ios_app=u.used_ios_app),u.used_android_app&&(p.used_android_app=u.used_android_app),p}),[e,t],{useDeepEqual:!0});(0,r.useEffect)((()=>{n&&"none"!==n.user_plan_type&&bo(e,n)}),[e,n]);const i=void 0!==n;(0,r.useEffect)((()=>{const t=window.setTimeout((()=>{!i&&e.currentUser.id&&bo(e,{user_id:e.currentUser.id})}),5e3);return()=>{window.clearTimeout(t)}}),[e,i])}const bo=X().nF((function(e,t){(0,n(430588).T)({environment:e,userId:(0,vo().ot)(t.user_id),traits:{...t,user_id:(0,vo().ot)(t.user_id)}})}),5e3);function So(e){return e.map((e=>(0,go().G)(e))).filter(te().Vq).some((e=>fo().dL(e)))}var yo=()=>n(528981),wo=()=>n(599824),_o=()=>n(576727);async function ko(e,t){t.loggedIn&&await o().default.waitUntilRendered();const{callApi:r}=await Promise.resolve().then(n.bind(n,753812)),i=await r({eventName:"getUserAnalyticsSettings",environment:e,data:{}});if("success"!==i.type)return void Q().log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:i}}});const a=i.data;return _o().default.setState(a),a}var Ao=()=>n(893820),Io=()=>n(268405);var Eo=()=>n(987201),Co=()=>n(920198),To=()=>n(410690),Po=()=>n(711771),xo=()=>n(499233),Lo=()=>n(671199);const Ro={recentPagesActions:new(v().O2)("recentPagesActions",(async()=>Promise.resolve().then(n.bind(n,824188)))),userSignalsHelpers:new(v().O2)("userSignalsHelpers",(async()=>n.e(84084).then(n.bind(n,954220)))),broadcastChannel:new(v().O2)("broadcastChannel",(async()=>Promise.resolve().then(n.bind(n,467135)))),minisearchDependency:Po().f};function Uo(e){const{elector:t,broadcastChannel:n}=e.state;e.setState(e.getInitialState());(async()=>{await(null==t?void 0:t.die()),await(null==n?void 0:n.close())})()}function Do(){(0,r.useEffect)((()=>{(0,xo().So)((()=>({appStart:(0,To().getAppStartTime)(),hookStart:performance.now()})))}),[]);const e=(0,l().v3)(),t=(0,ct().T)(),n=(0,Co().L)(),o=null==n?void 0:n.id,i=(0,bt().ZC)(t),a=(0,bt().ZC)(o);(0,r.useEffect)((()=>{t&&o&&(t!==i||o!==a)&&(Uo(Lo().A),async function(e){const{spaceStore:t,userId:n,environment:r}=e,o=t.id;Uo(Lo().A),(0,xo().So)((e=>({appStart:e.appStart,hookStart:e.hookStart,setupLocalSearchStart:performance.now()})));const i=Ro.recentPagesActions.load().then((async e=>{await e.reinitializeGlobalRecentPagesStoreState(r,n,t)})),a=Ro.userSignalsHelpers.load(),s=Ro.broadcastChannel.load(),c=(async()=>{const{BroadcastChannel:e,createLeaderElection:t}=await s,r=new e(`local_search_${o}_${n}`),i=t(r);Lo().A.update((e=>({...e,elector:i,broadcastChannel:r})))})(),l=(await a).initializeAndLoadAllUserSignals({spaceId:o,userId:n,environment:r});await Promise.all([Po().f,i,l,c])}({spaceStore:n,userId:t,environment:e}))}),[e,t,n,i,a,o])}function Mo(){const e=(0,l().v3)(),t=(0,l().Y0)();(0,r.useEffect)((()=>{var n;t.isElectron&&(n=Q().clientLogglyEnvironmentData,ae().electronApi&&(ae().electronApi.setLoggerData?ae().electronApi.setLoggerData(n):ae().electronApi.setLogglyData&&ae().electronApi.setLogglyData(n))),e.mobileNative&&e.mobileNative.setLogglyData(Q().clientLogglyEnvironmentData)}),[t.isElectron,e.mobileNative])}var No=()=>n(94484),Oo=()=>n(807449),jo=()=>n(124092),Bo=()=>n(75756),qo=()=>n(126617),Wo=()=>n(183558),zo=()=>n(74464),Fo=()=>n(363496),$o=()=>n(428614),Ko=()=>n(512793),Vo=()=>n(744974),Ho=()=>n(991385);function Go(){const e=(0,l().v3)();(0,r.useEffect)((()=>{!async function(e){const{environment:t,onboardingState:n}=e,{inAppCalloutStore:r,currentUserSettingsStore:i}=o().default.state,a=await Fo().w3(t);if(!a||!r.getCalloutVisibility("cookie_preference_popup").canShow)return;const s=z().default.checkGate({gateName:"enable_cookie_consent_settings_hydration"});if(i&&s){await i.load();const e=i.getSettings(),n=null==e?void 0:e.cookie_consent;if(n)return void(await Ko().A.setCookieConsent(t,n))}if((0,Ho().B)(t.currentUser.id)>=2)return Fo().Wv(),Vo().A.setState({open:!0}),Fo().JI({environment:t,type:"modal",onboardingState:n}),r.updateCalloutStatus({calloutId:"cookie_preference_popup",visible:!0,validateCanShow:!0}),void(0,R().DO_NOT_USE_trackLegacy)(t,"cookie_modal_shown");if(No().Ay.state.currentItem)return;r.updateCalloutStatus({calloutId:"cookie_preference_popup",visible:!0,validateCanShow:!0}),No().Ay.setState({...No().Ay.state,currentItem:{key:(0,Wo().Ay)(),label:(0,at.jsx)("div",{children:(0,Bo().Qq)(zo().i,"snackbar")}),right:(0,at.jsx)(Jo,{})},shouldReset:!1}),Fo().JI({environment:t,type:"snackbar",onboardingState:n})}({environment:e})}),[e])}function Jo(){const e=(0,l().v3)(),t=(0,En().IS)((()=>({buttonContainer:{display:"flex"},buttonText:{color:tt().Tj.text.inversePrimary},plainButton:{paddingInlineStart:8,paddingInlineEnd:8,marginInlineStart:12}})),[]);return(0,at.jsxs)("div",{style:t.buttonContainer,children:[(0,at.jsx)(jo().p,{onClick:()=>Fo().gz(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,at.jsx)("b",{style:t.buttonText,children:(0,at.jsx)(et().sA,{...Bo().LS.acceptAllButtonLabel})})}),(0,at.jsx)(jo().p,{onClick:()=>Fo().gz(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,at.jsx)("b",{style:t.buttonText,children:(0,at.jsx)(et().sA,{...Bo().LS.rejectAllButtonLabel})})}),(0,at.jsx)($o().A,{hasDismissButton:!0,renderOrigin:e=>(0,at.jsx)(jo().p,{style:t.plainButton,...e,children:(0,at.jsx)(Oo().I,{icon:qo().ellipsisSmallIcon,size:"sm",colorVariant:"inversePrimary"})})})]})}var Zo=()=>n(908006),Qo=()=>n(988083),Xo=()=>n(723233);const Yo=new(n(140934).ComputedStore)((()=>{const e=Qo().A.state;return e.phase===Qo().i.willShow?0:e.estimatedKeyboardWebViewOverlap}),{debugName:"estimatedKeyboardWebViewOverlapStore"});function ei(){const e=(0,l().v3)();(0,r.useEffect)((()=>{function t(t){!function(e,t){(0,R().DO_NOT_USE_trackLegacy)(e,"show_page_reload_confirmation_dialog",t)}(e,{reason:t})}return Ar().showConfirmationDialogEventEmitter.addListener(t),()=>{Ar().showConfirmationDialogEventEmitter.removeListener(t)}}),[e])}const ti=300;var ni=()=>n(638681);const ri=ni().object({required:{ai:ni().number(),business:ni().number(),education:ni().number(),personal:ni().number()},optional:{}}),oi=["business","personal","education","ai"];class ii{constructor(e){this.pageCategories=void 0,this.pageCategories=e}getCategoriesForPage(e){const t=[];for(const n of this.pageCategories)n.pattern.test(e)&&t.push(n.category);return t}async trackPageVisit(e){const t=this.getCategoriesForPage(e);0!==t.length&&await this.incrementPageVisitCount(t)}}function ai(e){try{ri.validator(e)}catch(t){return!1}for(const n of(0,te().uv)(e))if(!Number.isInteger(e[n])||e[n]<0||e[n]>9)return!1;return!0}function si(e){return!!(0,te().Xk)(oi,e)}const ci=[];class li extends ii{constructor(e){super(ci),this.DEFAULT_PAGE_VISIT_DATA=void 0,this.environment=void 0,this.environment=e,this.DEFAULT_PAGE_VISIT_DATA=(0,te().MU)(oi.map((e=>[e,0])))}async getPersonalizationData(){if("undefined"==typeof window)return{...this.DEFAULT_PAGE_VISIT_DATA};const e=await(0,K().getCookie)(this.environment,"notion_personalization");if(!e)return{...this.DEFAULT_PAGE_VISIT_DATA};const t=(0,k().$l)(e);return t&&ai(t)?t:{...this.DEFAULT_PAGE_VISIT_DATA}}async setPageVisitTrackerDataFromCrossOver(e){if("undefined"==typeof window)return;if(!ai(e))return;const t=await this.getPersonalizationData();for(const[n,r]of Object.entries(e))si(n)&&(e[n]=Math.max(r,t[n]));await this.setPageVisitTrackerData(e)}async setPageVisitTrackerData(e){if("undefined"==typeof window)return;const t={...await this.getPersonalizationData()};for(const[n,r]of Object.entries(e))si(n)&&(t[n]=(0,k().qE)(r,0,9));await(0,K().setCookie)(this.environment,{name:"notion_personalization",value:JSON.stringify(t)})}async incrementPageVisitCount(e){return Promise.resolve()}}function di(){const e=function(e){return new li(e)}((0,l().v3)());(0,r.useEffect)((()=>{const t=I;t&&e.setPageVisitTrackerDataFromCrossOver(t)}),[e])}const ui=Math.random()<.01&&!0;var pi=()=>n(253849),mi=()=>n(858038),fi=()=>n(855801),vi=()=>n(862292),gi=()=>n(852851);var hi=()=>n(482099);var bi=()=>n(250454);const Si=5e3,yi=Math.random()<.01&&!0;bi().I.setShouldCollect(yi);var wi=()=>n(352246);const _i=5e3;wi().t.setShouldCollect(!1);var ki=()=>n(755125);var Ai=()=>n(86159),Ii=()=>n(649642);function Ei(){const e=(0,l().v3)(),t=(0,r.useRef)("none"),n=(0,r.useCallback)((e=>{const n=t.current;e!==n&&(t.current=e,"dragging"===e?Ii().A.setState({isDragging:!0}):"dragging"===n&&Ii().A.setState({isDragging:!1}))}),[]),o=(0,r.useCallback)((()=>{"none"===t.current&&n("touching")}),[n]),i=(0,r.useCallback)((()=>{n("none")}),[n]),a=(0,r.useCallback)((()=>{"touching"===t.current&&Ai().isExpanded(Ai().get())&&n("dragging")}),[n]);(0,r.useEffect)((()=>{if(e.device.isIOS)return window.addEventListener("touchstart",o),window.addEventListener("touchend",i),window.addEventListener("touchcancel",i),document.addEventListener("selectionchange",a),()=>{window.removeEventListener("touchstart",o),window.removeEventListener("touchend",i),window.removeEventListener("touchcancel",i),document.removeEventListener("selectionchange",a)}}),[e.device.isIOS,o,i,a]);const s=(0,r.useCallback)((()=>{Zo().default.afterNextFlush((()=>{"empty"!==Nr().default.state.mode&&Nr().default.setState({...Nr().default.state,savedSelectionXPosition:void 0})}))}),[]),c=(0,r.useCallback)((()=>{setTimeout((()=>{Ai().get()||(0,ki().clear)({environment:e})}),0)}),[e]);(0,r.useEffect)((()=>(window.addEventListener("mousedown",s),e.device.isMobileBrowser&&document.addEventListener("focusout",c),()=>{window.removeEventListener("mousedown",s),document.removeEventListener("focusout",c)})),[e,s,c])}const Ci=window.matchMedia("(prefers-color-scheme: dark)");var Ti=()=>n(802149),Pi=()=>n(196286);const xi=!1,Li=(xi?1:10)*k().TD,Ri=5*Li;function Ui(...e){xi&&console.log(...e)}function Di(){(0,r.useEffect)((()=>{if(!window.BroadcastChannel)return;const e=(0,Ti().x0)(),t=new Map,n=new BroadcastChannel("notion_tab_tracker");n.onmessage=e=>{const n=e.data;"string"==typeof n&&t.set(n,Date.now())};const r=window.setInterval((()=>{(()=>{const e=[],n=Date.now();for(const[r,o]of t.entries())n-o>Ri&&e.push(r);e.length&&Ui("Removing tab ids:",e);for(const r of e)t.delete(r)})(),n.postMessage(e);const r=t.size+1;Ui("Tab count is",r),(0,Pi().g)(r)}),Li);return()=>{n.close(),window.clearInterval(r)}}),[])}var Mi=()=>n(857048);const Ni="loadCachedPageChunk";n(16280);const Oi=function(){const e=(0,l().v3)(),t=(0,r.useCallback)(((t,n)=>{(0,J().u)({environment:e,event:{eventName:"statsig_client_init_error",eventProperties:{statsig_init_method:"bootstrap",statsig_init_error:n}}}),Q().log({level:"error",from:"statsig",type:"initialize",error:(0,Y().convertErrorToLog)(t),data:{userId:e.currentUser.id}})}),[e]);(0,m().w)((()=>{void 0!==W().StatsigInitializer.statsigConfigFetch&&(0,J().u)({environment:e,event:{eventName:"statsig_config_file_fetch",eventProperties:{time:W().StatsigInitializer.statsigConfigFetch.durationMs,timed_out:!W().StatsigInitializer.statsigConfigFetch.success}}}),W().StatsigInitializer.initializePromise?W().StatsigInitializer.error?t(W().StatsigInitializer.error,"error"):W().StatsigInitializer.isComplete||t(new Error("`statsig.initialize` was not awaited on app bootstrap"),"incomplete"):t(new Error("`statsig.initialize` was not called on app bootstrap"),"uninitialized")}))};var ji=()=>n(763765),Bi=()=>n(386466);const qi=function(){const e=(0,l().v3)(),t=(0,r.useCallback)((t=>{(0,J().u)({environment:e,event:{eventName:"statsig_client_update_user_error",eventProperties:{statsig_init_method:"bootstrap"}}}),Q().log({level:"error",from:"statsig",type:"updateUser",error:(0,Y().convertErrorToLog)(t),data:{nextUserId:e.currentUser.id,err:(0,n(319625).A)(t).message}})}),[e]),[i]=(0,F().Yb)((async()=>await K().getExperimentDeviceId(e)),[e]),[a]=(0,F().Yb)((async()=>await K().getBrowserId(e)),[e]),s=(0,f().K8)((()=>{var e,t;return!(null===(e=o().default.state.currentUserStore)||void 0===e||!e.isDefined())&&!(null!==(t=o().default.state.currentUserStore)&&void 0!==t&&t.getOnboardingCompleted())}),[]),d=(0,f().K8)((()=>{var e;return null===(e=(0,U().S)())||void 0===e?void 0:e.isDefined()}),[]),u=(0,f().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]),p=(0,r.useRef)(W().StatsigInitializer.statsigStageTwoUser),m=(0,f().K8)((()=>{if("resolved"===i.status&&"resolved"===a.status&&(We().A.state.initialRenderCompleted||u)&&(!e.currentUser.id||d||s||u)){const o=n(546369).getDataForStatsigUser({environment:e,deviceId:i.value,browserId:a.value});if(void 0===o.subscriptionTier){var t;const e=null===(t=p.current)||void 0===t||null===(t=t.custom)||void 0===t?void 0:t.spaceSubscriptionTier;n(326215).nb.find((t=>t===e))&&(o.subscriptionTier=e)}if(void 0===o.country){var r;const e=null===(r=p.current)||void 0===r||null===(r=r.custom)||void 0===r?void 0:r.country;"string"==typeof e&&(o.country=e)}return(0,Bi().tX)({data:o,config:{env:"production"}})}}),[e,i,a,d,s,u],{useDeepEqual:!0}),v=(0,r.useRef)(0),h=!(0,f().O$)(Xe().e),b=(0,f().K8)((()=>{var e;return null===(e=n(105764).LX.getState())||void 0===e?void 0:e.isStatsigUserDiffDebuggingEnabled}),[]);(0,r.useEffect)((()=>{var r;const o=null===(r=(0,U().S)())||void 0===r?void 0:r.id;!async function(){if(W().StatsigInitializer.isComplete&&m&&!X().n4(m,p.current)&&!h){p.current=m,v.current++;try{ji().t.USEWITHCAUTION_markStatsigUserFetched({userId:m.userID,spaceId:o,fetched:!1});const t=await W().statsigClientLoader.getClient()||await W().statsigClientLoader.getUninitializedStatsigClient({statsigUser:m,initialValues:void 0,overrideStableID:(0,W().getOrCreateStableID)(),configFilePromise:W().StatsigInitializer.fetchConfigFilePromise(),storageProviderPromise:W().statsigClientLoader.getStorageProvider(e.device)}),r=async function(){var r,i,a,s,l,d,u;const p=(0,n(754704).createApiHttpJsonRequestOptions)({environment:e,eventName:"getStatsigResults",data:{...m.customIDs,device:(0,Bi().getDeviceAttributesForStatsigUser)(e.device),locale:g().locale,clientSdkApiKey:c().A.statsig.apiKey,spaceId:o,additionalUserAttributes:{spaceCreatedTime:null===(r=m.custom)||void 0===r?void 0:r.spaceCreatedTime,spaceCreatedDate:null===(i=m.custom)||void 0===i?void 0:i.spaceCreatedDate,subscriptionTier:null===(a=m.custom)||void 0===a?void 0:a.spaceSubscriptionTier,isSalesAssistedPlan:null===(s=m.custom)||void 0===s?void 0:s.isSalesAssistedPlan,spacePlanType:null===(l=m.custom)||void 0===l?void 0:l.spacePlanType,userSignupTime:null===(d=m.custom)||void 0===d?void 0:d.userSignupTime,domainType:null===(u=m.custom)||void 0===u?void 0:u.domainType}},activeUserId:e.currentUser.id,tracking:void 0,eventListeners:(0,n(998191).getPerformanceEventListeners)({eventName:"getStatsigResults",isPrefetchRequest:!0})}),f=await(0,uo().httpRequest)(p);"success"===f.type?(t.dataAdapter.setData(JSON.stringify(f.data.initialValues)),W().StatsigInitializer.currentUserDoNotUse=f.data.statsigUser,t.updateUserSync(f.data.statsigUser)):Q().log({level:"error",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsigAndServer",data:{message:"Unable to reach statsig and fallback failed",err:(0,uo().V4)(f),nextUserId:e.currentUser.id}})},i=async function(n){t.off("initialization_failure",i),Q().log({level:"info",from:"useUpdateStatsigData",type:"updateStatsigUser.failedToReachStatsig",data:{message:"Unable to reach statsig, trying to get latest values from server.",nextUserId:e.currentUser.id}}),await r()};t.dataAdapter.getDataSync(m)?(t.on("initialization_failure",i),await t.updateUserAsync(m)):await r()}catch(r){t(r)}v.current--,0===v.current&&(z().default.recomputeAllGroupStores(),Zo().default.afterNextFlush((()=>{ji().t.USEWITHCAUTION_markStatsigUserFetched({userId:m.userID,spaceId:o,fetched:!0})})))}}()}),[t,m,e,h,b])};var Wi=()=>n(106702),zi=()=>n(611648),Fi=()=>n(921676),$i=()=>n(911988),Ki=()=>n(201794);const Vi={MobileNativePerformanceListener:new(v().O2)("MobileNativePerformanceListener",(async()=>await n.e(62058).then(n.bind(n,252459))))},Hi=(0,v()._h)(Vi.MobileNativePerformanceListener,(e=>e.MobileNativePerformanceListener));var Gi=()=>n(524171),Ji=()=>n(172489),Zi=()=>n(906536),Qi=()=>n(960955),Xi=()=>n(584262),Yi=()=>n(243020),ea=()=>n(427704),ta=()=>n(343666),na=()=>n(245241);const ra=["compact","regular","unknown"];var oa=()=>n(671593),ia=()=>n(328523),aa=()=>n(518646),sa=()=>n(495262),ca=()=>n(254600),la=()=>n(274873),da=()=>n(840153),ua=()=>n(994877),pa=()=>n(744988),ma=()=>n(445560),fa=()=>n(723545),va=()=>n(654069),ga=()=>n(233124),ha=()=>n(748197),ba=()=>n(767537),Sa=()=>n(232930),ya=()=>n(613885),wa=()=>n(111379),_a=()=>n(634596),ka=()=>n(395361),Aa=()=>n(77311),Ia=()=>n(689355),Ea=()=>n(900442),Ca=()=>n(250452);var Ta=()=>n(246766),Pa=()=>n(618571);var xa=()=>n(645266),La=()=>n(541585),Ra=()=>n(209879);function Ua(e){const t=(0,sr().Xz)(e);switch(t.type){case"native":return;case"web":const e=t.route;switch(e.name){case"page":return e.collectionViewId?"collection":"page";case"nativeTab":switch(e.tab){case"updates":return"updates";case"assistant":return"assistant";case"trash":return"trash";case"members":return"members";case"help":return"help";case"templates":return"templates";case"offline":return"offline_settings"}break;default:return}}}var Da=()=>n(357307);var Ma=()=>n(644914);var Na=()=>n(371231),Oa=()=>n(376049),ja=()=>n(22472),Ba=()=>n(1130),qa=()=>n(179266),Wa=()=>n(129522),za=()=>n(975394),Fa=()=>n(291430),$a=()=>n(106628),Ka=()=>n(321874),Va=()=>n(440024),Ha=()=>n(518489),Ga=()=>n(206051),Ja=()=>n(599412),Za=()=>n(624307),Qa=()=>n(323914),Xa=()=>n(496067),Ya=()=>n(718807),es=()=>n(732797),ts=()=>n(529649),ns=()=>n(224701);const rs=X().Bj((async(e,t)=>(await $a().T.searchActions.load()).getLocalCacheFromAppState({environment:e})),((e,t)=>{var n;return`${e.currentUser.id}-${(null===(n=o().default.state.sidebarSpaceViewStore)||void 0===n?void 0:n.id)??"none"}-${t??"none"}`}));function os(e,t){const{mobileNative:r,TabbedRouterStore:i,device:a}=e();if(a.isMobileNative&&r){var s;r.updateReceiveApiHandlers({nativeToWebRenderStart:e=>{Gi().N.markNativeStart(e)},connectivityTypeChanged:e=>{Xe().A.setState({...Xe().A.state,mobileConnectivityType:e})},toggleAvailableOffline:t=>{const{pageId:n,operation:r}=t;ja().lX({store:new(fe().B)(e(),{table:fn().ev,id:n}),environment:e(),analyticsFrom:"mobile_home",operation:r})},statusBarTap:as,backButtonPress:()=>mr().N6(e(),{type:"backbutton"}),getLocalizedUrl:e=>[{value:{url:(0,Sa().x)(e.routeId)}}],keyboardWillShow:t=>{Na().m(e(),Qo().i.willShow,t??0)},keyboardDidShow:t=>{Na().m(e(),Qo().i.shown,t??0)},keyboardWillHide:()=>{Na().m(e(),Qo().i.willHide,0)},keyboardDidHide:()=>{Na().m(e(),Qo().i.hidden,0),a.isIpad&&((0,Va().I)({environment:e()}),Ea().A.clear(!0))},keyboardConfigChanged:e=>{Qo().A.updateKeyboardConfig(e.packageName,e.activeLocale)},safeAreaConfigChanged:t=>{(0,Ki().T)("supportsNativeSafeAreaConfig")?($i().U4.update((e=>({...e,supportsNativeSafeAreaConfig:!0,top:t.top,bottom:t.bottom,left:t.left,right:t.right}))),e().WindowSizeStore.updateWindowSize()):$i().U4.reset()},keyboardShortcut:t=>mr().N6(e(),t),nativeBottomBarDidChange:e=>{void 0!==e.height&&Qo().A.update((t=>t.lastUpdatedTimestamp&&e.timestamp&&e.timestamp<t.lastUpdatedTimestamp?t:{...t,nativeBottomBarHeight:e.height,lastUpdatedTimestamp:e.timestamp}))},pushNotificationTokenRefresh:t=>La().handleTokenRefresh(e(),t,"refresh"),resume:Ra().A.resume,pause:async()=>{Ra().A.pause();const{stopDictation:t}=await Zr().i.load();t({environment:e(),from:"native_action"})},refreshSubscriptionData:async t=>{await It().callApi({eventName:"invalidateSubscriptionData",environment:e(),data:{spaceId:t,provider:"revenue_cat"}});const n=(0,U().S)();n&&await ns().o2({environment:e(),spaceStore:n})},refreshSubscriptionDataV2:async()=>{const t=(0,U().S)();t&&await ns().o2({environment:e(),spaceStore:t})},processMobileActionBarAction:e=>{const{componentId:t,action:n}=e;r.componentEvents.dispatch("MobileActionBar",t,"onAction",{action:n})},logout:t=>{_a().Yq({environment:e(),userId:t,logoutOrigin:Yi().d.MobileNativeListener})},logoutV2:t=>{const{userId:n,fcmToken:r}=t;_a().Yq({environment:e(),userId:n,logoutOrigin:Yi().d.MobileNativeListener,fcmToken:r})},updateTranscriptionState:async t=>{var n;const{blockId:r,state:o}=t,i=e(),a=new(fe().B)(i,{table:fn().ev,id:r}),s=null===(n=a.getFormat())||void 0===n||null===(n=n.transcription_state)||void 0===n?void 0:n.state;if((0,fa().K)({environment:i,blockStore:a,state:o,from:"native_sync"}),"transcribing"===o.state&&"transcribing"!==s&&(0,ga().D_)(i,{dictation_session_id:o.session_id,block_id:r,transcription_started_from:"native_sync",has_audio_consent:!1,device_volume:void 0}),"recorded_audio_file_uploading"===o.state)try{await a.load();const e=(0,va().D)({environment:i,transcriptionBlockStore:a,tabType:"summary"});ha().c.setTabState(a.id,e.id)}catch(c){const e=c instanceof Error?c:new Error(String(c??"unknown error"));Q().log({level:"error",from:"MobileNativeListener.updateTranscriptionState",type:"transcriptionTabCreationFailed",error:e,data:{miscDataToConvertToString:{blockId:r,newState:o.state,tabType:"summary"}}})}ha().c.setLoadingState(r,!1)},focusMeetingNotesTab:async t=>{const{blockId:n,tab:r}=t,o=e(),i=new(fe().B)(o,{table:fn().ev,id:n});await i.load();const a=()=>{const e=i.getFormat();switch(r){case"summary":return null==e?void 0:e.transcription_summary_id;case"notes":return null==e?void 0:e.transcription_notes_id;case"transcript":return null==e?void 0:e.transcription_transcript_id}};await i.getFormatStore().waitUntil((()=>Boolean(a()))).catch((()=>{}));const s=a();s&&(await i.getContentStore().waitUntil((()=>i.getContentIds().includes(s))).catch((()=>{})),ha().c.setTabState(i.id,s))},logoutAll:()=>{_a().ri(e())},openDestinationV2:t=>{Qi().A.closeAll();const n=e(),r=(0,sr().Xz)(n.TabbedRouterStore.state),{activeTab:o,tabs:i}=n.TabbedRouterStore.state,a=r===i[o].rootPage,s="native"===r.type,c=a&&s;switch((0,cr().A)(n)&&(0,Fa().s)({environment:n,tab:n.TabbedRouterStore.state.activeTab,nativeRootPageOverrideEnabled:!1}),t.type){case"moveTo":const e=new(fe().B)(n,{table:fn().ev,id:t.blockId});(0,za().Y)({store:e,environment:n,pageVisitSource:Xi().y8.Move}),function(e,t){const n=new(fe().B)(t,{table:fn().ev,id:e});Oa().ho({environment:t,blocks:[n],moveToContext:"home_tab",onAccept:e=>{(0,za().Y)({store:n,environment:t,pageVisitSource:Xi().y8.Move})}})}(t.blockId,n);break;case"trash":ds({query:t.query});break;case"webSearch":!function(e,t){Ka()._N({environment:e,analyticsFrom:"mobile-bottom-bar",query:t}),ia().Mq(e,{itemName:"search",logging_source:"mobile_native"})}(n,t.query);break;case"templates":!function(e,t){us(e),xa().A.setState({open:!0,isFromNativeHome:!0,source:t.source})}(n,{source:t.source});break;case"AIAssistant":!function(e,t,n){ma().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:n.from??"search",shouldReset:Boolean(n.query&&n.query.trim().length>0)}))),(0,Ta().navigate)({environment:e,url:`${ea().GJ.nativeTab}/assistant`,redirect:t})}(n,c,{query:t.query,searchSessionId:t.searchSessionId,from:t.from});break;case"passkeySettings":const r=`${ea().GJ.nativeTab}/settings?addPasskey=true`;(0,Ta().navigate)({environment:n,url:r,redirect:!0});break;case"createOrJoinWorkspace":return cs(n,t.userId);case"createNewWorkspace":return ls(n,t.userId)}},openDestination:t=>{Qi().A.closeAll();const n=e();switch("closePopup"!==t&&(0,cr().A)(n)&&Boolean(n.TabbedRouterStore.state.tabs[n.TabbedRouterStore.state.activeTab].nativeRootPageOverrideEnabled)&&(0,Fa().s)({environment:n,tab:i.state.activeTab,nativeRootPageOverrideEnabled:!1}),t){case"addPage":us(n);break;case"allUpdates":!function(e){(0,Ki().T)("supportsNativeHome")&&e.device.isPhone?((0,Dr().T)({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),(0,Ta().navigate)({environment:e,url:`${ea().GJ.nativeTab}/updates`,redirect:!0})):pa().A.setState({...pa().A.state,open:!0})}(n);break;case"addAccount":!function(e){(0,Ta().navigate)({environment:e,url:ea().GJ.blank,redirect:!0}),Qa().c.setState({...Qa().c.state,open:!0})}(n);break;case"createOrJoinWorkspace":return cs(n);case"createNewWorkspace":return ls(n);case"notificationAndSettings":Za().A.setState({open:!0,source:Za().C.Home});break;case"trash":ds({});break;case"memberSettings":ts().A.setState({...ts().A.state,open:!0});break;case"help":es().r.setState({...es().r.state,open:!0,source:"mobileNative"});break;case"intercom_messages":!function(e){ua().SI({environment:e,from:"help_button"})}(n);break;case"aiWriter":!async function(e){(await ps()).handleAi(e)}(n)}},updateFileUploadProgress:e=>{const{uploadKey:t,progressPercent:n}=e,r=ba().default.getKeyState(t);r&&ba().default.setKeyState(t,{...r,progressPercent:n})},setCurrentUserId:async t=>{await ss(t,e())},setCurrentSpace:async t=>{await async function(e,t,n){const r=await da().T({environment:n,newCurrentUserId:e}),{currentUserRootStore:i,currentUserSettingsStore:a}=o().default.state;if(!i)return;await i.load();const s=(0,wa().k)(t);s&&await(0,ca().t)({environment:r,spaceViewStore:s,userSettingsStore:a,userRootStore:i,pageVisitSource:Xi().y8.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}(t.userId,t.spaceId,e())},updateHorizontalSizeClass:e=>{const t=(0,oa().tf)(ni().literals(...ra),e)?"unknown":e;t!==r.horizontalSizeClass.state&&r.horizontalSizeClass.setState(t)},updateTabbedRouterState:t=>{var n;const r=e(),{TabbedRouterStore:o}=r,i=o.state;if(t.tab!==i.activeTab||null!==(n=t.pages)&&void 0!==n&&n.length||!X().n4(t.modal,i.modal)||i.tabs[i.activeTab].pages.length){const n=t.navigationEffect;if(n&&"AIAssistant"===n.type)ma().X.update((e=>({query:n.query,searchSessionId:n.searchSessionId,from:"shortcut"===n.from?"search":n.from??"search",isFromShortcut:"shortcut"===n.from,shouldReset:Boolean(n.query&&n.query.trim().length>0)})));(0,Fa().s)({environment:e(),tab:t.tab,queryParams:t.queryParams,pages:t.pages,modal:t.modal,nativeRootPageOverrideEnabled:t.nativeRootPageOverrideEnabled,navigationAction:t.navigationAction,navigationSource:t.navigationSource})}else as();const a=o.state;return[{state:a,topPage:(0,sr().Xz)(a),webTransitionType:Ua(a),updateId:t.updateId??(0,vo().Ay)()}]},getLocalSearchResults:async t=>{const n=await rs(e(),t.searchSessionId);if(!n)return[{error:"Local cache does not exist"}];const r=(0,oa().tf)(na().gG,t.sort);if(r)return[{error:`old sort type is unsupported! ${r}`}];const o=t.sort,i=!Xe().A.state.online&&z().default.checkGate({gateName:"download_for_offline"}),a={...t.filters,isOfflineOnly:i},{searchAndRerankLocalPages:s}=await $a().T.search.load(),c=s({query:{query:{text:t.query??"",filters:a,sort:o},limit:t.limit},localCachedPages:n,includeRecordMap:!1,userId:e().currentUser.id,environment:e(),spaceStore:(0,U().S)()}),l=[{value:{total:0,results:[],recordMap:{},trackEventProperties:void 0}}];if(!c||0===c.results.length)return l;const d=Xe().A.state.online?(0,ya().k)(e(),c.results):c.results;return[{value:{results:d,total:d.length,recordMap:{},trackEventProperties:{}}}]},customAddCommentMenuItemTapped:async()=>{const t=await vi().T.formulas.load();(await ps()).handleComment(e(),"custom_add_comment_menu_item",t)},convertEnrichedMarkdownToBlocks:async t=>{try{const{convertEnrichedMarkdownToBlocks:r}=await Promise.all([n.e(35530),n.e(55373),n.e(36192),n.e(27992),n.e(63452),n.e(66249),n.e(87249),n.e(79022),n.e(34877),n.e(61165),n.e(16060),n.e(19972)]).then(n.bind(n,567552));return[r(e(),t.spaceId,t.userId,t.markdown)]}catch(r){return[{error:`Failed to convert enhanced markdown to blocks: ${r instanceof Error?r.message:"Unknown error"}`}]}},undoRevision:()=>{sa().tN({environment:e(),preventSelectText:!0})},searchTeams:async e=>{const{query:t}=e,n=(0,U().S)(),r=o().default.state.sidebarSpaceViewStore;if(!n||!r)return[{error:"SpaceStore or SpaceViewStore was undefined"}];const i=await $a().T.searchActions.load();return[{value:{ids:(await i.searchTeams({spaceViewStore:r,query:t,teamStores:(0,Nt().r)(r)})).map((e=>e.id))}}]},getImageBlockUrls:async t=>{var r;const{blockId:o,renderWidth:i}=t,a=null===(r=Wa().K.findBlockFromId(o))||void 0===r?void 0:r.getBlockStore();if(!a||"image"!==a.getType())return[{error:"blockId points to a non-image block"}];const s=a,{getEmbedSourceFromBlockStore:l}=await Promise.resolve().then(n.bind(n,347100)),d=l(s),u={isAuthenticated:!0,url:d,width:i,permissionRecord:s.pointer},p=e(),m=await(0,qa().L)(u,p);if(!m)return[{error:"could not get proxied image url"}];const f=0===m.indexOf("https:")?m:`${c().A.domainBaseUrl}${m}`;let v;return Xn()._J(d)&&(v=await(0,aa().k)(p,{url:d,download:!1,downloadName:"image",permissionRecord:s.pointer},!1,!1)),[{value:{previewUrl:f,originalUrl:v}}]},createMeetingNote:async t=>{const r=e(),{createMeetingNoteAndGetUrlWhenReady:o}=await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(14578),n.e(87017),n.e(49021),n.e(13131),n.e(29486)]).then(n.bind(n,533336)),i=await o({environment:r,from:(null==t?void 0:t.from)??"mobile_home_callout",title:null==t?void 0:t.title,pageVisitSource:null==t?void 0:t.pageVisitSource});if(!i)return[{error:"Could not create meeting notes page"}];if(null!=t&&t.autoStart){const{startTranscription:e}=await le().w.load(),t=new(fe().B)(r,{table:fn().ev,id:i.blockId});await e({environment:r,blockStore:t,from:"start",audioConsentEnabled:!0})}return[{value:{pageId:i.pageId,blockId:i.blockId,spaceId:i.spaceId,blockUrl:i.blockUrl}}]},dismissKeyboard:()=>{if(!(Ga().default.state.stores.length>0))return;if("editing"===Nr().default.state.mode&&Nr().default.state.multiSelection.start.store.table===ta().SN)return;const t=e();(0,Va().I)({environment:t}),(0,Ji().k)()},focusOnBlock:t=>{var n;const{blockId:r,position:o}=t,i=null===(n=Wa().K.findBlockFromId(r))||void 0===n?void 0:n.getBlockStore();if(!i)return;const a=i.getBlockTitleStore();if(!a)return;const s=e();(0,Ha().h)({environment:s,store:i});const c=void 0!==o?{startIndex:o,endIndex:o}:{startIndex:0,endIndex:0};(0,Zi().t)({store:a,selection:c})},webViewBoundsChanged:()=>{e().WindowSizeStore.updateWindowSize()},syncNativePageStates:t=>{const{states:n}=t,r=e(),o=r.currentUser.id;for(const e of n)"toggle"===e.type&&la().xT({environment:r,blockId:e.blockId,state:e.isExpanded,currentUserId:o,shouldNotSyncWithNative:!0})},evaluateCollectionFormula:async t=>{const r=e(),{evaluateFormulaFromNativeViewer:o}=await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(14578),n.e(87017),n.e(49021),n.e(13131),n.e(29486)]).then(n.bind(n,181348));return[{value:{results:await o(r,t)}}]},forceShowWebError:e=>{t(new Error(e.message))},runButtonBlockAction:e=>{var t;const{blockId:n}=e,r=Wa().K.findBlockFromId(n);if(!r)return;const o=null===(t=Wa().K.findBlockFromId(n))||void 0===t?void 0:t.getBlockStore();o&&"button"===o.getType()&&r&&"activate"in r&&"function"==typeof r.activate&&r.activate()}});const d=e().mobileNative;var l;if(null!=d&&null!==(s=d.api)&&void 0!==s&&s.ready)null==d||null===(l=d.api)||void 0===l||l.ready()}}function is(){const e=(0,l().v3)(),{device:t}=e,[n,i]=(0,r.useState)(null);(0,r.useEffect)((()=>os((()=>e),i)),[e]),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>(0,Da().Y)(e)),[e]);(0,r.useEffect)((()=>{var n;null===(n=e.mobileNative)||void 0===n||n.toggleBottomBar(t)}),[e.mobileNative,t])}(),function(){const{mobileNative:e}=(0,l().v3)(),t=(0,f().K8)((()=>{const{currentUserStore:e,sidebarSpaceStore:t}=o().default.state;if(!e||!t)return;const n=un().zD.isShowingQNAOnMobile();return{userId:e.id,spaceId:t.id,enabled:n}}),[]);(0,r.useEffect)((()=>{t&&(null==e||e.updateAiAssistantEnabledState(t))}),[e,t])}(),function(){const e=(0,l().v3)(),{mobileNative:t,WindowSizeStore:n}=e,o=(0,f().O$)(n),i=(0,f().K8)((()=>({visible:oo().sidebarExpandedStore.state&&!(0,Ma().o1)(e),width:(0,Ma().r6)(e)})),[e]);(0,r.useEffect)((()=>{null==t||t.sidebarVisibility(i.visible,i.width)}),[e,t,o,i])}(),function(){const e=(0,l().v3)(),{mobileNative:t,TabbedRouterStore:n}=e,{state:o,previousState:i}=(0,f().K8)((()=>({state:n.state,previousState:n.getPreviousState()})),[n]);(0,r.useEffect)((()=>{const n=null==t?void 0:t.api.handleTabbedRouterStateUpdate;if(n){if(n({state:o,topPage:(0,sr().Xz)(o),webTransitionType:Ua(o),updateId:(0,Wo().Ay)()}),!i)return;const t=(0,sr().WP)(i),r=(0,sr().WP)(o);X().n4(t,r)||ia().yY(e,{origin:t,destination:r,from:o.navigationSource,action:o.navigationAction,logging_source:"mobile_native"})}}),[e,t,o,i])}(),function(){const{mobileNative:e,RouterStore:t}=(0,l().v3)(),{isIOS:n}=(0,l().Y0)(),o=(0,r.useRef)(!1),i=(0,f().K8)((()=>"onboarding"===t.state.route.name),[t]);(0,r.useEffect)((()=>{n&&null!=e&&e.setWebViewAllowsNavigationGestures&&(i||oo().sidebarOpenStore.state||Fi().A.getPreventScrollType()!==zi().A.None?!1!==o.current&&(o.current=!1,e.setWebViewAllowsNavigationGestures(!1)):!0!==o.current&&(o.current=!0,e.setWebViewAllowsNavigationGestures(!0)))}),[n,i,e])}(),function(){const{mobileNative:e,TabbedRouterStore:t}=(0,l().v3)(),n=(0,f().K8)((()=>{var e;if(!(0,Ki().T)("supportsCustomAddCommentMenuItem"))return!1;const{currentUserStore:n}=o().default.state;if(!Boolean(null==n?void 0:n.id))return!1;if((0,Ki().T)("supportsNativeBottomBarOverlappingWebView")?Qi().A.hasOpenMobileSlideUps():Qi().A.hasOpenPopups())return!1;const r=(0,sr().Xz)(t.state),i="web"===r.type&&((null===(e=r.redirectedTo)||void 0===e?void 0:e.route)||r.route);if(!i||"page"!==i.name)return!1;const a=Nr().default.state;if("empty"===a.mode)return!1;const s=(0,Pr().ZS)({multiSelection:a.multiSelection,filterCommonAncestors:!0,focus:void 0});return!(!s||0===s.stores.length)&&s.stores.every((e=>e.canComment()))}),[t]);(0,r.useEffect)((()=>{(0,Ki().T)("supportsCustomAddCommentMenuItem")&&(null==e||e.updateCustomAddCommentMenuItemEnabled(n))}),[e,n])}(),function(){const{mobileNative:e}=(0,l().v3)(),t=(0,f().K8)((()=>{var e;return Boolean(null===(e=ve().ei.state)||void 0===e?void 0:e.isTranscriptionBlock())}),[]);(0,r.useEffect)((()=>{null==e||e.requestKeepScreenOn(t)}),[t,e])}(),function(){const e=(0,l().v3)(),{isMobileNative:t,isAndroid:n}=(0,l().Y0)(),{RouterStore:o}=e,i=(0,f().K8)((()=>{var e,r;if(!t||!n)return!1;if("page"!==o.state.route.name)return!1;if(Qo().A.state.phase!==Qo().i.hidden)return!1;if(Ia().A.state.open)return!1;if(Bn().A.state.open)return!1;if(Boolean(null===(e=Ea().A.state)||void 0===e?void 0:e.menu))return!1;const i=Nr().default.state,a="editing"===i.mode?i.multiSelection:void 0;if(a&&!(0,Aa().k)(a))return!1;const s=null==a||null===(r=a.start)||void 0===r?void 0:r.store;return!s||!(0,Ca().Le)(s)}),[o,n,t]),a=(0,ka().Y)(((e,t)=>{t&&(0,ki().clear)({environment:e})}),150);(0,r.useEffect)((()=>{a(e,i)}),[e,i,a])}(),function(){const e=(0,l().v3)(),{isMobileNative:t}=(0,l().Y0)(),n=(0,f().K8)((()=>{if(!t)return!1;const n=e.currentUser.id;if(!n)return!1;const r=o().AppStoreSidebarSpaceIdStore.state;if(!r)return!1;const i=Pa().zo.getWorkspaceAccessRestrictionForSpace({userId:n,spaceId:r});return void 0!==i&&(0,Pa().yQ)(i)}),[t,e.currentUser.id]);(0,r.useEffect)((()=>{n&&(0,Ta().navigate)({environment:e,url:ea().JZ.requiredSamlError,updateMobileTabbedRouterArgs:{clearNativeRootPageOverride:!0}})}),[e,n])}(),(0,r.useEffect)((()=>{t.isTablet&&oo().sidebarWidthStore.setState(300)}),[t]);const a=(0,r.useCallback)(((e,t=!1)=>{Object.keys(e.tabs).forEach((n=>{const r=n;t&&(e.tabs[r].nativeRootPageOverrideEnabled=void 0),r!==e.activeTab?e.tabs[r].pages=[]:e.tabs[r].pages=e.tabs[r].pages.slice(-1)}))}),[]),c=(0,r.useCallback)(((t,n)=>{var r;const{mobileNative:o,TabbedRouterStore:i,currentUser:s}=e,c=(0,U().S)(),l=null==c?void 0:c.id;if(null!=o&&null!==(r=o.api)&&void 0!==r&&r.setCurrentSpaceInfo&&(Q().log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"Web calling nativeAPI setCurrentSpaceInfo",spaceId:l}}),o.api.setCurrentSpaceInfo({spaceId:l,spaceViewId:null==t?void 0:t.id,userId:s.id,editable:(null==c?void 0:c.canEdit())??!0})),(0,cr().A)(e)){const e=e=>{if("web"!==e.type)return;const t={...e.queryParams},n=l&&(0,vo().Xw)(l);t.spaceId=n,e.queryParams=t,e.route.spaceId=n},t=X().mg(i.state);e(t.tabs.updates.rootPage),e(t.tabs.addPage.rootPage),void 0!==(null==n?void 0:n.id)&&a(t),i.setState(t)}rs(e,void 0)}),[a,e]),d=(0,r.useCallback)((t=>{var n;null!==(n=e.mobileNative)&&void 0!==n&&null!==(n=n.api)&&void 0!==n&&n.setCurrentUserInfo&&e.mobileNative.api.setCurrentUserInfo({userId:null==t?void 0:t.id,loggedInUserIds:e.currentUser.loggedInUserIds});const r=!(0,cr().A)(e)||void 0===e.currentUser.id,{TabbedRouterStore:o}=e,i=X().mg(o.state);a(i,r),o.setState(i)}),[a,e]),u=(0,Wi().$)(),p=(0,bt().ZC)(u);(0,r.useEffect)((()=>{(null==u?void 0:u.id)!==(null==p?void 0:p.id)&&d(u)}),[d,u,p,t.isMobileNative,e.mobileNative]);const m=(0,f().O$)(o().AppStoreSidebarSpaceViewStore),v=(0,bt().ZC)(m);(0,r.useEffect)((()=>{(null==m?void 0:m.id)!==(null==v?void 0:v.id)&&c(m,v)}),[c,m,v,t.isMobileNative,e.mobileNative]);const g=(0,s().X)("mab_debugging");if((0,F().Yb)((async()=>{(await ps()).updateDebugShouldShow(g)}),[g]),(0,r.useEffect)((()=>{if(n){const e=setTimeout((()=>{i(null)}),0);return()=>clearTimeout(e)}}),[n]),n)throw n;return(0,at.jsx)(Hi,{})}function as(){var e;if(Fi().A.getPreventScrollType()===zi().A.None)if(oo().sidebarOpenStore.state)Lr().A.SidebarMobileScroller&&(null===(e=Lr().A.SidebarMobileScroller.getNode())||void 0===e||e.scrollTo({top:0,behavior:"auto"}));else if(Lr().A.MenuScroller){var t;null===(t=Lr().A.MenuScroller.getNode())||void 0===t||t.scrollTo({top:0,behavior:"auto"})}else if(Lr().A.MenuPageScroller){var n;null===(n=Lr().A.MenuPageScroller.getNode())||void 0===n||n.scrollTo({top:0,behavior:"auto"})}else if(Lr().A.PageScroller){var r;null===(r=Lr().A.PageScroller.getNode())||void 0===r||r.scrollTo({top:0,behavior:"auto"})}}async function ss(e,t){return t.currentUser.id===e?t:await da().T({environment:t,newCurrentUserId:e})}async function cs(e,t){let n=e;t&&(n=await ss(t,e)),await Ba().createOrJoinSpace(n,"mobile_native_listener")}async function ls(e,t){let n=e;t&&(n=await ss(t,e)),await Ba().createOrJoinSpace(n,"mobile_native_listener_sidebar_switcher")}function ds(e){Xa().A.setState({open:!0});const{query:t}=e;t&&Ya().Ay.setState({...Ya().Ay.state,filter:t})}function us(e){(0,Ki().T)("supportsNativeHome")&&e.device.isPhone?((0,Dr().T)({RouterStore:e.RouterStore,currentUserId:e.currentUser.id}),(0,Ja().M)({environment:e,from:"mobile_bottom_bar",redirect:!0,quickAddParentOverride:{type:"space-private-pages"}})):(0,Ja().M)({environment:e,from:"mobile_bottom_bar"}),ia().Mq(e,{itemName:"add_page"})}async function ps(){return await Promise.all([n.e(46414),n.e(86477)]).then(n.bind(n,658012))}const ms=new(v().O2)("useReactiveMessageEventListener",(()=>n.e(38402).then(n.bind(n,485961))));function fs(e){const t=(0,l().v3)(),i=(0,s().X)("enable_early_space_store"),a=(0,Pe().V)(),v="on"===(0,Te().r)("lazier_ad_analytics_iframe",{enableEventTrailLogging:!0});return(0,m().l)((()=>{const{device:e,mobileNative:n}=t;if(!i){"/blank"===window.location.pathname&&(0,Ce().isPrewarmedTabLoadSidebarEnabled)()||o().default.setState(o().default.getInitialState())}if((0,T().f)(t),P().fD(t),n&&n.hideSplashscreen(),c().A.isMobile){const e=document.body.parentElement;e&&e.classList.add(h().Hw6)}v||y().hR({device:e,config:c().A,cookieService:t.cookieService}),C().g5({locale:g().locale,env:"production"}),(0,w().O8)(window.location.href),E(window.location.href)})),(0,hi().p)(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{yo().h.setAnalyticsSettingsFetcher(ko),(0,wo().E)(e)}),[e])}(),function(){const e=(0,l().v3)(),t=(0,l().Y0)();(0,r.useEffect)((()=>{if(t.isMobileNative)return;let n;document.hasFocus()&&(n=setInterval((()=>{q(e)}),B),q(e));const r=()=>{n&&clearInterval(n),n=setInterval((()=>{q(e)}),B),q(e)},o=()=>{n&&clearInterval(n),n=void 0};return window.addEventListener("focus",r),window.addEventListener("blur",o),()=>{n&&clearInterval(n),window.removeEventListener("focus",r),window.removeEventListener("blur",o)}}),[t.isMobileNative,e])}(),function(){const e=(0,r.useRef)(!1),t=(0,l().v3)(),n=(0,r.useCallback)((async e=>{if(e.currentUser.id&&Ct().fJ.size>0){const t=await It().callApi({eventName:"getTasks",environment:e,data:{taskIds:Array.from(Ct().fJ.values())}});if("success"===t.type){const{results:n}=t.data,r=new Set(Ct().fJ);for(const t of n)r.delete(t.id),t.status&&(0,Et().s)({environment:e,eventName:t.eventName,response:t.status,userId:e.currentUser.id}),Ct().u_.emit(t.id,t),Lt.emit(t.eventName,t),"failure"!==t.state&&"success"!==t.state&&"dead"!==t.state&&"timeout_before_execution"!==t.state||Ct().fJ.delete(t.id);if(r.size>0)for(const e of r.values())Ct().fJ.delete(e)}}}),[]),i=(0,f().K8)((()=>{var e;return null===(e=o().default.state)||void 0===e||null===(e=e.sidebarSpaceStore)||void 0===e?void 0:e.getSpaceId()}),[]),a=(0,r.useCallback)((async e=>{if(e.currentUser.id&&i){const t=await It().callApi({eventName:"getUserTasks",environment:e,data:{spaceId:i}});if("success"===t.type){for(const e of t.data.taskIds)Ct().fJ.add(e);t.data.taskIds.length>0&&n(e)}}}),[n,i]),s=(0,r.useCallback)((()=>{const n=Xe().A.state.online;n&&!e.current&&a(t),e.current=n}),[t,a]),c=(0,r.useCallback)((e=>{const t=xt.state||{},{[e]:n,...r}=t;xt.setState(Object.keys(r).length>0?r:void 0)}),[]),d=(0,r.useCallback)((e=>{var t;const n=null===(t=e.request.block)||void 0===t?void 0:t.id;if(n)if("success"===e.state){const t=e.status,r=null==t?void 0:t.continuationTask;if(null!=r&&r.scheduled&&t){Tt().A.setStatus(n,t);const e=xt.state||{};xt.setState({...e,[n]:t})}else Tt().A.setStatus(n,void 0),c(n)}else if("in_progress"===e.state||"not_started"===e.state){var r;const t=e.status,o=Tt().A.state.pageMap[n];if(null!=o&&null!==(r=o.continuationTask)&&void 0!==r&&r.scheduled){const e=o.continuationTask.resumesAt;(!e||e<=Date.now())&&t&&(Tt().A.setStatus(n,{importedNotes:t.importedNotes,totalNotes:t.totalNotes,continuationTask:void 0}),c(n))}else Tt().A.setStatus(n,t)}else Tt().A.setStatus(n,void 0),c(n)}),[c]);function u(e){var t;const n=null===(t=e.request.block)||void 0===t?void 0:t.id;n&&("success"===e.state?Pt().A.setStatus(n,!1):"in_progress"===e.state||"not_started"===e.state?Pt().A.setStatus(n,!0):Pt().A.setStatus(n,!1))}(0,r.useEffect)((()=>{e.current=Xe().A.state.online;const r=setInterval((()=>n(t)),2e3);a(t);const o=xt.state;if(o){const e=Date.now(),t={};for(const[n,r]of Object.entries(o)){var i;null!==(i=r.continuationTask)&&void 0!==i&&i.resumesAt&&r.continuationTask.resumesAt>e&&(Tt().A.setStatus(n,r),t[n]=r)}Object.keys(t).length!==Object.keys(o).length&&xt.setState(Object.keys(t).length>0?t:void 0)}return Xe().A.addListener(s),Lt.addListener(At().r,d),Lt.addListener(kt,u),()=>{clearInterval(r),Xe().A.removeListener(s),Lt.removeListener(At().r,d),Lt.removeListener(kt,u)}}),[t,n,s,d,a])}(),function(){const e=(0,l().v3)(),t=(0,s().X)("nds_high_contrast_mode"),n=(0,r.useCallback)((()=>{Rt().uh(e)}),[e]);(0,r.useEffect)((()=>(n(),Dt().A.addListener(n),()=>{Dt().A.removeListener(n)})),[n]);const i=(0,r.useCallback)((()=>{if(!t)return;const n=(0,Ut().Wu)(e);(0,Ut().OY)(n)}),[e,t]);(0,r.useEffect)((()=>{if(!t)return;i(),o().default.addListener(i);const n=window.matchMedia("(prefers-contrast: more)"),r=()=>{"auto"===(0,Ut().Wu)(e)&&(0,Ut().OY)("auto")};return n.addEventListener("change",r),()=>{o().default.removeListener(i),n.removeEventListener("change",r)}}),[e,i,t])}(),di(),qt(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{"external"===(0,mn().parseRoute)({url:window.location.href,isMobile:c().A.isMobile,baseUrl:c().A.domainBaseUrl,publicDomainName:c().A.publicDomainName,protocol:c().A.protocol,currentUrl:window.location.href}).name&&$t().ui({message:"Mismatch between origin and baseUrl (dev).",showCancel:!1,keepFocus:!1,items:[{label:(0,at.jsx)(et().sA,{defaultMessage:"OK",id:"notionAppContainer.dialog.mismatchedOriginURL.okayButton.label"}),onAccept:()=>{const e=_().pf({relativeUrl:_().ZO(window.location.href),baseUrl:c().A.domainBaseUrl}),t=_().qg(e);t.protocol=_().qg(window.location.href).protocol,window.location.href=_().GP(t)}}]})}),[e])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{_n(e);const t=window.setInterval((()=>_n(e)),An);return()=>window.clearInterval(t)}),[e])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{(0,In().setEnvironment)(e)}),[e])}(),Qn(),pr(),(0,r.useEffect)((()=>{po();const e=window.setInterval((()=>po()),k().pT);return()=>window.clearInterval(e)}),[]),ho(),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>_o().default.state.isLoaded),[]),n=(0,f().K8)((()=>_o().default.state.isLoggingEnabled),[]);(0,r.useEffect)((()=>{t&&async function(){const t=await(0,Io().T)(e);await Ao().n_({config:c().A,isEnabled:n,deviceId:t,cookieService:e.cookieService,endpoint:_o().default.state.endpoint})}()}),[e,t,n])}(),(0,d().A)(),(0,Eo().A)(),Mo(),Go(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{if(c().A.isMobile){function t(){Zo().default.afterNextFlush((()=>{(0,Xo().p)(e)}))}return Nr().default.addListener(t),Yo.addListener(t),Qo().A.addListener(t),()=>{Nr().default.removeListener(t),Yo.removeListener(t),Qo().A.addListener(t)}}}),[e])}(),(0,u().z)(),(0,p().Ay)(),function(){const[{value:e}]=(0,F().Yb)((()=>W().statsigClientLoader.getClient()),[]),t=(0,f().O$)(Xe().e);(0,r.useEffect)((()=>{e&&(t?e.updateRuntimeOptions({disableLogging:!1}):e.updateRuntimeOptions({disableLogging:!0}))}),[e,t])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{if(!bi().I.getShouldCollect())return;const t=setInterval((()=>{bi().I.getLongEventMetrics().forEach((t=>{(0,J().u)({environment:e,event:t})})),bi().I.resetMetrics()}),Si);return()=>clearInterval(t)}),[e])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{if(!wi().t.getShouldCollect())return;const t=setInterval((()=>{wi().t.getMetrics().forEach((t=>{(0,J().u)({environment:e,event:t})})),wi().t.resetMetrics()}),_i);return()=>{clearInterval(t),wi().t.resetMetrics()}}),[e])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{const{mobileNative:t}=e;t&&t.enableBridgeMetricsCollection(e,b().default,z().default)}),[e])}(),ei(),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>"blank"===e.RouterStore.state.route.name),[e.RouterStore]);(0,r.useEffect)((()=>{if(t)return;let n,r=!document.hidden;function o(){e.device.isElectron||Ft().A.setState({...Ft().A.state,isVisible:!document.hidden});const t=!document.hidden;t!==r&&(r=t,Ft().P.setState(t),clearTimeout(n),t&&(n=setTimeout((()=>{Ft().P.setState(!1)}),ti)));const o=Ht().K7(),i=o&&(Date.now()-o)/k().nD>=7;if(e.device.isBrowser&&!document.hidden&&(!o||i)&&Xe().A.getState().online){const t=e.AppUpdateStore;if(t.isSilentUpdate()){const n=t.state.appUpdate;Ht().JG({environment:e,url:window.location.href,version:n.version,versionCreatedTime:n.versionCreatedTime})}}}return document.addEventListener("visibilitychange",o),o(),()=>{document.removeEventListener("visibilitychange",o)}}),[e,t])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{if(!ui||e.device.isIOS)return;let t,r=!1;return(async()=>{try{const{initializePerformanceObserver:o}=await n.e(36773).then(n.bind(n,912287));if(r)return;t=o(e)}catch(o){}})(),()=>{var e;r=!0,null===(e=t)||void 0===e||e()}}),[e])}(),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>"blank"===e.RouterStore.state.route.name),[e]),n="on"===(0,Te().r)("prewarm_prefetch_more",{enableEventTrailLogging:!0});(0,r.useEffect)((()=>{t&&n&&(pi().H.load(),mi().U.load(),gi().p.load(),fi().VI.duplicateActions.load(!0),vi().T.formulas.load())}),[t,n])}(),function(){const{WasmSqlite:e,ElectronSqlite:t}=(0,l().v3)(),n=e||t||void 0,o=(0,f().O$)(Xe().e),i=(0,s().X)("recover_from_sqlite_corruption");(0,r.useEffect)((()=>{n&&(i&&o?n.enableCorruptionRepair():n.disableCorruptionRepair())}),[n,i,o])}(),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>bn().z.state.pendingPages),[]);(0,r.useEffect)((()=>{if(0===t.size)return;const n=async t=>{const{pageId:n,spaceId:r,localRole:o}=t;try{const t={table:fn().ev,id:n,spaceId:r};await gn().BB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:t,userId:e.currentUser.id});const i=e.defaultRecordCache.inMemoryRecordCache.getRole({pointer:t,userId:e.currentUser.id});if(o===i)return;Q().log({level:"info",from:"useCheckRemotePageRoleForCachedPage",type:"roleMismatchDetected",data:{miscDataToConvertToString:{pageId:n,localRole:o,serverRole:i}}});const a=e.currentUser.id,s=(0,Sn().getOPFSPageCacheInstance)();a&&s&&await s.delete(a,n);const l=await hn().Vn({environment:e,request:{page:{id:n,spaceId:r??""},verticalColumns:c().A.isMobile},abortSignal:void 0,prefetchCacheKey:void 0,headers:{}});if("success"!==l.type)throw l.error;let d=l.data.cursors.filter((e=>!(0,yn().ys)(e)));for(;d.length>0;)d=(await vn().lX(d,10,(async t=>{const o=await hn().Vn({environment:e,request:{page:{id:n,spaceId:r??""},cursor:t,verticalColumns:c().A.isMobile},abortSignal:void 0,prefetchCacheKey:void 0,headers:{}});return"success"!==o.type?{cursors:[]}:o.data}))).flatMap((e=>(e.cursors??[]).filter((e=>!(0,yn().ys)(e)))))}catch(i){Q().log({level:"info",from:"useCheckRemotePageRoleForCachedPage",type:"roleMismatchCheckFailed",data:{miscDataToConvertToString:{pageId:n}},error:(0,Y().convertErrorToLog)(i)})}finally{bn().z.markPageComplete(n)}},r=bn().z.consumePendingPages();for(const e of r)n(e)}),[e,t])}(),function(){const{deviceType:e}=(0,l().Y0)(),t=(0,l().v3)(),n=t.currentUser.isLoggedIn();(0,r.useEffect)((()=>{if(!n)return;if("windows-desktop"!==e&&"mac-desktop"!==e)return;const r=async()=>{await(0,ne().a)()&&It().callApi({eventName:"registerDesktopApp",environment:t,data:{deviceType:e}})};r();const o=window.setInterval((()=>{r()}),5*k().Xb);return()=>{window.clearInterval(o)}}),[n,e,t])}(),Di(),function(){const e=(0,l().v3)(),t=(0,r.useRef)(),n=(0,r.useRef)();(0,r.useEffect)((()=>{function r(){const r=Nr().default.state,o="empty"===r.mode?void 0:r.multiSelection.start.store,i="empty"===r.mode?void 0:r.multiSelection.end.store;if(t.current===o&&n.current===i)return;if(t.current=o,n.current=i,t.current!==n.current)return;const a=Mi().wg();if(!a)return;const{rowIndex:s,columnIndex:c,simpleTableStore:l}=a.getProps();Mi().VC({environment:e,rowIndex:s,columnIndex:c,simpleTableStore:l})}return Nr().default.addListener(r),()=>{Nr().default.removeListener(r),t.current=void 0,n.current=void 0}}))}(),function(){const e=(0,l().v3)(),t=(0,r.useCallback)((t=>{var n,r;const i={compressed:t.decodedBodySize!==t.encodedBodySize,local_cache_hit:0===t.transferSize,next_hop_protocol:t.nextHopProtocol,did_prefetch:"hit-match"===(null===(n=e.prefetcher.cache.getPrefetchAnalytic(`loadCachedPageChunk(${null===(r=o().default.state.mainEditorCurrentBlockStore)||void 0===r?void 0:r.id})`))||void 0===n?void 0:n.type)},a={dns_lookup:{startTime:t.domainLookupStart,endTime:t.domainLookupEnd},connection_establish:{startTime:t.connectStart,endTime:t.connectEnd},request_queued:{startTime:t.connectEnd,endTime:t.requestStart},response_wait:{startTime:t.requestStart,endTime:t.responseStart},response_download:{startTime:t.responseStart,endTime:t.responseEnd}};b().default.DO_NOT_USE_measureLegacy({metricName:"load_cached_page_chunk.fetch",startTime:t.fetchStart,endTime:t.responseEnd},{environment:e,data:{...i,sub_metrics:{dns_lookup:a.dns_lookup.endTime-a.dns_lookup.startTime,connection_establish:a.connection_establish.endTime-a.connection_establish.startTime,request_queued:a.request_queued.endTime-a.request_queued.startTime,response_wait:a.response_wait.endTime-a.response_wait.startTime,response_download:a.response_download.endTime-a.response_download.startTime}}});for(const[o,{startTime:s,endTime:c}]of Object.entries(a))b().default.DO_NOT_USE_measureLegacy({metricName:`load_cached_page_chunk.fetch.${o}`,startTime:s,endTime:c},{environment:e,data:i})}),[e]);(0,r.useEffect)((()=>{const e=new PerformanceObserver((n=>{const r=n.getEntries().find((e=>e.name.includes(`${c().A.api.http}/${Ni}`)&&!e.name.endsWith("s")));r&&("resource"===r.entryType&&t(r),null==e||e.disconnect())}));return e.observe({type:"resource",buffered:!0}),()=>{e.disconnect()}}),[t])}(),Oi(),function(){const e=(0,l().v3)(),t=(0,s().X)("transactions_api_fewer_roundtrips");(0,r.useEffect)((()=>{function n({state:n}){"flushCompleted"===n.status&&b().default.measure({metricName:n.wentBackOnlineFromOffline?"transaction_queue_flush.from_offline_to_online":"transaction_queue_flush.online",startTime:n.startTime},{environment:e,data:{items_flushed:n.itemsFlushed,retryable_error_responses:n.retryableErrorResponses,failed_error_responses:n.failedErrorResponses,all_error_responses:n.retryableErrorResponses+n.failedErrorResponses,transactions_api_fewer_roundtrips:t}})}return S().R.addListener(n),()=>{S().R.removeListener(n)}}),[e,t])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{const t=()=>ke().updateConnectionState(e);return t(),Xe().A.addListener(t),()=>{Xe().A.removeListener(t)}}),[e])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{e.defaultRecordCache.persistedRecordCache&&e.defaultRecordCache.persistedRecordCache.setEnvironment(e)}),[e])}(),function(){const e=(0,r.useRef)(!1),t=(0,Pe().V)(),n=(0,l().v3)();(0,r.useEffect)((()=>{if(e.current||t)return;if(!(0,wt().isBootWasmSqliteLaterEnabled)())return;e.current=!0;const{device:r,currentUser:o,defaultRecordCache:i}=n,a=o.id,s=_t().u.maybeCreateInstance({device:r,currentUserId:a});if(!s)return;const c=new(yt().m)({connection:s.sqliteConnection,maxSize:r.isDesktop?1e6:1e5,getEnvironment:()=>n});i.enablePersistedRecordCache(c),s.waitForInitialize().catch((()=>{(0,W().aH)({gateName:"recover_from_sqlite_corruption"})||i.disablePersistedRecordCache()}))}),[t,n])}(),Ei(),St(),st(),function(){const e=(0,l().v3)(),t=(0,l().Y0)(),n=(0,r.useRef)(!1),i=(0,r.useCallback)((()=>{"system"===Rt().lv()&&Dt().A.emit()}),[]),a=(0,f().K8)((()=>{var e;return null===(e=o().default.state.mainEditorCurrentBlockStore)||void 0===e?void 0:e.isReady()}),[]);(0,r.useLayoutEffect)((()=>{!n.current&&a&&(i(),n.current=!0)}),[a,i]),(0,r.useEffect)((()=>{if(t.isAndroid&&e.mobileNative)e.mobileNative.updateReceiveApiHandlers({themeChanged:e=>i()});else{if(Ci.addEventListener&&Ci.removeEventListener)return Ci.addEventListener("change",i),()=>{Ci.removeEventListener("change",i)};if(Ci.addListener&&Ci.removeListener)return Ci.addListener(i),()=>{Ci.removeListener(i)}}}),[t.isAndroid,e,i])}(),qi(),pt(),function(){const e=(0,f().O$)(Xe().e);(0,r.useEffect)((()=>{ut().OPFSBootupRegistry.updateIsOnline(e)}),[e])}(),V("query_client","control"),V("prewarm_wasm_sqlite_worker","control"),V("prewarmed_tab_load_sidebar_exp","control"),function(){const e=(0,l().v3)(),t=(0,f().K8)((()=>{var e;return null===(e=(0,U().S)())||void 0===e?void 0:e.id}),[]),n=(0,Pe().V)(),o=(0,f().K8)((()=>un().zD.getIsInitialized()),[]),i=(0,f().K8)((()=>un().zD.isAvailableModelsStorePrefetchEnabled()),[]);(0,r.useEffect)((()=>{n||o&&i&&t&&pn().P.getData(e,{spaceId:t})}),[e,t,n,i,o])}(),function(){const e=(0,l().v3)();(0,r.useEffect)((()=>{$().U.setOnQuotaExceededError((function(t,n,r,o){(0,J().u)({environment:e,event:{eventName:"localstorage_quota_exceeded",eventProperties:{attempted_key:t,attempted_key_size:n,num_keys:r,keys_with_sizes:o}}})}))}),[e])}(),(0,at.jsxs)(at.Fragment,{children:[c().A.isMobile?(0,at.jsx)(is,{}):void 0,!c().A.isMobile&&t.device.isElectron?(0,at.jsx)(hs,{}):void 0,a?void 0:(0,at.jsx)(vs,{isLazierAdAnalyticsEnabled:v})]})}function vs({isLazierAdAnalyticsEnabled:e}){var t;const n=(0,l().v3)(),i=(0,mt().kg)();return rn(),Do(),Be(),Ke(),Ge(),function(){const e=(0,l().v3)(),t=(0,f().O$)(Xe().e),n=(0,ct().T)(),o=(0,qe().r)();(0,r.useEffect)((()=>{const r=(0,lt().bB)();if(!(r&&n&&o&&t))return;let i=null;const a=new AbortController,s=a.signal,c=()=>{r.cleanCacheForUser({userId:n,spaceId:o,environment:e,waitUntilOpts:{signal:s,timeout:ee().Xb}}).catch((e=>{Q().log({level:"error",from:"cleanCachePeriodically",type:"errorCleaningCache",error:(0,Y().convertErrorToLog)(e)})})).finally((()=>{s.aborted||(i=setTimeout((()=>{i=null,s.aborted||c()}),dt))}))};return c(),()=>{a.abort(),i&&(clearTimeout(i),i=null)}}),[n,o,t,e])}(),function(){const e=en((0,l().v3)()),t=(0,s().X)("service_worker_in_browser"),n=(0,s().X)("disable_service_worker_in_browser");(0,r.useEffect)((()=>{e&&t&&navigator.serviceWorker.register("/sw.js").then((e=>{var t;null===(t=e.active)||void 0===t||t.postMessage({type:Yt})}))}),[e,t]),(0,r.useEffect)((()=>{var t;e&&n&&(navigator.serviceWorker.getRegistration().then((e=>{null==e||e.unregister()})),null===(t=self.caches)||void 0===t||t.open(Xt().BROWSER_SW_VERSION_CACHE_NAME).then((e=>{null==e||e.delete(Xt().BROWSER_SW_VERSION_CACHE_PATH),null==e||e.delete(Xt().BROWSER_SW_VERSION_CACHE_MIGRATION_VERSION_PATH)})))}),[e,t,n]),(0,r.useEffect)((()=>{if(!e||!t)return;const n=e=>{var t;"service-worker-fetch-error"===(null===(t=e.data)||void 0===t?void 0:t.type)&&Q().log({level:"error",from:"useRegisterBrowserServiceWorker",type:"browserServiceWorkerFetchError",error:e.data.error})},r=()=>{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then((e=>{var t;null==e||null===(t=e.active)||void 0===t||t.postMessage({type:Yt})}))};return"serviceWorker"in navigator&&(navigator.serviceWorker.addEventListener("message",n),navigator.serviceWorker.addEventListener("controllerchange",r)),()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.removeEventListener("message",n),navigator.serviceWorker.removeEventListener("controllerchange",r))}}),[e,t])}(),(0,r.useEffect)((()=>{function e(e){}return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[!1]),function(){const e=(0,s().X)("enable_jam_recording_links"),t=(0,v().fJ)(Re,{disabled:!e}),n=(0,f().K8)((()=>Ue().I.state.recordingLinkId),[]);r.useEffect((()=>{if(!e)return;const{status:r,value:o}=t;"resolved"===r&&o&&!o.isInitialized()&&o.initialize({teamId:"b729e17e-7abd-4cc6-a15f-256d0eceb210",openImmediately:n})}),[t,n,e])}(),function(){const e=(0,l().v3)(),t=(0,r.useRef)(!1);(0,r.useEffect)((()=>{var n;if(t.current)return;const r=o().default.state.currentUserSettingsStore;if(!r)return;t.current=!0;const i=O().K.get({userId:e.currentUser.id,key:Ae().XK});if(!i)return;const a=(0,Ee().a)(i);if(!a)return void O().K.remove({userId:e.currentUser.id,key:Ae().XK});const s=null===(n=r.getSettings())||void 0===n?void 0:n.preferred_meeting_notes_language;if(s)return void(0,Ie().p)({userId:e.currentUser.id,from:"useMigrateDictationLanguageOnMount",additionalLogData:{existingUserSettingsLanguage:s,reason:"cleanupAfterMigration"}});const{serverCommitResult:c}=ke().createAndCommit({userAction:"migrateDictationLanguageToUserSettings",environment:e,canUndo:!1,perform:e=>{(0,_e().m)({userSettingsStore:r,transaction:e,data:{preferred_meeting_notes_language:a}})}});c.then((()=>{(0,Ie().p)({userId:e.currentUser.id,from:"useMigrateDictationLanguageOnMount",additionalLogData:{migratedLanguage:a,reason:"migrationSuccess"}})})).catch((t=>{Q().log({level:"error",from:"useMigrateDictationLanguageOnMount",type:"migrationFailed",error:(0,Y().convertErrorToLog)(t),data:{miscDataToConvertToString:{userId:e.currentUser.id,attemptedLanguage:a}}})}))}),[e])}(),(0,m().w)((()=>{e&&y().hR({device:n.device,config:c().A,cookieService:n.cookieService})})),(0,at.jsxs)(at.Fragment,{children:[!c().A.isMobile&&n.device.isElectron?(0,at.jsxs)(at.Fragment,{children:[(0,at.jsx)(bs,{}),(0,at.jsx)(Ze().gE,{}),(0,at.jsx)(As,{dependency:Qe().W,hook:({useOfflineTransitionTracking:e})=>e}),(0,at.jsx)(As,{dependency:ws,hook:({useCalendarMeetingNotificationScheduler:e})=>e})]}):void 0,c().A.isMobile?void 0:(0,at.jsx)(L,{}),!c().A.isMobile&&i?(0,at.jsx)(Ss,{}):void 0,c().A.isMobile||null!==(t=n.mobileNative)&&void 0!==t&&t.supportsNativeHomeOnPhone()?void 0:(0,at.jsx)(As,{dependency:Qe().W,hook:({useCacheSidebarImages:e})=>e}),(0,at.jsx)(As,{dependency:Qe().W,hook:({useFetchImportantPagesAfterSqliteCorruptionRecovery:e})=>e}),c().A.isMobile?void 0:(0,at.jsx)(ht,{}),(0,at.jsx)(gs,{}),(0,at.jsx)(G,{}),(0,at.jsx)(Le,{}),(0,at.jsx)(As,{dependency:ks,hook:({useRecentEventsListener:e})=>e}),(0,at.jsx)(As,{dependency:ms,hook:({useReactiveMessageEventListener:e})=>e}),(0,at.jsx)(As,{dependency:ys,hook:({useMeetingKeywordToast:e})=>e}),(0,at.jsx)(As,{dependency:Qe().W,hook:({useUpdateAutosyncedPages:e})=>e}),(0,at.jsx)(As,{dependency:Qe().W,hook:({useRefetchOfflinePages:e})=>e}),(0,at.jsx)(As,{dependency:_s,hook:({useUserLifecycleProfile:e})=>e})]})}function gs(){return(0,De().y)()?(0,at.jsx)(a().K,{from:"OfflineSyncListeners",fallback:()=>null,children:(0,at.jsx)(As,{dependency:Qe().W,hook:({usePageSubscriptionManager:e})=>e})}):null}function hs(){return lo(),null}function bs(){const e=(0,f().K8)((()=>i().A.state.isActiveTab),[]);return(0,s().X)("meeting_detection_debounced_processing")?(0,at.jsx)(be,{isActiveTab:e??!1}):(0,at.jsx)(we,{isActiveTab:e??!1})}function Ss(){return(0,mt().a1)(),null}const ys=new(v().O2)("useMeetingKeywordToast",(()=>n.e(28156).then(n.bind(n,25842)))),ws=new(v().O2)("useCalendarMeetingNotificationScheduler",(()=>Promise.all([n.e(35530),n.e(9773),n.e(55373),n.e(36192),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(40992),n.e(88455),n.e(49021),n.e(71136),n.e(86341),n.e(13131),n.e(31034)]).then(n.bind(n,503571)))),_s=new(v().O2)("useUserLifecycleProfile",(()=>n.e(2302).then(n.bind(n,770208)))),ks=new(v().O2)("useRecentEventsListener",(()=>n.e(88738).then(n.bind(n,569313))));function As(e){const{value:t}=(0,v().fJ)(e.dependency);return t?(0,at.jsx)(Is,{hook:e.hook(t)}):null}function Is(e){return e.hook(),null}},652393:(e,t,n)=>{n.r(t),n.d(t,{initialize:()=>s});var r=()=>n(726637),o=()=>n(86846),i=()=>n(884268),a=()=>n(165358);function s(e){"object"==typeof r().A&&r().A.version&&(a().clientLogglyEnvironmentData.version=r().A.version);const{device:t,currentUser:n}=e;t.isMobileNative&&(a().clientLogglyEnvironmentData.isMobileNative=!0),r().A.isMobile&&(a().clientLogglyEnvironmentData.isMobile=!0),t.isAndroid&&(a().clientLogglyEnvironmentData.isAndroid=!0),t.isIOS&&(a().clientLogglyEnvironmentData.isIOS=!0),t.isElectron&&(a().clientLogglyEnvironmentData.isElectron=!0),t.isChromeExtension&&(a().clientLogglyEnvironmentData.isChromeExtension=!0),a().clientLogglyEnvironmentData.os=t.os,a().clientLogglyEnvironmentData.platform=t.platform,window.navigator.userAgent&&(a().clientLogglyEnvironmentData.userAgent=window.navigator.userAgent),document.referrer&&(a().clientLogglyEnvironmentData.referrer=document.referrer),n.id&&(a().clientLogglyEnvironmentData.userId=n.id),a().clientLogglyEnvironmentData.is_experimental_build=r().A.buildTarget===i().w6,a().clientLogglyEnvironmentData.is_mobile_build=r().A.buildTarget===i()._j,(0,o().x)().then((e=>{e&&(a().clientLogglyEnvironmentData.storageUsageEstimate=e.usage,a().clientLogglyEnvironmentData.storageQuotaEstimate=e.quota)}))}},654069:(e,t,n)=>{n.d(t,{D:()=>l});var r=()=>n(534177),o=()=>n(896628),i=()=>n(44729),a=()=>n(384944),s=()=>n(244828),c=()=>n(192359);function l(e){const{environment:t,transcriptionBlockStore:n,tabType:l,withTextBlock:d}=e,u=(0,c().y1)(n,l);if(u)return u;const{performResult:p}=s().createAndCommit({userAction:`transcriptionBlockTabActions.getOrCreateTranscriptionTabBlockStore.${l}`,environment:t,perform:e=>{const s=a().Wv({environment:t,type:"text",inMemoryRecordCache:n.inMemoryRecordCache,transaction:e});if("summary"===l?i().Ti({transaction:e,parentStore:n,childStore:s}):i().NI({transaction:e,parentStore:n,childStore:s}),"transcript"===l&&d){const r=a().Wv({environment:t,type:"text",inMemoryRecordCache:n.inMemoryRecordCache,transaction:e});i().NI({transaction:e,parentStore:s,childStore:r})}let c;return"summary"===l?c={transcription_summary_id:s.id}:"transcript"===l?c={transcription_transcript_id:s.id}:(0,r().HB)(l),o().zA({transaction:e,stores:[n],update:c}),s},canUndo:!1});return p}},682497:(e,t,n)=>{n.d(t,{o:()=>i});var r=()=>n(79926);const o=new(r().O2)("PageError",(async()=>Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(49418),n.e(5331),n.e(89696),n.e(66960)]).then(n.bind(n,927150)))),i=(0,r()._h)(o,(e=>e.PageError))},710144:(e,t,n)=>{n.d(t,{O:()=>a});var r=n(296540),o=()=>n(242422),i=()=>n(590526);function a(e){const[t,n]=(0,r.useState)(!1);(0,r.useEffect)((()=>{o().default.waitUntilStatsigReadyAsync().then((()=>{n(!0)}))}),[]);const a=(0,i().K8)((()=>t&&o().default.checkGate({gateName:e})),[t,e]);return{isStatsigReady:t,isFeatureEnabled:a}}},737022:(e,t,n)=>{n.d(t,{i:()=>r});const r=new(n(79926).O2)("transcriptionNotificationActions",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,632176))))},750468:(e,t,n)=>{n.d(t,{A:()=>b,k:()=>v});n(944114),n(898992),n(354520),n(803949),n(581454);var r=n(296540),o=()=>n(792057),i=()=>n(467947),a=()=>n(550368),s=()=>n(396896),c=()=>n(406094),l=()=>n(663639),d=()=>n(736847),u=()=>n(69708),p=()=>n(100622),m=()=>n(132389),f=n(474848);const v=9999999;function g({items:e,selectType:t,selectAlignXAxis:n,selectedKeys:r,setSelectedKeys:o}){const i=e.map(((i,a)=>{const s=i.key;return(0,f.jsx)(h,{text:i.text,description:i.description,selected:r[s]??!1,isBelowButtons:Boolean(i.showBelowButtons),isLastItem:a===e.length-1,onSelect:e=>{var n;null===(n=i.onSelect)||void 0===n||n.call(i,e),o("radio"===t?e=>{const t={...e};return Object.keys(t).forEach((e=>{t[e]=e===i.key})),t}:t=>({...t,[s]:e}))},selectType:t,selectAlignXAxis:n},s)}));return(0,f.jsxs)(s().VP,{children:[(0,f.jsx)(m().A,{size:5}),i]})}function h({text:e,description:t,selected:n,onSelect:o,isBelowButtons:i,selectType:s="checkbox",selectAlignXAxis:c,isLastItem:l}){const d=(0,r.useCallback)((()=>{"radio"===s?null==o||o(!0):null==o||o(!n)}),[s,o,n]);return(0,f.jsx)(a().a,{label:e,description:t,isSelected:n,value:"select_item",width:i?"hug":"fill",colorVariant:i?"secondary":"primary",style:{marginBottom:l?0:12,...i?{justifyContent:"center",border:"none"}:{}},selectType:s,selectAlignXAxis:c,onChange:d})}const b=function(){const e=(0,r.useId)(),t=(0,r.useId)(),{open:a,innerStyle:s,keepFocus:h,mode:b,message:S,debugInfo:y,description:w,items:_,selectionItems:k,showCancel:A,showCloseButton:I,renderDraftCommentIcon:E,icon:C,allowCopy:T,selectType:P}=(0,n(590526).K8)((()=>{const{open:e,innerStyle:t,keepFocus:n,mode:r,message:o,debugInfo:a,description:s,items:c,selectionItems:l,showCancel:d,showCloseButton:u,shouldRenderDraftCommentIcon:p,icon:m,allowCopy:f,selectType:v}=i().A.state;return{open:e,innerStyle:t,keepFocus:n,mode:r,message:o,debugInfo:a,description:s,items:c,selectionItems:l,showCancel:d,showCloseButton:u,renderDraftCommentIcon:p,icon:m,allowCopy:f,selectType:v}}),[]),x=(0,r.useCallback)((()=>{o().zw();const{handleCancel:e}=i().A.state;return e&&e(),!1}),[]),L=(0,r.useCallback)((()=>{const{requiresUserAction:e}=i().A.state;e||x()}),[x]),R=(0,n(59226).X)("update_dialog_styles"),U=(0,n(401497).IS)((()=>{const e={width:"100%",...!R&&{marginTop:8}};return{plainButton:{...e,marginBottom:"-12px",justifyContent:"center",borderRadius:6},button:{...e,borderRadius:6},description:{color:p().Tj.text.secondary,...!R&&{paddingTop:6,paddingBottom:6},textWrap:"pretty"},debugMessage:{paddingTop:10,fontSize:12,color:p().Tj.text.tertiary,textAlign:w?"unset":"center"},overflowWrap:{overflowWrap:"break-word"},modal:{overflow:"hidden",width:"wide"===b?406:324,marginInlineStart:24,marginInlineEnd:24,padding:20,boxShadow:p().Tj.shadowLG,background:p().Tj.background.elevated,borderRadius:12,fontSize:16,alignItems:"center",...s},message:{textAlign:w?"unset":"center",fontWeight:n(284371).Wy.semibold,textWrap:"pretty"},iconContainer:{width:"100%",display:"flex",justifyContent:"center",marginBottom:10,fill:p().Tj.icon.secondary},buttonContainer:{...R?{padding:0,gap:8}:{padding:0}}}}),[w,s,b,R]),[D,M]=(0,r.useState)({});(0,r.useEffect)((()=>{const e={};null==k||k.forEach((t=>{e[t.key]=t.preSelected??!1})),M(e)}),[k]);const N=(0,r.useCallback)((()=>{const r=_.map(((e,t)=>({key:t,render:t=>"plain"===e.buttonType?(0,f.jsx)(n(631524).p,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,colorPalette:e.color,style:U.plainButton,className:e.className,...t,children:e.label||"Label"}):"solid"===e.buttonType?"gray"===e.color?(0,f.jsx)(n(373009).E,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:U.button,className:e.className,...t,children:e.label||"Label"}):(0,f.jsx)(n(160432).A,{size:"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:U.button,className:e.className,colorPalette:"red"===e.color?"red":"blue",...t,children:e.label||"Label"}):(0,f.jsx)(c().A,{size:e.isSmall?"sm":"lg",ariaLabel:e.ariaLabel,hovered:t.focused,style:U.button,colorPalette:"red"===e.color?"red":"blue"===e.color?"blue":void 0,className:e.className,...t,children:e.label||"Label"}),action:()=>{var t;null===(t=e.onClick)||void 0===t||t.call(e),e.onAccept&&(e.onAccept(k?D:void 0),o().zw())}})));A&&r.push({key:"cancel",render:e=>(0,f.jsx)(c().A,{size:"lg",hovered:e.focused,style:U.button,...e,children:(0,f.jsx)(u().sA,{id:"genericDialogModal.cancelButton.label",defaultMessage:"Cancel"})}),action:()=>{x()}});const i=(null==k?void 0:k.filter((e=>!e.showBelowButtons)))??[],a=i.length>0?(0,f.jsx)(g,{items:i,selectType:P,selectedKeys:D,selectAlignXAxis:"right",setSelectedKeys:M}):void 0,s=(null==k?void 0:k.filter((e=>e.showBelowButtons)))??[],p=s.length>0?(0,f.jsx)(g,{items:s,selectType:P,selectedKeys:D,selectAlignXAxis:"right",setSelectedKeys:M}):void 0;let v;y&&(null!=y&&y.messagePrefix?v=`${y.messagePrefix}: ${y.message}`:n(726637).A.isAdminMode&&(v=(0,f.jsx)(u().sA,{id:"dialogRenderer.debugMessage.messagePrefix",defaultMessage:"Debug message: {message}",values:{message:y.message}})));const h=n(242422).default.checkGate({gateName:"update_dialog_styles"});return(0,f.jsx)(n(329661).A,{capture:!0,preventType:n(611648).A.All,children:(0,f.jsxs)("div",{style:U.overflowWrap,children:[I?(0,f.jsx)(n(313633).A,{onClick:L}):void 0,E?(0,f.jsx)(n(254131).j,{}):void 0,C?(0,f.jsx)("div",{style:U.iconContainer,children:C}):void 0,T?(0,f.jsx)(n(417553).k,{enable:!0,shortcuts:{copy:n(496603).D_},debugName:"DialogRenderer.allowCopy"}):void 0,h?(0,f.jsxs)(n(699143).Y1,{direction:"vertical",gap:24,children:[S?(0,f.jsx)("div",{style:U.message,id:e,children:S}):void 0,v?(0,f.jsx)("div",{style:U.debugMessage,children:v}):void 0,w?(0,f.jsx)("div",{style:U.description,id:t,children:w}):void 0,a?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(m().A,{size:20}),a,(0,f.jsx)(m().A,{size:8})]}):void 0,(0,f.jsx)(l().A,{type:l().O.Vertical,priority:1,initialFocus:0,resetFocusOnMouseOut:!0,sections:[{key:"dialog",render:e=>(0,f.jsx)(d().A,{topBorder:!1,disableMobileBorders:!0,style:U.buttonContainer,...e}),items:r}]}),p||void 0]}):(0,f.jsxs)(f.Fragment,{children:[S?(0,f.jsx)("div",{style:U.message,id:e,children:S}):void 0,v?(0,f.jsx)("div",{style:U.debugMessage,children:v}):void 0,w?(0,f.jsx)("div",{style:U.description,id:t,children:w}):void 0,a?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(m().A,{size:20}),a,(0,f.jsx)(m().A,{size:8})]}):void 0,(0,f.jsx)(l().A,{type:l().O.Vertical,priority:1,initialFocus:0,resetFocusOnMouseOut:!0,sections:[{key:"dialog",render:e=>(0,f.jsx)(d().A,{topBorder:!1,disableMobileBorders:!0,style:U.buttonContainer,...e}),items:r}]}),p?(0,f.jsx)(f.Fragment,{children:p}):void 0]})]})})}),[_,A,k,P,D,y,U.overflowWrap,U.iconContainer,U.message,U.debugMessage,U.description,U.button,U.plainButton,U.buttonContainer,I,L,E,C,T,S,e,w,t,x]);return(0,f.jsx)(n(107975).a,{ariaLabelledBy:e,ariaDescribedBy:t,open:a,keepFocus:h,overlayZIndex:v,onDismiss:L,preventHideChildrenWhileOpening:!0,innerStyle:U.modal,render:N})}},753721:(e,t,n)=>{n.d(t,{X:()=>i});var r=()=>n(590526),o=()=>n(391400);function i(){return(0,r().K8)((()=>o().A.state.initialRenderCompleted),[])}},757747:(e,t,n)=>{n.d(t,{v:()=>a});var r=()=>n(79926);const o=new(r().O2)("idleTranscriptionActions",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,247865)))),i=new(r().O2)("transcriptionErrorActions",(async()=>await Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(27992),n.e(63452),n.e(66249),n.e(92845),n.e(87249),n.e(79022),n.e(14578),n.e(87017),n.e(34877),n.e(46414),n.e(11676),n.e(61165),n.e(94522),n.e(44584),n.e(38293),n.e(40992),n.e(88455),n.e(52871),n.e(47160),n.e(49021),n.e(53697),n.e(17680),n.e(6039),n.e(71136),n.e(86341),n.e(29316),n.e(3101)]).then(n.bind(n,872903))));const a={transcription_idle:async(e,t)=>{(await o.load()).showIdleTranscriptionToast(e,t)},transcription_error:async(e,t)=>{(await i.load()).showTranscriptionErrorToast(e,t)},transcription_recording_stopped:async(e,t)=>{(await n(737022).i.load()).showTranscriptionRecordingStoppedToast(e,t)}}},762014:(e,t,n)=>{n.d(t,{A:()=>i,e:()=>r});let r=function(e){return e.IN_APP_CALLOUT_CONFLICT="in-app callout conflict",e.DARK_MODE="not shown in dark mode",e}({});class o extends(()=>n(757695))().Store{getInitialState(){return{isVisible:!1,suppressReason:void 0}}}const i=new o},779975:(e,t,n)=>{n.r(t),n.d(t,{provideDependencies:()=>o});var r=()=>n(944814);function o(e){(0,r().e6)(e.defaultStableParentStore)}},783068:(e,t,n)=>{n.r(t),n.d(t,{createClientEnvironment:()=>ee});var r=()=>n(20022),o=()=>n(678293),i=()=>n(813974),a=()=>n(221844),s=()=>n(711740),c=()=>n(105751),l=()=>n(590966),d=()=>n(396487),u=()=>n(609990),p=()=>n(299972),m=()=>n(589620),f=()=>n(110750),v=()=>n(721338),g=()=>n(526323),h=()=>n(138418),b=()=>n(911988),S=()=>n(165358),y=()=>n(229833),w=()=>n(753812),_=()=>n(721253),k=()=>n(463832);class A extends(()=>n(573442))().K{constructor(e){super({...e,mapSpaceIdToShortId:t=>e.mapSpaceIdToShortId(this.currentUserId,t)}),this.currentUserId=void 0,this.currentUserId=e.currentUserId}updateCurrentUserId(e){this.currentUserId=e}}var I=()=>n(900527),E=()=>n(671432),C=()=>n(250084),T=()=>n(356853),P=(n(16280),n(581454),()=>n(44551)),x=()=>n(242422),L=()=>n(206267);const R=[WebSocket.OPEN,WebSocket.CONNECTING];class U{constructor(){this.sqliteConnection=void 0,this.environment=void 0,this.requests=new Map,this.debug=!1}setEnvironment(e){this.environment=e}async initialize(){const e=await this.getConnectionType();try{this.debug=Boolean(window.localStorage.getItem("sqlitedebug"))}catch{}"message-ports"===e?await this.initializeMessagePort():await this.initializeWebSocket()}async getConnectionType(){const{preferences:e}=await r().Zq.get()||{};if("message-ports"===(null==e?void 0:e.sqliteConnectionType))return"message-ports";const t=(0,n(751629).getDesktopVersion)();if(t&&t[0]>=4)return"message-ports";const o=navigator.userAgent.match(/Notion\/(\d+\.\d+\.\d+)/);if(o){const[,e]=o,[t]=e.split(".").map(Number);if(t>=4)return"message-ports"}return null!==P().electronApi&&void 0!==P().electronApi&&P().electronApi.sqliteServerEnabled?"web-sockets":null}async initializeMessagePort(){await this.initializeMessagePortConnection();try{const e=n(929219).A.state.online;(0,o().aH)({gateName:"recover_from_sqlite_corruption"})&&e&&await this.enableCorruptionRepair()}catch(e){}try{this.sqliteConnection=await this.createOrReinitializeSqliteConnection(),x().default.waitUntilStatsigReadyAsync().then((()=>{this.applyJournalModeIfConfigured()}))}catch(e){}}async initializeWebSocket(){await this.initializeWebSocketConnection(),this.sqliteConnection=await this.createOrReinitializeSqliteConnection()}createMessagePortBaseConnection(){return{execSqliteBatchV2:async({batch:e,precondition:t})=>this.execSqliteBatchInnerMessagePort({id:L().JW(),batch:e,precondition:t}),execSqliteBatch:async e=>this.execSqliteBatchInnerMessagePort({id:L().JW(),batch:e}),completelyRebuildSqliteDb:async()=>this.completelyRebuildSqliteDbInnerMessagePort(L().JW())}}createWebSocketBaseConnection(){return{execSqliteBatchV2:async e=>{const t=L().JW(),{batch:n,precondition:r}=e,o=JSON.stringify({id:t,batch:n,precondition:r,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,o)},execSqliteBatch:async e=>{const t=L().JW(),n=JSON.stringify({id:t,batch:e,auth:this.authToken});return await this.execSqliteBatchInnerWebSockets(t,n)},completelyRebuildSqliteDb:async()=>{}}}async createOrReinitializeSqliteConnection(){try{let e;e="message-ports"===await this.getConnectionType()?this.createMessagePortBaseConnection():this.createWebSocketBaseConnection();const t=await(0,n(203587).G)(e);if(this.sqliteConnection)return this.sqliteConnection.reinitialize({connection:e,type:"v2",migrations:t}),this.sqliteConnection;return new(n(873842).i)({connection:e,type:"v2",migrations:t,debug:this.debug})}catch(e){throw e}}async applyJournalModeIfConfigured(){try{if(!this.sqliteConnection)return;if(!x().default.isStatsigEnabledAndInitialized())return;const e=x().default.getEligibleGroup({experimentId:"desktop_sqlite_journal_mode",defaultGroup:"off"}),t="string"==typeof e?e.toLowerCase():"off";if("wal"!==t&&"delete"!==t)return;const r="wal"===t?"PRAGMA journal_mode=WAL":"PRAGMA journal_mode=DELETE";await(0,n(430476).Bg)({connection:this.sqliteConnection,sql:r})}catch(e){S().log({level:"error",from:"electronSqlite",type:"applyJournalModeError",error:(0,y().convertErrorToLog)(e)})}}async execSqliteBatchInnerWebSockets(e,t){const n=new Promise((t=>{this.requests.set(e,t)}));this.ws.readyState===WebSocket.CLOSED&&await this.initializeWebSocket();try{this.ws.send(t)}catch(o){const e=this.ws;this.ws.onopen=function(n){e.send(t)}}const r=await n;if(r.error)throw new Error("Received SQLite error.",{cause:r.error});return r.value}async execSqliteBatchInnerMessagePort(e){const t=new Promise((t=>{this.requests.set(e.id,t)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(e);const n=await t;if(n.error)throw new Error("Received SQLite error.",{cause:n.error});return n.value}async completelyRebuildSqliteDbInnerMessagePort(e){const t={id:e,command:"completelyRebuildSqliteDb",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const r=await n;if(r.error)throw new Error("completelyRebuildSqliteDb error.",{cause:r.error})}async enableCorruptionRepairInnerMessagePort(e){const t={id:e,command:"enableCorruptionRepair",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const r=await n;if(r.error)throw new Error("enableCorruptionRepair error.",{cause:r.error})}async disableCorruptionRepairInnerMessagePort(e){const t={id:e,command:"disableCorruptionRepair",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const r=await n;if(r.error)throw new Error("disableCorruptionRepair error.",{cause:r.error})}async restoreBackupInnerMessagePort(e){const t={id:e,command:"restoreBackup",batch:{body:[],onError:void 0}},n=new Promise((e=>{this.requests.set(t.id,e)}));if(this.messagePort||await this.initializeMessagePortConnection(),!this.messagePort)throw new Error("Message port not initialized.");this.messagePort.postMessage(t);const r=await n;if(r.error)throw new Error("restoreBackup error.",{cause:r.error})}async initializeMessagePortConnection(){return(0,n(763824).qt)((async e=>{if(null===P().electronApi||void 0===P().electronApi||!P().electronApi.getSqliteMeta)return void e();if(this.messagePort)return void e();const t=r=>{try{if(!r.ports.length||r.source!==window)return;this.messagePort=r.ports[0],this.messagePort.onclose=()=>{this.messagePort=void 0},this.messagePort.onmessage=async e=>{const{type:t,id:r,result:o,durationMs:i}=e.data;if(i&&"number"==typeof i&&this.environment){const e=performance.now(),t=e-i;n(711339).default.measure({metricName:"desktop.sqlite_query_execution",startTime:t,endTime:e},{environment:this.environment,shouldExcludeFromTimeline:!0})}if("backupAndResetDatabaseComplete"===t)return void(await this.handleBackupAndResetDatabaseComplete());const a=this.requests.get(r);a&&(this.requests.delete(r),a({value:o}))},window.removeEventListener("message",t),e()}catch(o){S().log({level:"error",from:"electronSqlite",type:"messagePortError",error:(0,y().convertErrorToLog)(o)})}};window.addEventListener("message",t);(await P().electronApi.getSqliteMeta()).error}))}async initializeWebSocketConnection(){if(null===P().electronApi||void 0===P().electronApi||!P().electronApi.getSqliteMeta)return;const e=await P().electronApi.getSqliteMeta();if(e.error)return;if(this.ws&&R.includes(this.ws.readyState))return;const{serverProcessPort:t,authToken:n}=e.value;this.authToken=n;const r=`ws://127.0.0.1:${t}`;this.ws=new WebSocket(r),this.ws.onclose=()=>{S().log({level:"warning",from:"electronSqlite",type:"reinitializingWebsocket"}),this.initializeWebSocketConnection()},this.ws.addEventListener("message",(async e=>{const t=e.data.toString(),{type:n,id:r,result:o}=JSON.parse(t);if("backupAndResetDatabaseComplete"===n)return void(await this.handleBackupAndResetDatabaseComplete());const i=this.requests.get(r);i&&(this.requests.delete(r),i({value:o}))})),await new Promise((e=>{this.ws.onopen=()=>{e()}}))}async enableCorruptionRepair(){await this.enableCorruptionRepairInnerMessagePort(L().JW())}async disableCorruptionRepair(){await this.disableCorruptionRepairInnerMessagePort(L().JW())}async handleBackupAndResetDatabaseComplete(){try{if(await this.initialize(),!this.sqliteConnection)return;await this.sqliteConnection.ensureMigrated(),await this.restoreBackup();const{SqliteCorruptionRecoveryStatusStore:e}=await n(99040).W.load();e.setState({shouldFetchImportantPages:!0})}catch(e){}}async restoreBackup(){await this.restoreBackupInnerMessagePort(L().JW())}}var D=()=>n(859312),M=()=>n(757695);class N extends M().Store{getInitialState(){return{loading:!1,loaded:!1}}async loadIfNeeded(e){if(this.state.loaded||this.state.loading)return;const t=e();if(!t)return;if(0===n(201980).IcF(t).length)return;const r=n(771467).V.load();this.setState({loading:!0,loaded:!1,result:r}),this.setState({loading:!1,loaded:!0,result:await r})}getKatex(){if(this.state.loaded)return this.state.result}}n(944114),n(517642),n(658004),n(733853),n(845876),n(432475),n(515024),n(731698),n(898992),n(354520),n(803949),n(908872),n(737550);var O=()=>n(852273),j=()=>n(763884),B=()=>n(179034),q=()=>n(496603),W=()=>n(720665),z=()=>n(129286);class F extends M().Store{static getCacheKey(e){return`LocalBacklinkStore2:${e}`}getInitialState(){return{}}initializeBacklinks({block:e,currentUserId:t,environment:n}){if(this.instanceState[e.id])return;const r=this.getCachedBacklinkState({blockId:e.id,currentUserId:t});r?this.setState({...this.instanceState,[e.id]:{state:r,loaded:!0}}):this.setState({...this.instanceState,[e.id]:{state:{backlinks:[],inaccessibleBacklinkCount:0},loaded:!1}}),$(n,e),this.startMessageListeners(e,n)}awaitLoaded(e){return this.waitUntil((()=>{const t=this.state[e];return Boolean(t&&t.loaded)}))}destroyBacklinks(e,t){this.stopMessageListeners(e,t),delete this.instanceState[e]}getBacklinkState({blockId:e,currentUserId:t}){const n=this.state[e];return n?n.state:this.getCachedBacklinkState({blockId:e,currentUserId:t})||{backlinks:[],inaccessibleBacklinkCount:0}}setBacklinkState({blockId:e,state:t,currentUserId:n}){this.setCachedBacklinkState({blockId:e,state:t,currentUserId:n});const r=this.state[e];r&&this.setState({...this.state,[e]:{...r,state:t,loaded:!0}})}updateBacklinks(e){const{createdBacklinks:t,deletedBacklinks:n,currentUserId:r}=e,o=(0,W().qt)(t),i=(0,W().qt)(n),a=o.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),s=i.reduce(((e,t)=>{const{block_id:n}=t;return e[n]=e[n]?[...e[n],t]:[t],e}),{}),c=new Set([...Object.keys(a),...Object.keys(s)]);return c.forEach((e=>{const t=a[e]||[],n=s[e]||[],o=this.getBacklinkState({blockId:e,currentUserId:r}),i=t.filter((e=>!o.backlinks.some((t=>q().n4(e,t))))),c=[...o.backlinks,...i].filter((e=>!n.some((t=>q().n4(e,t)))));this.setBacklinkState({blockId:e,state:{...o,backlinks:c},currentUserId:r})})),Array.from(c)}resetBacklinkState({blockIds:e,currentUserId:t}){for(const n of e)this.setCachedBacklinkState({blockId:n,state:{backlinks:[],inaccessibleBacklinkCount:0},currentUserId:t})}getCachedBacklinkState({blockId:e,currentUserId:t}){return j().K.get({userId:t,key:F.getCacheKey(e)})}setCachedBacklinkState({blockId:e,state:t,currentUserId:n}){return j().K.set({userId:n,key:F.getCacheKey(e),value:t})}async startMessageListeners(e,t){const r=n(277153).L3.fromSpaceShardRecordId(e,B().ev);z().transactionQueue.isPendingTransactionForRecord(r)&&await z().transactionQueue.drain();const o=this.instanceState[r.id];if(!o)return;let i,a=!1;const s=q().nF((({value:n})=>{const r=i,o=n||void 0;i=o,a?r!==o&&$(t,e):a=!0}),1e3),c=(0,n(921997).U)(r.id);o.messageStoreListenerReference=O().Ay.addListener(c,void 0,s,void 0,t)}stopMessageListeners(e,t){const n=this.instanceState[e];n&&n.messageStoreListenerReference&&(O().Ay.removeListener(n.messageStoreListenerReference,t),n.messageStoreListenerReference=void 0)}}async function $(e,t){await z().transactionQueue.awaitRecordTransaction({id:t.id,table:B().ev});const r=(0,n(851941).dR)(t.id),o=r?{"x-notion-space-short-id":r.toString()}:t.spaceId?{"x-notion-space-id":t.spaceId}:{},i=w().callInitialFanoutApi({eventName:"getPageBacklinks",environment:e,data:{block:t},headers:o}),a=[];let s=0;for await(const n of i)"failed"!==n.type&&(a.push(...n.data.backlinks),s+=n.data.inaccessibleBacklinkCount,e.LocalBacklinkStore.setBacklinkState({blockId:t.id,state:{backlinks:a,inaccessibleBacklinkCount:s},currentUserId:e.currentUser.id}))}function K(e){return`PageDetailsStore:${e.type}:${e.id}`}class V extends M().Store{getInitialState(){return{}}static getDefaultToggleState(e){return"discussion"===e.type||"backlinks"!==e.type&&void(0,n(534177).HB)(e)}getToggleState(e){const t=K(e);if(t in this.state)return this.state[t]}setToggleState(e,t){const n=K(e);this.setState({...this.state,[n]:t})}}var H=()=>n(618659);async function G({environment:e,currentUserId:t,route:r}){const{blockId:o}=H().v({route:r,userId:t}),i=void 0!==o&&await(0,n(866654).RJ)({environment:e,request:{page:{id:o,spaceId:""},cursor:{stack:[]},verticalColumns:!1}});H().performPrefetchRequests({environment:e,currentUserId:t,options:{skipPrefetchPageChunk:i,nextRoute:r}})}class J{constructor(e,t){this.cache=e,this.getEnvironment=t}performPrefetchRequests(e){return H().performPrefetchRequests({environment:this.getEnvironment(),currentUserId:e.currentUserId,options:e.options})}async performNavigationPrefetchRequests(e){return G({environment:this.getEnvironment(),currentUserId:e.currentUserId,route:e.route})}getPrefetchRecordIdsForRoute(e){return H().v(e)}}var Z=()=>n(994310);const Q="spellcheckEnabled";class X{constructor(){this.enabled=void 0,this.currentLanguages=void 0;const e=Z().A.get(Q);this.setEnabled(void 0===e||e)}setEnabled(e){this.enabled=e,Z().A.set(Q,e),null!==r().Ht&&void 0!==r().Ht&&r().Ht.setSpellCheckerEnabled&&(null===r().Ht||void 0===r().Ht||r().Ht.setSpellCheckerEnabled(e))}isEnabled(){return this.enabled}getCorrections(e){return e.dictionarySuggestions}addToDictionary(e){null!==r().Ht&&void 0!==r().Ht&&r().Ht.addToDictionary&&r().Ht.addToDictionary(e)}setLanguages(e){q().n4(this.currentLanguages,e)||(this.currentLanguages=e,null!==r().Ht&&void 0!==r().Ht&&r().Ht.setSpellCheckerLanguages&&r().Ht.setSpellCheckerLanguages(0===e.length?[navigator.language]:e))}async getLanguages(){const e=new Intl.DisplayNames([navigator.language],{type:"language"}),t=[];if(null!==r().Ht&&void 0!==r().Ht&&r().Ht.getSpellCheckerLanguages){const n=await r().Ht.getSpellCheckerLanguages();for(const r of n)t.push({code:r,name:e.of(r)})}return t}async getAvailableLanguages(){const e=new Intl.DisplayNames([navigator.language],{type:"language"}),t=[];if(null!==r().Ht&&void 0!==r().Ht&&r().Ht.getAvailableSpellCheckerLanguages){const n=await r().Ht.getAvailableSpellCheckerLanguages();for(const r of n)t.push({code:r,name:e.of(r)})}return t}}let Y=0;async function ee(e){const{minimalEnvironment:t,prefetchCache:n,currentUserId:x}=e,{device:L,deviceStore:R,mobileNative:M,cookieService:O,queryClient:j}=t,B=""+Y++,q=L.isElectron&&Boolean(null===r().Ht||void 0===r().Ht?void 0:r().Ht.sqliteServerEnabled)?await async function(e){if(!e.device.isElectron||null===P().electronApi||void 0===P().electronApi||!P().electronApi.sqliteServerEnabled)return;const t=new U;return e.environment&&t.setEnvironment(e.environment),await t.initialize(),t}({device:L}):void 0,W=(0,T().isBootWasmSqliteLaterEnabled)()?void 0:D().u.maybeCreateInstance({device:L,currentUserId:x}),z=new(p().A),$=new(f().Bd),K=new(h().A),H=new X,G=(null==M?void 0:M.sqliteConnection)||(null==q?void 0:q.sqliteConnection)||(null==W?void 0:W.sqliteConnection),Z=G?new(C().m)({connection:G,maxSize:L.isDesktop?1e6:1e5,getEnvironment:function(){return ie}}):void 0,Q=new(s().L)({inMemoryRecordCache:new(a().A)({name:"default"}),persistedRecordCache:Z});W&&W.waitForInitialize().catch((e=>{(0,o().aH)({gateName:"recover_from_sqlite_corruption"})||Q.disablePersistedRecordCache()}));const ee=(0,g().OH)({device:L,RouterStore:z,ThemeStore:K}),te=await k().getPublicDomainUserId({device:L,deviceStore:R,mobileNative:M,cookieService:O,queryClient:j}),ne=new(l().CurrentUser),re=new A({environmentName:"production",getSettings:()=>({enableIdSchema:!0}),isServerOriginated:!1,currentUserId:x,mapSpaceIdToShortId:(e,t)=>{const n=(0,I().J)({defaultRecordCache:Q,userId:e,spaceId:t});if(n&&n.short_id_str)return Number(n.short_id_str);const r=m().D.getState();if(r&&t in r){const e=r[t];return Number(e)}}}),oe=await(0,c().getHtmlStreamQueueEntry)("bootData").catch((e=>{S().log({level:"warning",from:"clientEnvironment",type:"BootDataError",error:(0,y().convertErrorToLog)(e)})}))??void 0,ie={key:B,AppUpdateStore:new(d().I),device:L,deviceStore:R,WindowSizeStore:new(b().nJ)({device:L},window),KeyboardShortcutsStore:i().getKeyboardShortcutsStore(),KeyboardShortcutStackStore:new(u().X),defaultRecordCache:Q,mobileNative:M,RouterStore:z,ThemeStore:K,ThemeModeStore:ee,ElectronSqlite:q,WasmSqlite:W,sqliteConnection:G,queryClient:j,KatexStore:new N,LocalBacklinkStore:new F,PageDetailsStore:new V,updateCurrentUserId:void 0,currentUser:ne,SpellCheckService:H,TextSelectionCompositionStore:new(v().P),recordSubscriptionActions:{subscribe:E().B1,unsubscribeAfterDelay:E().N$},TabbedRouterStore:$,cookieService:O,publicDomainUserId:te,idCreator:re,bootData:oe,prefetcher:new J(n,(()=>ie)),api:w().apiClient};return q&&q.setEnvironment(ie),_().uh(ie),ie}},787804:(e,t,n)=>{n.d(t,{o:()=>o});var r=()=>n(711059);function o(e){const t=[4,9,0];return(0,r().isLessThanVersion)(e,t)}},793007:(e,t,n)=>{n.d(t,{o:()=>S});var r=n(296540),o=()=>n(949054),i=()=>n(564884),a=()=>n(756117),s=()=>n(484714),c=()=>n(590526),l=()=>n(401497),d=()=>n(718827),u=()=>n(807449),p=n(474848);const m={viewBox:"0 0 20 20",fittedViewBox:"1.87 3.47 16.26 12.66",directional:!0,svg:(0,p.jsx)("path",{d:"M12.231 4.969A.875.875 0 1 1 13.47 3.73l4.4 4.4a.875.875 0 0 1 0 1.238l-4.4 4.4a.875.875 0 1 1-1.238-1.238l2.906-2.906H6a2.375 2.375 0 1 0 0 4.75h1.42a.875.875 0 0 1 0 1.75H6a4.125 4.125 0 1 1 0-8.25h9.138z"})},f=(0,n(340498).wt)("arrowUTurnUpRightFill",m,"fill");var v=()=>n(69708),g=()=>n(100622),h=()=>n(644914),b=()=>n(749687);function S({sidebarAware:e=!0}){const t=(0,s().v3)(),n=(0,c().O$)(b().sidebarWidthStore),m=e?n:void 0,S=(0,c().K8)((()=>!!e&&(0,h().KB)(t)),[t,e]),[y,w]=(0,r.useState)(!1),_=(0,r.useRef)(null),k=(0,l().eP)(),A=(0,l().IS)((()=>({container:{background:S?"light"===k?g().Tj.background.secondary:g().Tj.background.elevated:void 0,height:68,position:"fixed",top:0,insetInlineStart:0,insetInlineEnd:0,bottom:0,zIndex:1e3},skipLink:{position:"absolute",insetInlineStart:12,top:12,width:200,height:48,overflow:"hidden",zIndex:9999,padding:12,background:g().Tj.blue.background.accentPrimary,color:"white",textAlign:"center",textDecoration:"none",borderRadius:16},buttonHoveredStyle:{background:g().Tj.blueButtonHoveredBackground},buttonPressedStyle:{background:g().Tj.blueButtonPressedBackground}})),[S,k]);return(0,p.jsx)(a().A,{tag:"div",animate:{...void 0!==m&&{width:m},translateY:y?0:-100},style:{...A.container,...void 0===m&&{width:"auto"}},className:"notion-print-ignore",children:(0,p.jsx)(d().Ay,{style:A.skipLink,hoveredStyle:A.buttonHoveredStyle,pressedStyle:A.buttonPressedStyle,href:"#main",id:"skip-to-content",ref:_,onClick:e=>{const n=0===e.detail||0===e.screenX&&0===e.screenY,r=document.getElementById("main");if(r){const e=(0,o().Kr)(r);e.length>0&&e[0].focus()}w(!1),(0,i().u)({environment:t,event:{eventName:"skip_to_content_click",eventProperties:{user_navigation_type:n?"keyboard":"mouse"}}})},onFocus:()=>{w(!0)},onBlur:()=>{w(!1)},children:(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[(0,p.jsx)(v().sA,{defaultMessage:"Skip to content",id:"skipToContent.skipToContent"}),(0,p.jsx)(u().I,{icon:f})]})})})}},840125:(e,t,n)=>{n.r(t),n.d(t,{getCloseConfirmationDialogReason:()=>m,getUserControlledCloseConfirmationDialogReason:()=>p,setupOnBeforeUnload:()=>v,showConfirmationDialogEventEmitter:()=>d});n(16280);var r=()=>n(534177),o=()=>n(715142),i=()=>n(140400),a=()=>n(964345),s=()=>n(748197),c=()=>n(540423),l=()=>n(549508);const d=new(n(592328).A);let u;function p(){const e=m();switch(e){case"have_local_draft_unsaved_changes":case"dictation_in_progress":return e;case void 0:case"transaction_queue_has_tasks":case"uploading_files":case"generating_ai_completions":case"have_pending_ai_edits":case"have_pending_synced_collection_changes":return}(0,r().HB)(e)}function m(){if(!u)throw new Error("beforeUnloadHelpers.setupOnBeforeUnload() was not called!");return u()}const f="Changes you made may not be saved. Are you sure you want to quit?";function v(e){const{TransactionQueue:t,device:n,AppUpdateStore:r,GlobalFileUploadStore:p}=e,v=!(0,l().o)();u=function(){return!t.hasTasks()||n.isMobileNative||n.isElectron||r.isMajorUpdate()||v?(0,o().A5)()?"have_pending_ai_edits":c().A.doesAnyCacheHaveUnsavedChanges()?"have_local_draft_unsaved_changes":p.isUploading()?"uploading_files":i().A.hasPendingSyncedCollectionChanges()?"have_pending_synced_collection_changes":a().gZ.state||s().c.areBlocksSummarizing()?"dictation_in_progress":void 0:"transaction_queue_has_tasks"},window.onbeforeunload=function(){const e=m();if(e)return d.emit(e),f}}},843787:(e,t,n)=>{n.d(t,{JK:()=>i});var r=()=>n(79926);const o={EdgeManagerContext:new(r().O2)("EdgeManagerContext",(()=>Promise.all([n.e(75134),n.e(64756),n.e(42510)]).then(n.bind(n,566563)))),RelationPropertyWithEdges:new(r().O2)("RelationPropertyWithEdges",(()=>Promise.all([n.e(75134),n.e(64756),n.e(71003),n.e(68395),n.e(51696),n.e(82202),n.e(91562)]).then(n.bind(n,39931)))),RelationPropertyOverlayWithEdges:new(r().O2)("RelationPropertyOverlayWithEdges",(()=>Promise.all([n.e(75134),n.e(35530),n.e(9773),n.e(36556),n.e(55373),n.e(36192),n.e(40537),n.e(71562),n.e(62475),n.e(3151),n.e(98629),n.e(64756),n.e(18113),n.e(27992),n.e(63452),n.e(66249),n.e(87249),n.e(79022),n.e(34877),n.e(11676),n.e(94522),n.e(38293),n.e(63515),n.e(55162),n.e(71003),n.e(32370),n.e(26264),n.e(6769),n.e(64242),n.e(39986),n.e(47160),n.e(76677),n.e(68609),n.e(15553),n.e(77345),n.e(79340),n.e(42056),n.e(3261),n.e(54219),n.e(68395),n.e(96654),n.e(68643),n.e(27083),n.e(96385),n.e(82202),n.e(33490)]).then(n.bind(n,406851))))},i=((0,r()._h)(o.EdgeManagerContext,(e=>e.EdgeManagerProvider)),(0,r().jQ)(o.RelationPropertyWithEdges,(e=>e.RelationPropertyWithEdges)),(0,r().jQ)(o.RelationPropertyOverlayWithEdges,(e=>e.RelationPropertyRendererWithEdges)))},843801:(e,t,n)=>{n.d(t,{H:()=>i,j:()=>o});class r extends(()=>n(757695))().Store{constructor(...e){super(...e),this.initiate=()=>{this.setState({mcpDesktopOAuthState:{status:"initiated"}})},this.complete=e=>{this.setState({mcpDesktopOAuthState:{status:"completed",...e}})},this.fail=()=>{this.setState({mcpDesktopOAuthState:{status:"failed"}})},this.reset=()=>{this.setState({mcpDesktopOAuthState:void 0})}}getInitialState(){return{}}}const o=new r;function i(e){var t;if("initiated"!==(null===(t=o.state.mcpDesktopOAuthState)||void 0===t?void 0:t.status))return{didHandle:!1};const{connectionId:n,spaceId:r,error:i}=e;return!i&&n&&r?(o.complete({connectionId:n,spaceId:r}),{didHandle:!0}):(o.fail(),{didHandle:!0})}(0,n(852832).exposeDebugValue)("mcpOAuthStore",o)},859312:(e,t,n)=>{n.d(t,{u:()=>d});n(814603),n(147566),n(198721);var r=()=>n(391400),o=()=>n(165358),i=()=>n(651170),a=()=>n(229833),s=()=>n(681335),c=()=>n(356853);class l{constructor(e){this.tabId=void 0,this.initializePromise=void 0,this.sharedWorkerConnection=void 0,this.dedicatedWorkerConnection=void 0,this.lockAcquired=!1,this.observer=new(n(255670).P)({execSqliteBatch:e=>this.unobservedExecSqliteBatch(e),completelyRebuildSqliteDb:()=>this.unobservedCompletelyRebuildSqliteDb()}),this.args=e,this.tabId=n(206267).JW(),this.initializePromise=this.initialize(e)}async waitForInitialize(){await this.initializePromise}execSqliteBatch(e){return this.observer.connection.execSqliteBatch(e)}async unobservedExecSqliteBatch(e){const{sqliteConnectionManager:t}=await this.initializePromise;return t.execSqliteBatch(e)}completelyRebuildSqliteDb(){return this.observer.connection.completelyRebuildSqliteDb()}async unobservedCompletelyRebuildSqliteDb(){const{sqliteConnectionManager:e}=await this.initializePromise;return e.completelyRebuildSqliteDb()}async enableCorruptionRepair(){try{const{sharedWorkerConnection:e}=await this.initializePromise;await e.enableCorruptionRepair()}catch(e){}}async disableCorruptionRepair(){try{const{sharedWorkerConnection:e}=await this.initializePromise;await e.disableCorruptionRepair()}catch(e){}}getObserver(){return this.observer}getDedicatedWorkerConnection_DEBUG_ONLY(){return this.dedicatedWorkerConnection}async initialize(e){performance.now();const{loadWorker:t,loadSharedWorker:l}=e;let d=performance.now();const u=t(),p=l();d=performance.now(),this.sharedWorkerConnection??=s().LV(p.port);const m=this.sharedWorkerConnection;this.dedicatedWorkerConnection??=s().LV(u);const f=this.dedicatedWorkerConnection,v={initialize:()=>f.initialize(),execSqliteBatch:e=>f.execSqliteBatch(e),execSqliteBatchV2:e=>f.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>f.completelyRebuildSqliteDb(),handleBackupAndResetDatabaseComplete:()=>this.handleBackupAndResetDatabaseComplete()};s().p(v,p.port);const g=n(929219).A.state.online;if((0,n(678293).aH)({gateName:"recover_from_sqlite_corruption"})&&g)if((0,c().isBootWasmSqliteEarlierEnabled)())m.enableCorruptionRepair().catch((e=>{}));else try{await m.enableCorruptionRepair()}catch(w){}var h;d=performance.now(),this.lockAcquired||(await(h=n(714681).S(this.tabId),new Promise(((e,t)=>{navigator.locks.request(h,(()=>(e(),new Promise((()=>{}))))).catch(t)}))),this.lockAcquired=!0),d=performance.now(),await m.initializeNewTab({tabId:this.tabId}),r().A.state.metricDataStore.update((e=>({...e,wasm_sqlite_wasm_ready_time:performance.now()})));const b={execSqliteBatch:e=>m.execSqliteBatch(e),execSqliteBatchV2:e=>m.execSqliteBatchV2(e),completelyRebuildSqliteDb:()=>m.completelyRebuildSqliteDb()};d=performance.now();const S=await(0,n(203587).G)(b),y=new(n(873842).i)({connection:b,type:"v2",migrations:S});try{d=performance.now(),await y.ensureMigrated()}catch(w){o().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionEnsureMigratedError",error:(0,a().convertErrorToLog)(w),data:(0,i().CS)(w,{isBrowser:!0})})}return y.optimize().catch((e=>{o().log({level:"error",from:"ProxiedWasmSqliteConnectionWrapper",type:"sqliteConnectionOptimizeError",error:(0,a().convertErrorToLog)(e),data:(0,i().CS)(e,{isBrowser:!0})})})),{sqliteConnectionManager:y,sharedWorkerConnection:m}}async handleBackupAndResetDatabaseComplete(){try{this.initializePromise=this.initialize(this.args);const{sqliteConnectionManager:e,sharedWorkerConnection:t}=await this.initializePromise;if(!t)return;await e.ensureMigrated(),await t.restoreBackup();const{SqliteCorruptionRecoveryStatusStore:r}=await n(99040).W.load();r.setState({shouldFetchImportantPages:!0})}catch(e){}}}class d{constructor(e){this.sqliteConnection=void 0;const t=(0,c().consumePrewarmedWorkers)();this.sqliteConnection=new l({loadWorker:()=>t.worker?t.worker:new Worker(new URL(n.p+n.u(75528),n.b)),loadSharedWorker:()=>t.sharedWorker?t.sharedWorker:new SharedWorker(new URL(n.p+n.u(33429),n.b)),currentUserId:e.currentUserId})}static maybeCreateInstance(e){const{device:t,currentUserId:n}=e;if(function(e){var t;return!!e.isBrowser&&"undefined"!=typeof navigator&&void 0!==(null===(t=navigator.locks)||void 0===t?void 0:t.request)&&"undefined"!=typeof SharedWorker&&!e.isAndroid}(t)){u("loading");const e=new d({currentUserId:n});return e.waitForInitialize().then((()=>{var e;u("success"),e=performance.now(),r().A.state.metricDataStore.update((t=>({...t,wasm_sqlite_fully_ready_time:e})))}),(e=>{u("error"),o().log({level:"error",from:"clientEnvironment",type:"wasmSqliteInitializeError",error:(0,a().convertErrorToLog)(e),data:{...(0,i().CS)(e,{isBrowser:!0}),userId:n}})})),e}u("skipped-unsupported-device")}async waitForInitialize(){return await this.sqliteConnection.waitForInitialize()}async enableCorruptionRepair(){await this.sqliteConnection.enableCorruptionRepair()}async disableCorruptionRepair(){await this.sqliteConnection.disableCorruptionRepair()}}function u(e){r().A.state.metricDataStore.update((t=>({...t,wasm_sqlite_initialized:e})))}},863642:(e,t,n)=>{n.d(t,{d:()=>r,f:()=>o});const r=new(n(29923).R)({key:"slipperySlopeSidebarSelectedTab",namespace:n(553737).Bq,important:!0,trackingType:"preference"}),o=n(757695).Store.createValue(n(749687).SIDEBAR_MIN_WIDTH,{name:"sidebarPreviousNonFullWidthStore"})},923455:(e,t,n)=>{n.d(t,{Lp:()=>y,Rx:()=>_,a$:()=>w});var r=n(296540),o=()=>n(907258),i=()=>n(755531),a=()=>n(59226),s=()=>n(484714),c=()=>n(590526),l=()=>n(391400),d=()=>n(269183),u=()=>n(753721),p=()=>n(877051),m=()=>n(644914),f=()=>n(82648),v=()=>n(840247),g=()=>n(479349),h=n(474848);const b=(0,r.createContext)(null);b.displayName="SidebarStateContext";const S=2e4;function y({children:e}){const t=(0,s().v3)(),n=(0,v().r)(t),y=(0,p().V)(),{deferSidebarLoadingWhenCollapsed:w}=(0,d().b8)(t.currentUser.id),_=!(0,c().K8)((()=>(0,m().KB)(t)),[t])&&w&&y,[k,A]=(0,r.useState)(!1);(0,r.useEffect)((()=>{const e=setTimeout((()=>{A(!0)}),S);return()=>{clearTimeout(e)}}),[]);const{currentUserId:I,spaceId:E,isFreshStateReady:C}=(0,c().K8)((()=>{var e,t,r,a;null!==(e=o().default.state.currentUserStore)&&void 0!==e&&e.id&&null!==(t=(0,i().S)())&&void 0!==t&&t.id&&(0,f().yd)("user_and_space_stores_loaded");const s=null===(r=o().default.state.currentUserStore)||void 0===r?void 0:r.id,c=null===(a=(0,i().S)())||void 0===a?void 0:a.id;if(_)return{currentUserId:s,spaceId:c,isFreshStateReady:!1};const d=n.state,u=l().A.state.initialRenderCompleted;return{currentUserId:s,spaceId:c,isFreshStateReady:(0,g().XA)({sidebarState:d,userId:s,spaceId:c,isInitialPageRenderCompleted:u})}}),[n,_]),T=(0,a().X)("enable_greedy_sidebar_initial_render"),P=(0,u().X)(),x=(0,g().cT)({isFreshStateReady:C,userId:I,spaceId:E}),L=(0,c().K8)((()=>{const e=null==x?void 0:x.state;return Boolean(I===(null==e?void 0:e.userId)&&E===(null==e?void 0:e.spaceId))}),[x,I,E]),R=Boolean(L&&(P||T)&&!C&&!k);return(0,h.jsx)(b.Provider,{value:R?x:n,children:e})}function w(){const e=(0,r.useContext)(b),t=(0,s().v3)(),n=(0,v().r)(t);return e??n}function _(){return(0,c().O$)(w())}},929871:(e,t,n)=>{n.d(t,{v:()=>i});n(898992),n(737550);var r=()=>n(534177);const o={zoom:["us.zoom.xos","Zoom.exe"],safari:["com.apple.WebKit.GPU"],chrome:["com.google.Chrome.helper","chrome.exe"],teams:["com.microsoft.teams2","ms-teams.exe"],edge:["msedge.exe"],brave:["com.brave.Browser.helper","brave.exe"],arc:["company.thebrowser.browser.helper","Arc.exe"],firefox:["org.mozilla.firefox","firefox.exe"],slack:["com.tinyspeck.slackmacgap.helper","slack.exe"],webex:["com.cisco.webexmeetingsapp","Webex.exe"],atlas:["com.openai.atlas.web.helper"],comet:["ai.perplexity.comet.helper","comet.exe"]};function i(e){for(const t of(0,r().uv)(o)){if(o[t].some((t=>e.toLowerCase().includes(t.toLowerCase()))))return t}}},942906:(e,t,n)=>{n.d(t,{Lj:()=>s,W2:()=>c,xw:()=>a});var r=()=>n(416504),o=()=>n(244828),i=()=>n(680977);function a(e){const{environment:t,userSettingsStore:n}=e,o=n.getSettings(),i=null==o?void 0:o.time_zone,a=(0,r().P)();i!==a&&s({environment:t,userSettingsStore:n,timeZone:a})}function s(e){const{environment:t,userSettingsStore:n,timeZone:r}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateTimeZone",environment:t,canUndo:!0,perform:e=>{(0,i().m)({userSettingsStore:n,transaction:e,data:{time_zone:r}})},userId:n.id})}function c(e){const{environment:t,userSettingsStore:n,disableAutoSetTimezone:r}=e;o().createAndCommit({userAction:"checkUserTimeZoneAction.updateDisableAutoSetTimezone",environment:t,canUndo:!0,perform:e=>{(0,i().m)({userSettingsStore:n,transaction:e,data:{disable_auto_set_timezone:r}})},userId:n.id})}},965142:(e,t,n)=>{n.d(t,{V:()=>o});class r extends(()=>n(757695))().Store{getInitialState(){return{isKeyboardShortcutsOpen:!1,toggleSource:void 0,openCount:0}}}const o=new r;(0,n(852832).exposeDebugValue)("keyboardShortcutsModalStore",o)},969339:(e,t,n)=>{n.d(t,{C6:()=>a,HQ:()=>i,Yo:()=>s});var r=()=>n(79926);const o=new(r().O2)("login",(async()=>{const{default:e}=await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(96966)]).then(n.bind(n,465209)),{default:t}=await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(96966)]).then(n.bind(n,406370)),{LoginMobileNative:r}=await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(96966)]).then(n.bind(n,737515)),{default:o}=await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(96966)]).then(n.bind(n,990718)),{default:i}=await Promise.all([n.e(44711),n.e(35837),n.e(38293),n.e(91793),n.e(19456),n.e(65375),n.e(60751),n.e(25192),n.e(96966)]).then(n.bind(n,52542));return{LoginPage:e,LoginDesktop:t,LoginMobileNative:r,FrontLoginPage:o,LoginModalContent:i}})),i=(0,r()._h)(o,(e=>e.LoginPage)),a=(0,r()._h)(o,(e=>e.FrontLoginPage)),s=(0,r()._h)(o,(e=>e.LoginModalContent))},987954:(e,t,n)=>{n.d(t,{u:()=>o});var r=()=>n(44551);function o(e){r().electronApi&&r().electronApi.navigationReady&&r().electronApi.navigationReady(e)}}}]);