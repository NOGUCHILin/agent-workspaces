"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[28763],{363524:(e,t,n)=>{n.r(t),n.d(t,{default:()=>oe});n(898992),n(354520);var i=n(296540),a=()=>n(907258),s=()=>n(933922),o=()=>n(484714),r=()=>n(590526),l=()=>n(401497),c=()=>n(442610),d=()=>n(107975),u=()=>n(807449),h=()=>n(695115),p=()=>n(148307),g=()=>n(940563),m=()=>n(995847),A=()=>n(340498),f=()=>n(206267),y=()=>n(182183),v=()=>n(69708),x=()=>n(100622),j=()=>n(284371),w=()=>n(691298),C=()=>n(905388),S=()=>n(351337),I=(n(672577),n(581454),()=>n(717137)),b=()=>n(249046),T=()=>n(250910),k=()=>n(388926),_=()=>n(31511),M=()=>n(546926),D=()=>n(406094),B=()=>n(631524),V=()=>n(160432),z=()=>n(26697),F=()=>n(890492),P=()=>n(81068),J=()=>n(663639),L=()=>n(736847),H=()=>n(803960),U=()=>n(395546),E=()=>n(564884),R=()=>n(726637),O=()=>n(247584),W=()=>n(365917),N=()=>n(675133),Y=()=>n(792057),q=()=>n(617871),K=()=>n(165358),G=()=>n(388693),$=()=>n(496603),X=()=>n(229833),Q=()=>n(753812),Z=()=>n(63515);const ee=(0,v().YK)({pleaseTryAgainMsg:{defaultMessage:"Please try again",id:"dialog.pleaseTryAgainMsg"},AuthenticationFailedMsg:{defaultMessage:"Authentication failed. Please try again.",id:"jiraDCAuthActions.authenticationFailedMsg"}});var te=n(474848);function ne(e){const{site:t,APIToken:n,username:i,password:a,jiraDataCenterBasicAuthEnabled:s,jiraDCVersion:o,formValues:{site:c,token:d,username:u,password:h},onChange:p,invalidFields:g,hidePopup:m,environment:A}=e,f=(0,r().O$)(S().Ay),y=(0,l().IS)((()=>({inputLabels:{fontSize:j().J.UISmall.desktop,fontWeight:j().Wy.semibold,font:"SF Pro",lineHeight:j().K_.UISmall.desktop,color:x().Tj.text.tertiary},inputBox:{width:"100%",height:28,padding:4,gap:4},invalidInput:{boxShadow:x().Tj.inputRedFocusRing}})),[]);return(0,te.jsx)(I().A,{debugName:"AtlassianAPIAuthContentPopup",capture:!0,children:(0,te.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%",width:"100%"},children:[(0,te.jsx)("div",{style:{overflowY:"scroll"},children:(0,te.jsxs)("div",{style:{padding:2},children:[(0,te.jsx)("div",{children:s?(0,te.jsx)("div",{children:(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{htmlFor:"jiraDCVersion",style:{...y.inputLabels},children:o}),(0,te.jsx)(ie,{onSelectOption:e=>{S().Ay.setState({...S().Ay.state,authenticationType:e})},options:[{key:S().XT.Bearer,label:(0,te.jsx)(v().sA,{id:"jiraAuthentication.jiraDCNewerVersionOption.label",defaultMessage:"8.14 or later"})},{key:S().XT.Basic,label:(0,te.jsx)(v().sA,{id:"jiraAuthentication.jiraDCOlderVersionOption.label",defaultMessage:"Prior to 8.14"})}],currentOption:f.authenticationType??S().XT.Bearer})]})}):void 0}),(0,te.jsx)(k().A,{size:14,isHidden:!0}),(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{htmlFor:"site",style:y.inputLabels,children:t}),(0,te.jsx)(k().A,{size:8,isHidden:!0}),(0,te.jsx)(_().A,{id:"site",value:c,onChange:e=>p("site",e.target.value),showClearButton:!0,placeholder:"https://domain.com",inputElementAttributes:{minLength:4},style:{...y.inputBox,...g.includes("site")&&y.invalidInput}})]}),(0,te.jsx)(k().A,{size:14,isHidden:!0}),(0,te.jsx)("div",{children:s&&f.authenticationType===S().XT.Basic?(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{htmlFor:"username",style:y.inputLabels,children:i}),(0,te.jsx)(k().A,{size:8,isHidden:!0}),(0,te.jsx)(_().A,{id:"username",type:"username",value:u,onChange:e=>{p("username",e.target.value)},showClearButton:!0,placeholder:"Enter your username",inputElementAttributes:{minLength:4},style:{...y.inputBox,...g.includes("username")&&y.invalidInput}}),(0,te.jsx)(k().A,{size:8,isHidden:!0})]}),(0,te.jsx)(k().A,{size:14,isHidden:!0}),(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{htmlFor:"password",style:y.inputLabels,children:a}),(0,te.jsx)(k().A,{size:8,isHidden:!0}),(0,te.jsx)(_().A,{id:"password",type:"password",value:h,onChange:e=>{p("password",e.target.value)},showClearButton:!0,placeholder:"Enter your password",inputElementAttributes:{minLength:4},style:{...y.inputBox,...g.includes("password")&&y.invalidInput}}),(0,te.jsx)(k().A,{size:8,isHidden:!0})]}),(0,te.jsx)(k().A,{size:14,isHidden:!0})]}):(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{htmlFor:"APIToken",style:y.inputLabels,children:n}),(0,te.jsx)(k().A,{size:8,isHidden:!0}),(0,te.jsx)(_().A,{id:"AccessToken",type:"password",value:d,onChange:e=>{p("token",e.target.value)},showClearButton:!0,placeholder:"Paste your token here",inputElementAttributes:{minLength:4},style:{...y.inputBox,...(f.adminTokenError||g.includes("token"))&&y.invalidInput}}),(0,te.jsx)(k().A,{size:8,isHidden:!0})]}),(0,te.jsx)(k().A,{size:14,isHidden:!0})]})})]})}),(0,te.jsxs)("div",{style:{display:"flex",justifyContent:"normal"},children:[(0,te.jsx)(V().A,{colorPalette:"blue",size:"lg",disabled:"Basic"===f.authenticationType&&s?!c||!u||!h:!c||!d,onClick:async()=>{await async function(e){const{environment:t,siteValue:n,tokenValue:i,usernameValue:a,passwordValue:s}=e,o=S().Ay.getFlowId(),r=S().Ay.state;(0,E().u)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_initiated",flowId:o}}});try{const e=W().A.integrations.state.find((e=>e.id===q().Fv));if(!e||!r.spaceId||!t.currentUser.id)return Y().ui({message:N().A.formatMessage(ee.pleaseTryAgainMsg),showCancel:!1,keepFocus:!1,items:[{label:N().A.formatMessage(ee.pleaseTryAgainMsg),onAccept:$().D_}]}),void K().log({level:"info",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Missing required data to authenticate with Jira DC",miscDataToConvertToString:{siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}});const l=e.id,c=(0,G().UI)(R().A.domainBaseUrl),d=e.redirect_uris.includes(c)?c:e.redirect_uris[0],u=await Q().callApi({eventName:"createOauthAuthorizationCode",environment:t,data:{integrationId:l,spaceId:r.spaceId,redirectUri:d}});if("failed"===u.type){Y().Qg(u);const e=(0,O().V4)(u);return K().log({level:"error",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Unexpected error creating authorization code",miscDataToConvertToString:{response:u,errorMessage:e,siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}}),(0,E().u)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_status",flowId:o,status:"failed"}}}),{error:`Unexpected error creating authorization code: ${e}`}}const h=u.data.code;let p;if(p="Basic"===r.authenticationType?await Q().callApi({eventName:"authenticateJiraDCUser",environment:t,data:{domain:n,userId:t.currentUser.id,spaceId:r.spaceId,notionAuthorizationCode:h,username:a,password:s,authType:"Basic"}}):await Q().callApi({eventName:"authenticateJiraDCUser",environment:t,data:{domain:n,userId:t.currentUser.id,spaceId:r.spaceId,personalAccessToken:i,notionAuthorizationCode:h}}),(0,E().u)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_status",flowId:o,status:"success"===p.type?"success":"failed"}}}),"failed"===p.type||"AUTHENTICATION_FAILED"===p.data.code){const e="failed"===p.type?(0,O().V4)(p):ee.AuthenticationFailedMsg.defaultMessage;Y().ui({message:e,showCancel:!1,keepFocus:!1,items:[{label:N().A.formatMessage(Y()._0.dismissButtonLabel),onAccept:$().D_}]}),K().log({level:"error",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Failed to authenticate with Jira DC",miscDataToConvertToString:{authResponse:p,errorMessage:e,errorStatus:p.status,siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}})}else{K().log({level:"info",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Authentication with Jira DC is successful",miscDataToConvertToString:{siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}}}),await Z().refreshExternalIntegrationStore({environment:t});const e=r.notionState;S().Ay.setState({...S().Ay.state,open:!1,isMemberAuthSuccessForDataCenter:!0,notionState:void 0}),e&&await Z().activateFromRedirect({environment:t,notionState:e})}}catch(l){(0,E().u)({environment:t,event:{eventName:"external_sync_auth",eventProperties:{integration:"jira-dc",actionType:"auth_status",flowId:o,status:"failed"}}}),K().log({level:"error",from:"jiraDCAuthActions",type:"authenticateWithJiraDC",data:{message:"Failed to authenticate with Jira DC",miscDataToConvertToString:{siteValue:n,userId:t.currentUser.id,spaceId:r.spaceId}},error:(0,X().convertErrorToLog)(l)})}}({environment:A,siteValue:c,tokenValue:d,usernameValue:u,passwordValue:h})},children:(0,te.jsx)(v().sA,{id:"JiraDCAuthentication.authenticateButton.label",defaultMessage:"Authenticate"})}),(0,te.jsx)(D().A,{size:"lg",style:{marginInlineStart:12},onClick:()=>{m()},children:(0,te.jsx)(v().sA,{id:"JiraDCAuthentication.cancelButton.label",defaultMessage:"Cancel"})})]})]})})}function ie(e){var t;const{onSelectOption:n,options:i,currentOption:a}=e,s=null===(t=i.find((({key:e})=>e===a)))||void 0===t?void 0:t.label,o=(0,l().IS)((()=>({dropdownLabel:{font:"SF Pro",fontSize:j().J.UIRegular.desktop,fontWeight:j().Wy.regular,lineHeight:j().K_.UISmall.desktop}})),[]);return(0,te.jsx)(T().A,{popupType:T().z.Popup,placementToOrigin:"left",renderOrigin:e=>(0,te.jsx)(B().p,{...e,size:"lg",style:o.dropdownLabel,disabled:!1,hoveredStyle:{background:"rgba(0, 0, 0, 0)"},iconTrailing:{icon:H().arrowChevronSingleDownIcon,colorVariant:"tertiary"},children:s}),render:e=>{const t={menuType:M().gu.Popup,width:250,left:50},a=[{key:"settings-item-section",render:e=>(0,te.jsx)(L().A,{...e}),items:i.map((({key:t,label:i})=>({key:t,action:()=>{n(t),e.close()},render:e=>(0,te.jsx)(P().A,{...e,title:i,shouldWrapCaption:!0,isChecked:s===i})})))}];return(0,te.jsx)(F().A,{...t,children:(0,te.jsx)(J().A,{type:J().O.Vertical,sections:a,initialFocus:void 0,style:{position:"relative",alignItems:"flex-end"}})})}})}const ae=function(e){const t=(0,v().tz)(),n=t.formatMessage({id:"jiraDataCenterAuth.siteHelperText",defaultMessage:"The base URL that is used to access Jira. If you are running on a non-standard port, please provide the input in host:port format"}),i=t.formatMessage({id:"jiraDataCenterAuth.stepsToGetPAT.caption",defaultMessage:"Click to learn how to get personal authentication token from Jira server"}),a=t.formatMessage({id:"AtlassianApiTokenAuthentication.stepsToGetDCVersion.captions",defaultMessage:"Click to learn how to know the version of DC Server you are running"});return(0,te.jsx)(ne,{hidePopup:()=>{!function(e){const{key:t,value:n}=e;S().Ay.setState({...S().Ay.state,[t]:n})}({key:"open",value:!1})},site:(0,te.jsxs)(b().Ye,{style:{alignItems:"center",gap:2},children:[(0,te.jsx)(v().sA,{id:"AtlassianApiTokenAuthentication.siteMessage",defaultMessage:"Jira site url"}),(0,te.jsx)(z().m,{style:{width:300,whiteSpace:"normal"},placement:"right",renderTooltip:()=>n,render:e=>(0,te.jsx)(h().A,{ariaLabel:n,disableBackground:!0,icon:U().infoCircleSmallIcon,...e})})]}),APIToken:(0,te.jsxs)(b().Ye,{style:{alignItems:"center",gap:2},children:[(0,te.jsx)(v().sA,{id:"AtlassianDCApiTokenAuthentication.apiTokenMessage",defaultMessage:"API token"}),(0,te.jsx)(z().m,{placement:"right",renderTooltip:()=>i,render:e=>(0,te.jsx)(h().A,{ariaLabel:i,onClick:()=>{window.open("https://confluence.atlassian.com/enterprise/using-personal-access-tokens-1026032365.html","_blank")},icon:U().infoCircleSmallIcon,...e})})]}),username:(0,te.jsx)(b().Ye,{style:{alignItems:"center",gap:2},children:(0,te.jsx)(v().sA,{id:"AtlassianDCApiTokenAuthentication.usernameMessage",defaultMessage:"Jira username"})}),password:(0,te.jsx)(b().Ye,{style:{alignItems:"center",gap:2},children:(0,te.jsx)(v().sA,{id:"AtlassianDCApiTokenAuthentication.passwordMessage",defaultMessage:"Jira password"})}),jiraDCVersion:(0,te.jsxs)(b().Ye,{style:{alignItems:"center",gap:2},children:[(0,te.jsx)(v().sA,{id:"AtlassianApiTokenAuthentication.DCVersion",defaultMessage:"Jira version"}),(0,te.jsx)(z().m,{style:{width:300,whiteSpace:"normal"},placement:"right",renderTooltip:()=>a,render:e=>(0,te.jsx)(h().A,{ariaLabel:a,onClick:()=>{window.open("https://community.atlassian.com/t5/Jira-questions/Re-where-can-i-check-jira-version-am-using-how-to-check/qaq-p/664639/comment-id/218177#M218177","_blank")},icon:U().infoCircleSmallIcon,...e})})]}),...e})},se=(0,v().YK)({headerTitle:{id:"jiraDCAuthModal.header.title",defaultMessage:"Authenticate your account"}});function oe(){const e=(0,o().v3)(),t=(0,r().O$)(S().Ay),{open:n,type:i}=t,l=()=>{const e=S().Ay.getInitialState();S().Ay.setState({...e,open:!1})},u=(0,r().uB)(void 0,c().A),h=(0,r().O$)(a().AppStoreSidebarSpaceStore),p=t.flowId||f().JW(),g=Boolean(i)&&void 0!==h&&t.instanceValue!==S().cK.Cloud&&"dc-auth"===t.type;if((0,w().A)({shouldPreserveTextSelection:n&&g,shouldPreserveBlockSelection:n&&g,shouldRestoreSelection:!0}),!g)return null;const{height:m,width:A}="auth"===i?{width:450,height:"fit-content"}:{width:400,height:"fit-content"};return(0,te.jsx)(d().a,{open:n,innerStyle:{width:A,height:m,overflow:"scroll",borderRadius:5,maxHeight:675,minHeight:300,padding:6},render:()=>(0,te.jsx)(s().A,{capture:!0,allowEsc:!0,render:()=>(0,te.jsx)(re,{type:i,handleModalClose:l,environment:e,requestStore:u,spaceStore:h,flowId:p})}),onDismiss:l})}function re(e){const{environment:t,requestStore:n,spaceStore:a}=e,s=e.flowId||f().JW(),o=(0,r().O$)(S().Ay);(0,i.useEffect)((()=>{o.flowId||S().Ay.setState({...o,flowId:s})}),[o,s]);const c=(0,l().IS)((()=>({wrapper:{paddingTop:20,paddingInlineEnd:14,paddingBottom:10,paddingInlineStart:14,height:"100%",display:"flex",flexDirection:"column"}})),[]);return(0,te.jsx)("div",{style:c.wrapper,children:(0,te.jsx)(ce,{handleModalClose:e.handleModalClose,environment:t,requestStore:n,spaceStore:a,flowId:s})})}function le({handleModalClose:e,caption:t,title:n}){const i=(0,v().tz)(),a=(0,l().IS)((()=>({wrapper:{marginBottom:18},header:{fontWeight:j().Wy.medium,fontSize:17,textAlign:"center",marginTop:8},icon:{height:40,width:40},iconGroup:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",gridColumnGap:9,marginBottom:9},arrowRight:{opacity:.4,fontWeight:j().Wy.bold,padding:3},notionLogo:{height:40,width:40,color:x().Tj.icon.primary},closeButton:{position:"absolute",top:14,insetInlineEnd:14,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"100%",background:x().Tj.buttonHoveredBackground,width:20,height:20},closeButtonHover:{background:x().Tj.buttonPressedBackground},closeButtonIcon:{width:A().Ev.xs,height:A().Ev.xs,fill:x().Tj.text.secondary}})),[]),s=n||se.headerTitle;return(0,te.jsxs)("div",{style:a.wrapper,children:[(0,te.jsx)(h().A,{ariaLabel:i.formatMessage({id:"jiraDCAuthModal.header.closeButton.ariaLabel",defaultMessage:"Close"}),onClick:e,style:a.closeButton,hoveredStyle:a.closeButtonHover,icon:m().xMarkSmallIcon,iconStyle:a.closeButtonIcon}),(0,te.jsxs)("div",{style:a.iconGroup,children:[(0,te.jsx)("img",{style:a.icon,src:p().A.images.externalIntegrations.jiraPng,alt:"Jira Icon"}),(0,te.jsx)(u().I,{icon:g().arrowStraightRightIcon,style:a.arrowRight}),(0,y().notionTintableIcon)(a.notionLogo)]}),(0,te.jsx)("div",{style:a.header,children:(0,te.jsx)(v().sA,{...s})}),t]})}function ce({environment:e,handleModalClose:t}){const[n,a]=(0,i.useState)([]),s=(0,r().K8)((()=>S().Ay.state.site),[]),[o,l]=i.useState({site:s||"",token:"",username:"",password:""}),c=(0,r().K8)((()=>(0,C().nh)()),[]);return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(le,{handleModalClose:t}),(0,te.jsx)(ae,{formValues:o,onChange:(e,t)=>{l({...o,[e]:t}),a((t=>t.filter((t=>t!==e))))},invalidFields:n,environment:e,jiraDataCenterBasicAuthEnabled:c})]})}},395546:(e,t,n)=>{n.r(t),n.d(t,{iconDefinition:()=>a,infoCircleSmallIcon:()=>s});n(296540);var i=n(474848);const a={viewBox:"0 0 16 16",fittedViewBox:"1.87 1.87 12.25 12.25",svg:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("path",{d:"M7.9 4.425a.775.775 0 1 0 0 1.55.775.775 0 0 0 0-1.55M6.95 6.5a.625.625 0 1 0 0 1.25h.425V10H6.95a.625.625 0 1 0 0 1.25h2.1a.625.625 0 1 0 0-1.25h-.425V7.125A.625.625 0 0 0 8 6.5z"}),(0,i.jsx)("path",{d:"M8 1.875a6.125 6.125 0 1 0 0 12.25 6.125 6.125 0 0 0 0-12.25M3.125 8a4.875 4.875 0 1 1 9.75 0 4.875 4.875 0 0 1-9.75 0"})]})},s=(0,n(340498).wt)("infoCircleSmall",a,"small")},462853:(e,t,n)=>{n.d(t,{l:()=>s});var i=()=>n(617871);const a={[i().e1]:"collection_connected_property_figma",[i().Hd]:"collection_connected_property_google_drive",[i().ob]:"collection_connected_property_github",[i().k0]:"collection_connected_property_zendesk",[i().bh]:"collection_synced_database_github",[i().MN]:"collection_synced_database_asana",[i().Fo]:"collection_synced_database_gitlab",[i().me]:"collection_synced_database_jira",[i().F6]:"collection_synced_database_jira_workspace",[i().Fv]:"collection_synced_database_jira_datacenter",[i().mn]:"collection_synced_database_salesforce_workspace"};function s(e){if(e)return a[e]}},613016:(e,t,n)=>{n.d(t,{a:()=>a});var i=()=>n(907258);function a(){const{sidebarSpaceStore:e}=i().default.getState();return e?e.id:void 0}},691298:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(296540),a=()=>n(232615),s=()=>n(206051);const o=function({shouldPreserveTextSelection:e,shouldPreserveBlockSelection:t,shouldRestoreSelection:o,onClearSelection:r}){const l=(0,n(484714).v3)(),c=(0,i.useRef)(e),d=(0,i.useRef)(""),u=(0,i.useRef)({selectionState:null,textSelectionState:null}),h=(0,i.useCallback)((()=>u.current),[]),p=(0,i.useCallback)((()=>{d.current=window.location.href,a().default.hasSelection()&&(u.current.textSelectionState=a().default.cloneState()),(0,n(755125).clear)({environment:l}),t&&(s().default.isSelected()&&(u.current.selectionState=s().default.cloneState()),(0,n(440024).I)({environment:l}))}),[l,t]),g=(0,i.useCallback)((()=>{u.current={selectionState:null,textSelectionState:null},d.current="",null==r||r()}),[r]),m=(0,i.useCallback)((()=>{const{selectionState:e,textSelectionState:n}=u.current;window.location.href===d.current&&(n&&"mode"in n&&"editing"===n.mode&&a().default.setState({...a().default.state,...n}),t&&e&&s().default.setState({...s().default.state,...e})),g()}),[g,t]);return(0,n(852507).l)((()=>{c.current=e,e&&p()})),(0,i.useEffect)((()=>(c.current&&!e?o?m():g():!c.current&&e&&p(),c.current=e,()=>{o?m():g()})),[e,g,m,p,o]),{clearSavedSelection:g,restoreSavedSelection:m,getSavedSelection:h}}},803960:(e,t,n)=>{n.r(t),n.d(t,{arrowChevronSingleDownIcon:()=>a,iconDefinition:()=>i});n(296540);const i={viewBox:"0 0 20 20",fittedViewBox:"3.97 6.97 12.06 6.66",svg:(0,n(474848).jsx)("path",{d:"M9.558 13.442c.244.244.64.244.884 0l5.4-5.4a.625.625 0 0 0-.884-.884L10 12.116 5.042 7.158a.625.625 0 1 0-.884.884z"})},a=(0,n(340498).wt)("arrowChevronSingleDown",i,"default")}}]);