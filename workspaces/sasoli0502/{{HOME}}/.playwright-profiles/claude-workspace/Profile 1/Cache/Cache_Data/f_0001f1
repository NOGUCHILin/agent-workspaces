"use strict";(globalThis.webpackChunknotion_next=globalThis.webpackChunknotion_next||[]).push([[94995],{343168:(e,o,t)=>{t.d(o,{A:()=>n});class r extends(()=>t(757695))().Store{getInitialState(){return{openTooltip:void 0}}}const n=new r},791122:(e,o,t)=>{t.d(o,{m:()=>l});var r=()=>t(675133),n=()=>t(388821),i=()=>t(519831),a=()=>t(183558);const s=(0,t(69708).YK)({responderPropertyTitle:{defaultMessage:"Respondent",id:"blockTemplates.form.responderPropertyTitle"},createdTimePropertyName:{defaultMessage:"Submission time",id:"blockTemplates.form.createdTimePropertyName"},formInitialQuestionPropertyTitle:{defaultMessage:"Question 1",id:"blockTemplates.form.formInitialQuestionPropertyTitle"},formInitialQuestionPropertySelect:{defaultMessage:"Question 2",id:"blockTemplates.form.formInitialQuestionPropertySelect"},formInitialQuestionPropertySelectOption1:{defaultMessage:"Option 1",id:"blockTemplates.form.formInitialQuestionPropertySelectOption1"},formInitialQuestionPropertySelectOption2:{defaultMessage:"Option 2",id:"blockTemplates.form.formInitialQuestionPropertySelectOption2"},formInitialQuestionPropertySelectOption3:{defaultMessage:"Option 3",id:"blockTemplates.form.formInitialQuestionPropertySelectOption3"}});function l(e){const{isInline:o,name:t}=e,l=(0,a().Ay)(),d=(0,a().Ay)(),c=(0,a().Ay)(),u=(0,a().Ay)(),m=(0,a().Ay)(),p=(0,a().Ay)();return n().RecordMapPolymorphic.create({block:{root:{id:"root",type:o?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:i().Vl,id:"collection"}},view_ids:[],alive:!0}},collection:{collection:{id:"collection",name:t,schema:{title:{name:r().A.formatMessage(s.formInitialQuestionPropertyTitle),type:"title"},[l]:{name:r().A.formatMessage(s.responderPropertyTitle),type:"created_by"},[d]:{name:r().A.formatMessage(s.createdTimePropertyName),type:"created_time"},[c]:{name:r().A.formatMessage(s.formInitialQuestionPropertySelect),type:"multi_select",options:[{id:u,value:r().A.formatMessage(s.formInitialQuestionPropertySelectOption1),color:"blue"},{id:m,value:r().A.formatMessage(s.formInitialQuestionPropertySelectOption2),color:"yellow"},{id:p,value:r().A.formatMessage(s.formInitialQuestionPropertySelectOption3),color:"red"}]}},format:{},parent_id:"root",parent_table:"block",alive:!0}}})}},894995:(e,o,t)=>{t.r(o),t.d(o,{FORMS_SHARE_CALLOUT_KEY:()=>te,changeFormClosedState:()=>pe,changeFormSubmissionPermissions:()=>fe,changeFormSubmissionTemplate:()=>ye,createAndFocusCollectionFormEditorView:()=>ae,createCollectionFormEditorView:()=>se,createDummyFormPage:()=>be,createFormInPrivate:()=>le,createFormQuestion:()=>ce,createFormQuestionAndUpdateOrCreateModule:()=>me,createModuleForNewlyDuplicatedProperty:()=>ue,createResponsesCollectionView:()=>de,incrementAndTrackUserFormsCreated:()=>re,maybeAlertAboutUnsupportedPublicQuestions:()=>_e,maybeSyncQuestionNameToPropertyName:()=>ne,remapQuestionToNewProperty:()=>Ie,toggleAnonymousFormSubmissionState:()=>ve,toggleNotionBrandingState:()=>ge});t(16280),t(944114),t(898992),t(354520),t(672577),t(803949),t(581454),t(296540);var r=()=>t(564884),n=()=>t(907258),i=()=>t(401497),a=()=>t(675133),s=()=>t(792057),l=()=>t(807449),d=()=>t(584262),c=()=>t(700500),u=()=>t(31503),m=()=>t(898244),p=()=>t(713998),f=()=>t(110192),y=()=>t(416504),v=()=>t(123423),g=()=>t(626922),I=()=>t(421559),b=()=>t(688728),_=()=>t(235692),A=()=>t(388821),h=()=>t(450648),S=()=>t(179034),w=()=>t(519831),M=()=>t(869558),C=()=>t(37165),T=()=>t(144081),P=()=>t(201980),x=()=>t(69708),Q=()=>t(100622),B=()=>t(496603),O=()=>t(183558),N=()=>t(284371),F=()=>t(896628),E=()=>t(384944),k=()=>t(185544),D=()=>t(680977),U=()=>t(631123),R=()=>t(478251),V=()=>t(180762),z=()=>t(680288),j=()=>t(514578),L=()=>t(791122),G=()=>t(594794),q=()=>t(300789),X=()=>t(978846),Z=()=>t(33218),W=()=>t(535960),H=()=>t(343168),$=()=>t(957763),K=()=>t(598729),Y=()=>t(244828),J=()=>t(465741),ee=t(474848);const oe=(0,x().YK)({responsesViewName:{id:"formEditorActions.responsesViewName",defaultMessage:"Responses"},newFormViewName:{id:"formEditorActions.newFormViewName",defaultMessage:"Form builder"},formDatabaseTitle:{id:"newBlock.databaseInline.formDatabaseTitle",defaultMessage:"New form"}}),te="forms_share_form_tooltip";function re(e,o){const{currentUserSettingsStore:t}=n().default.state;if(!t)return;const i=function(){const{currentUserSettingsStore:e}=n().default.state;if(!e)return;return e.getSettingsStore().getKeyStore("user_forms_created_count").getValue()??0}();void 0!==i&&((0,D().m)({userSettingsStore:t,transaction:o,data:{user_forms_created_count:i+1}}),function(e,o){(0,r().u)({environment:e,event:{eventName:"form_created",eventProperties:{user_total_form_count:o.userFormsCreatedCount}}})}(e,{userFormsCreatedCount:i+1}))}function ne(e){var o;const{questionStore:t,environment:r,collectionStore:n,collectionContextStore:i}=e,s=null===(o=t.getConfig())||void 0===o?void 0:o.propertyId;if(!s)throw new Error("No property ID found for question");Y().createAndCommit({userAction:"formQuestion.changeName",environment:r,canUndo:!0,perform:e=>{if(!t.shouldSyncQuestionNameToPropertyName())return;const o=t.getNameStore().getValue();if(!o)return;const r=(0,h().r4)({textValue:o,getRecordModel:t.getRecordModel,deterministic:!0,userTimeZone:(0,y().P)(),intl:a().A.getIntl()}),l=(0,z().fE)({property:s,collectionContextStore:i,newValue:r})?(0,f().Q)(r):r;(0,U().Y)({collectionStore:n,property:s,name:l,transaction:e})}})}function ie(){const e=(0,i().IS)((()=>({container:{display:"flex",flexDirection:"column"},iconGroup:{display:"flex",flexDirection:"row",justifyContent:"center",color:Q().Tj.icon.secondary,alignItems:"center"},dialogTitle:{fontSize:16,fontWeight:N().Wy.semibold,lineHeight:"22px",marginTop:12,marginBottom:12},dialogDescription:{color:Q().Tj.text.secondary,fontSize:14,lineHeight:"20px"}})),[]);return(0,ee.jsxs)("div",{style:e.container,children:[(0,ee.jsxs)("div",{style:e.iconGroup,children:[(0,ee.jsx)(l().I,{icon:I().T,size:36}),(0,ee.jsx)(l().I,{icon:v().arrowStraightRightFillIcon,size:24,style:{marginInlineStart:12,marginInlineEnd:12}}),(0,ee.jsx)(l().I,{icon:g().e,size:36})]}),(0,ee.jsx)("span",{style:e.dialogTitle,children:(0,ee.jsx)(x().sA,{defaultMessage:"Auto-create form questions based on existing properties?",id:"NewFormOnExistingCollectionDialogTitle.message"})}),(0,ee.jsx)("span",{style:e.dialogDescription,children:(0,ee.jsx)(x().sA,{defaultMessage:"Only supported property types will create new questions.",id:"NewFormOnExistingCollectionDialogTitle.description"})})]})}function ae(e){const{environment:o,collectionContextStore:t,collectionStore:r,transaction:n}=e,i=t.collectionViewBlockStore();if(!i)return;const a=r.getSchema(),l=se({environment:o,collectionViewBlockStore:i,collectionId:r.id,schema:a,transaction:n,initializeWithAllDefaultQuestions:!1});if(!l)return;(0,V().t)({environment:o,collectionContextStore:t,collectionViewId:l.newViewId,isFullScreen:t.isFullScreenStore.state,isRootChild:t.isRootChildStore.state,isInPeekRenderer:t.isInPeekRendererStore.state});const d=l.layoutStore,c=Object.keys(a).filter((e=>{const o=a[e];return"title"!==e&&o&&(0,u().Sg)(o)}));c.length>0&&c.length<=J().eb&&s().ui({showCancel:!1,keepFocus:!1,message:(0,ee.jsx)(ie,{}),mode:"wide",items:[{label:(0,ee.jsx)(x().sA,{defaultMessage:"Create {numQuestions, plural, one {1 question} other {{numQuestions} questions}}",id:"formEditorActions.createQuestions.primaryAction",values:{numQuestions:c.length}}),color:"blue",buttonType:"solid",onAccept(){Y().createAndCommit({environment:o,userAction:"formActions.autoCreateFormQuestionsForExistingDatabase",canUndo:!0,perform:e=>{for(const n of c)ue({type:"formQuestion",environment:o,module:void 0,transaction:e,layoutStore:d,collectionStore:r,propertyId:n,position:{type:"area_relative",area:"form_layout_schema",location:"end_moveable"},collectionContextStore:t,shouldLogEvent:!0,autoCreatedFromExistingDatabase:!0,duplicateModuleMapping:new Map,propertyIdMapping:new Map,sessionId:(0,O().Ay)()})}})}},{label:(0,ee.jsx)(x().sA,{defaultMessage:"Start from scratch",id:"formEditorActions.createQuestions.secondary"}),color:"gray",buttonType:"plain",onAccept(){}}]})}function se(e){const{environment:o,collectionViewBlockStore:t,collectionId:r,transaction:n,schema:i,initializeWithAllDefaultQuestions:s}=e;if(!t)return;const l=t.getSpaceId(),{formBlockStore:d,layoutStore:c}=function(e){var o;const{environment:t,spaceId:r,inMemoryRecordCache:n,transaction:i,schema:a,initializeWithAllDefaultQuestions:s}=e,l=Object.keys(a).find((e=>{var o;return"multi_select"===(null===(o=a[e])||void 0===o?void 0:o.type)})),d=Boolean(s&&void 0!==l),c=(0,G().Z1)({environment:t,table:S().ev,spaceId:r}),p=(0,G().Z1)({environment:t,table:C().lo,spaceId:r}),f=d?(0,G().Z1)({environment:t,table:C().lo,spaceId:r}):void 0,y=E().Wv({id:c,environment:t,type:"form",permissions:(0,u().eb)(),inMemoryRecordCache:n,transaction:i}),v=E().eC({environment:t,table:T().zx,value:{space_id:r,parent_table:S().ev,parent_id:y.id,modules:(0,_().oP)(p,f)},inMemoryRecordCache:n,transaction:i});var g,I;F().zA({stores:[y],update:{form_layout_pointer:{id:v.id,spaceId:r,table:T().zx}},transaction:i}),ce({environment:t,questionId:p,spaceId:r,layoutId:v.id,propertyId:m().rn,initialQuestionTitle:(null===(o=a[m().rn])||void 0===o?void 0:o.name)??"",inMemoryRecordCache:n,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1,logData:{area:"form_layout_schema",layoutStore:v}}),d&&f&&l&&ce({environment:t,questionId:f,spaceId:r,layoutId:v.id,propertyId:l,initialQuestionTitle:(null===(g=a[l])||void 0===g?void 0:g.name)??"",existingFormQuestionConfig:{propertyId:l,name:[[(null===(I=a[l])||void 0===I?void 0:I.name)??""]],propertyTypeSpecificConfig:{multi_select:{maxSelectionCount:1}}},inMemoryRecordCache:n,transaction:i,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:!1,logData:{area:"form_layout_schema",layoutStore:v}});return{formBlockStore:y,layoutStore:v}}({environment:o,spaceId:l,inMemoryRecordCache:t.inMemoryRecordCache,transaction:n,schema:i,initializeWithAllDefaultQuestions:s}),p=(0,R().i)({environment:o,collectionViewBlockStore:t,collectionView:{type:"form_editor",parent_id:t.id,parent_table:S().ev,alive:!0,space_id:l,name:a().A.formatMessage(oe.newFormViewName),format:{form_block_pointer:{id:d.id,spaceId:l,table:S().ev},collection_pointer:{id:r,spaceId:l,table:w().Vl}}},transaction:n});return E().zv({store:d,data:{parent_id:p.id,parent_table:M().Gy,alive:!0},transaction:n}),H().A.setState({openTooltip:p.id}),q().HH(o,te),re(o,n),{newViewId:p.id,layoutStore:c,formId:d.id}}function le(e){const{environment:o,navigateToFormBuilder:t,spaceStore:r,spaceViewStore:n}=e;if(!(0,$().E)(o,r))return void(0,K().Q)(o,r);if(!(r&&r.canEdit()&&n))return;const i=r.id,s=o.idCreator.getSpaceIdCreatorSync(i);Y().createAndCommit({environment:o,userAction:"formActions.createAndNavigateToFormInPrivate",canUndo:!0,perform:e=>{var l;const{targetBlockStore:c}=(0,j().initializeTemplate)({environment:o,sourceBlockId:"root",targetBlockPointer:(0,G().zP)({environment:o,table:S().ev,spaceId:i}),sourceBlockSubtree:(0,A().partialRecordMapToRecordMap)((0,L().m)({isInline:!0,name:(0,P().x9d)(a().A.formatMessage(oe.formDatabaseTitle))})),targetRecordCache:r.inMemoryRecordCache,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,spaceIdCreator:s}),u=c.getCollectionStoreIfSingleSource();if(!u)throw new Error("Collection store not found");const m=null==u||null===(l=u.getModel())||void 0===l?void 0:l.getNormalizedSchema(),p=c;if(!m)throw new Error("Schema not found");se({environment:o,transaction:e,collectionViewBlockStore:p,collectionId:u.id,schema:m,initializeWithAllDefaultQuestions:!0}),de({environment:o,transaction:e,collectionViewBlockStore:p,collectionStore:u,schema:m}),k().yM({environment:o,spaceStore:r,spaceViewStore:n,pageStore:c,isPrivate:!0,transaction:e,location:{type:"prepend"}}),t&&(0,W().u)({environment:o,store:c,pageVisitSource:d().y8.CreateFormDeepLink})}})}function de(e){const{environment:o,collectionViewBlockStore:t,collectionStore:r,transaction:n}=e,i=t.getSpaceId(),s=Object.keys(e.schema).find((o=>{var t;return"created_by"===(null===(t=e.schema[o])||void 0===t?void 0:t.type)}));(0,R().i)({environment:o,collectionViewBlockStore:t,collectionView:{type:"table",parent_id:t.id,parent_table:S().ev,alive:!0,name:a().A.formatMessage(oe.responsesViewName),space_id:i,format:{table_properties:[{property:"title",visible:!0},...s?[{property:s,visible:!0}]:[]],table_wrap:!0,collection_pointer:r.pointer}},transaction:n})}function ce(e){const{environment:o,questionId:t,spaceId:n,layoutId:i,propertyId:a,initialQuestionTitle:s,inMemoryRecordCache:l,transaction:d,shouldSyncQuestionNameToPropertyName:c,collectionContextStore:u,shouldLogEvent:m=!0,autofocusTitle:p,existingFormQuestionConfig:f,autoCreatedFromExistingDatabase:y}=e;E().vt({environment:o,table:C().lo,args:{id:t,space_id:n,parentPointer:{id:i,table:T().zx,spaceId:n},config:{...f,propertyId:a,name:[[s]],shouldSyncQuestionNameToPropertyName:c}},inMemoryRecordCache:l,transaction:d}),m&&(0,r().u)({environment:o,event:{eventName:"add_form_question",eventProperties:{...(0,J().YA)({collectionContextStore:u,propertyId:a,questionId:t,area:e.logData.area,parentModuleId:e.logData.parentModuleId,layoutStore:e.logData.layoutStore}),auto_created_from_existing_database:Boolean(y)}}}),p&&p.autofocusedQuestionTextStore.autofocusQuestionTitle({questionId:t})}function ue(e){const{type:o,module:t,environment:r,transaction:n,layoutStore:i,position:a,duplicateModuleMapping:s,shouldLogEvent:l=!0,collectionContextStore:d,sessionId:c}=e;let u;const m=t&&s.get(t.id)||(0,O().Ay)();if("formQuestion"===o){var p;const{collectionStore:o,propertyId:c,autofocusTitle:f,existingFormQuestionConfig:y,autoCreatedFromExistingDatabase:v,propertyIdMapping:g}=e,I=o.getSchema()[c];if(!I)throw new Error(`No schema found for property ${c}`);const _=y?(0,P().q4_)(null==y?void 0:y.name):I.name,A=i.getSpaceId(),h=(0,G().Z1)({environment:r,table:C().lo,spaceId:A});if(!(0,b().uW)(a.area))throw new Error("Module is not allowed in this area");ce({environment:r,questionId:h,spaceId:A,layoutId:i.id,propertyId:c,initialQuestionTitle:_,inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,shouldSyncQuestionNameToPropertyName:!0,shouldLogEvent:l,logData:{area:a.area,parentModuleId:null==t?void 0:t.parentModuleId,layoutStore:i},collectionContextStore:d,autofocusTitle:f,existingFormQuestionConfig:y,autoCreatedFromExistingDatabase:v}),u={type:"formQuestion",id:m,formQuestionId:h,...t?{parentModuleId:s.get(t.parentModuleId??"")??t.parentModuleId,parentConditionalGroupId:t.parentConditionalGroupId,conditionalGroups:null===(p=t.conditionalGroups)||void 0===p?void 0:p.map((e=>({...e,trigger:{...e.trigger,property:g.get(e.trigger.property)??e.trigger.property},children:[]})))}:{}}}else u={type:"placeholder",id:m,parentModuleId:s.get(t.parentModuleId??""),parentConditionalGroupId:t.parentConditionalGroupId};return(0,X().UQ)({environment:r,transaction:n,layoutStore:i,position:a,module:u,sessionId:c,isPropertyCreation:!1}),{moduleId:m}}function me(e){const{environment:o,transaction:t,layoutStore:r,propertyId:n,initialQuestionTitle:i,moduleId:a,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d,area:c,sessionId:u}=e,m=r.getModel();if(!m)throw new Error("Layout model cannot be undefined");const p=r.getSpaceId(),f=(0,G().Z1)({environment:o,table:C().lo,spaceId:p});ce({environment:o,questionId:f,spaceId:p,layoutId:m.id,propertyId:n,initialQuestionTitle:i,inMemoryRecordCache:r.inMemoryRecordCache,transaction:t,shouldSyncQuestionNameToPropertyName:s,collectionContextStore:l,autofocusTitle:d,logData:{area:c,parentModuleId:"form_conditional_modules"===c?e.parentModuleId:void 0,layoutStore:r}});const y={type:"formQuestion",id:a??(0,O().Ay)(),formQuestionId:f,..."form_conditional_modules"===c?{parentModuleId:e.parentModuleId,parentConditionalGroupId:e.parentConditionalGroupId}:{}};return a?(0,Z().UQ)({environment:o,transaction:t,layoutStore:r,position:{area:c,moduleId:a},updatedModule:y}):"form_conditional_modules"===c&&(0,X().UQ)({environment:o,transaction:t,layoutStore:r,position:{type:"absolute",area:"form_conditional_modules",parentConditionalGroupId:e.parentConditionalGroupId,parentModuleId:e.parentModuleId},module:y,sessionId:u,isPropertyCreation:!1}),{updatedModuleId:y.id,formQuestionId:f}}function pe({environment:e,formBlockStore:o,isClosed:t}){o.getIsFormClosed()!==t&&Y().createAndCommit({userAction:"formActions.changeFormClosedState",environment:e,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),is_form_closed:t}},transaction:e})}})}function fe({environment:e,formBlockStore:o,permissions:t}){o.getFormSubmissionPermissions()!==t&&Y().createAndCommit({userAction:"formActions.changeFormSubmissionPermissions",environment:e,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),submission_permissions:t}},transaction:e})}})}function ye({environment:e,formBlockStore:o,template:t}){const r=o.getFormSubmissionTemplate();(0,B().n4)(r,t)||Y().createAndCommit({userAction:"formActions.changeFormSubmissionTemplate",environment:e,canUndo:!0,perform:e=>{E().KY({store:o.getFormatStore().getKeyStore("form_config").getKeyStore("form_submission_template"),transaction:e,value:t})}})}function ve({environment:e,formBlockStore:o}){const t=o.getIsFormAnonymousSubmissionEnabled();Y().createAndCommit({userAction:"formActions.changeAnonymousFormSubmissionState",environment:e,canUndo:!0,perform:e=>{F().zA({stores:[o],update:{form_config:{...o.getFormConfig(),anonymous_submissions:!t}},transaction:e})}})}function ge({environment:e,formBlockStore:o}){var t;const r=o.getSiteStore();if(!r)return;const n=(null===(t=r.getHeader())||void 0===t?void 0:t.hideWatermark)??!1;Y().createAndCommit({userAction:"formBlockStore.publicForm.toggleNotionBranding",environment:e,canUndo:!0,perform:e=>{Y().applyOperation({store:r,operation:{pointer:r.pointer,path:["header","hideWatermark"],command:"set",args:!n},transaction:e})}})}function Ie({environment:e,newPropertyId:o,formQuestionStore:t}){Y().createAndCommit({userAction:"formQuestion.remapQuestionToNewProperty",environment:e,canUndo:!0,perform:e=>{Y().applyOperation({store:t,operation:{pointer:t.pointer,path:["config","propertyId"],command:"set",args:o},transaction:e})}})}function be(e){const{environment:o,collectionSchemaPropertyIds:t,temporaryRecordCache:r,spaceId:n,collectionId:i,formMode:a}=e,s={};t.forEach((e=>{s[e]=(0,P().x9d)("")}));const{performResult:l}=Y().createAndCommit({environment:o,userAction:"formActions.createDummyFormPage",perform:e=>{const t=E().Wv({environment:o,type:c().xd.page,inMemoryRecordCache:r,transaction:e,spaceId:n,properties:{...s}});return E().zv({store:t,data:{alive:"viewer"===a,parent_id:i,parent_table:"collection"},transaction:e}),t},canUndo:!1});return l}async function _e(e){const{environment:o,formBlockStore:t,collectionSchema:r,onAccept:n}=e;if(!r)return;const i=(0,J().Dx)(t),l=(null==i?void 0:i.getNormalizedFormQuestionStoresForFormLayout({collectionSchema:r}))??[],d=[];if(l.forEach((e=>{const t=e.getPropertyId();if(!t)return;const n=(0,p()._g)({schema:r,property:t}),i=null==n?void 0:n.type;if(!i)return;(0,J().CK)({environment:o,propertyType:i,propertySchema:n,isPublicForm:!0})&&d.push(e)})),0===d.length)return void n();const c=d.map(((e,o)=>{const t=(0,h().r4)({textValue:e.getNameStore().getValue(),getRecordModel:e.getRecordModel,deterministic:!0,userTimeZone:(0,y().P)(),intl:a().A.getIntl()}),r=o===d.length-1;return(0,ee.jsx)("div",{style:{fontSize:14,textAlign:"start",padding:"8px 12px",borderBottom:r?void 0:`1px solid ${Q().Tj.border.secondaryTranslucent}`},children:t},e.id)})),{accept:u}=await s().Gh({message:(0,ee.jsx)(x().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.message",defaultMessage:"These questions are not supported in public forms and will not be shown to respondents:"}),description:(0,ee.jsx)("div",{style:{borderRadius:6,border:`1px solid ${Q().Tj.border.secondaryTranslucent}`,width:"calc(100% + 24px)",marginInlineStart:-12,marginTop:12,maxHeight:210,overflow:"auto"},children:c}),acceptLabel:(0,ee.jsx)(x().sA,{id:"formEditorActions.maybeAlertAboutUnsupportedPublicQuestions.acceptLabel",defaultMessage:"Got it"}),acceptColor:"blue",cancelButtonType:"plain",mode:"wide"});u&&n()}},978846:(e,o,t)=>{t.d(o,{E:()=>v,UQ:()=>g});t(16280),t(18107),t(944114),t(967357);var r=()=>t(31503),n=()=>t(792071),i=()=>t(688728),a=()=>t(500993),s=()=>t(369186),l=()=>t(475140),d=()=>t(120997),c=()=>t(251822),u=()=>t(778781),m=()=>t(534177),p=()=>t(244828),f=()=>t(447934),y=()=>t(479062);function v(e){const{moduleId:o,layoutStore:t,sessionId:n,environment:a,position:s}=e,l=t.getModuleById(o);if(!l)throw new Error(`Cannot move module with id ${o} because a module with that id is not in the layout`);const d=(0,y().TR)({modulesByArea:t.getModules(),moduleId:o,newPosition:s});I({...e,module:l,userAction:"BuilderLayoutModules.moveModuleToPosition",afterUpsertTransaction:()=>{var e;const o=(0,r().Cg)({moduleId:l.id,modulesByArea:t.getModules()}).length;(0,y().Ib)({environment:a,sessionId:n,collectionId:null===(e=t.getCollectionModel())||void 0===e?void 0:e.id,layoutId:t.id,context:(0,i().We)(s.area),action:d,moduleType:l.type,area:s.area,depth:o})}})}function g(e){const{position:o,module:t,layoutStore:n,sessionId:a,environment:s}=e;if(n.getModuleById(t.id))throw new Error(`Cannot add module with id ${t.id} because a module with that id is already in the layout`);I({...e,userAction:"BuilderLayoutModules.addModuleAtPosition",performBeforeApplyUpsertOperations:e=>{const{transaction:r}=e;"page_main"!==o.area&&"page_details"!==o.area||(0,u().gx)(t)&&(0,f().HD)({environment:s,transaction:r,layoutStore:n,property:t.propertyId})},afterUpsertTransaction:()=>{var l;const d=(0,r().Cg)({moduleId:t.id,modulesByArea:n.getModules()}).length;(0,y().zb)({environment:s,module:t,sessionId:a,collectionId:null===(l=n.getCollectionModel())||void 0===l?void 0:l.id,layoutId:n.id,context:(0,i().We)(o.area),isPropertyCreation:e.isPropertyCreation,area:o.area,depth:d})}})}function I(e){const{environment:o,position:t,layoutStore:r,module:c,transaction:u,userAction:f,performBeforeApplyUpsertOperations:y,afterUpsertTransaction:v}=e,g=r.pointer,I=r.getModules(),h=r.getRawModules(),S=h&&(0,l().c7)(h,(e=>e.id===c.id))||(0,s().Lv)(c),w="page_main"===t.area||"page_details"===t.area?function(e){const{layoutPointer:o,modulesByArea:t,rawModulesByArea:r}=e,a=(0,l().EX)(t,(e=>"relationsGroup"===e.type));if("form_conditional_modules"===(null==a?void 0:a.position.area))return;const d=r&&(0,l().LC)(r,(e=>"relationsGroup"===e.type));if(!a)return;if(a&&d)return;const c=a.module;if(!c||"relationsGroup"!==c.type)throw new Error("relations group module location in normalized was incorrect, cannot backfill relations group module");return function(e){var o;const{module:t,modulesByArea:r,layoutPointer:a}=e,d=(0,l().JO)(r,(e=>e.id===t.id));if(!d)throw new Error("cannot upsert module at current position because module does not have a current position");if("form_conditional_modules"===d.area)throw new Error("[Forms Conditional Logic Not Implemented] form_conditional_modules area is not supported for adding and moving modules");const c="views_main_tab_modules"===d.area?null===(o=r.views_main_tab_modules)||void 0===o?void 0:o[d.viewId]:r[d.area];if(!c||0===c.length)throw new Error("cannot upsert module at current position in area because that area is empty");const u={module:(0,s().Lv)(t),pointer:a,..."views_main_tab_modules"===d.area?{area:i().Zm[d.area],viewId:d.viewId}:{area:i().Zm[d.area]}};if(0===d.index)return n().N4X.putModuleAfter({...u,afterId:void 0});const m=c.at(d.index+1);if(!m)return n().N4X.putModuleAfter({...u,afterId:void 0});return n().N4X.putModuleBefore({...u,beforeId:m.id})}({module:c,layoutPointer:o,modulesByArea:t})}({layoutPointer:g,modulesByArea:I,rawModulesByArea:h}):null;w&&p().createAndCommitOrAppend({environment:o,perform:e=>{p().applyOperation({transaction:e,store:r,operation:w})},canUndo:!0,transaction:u,userAction:`${f||"BuilderLayoutModules.upsert"}.preOpBackfill`});const M=[],C=function(e){const{layoutStore:o,module:t,upsertPosition:r}=e,a=o.getModules(),s=(0,l().JO)(a,(e=>t.id===e.id));if(!s)return;if("form_conditional_modules"===s.area)return n().N4X.deleteModuleInArea({pointer:o.pointer,area:s.area,moduleId:t.id});if("views_main_tab_modules"===s.area){const e="absolute"===r.type&&"views_main_tab_modules"===r.area?r.viewId:void 0,i=s.viewId;if(e===i)return;return n().N4X.deleteModuleInArea({pointer:o.pointer,area:s.area,moduleId:t.id,viewId:i})}if("page_main"===s.area||"page_details"===s.area||"form_layout_schema"===s.area||"person_profile_page_main"===s.area||"person_profile_page_details"===s.area||"dashboard_layout_schema"===s.area){if(s.area===r.area)return;return n().N4X.deleteModuleInArea({pointer:o.pointer,area:i().Zm[s.area],moduleId:t.id})}(0,m().HB)(s.area)}({upsertPosition:t,module:c,layoutStore:r});C&&M.push(C);const T=function(e){const{upsertPosition:o,layoutPointer:t,modulesByArea:r,rawModuleToUpsert:s}=e;if("absolute"===o.type)return function(e){const{upsertPosition:o,rawModuleToUpsert:t,layoutPointer:r,modulesByArea:s}=e,c=(0,l().JO)(s,(e=>t.id===e.id)),{area:u}=o;if("form_conditional_modules"===u){const{parentConditionalGroupId:e,parentModuleId:i}=o;if(!(0,d().V)(t,"form_conditional_modules"))throw new Error("Can only add form question or placeholder modules to form_conditional_modules area.");const c=(0,l().Ib)({modulesByArea:s,find:e=>e.id===t.parentModuleId}),u=(0,a().A)(i,s);return n().N4X.upsertChildModule({pointer:r,module:t,previousParentModuleAndArea:c,newParentModule:{area:u.area,module:u.module,conditionalGroupId:e,index:o.index},modulesByArea:s})}const m=o.index;if(m<0)throw new Error(`Cannot upsert module with id ${t.id} to a negative position`);if("views_main_tab_modules"===u){const e=o.viewId;if(!s[u]||!s[u][e])throw new Error("Cannot upsert module into views_main_tab_modules area that does not have views");const a="views_main_tab_modules"===(null==c?void 0:c.area)&&(null==c?void 0:c.viewId)===e?c.index:void 0,l=b({modulesInArea:s[u][e],indexOfModuleToUpsertInArea:a,indexToUpsertTo:m});if(!l)return;return[n().N4X.putModuleBeforeOrAfter({pointer:r,area:i().Zm[u],viewId:e,module:t,direction:l.insertDirection,beforeOrAfterId:l.beforeOrAfterId})]}const p=s[u]??[],f=(null==c?void 0:c.area)===u?c.index:void 0,y=b({modulesInArea:p,indexOfModuleToUpsertInArea:f,indexToUpsertTo:m});if(!y)return;return[n().N4X.putModuleBeforeOrAfter({pointer:r,area:i().Zm[u],module:t,direction:y.insertDirection,beforeOrAfterId:y.beforeOrAfterId})]}({upsertPosition:o,rawModuleToUpsert:s,layoutPointer:t,modulesByArea:r});if("module_relative"===o.type)return[_({upsertPosition:o,rawModuleToUpsert:s,layoutPointer:t,modulesByArea:r})];if("area_relative"===o.type)return[A({upsertPosition:o,rawModuleToUpsert:s,layoutPointer:t,modulesByArea:r})];(0,m().HB)(o)}({module:c,upsertPosition:t,modulesByArea:I,layoutPointer:g,rawModuleToUpsert:S});T&&M.push(...T);const P="placeholder"===c.type&&"form_layout_schema"===t.area?`form_layout_new_question_${c.id}`:void 0;p().createAndCommitOrAppend({environment:o,undoCheckpoint:P,canUndo:!0,perform:e=>{y&&y({transaction:e});for(const o of M)p().applyOperation({transaction:e,store:r,operation:o})},transaction:u,userAction:f||"BuilderLayoutModules.upsert"}),v&&v()}function b(e){const{modulesInArea:o,indexOfModuleToUpsertInArea:t,indexToUpsertTo:r}=e;if(0===r||0===o.length)return{insertDirection:"before",beforeOrAfterId:void 0};const n=o.at(r);return n?void 0===t?{insertDirection:"before",beforeOrAfterId:n.id}:t!==r?t<r?{insertDirection:"after",beforeOrAfterId:n.id}:{insertDirection:"before",beforeOrAfterId:n.id}:void 0:{insertDirection:"after",beforeOrAfterId:void 0}}function _(e){const{upsertPosition:o,rawModuleToUpsert:t,layoutPointer:r,modulesByArea:a}=e,{area:s,direction:d,relativeToModuleId:c}=o,u=i().Zm[s],m=(0,l().JO)(a,(e=>e.id===c));if(!m||m.area!==s)throw new Error(`Cannot find module with id: ${c} to add upsert relative to in ${s}`);if("views_main_tab_modules"===u){const e="views_main_tab_modules"===m.area?m.viewId:void 0;if(!e)throw new Error("Cannot upsert module into views_main_tab_modules area that does not have views");return n().N4X.putModuleBeforeOrAfter({pointer:r,area:"views_main_tab_modules",viewId:e,module:t,direction:"above"===d?"before":"after",beforeOrAfterId:c})}return n().N4X.putModuleBeforeOrAfter({pointer:r,area:u,module:t,direction:"above"===d?"before":"after",beforeOrAfterId:c})}function A(e){const{upsertPosition:o,rawModuleToUpsert:t,layoutPointer:r,modulesByArea:a}=e,{location:s}=o;if("views_main_tab_modules"===o.area){const e=o.viewId,d={pointer:r,area:i().Zm[o.area],viewId:e,module:t};if("start"===s||"end"===s)return n().N4X.putModuleBeforeOrAfter({...d,direction:"start"===s?"before":"after",beforeOrAfterId:void 0});if("end_moveable"===s){var l;const e=h({area:o.area,modulesInArea:(null===(l=a.views_main_tab_modules)||void 0===l?void 0:l[o.viewId])??[]});return n().N4X.putModuleBeforeOrAfter({...d,direction:e.insertDirection,beforeOrAfterId:e.beforeOrAfterId})}(0,m().HB)(s)}const d={pointer:r,area:i().Zm[o.area],module:t};if("start"===s||"end"===s)return n().N4X.putModuleBeforeOrAfter({...d,direction:"start"===s?"before":"after",beforeOrAfterId:void 0});if("end_moveable"===s){const e=a[o.area]??[],t=h({area:o.area,modulesInArea:e});return n().N4X.putModuleBeforeOrAfter({...d,direction:t.insertDirection,beforeOrAfterId:t.beforeOrAfterId})}(0,m().HB)(s)}function h(e){const{area:o,modulesInArea:t}=e,r=(0,c().jS)(o,t),n=r.nonMoveableHeaderModules,i="moveableCenterModules"in r?r.moveableCenterModules:[],a="moveableFooterModules"in r?r.moveableFooterModules:[];if(i.length){const e=i.at(-1);if(!e)throw new Error("cannot find last moveable center module to add below for end moveable");return{insertDirection:"after",beforeOrAfterId:e.id}}if(n.length){const e=n.at(-1);if(!e)throw new Error("cannot find last header module to add below for end moveable");return{insertDirection:"after",beforeOrAfterId:e.id}}if(a.length){const e=a.at(0);if(!e)throw new Error("cannot find first moveable footer module to add above for end moveable");return{insertDirection:"before",beforeOrAfterId:e.id}}return{insertDirection:"after",beforeOrAfterId:void 0}}}}]);