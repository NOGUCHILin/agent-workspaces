# テストデータ確認方法

## ✅ テスト実施済み

**実施日時**: 2025-11-20 12:55

データ収集スクリプトの動作確認が完了しました。

---

## 📊 テスト結果

### 入力CSVフォーマット（成功確認済み）

#### LINE仮査定データ (`line_estimates_YYYYMMDD.csv`)
```csv
日付,機種,容量,ランク,仮査定数,不良有無
2025-11-19,iPhone 15 Pro Max,256GB,S,5,False
2025-11-19,iPhone 15 Pro Max,256GB,A,3,False
...
```

**カラム要件**:
- `日付`: YYYY-MM-DD形式
- `機種`: iPhone 15 Pro Max など
- `容量`: 128GB, 256GB, 512GB, 1TB
- `ランク`: S, A, B, C など
- `仮査定数`: 整数
- `不良有無`: False, True（または 0, 1）

#### 梱包キットデータ (`packing_kits_YYYYMMDD.csv`)
```csv
日付,機種,容量,ランク,キット数
2025-11-19,iPhone 15 Pro Max,256GB,S,3
2025-11-19,iPhone 15 Pro Max,256GB,A,2
...
```

#### 集荷要請データ (`pickup_requests_YYYYMMDD.csv`)
```csv
日付,機種,容量,ランク,集荷数
2025-11-19,iPhone 15 Pro Max,256GB,S,3
2025-11-19,iPhone 15 Pro Max,256GB,A,2
...
```

---

## 🔍 実際のデータでテストする方法

### 1. 実際のCSVを1つエクスポート

まず、LINE仮査定、梱包キット、集荷要請の各データを1日分だけエクスポートしてください。

### 2. テストデータを削除

```bash
cd /Users/noguchisara/projects/work/iphone-market-research/price-impact-analysis

# テストデータを削除
rm data/raw/line_estimates/line_estimates_20251119.csv
rm data/raw/packing_kits/packing_kits_20251119.csv
rm data/raw/pickup_requests/pickup_requests_20251119.csv
```

### 3. 実際のデータを配置

エクスポートしたCSVを以下に配置:
```
data/raw/
├── line_estimates/line_estimates_YYYYMMDD.csv
├── packing_kits/packing_kits_YYYYMMDD.csv
└── pickup_requests/pickup_requests_YYYYMMDD.csv
```

### 4. スクリプトを実行

```bash
uv run python scripts/collect_data.py
```

### 5. エラーが出た場合

**カラム名が違う場合**:

`scripts/collect_data.py` の `COLUMN_MAPPING` を修正してください。

```python
COLUMN_MAPPING = {
    'line_estimates': {
        'date': '日付',        # ← 実際のカラム名に変更
        'model': '機種',       # ← 実際のカラム名に変更
        'capacity': '容量',    # ← 実際のカラム名に変更
        'rank': 'ランク',      # ← 実際のカラム名に変更
        'count': '仮査定数',   # ← 実際のカラム名に変更
        'has_defect': '不良有無',  # ← 実際のカラム名に変更
    },
    # ... 以下同様
}
```

---

## 📋 確認項目チェックリスト

実際のデータでテストする際、以下を確認:

- [ ] CSVファイルが正常に読み込まれる
- [ ] 「不良なし端末のみ抽出」が正しく動作する
- [ ] 梱包キット数 = 集荷要請数のチェックが機能する
- [ ] データ統合が正常に完了する
- [ ] `data/results/collected_data_YYYYMMDD.csv` が生成される
- [ ] コンバージョン率が正しく計算される

---

## 🎯 次のステップ

実際のデータでテストが成功したら:

1. テストデータを削除
2. 毎日18:30のデータ収集を開始
3. データが7日分溜まったら、次の練習として `analyze_impact.py` をテスト
