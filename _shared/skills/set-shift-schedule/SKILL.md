---
name: set-shift-schedule
description: スプレッドシートの「裏」セルを確認し、KING OF TIMEにシフトを入力する。「シフト設定」「シフト作成」と言われた時に使用。
---

# シフト設定スキル

スプレッドシートの「裏」セルとコメントを確認し、KING OF TIMEの月別スケジュールにシフトを入力する。

## 対象システム

### スプレッドシート（２０２５年シフト）
- URL: https://docs.google.com/spreadsheets/d/17j75NtzOjnDDc8ffr2nQzTmw5tU_nLm0h5pGGvIB0OA/edit
- 対象シート: 入力したい月のシート（例: 2026/2）

### KING OF TIME
- URL: https://s4.ta.kingoftime.jp/admin/
- ログインID: cnwqao1admin
- パスワード: 4669Uprose

## シフトパターンルール

スプレッドシートのセル内容に応じてパターンを決定：

| セル内容 | 勤務パターン | 時間 |
|---------|-------------|------|
| 「裏」のみ | 事務所勤務10-19 | 10:00-19:00 |
| 「裏」+コメント | 事務所勤務13-19 | 13:00-19:00 |

**注意:** コメントには出勤時間が記載されている（例: 13時10分〜）

## 入力手順

### 1. スプレッドシートで「裏」セルを確認
1. スプレッドシートURLにアクセス
2. 対象月のシートを選択
3. 対象従業員の行で「裏」と書いてあるセルを確認
4. 各セルにコメントがあるかどうかを確認

### 2. KING OF TIMEにログイン
1. KING OF TIME管理画面にアクセス
2. ログインID・パスワードでログイン

### 3. 月別データから従業員を選択
1. ホーム → 月別データ
2. 表示期間を対象月に設定（例: 2026/02）
3. 対象従業員の「タイムカード」ボタンをクリック
4. 「スケジュール編集」ボタンをクリック

### 4. 月別スケジュール登録でシフト入力

#### コメントありの日（13:00-19:00）
1. パターン: 「事務所勤務13-19」を選択
2. 勤務日種別: 「平日」を選択
3. 対象日のチェックボックスをJavaScriptで操作
4. 「登録」をクリック

#### コメントなしの日（10:00-19:00）
1. パターン: 「事務所勤務10-19」を選択
2. 勤務日種別: 「平日」を選択
3. 対象日のチェックボックスをJavaScriptで操作
4. 「登録」をクリック

## チェックボックス操作（JavaScript）

ページが大きくチェックボックスが非表示のため、JavaScript経由で操作:

```javascript
async (page) => {
  // 対象日付のチェックボックスをチェック（例: 2月2日、4日、9日）
  const dates = ['20260202', '20260204', '20260209'];

  await page.evaluate((dates) => {
    for (const date of dates) {
      const checkbox = document.querySelector(`input[value="${date}"][name="schedule_copy"]`);
      if (checkbox) {
        checkbox.checked = true;
        checkbox.dispatchEvent(new Event('change', { bubbles: true }));
        checkbox.dispatchEvent(new Event('click', { bubbles: true }));
      }
    }
  }, dates);
}
```

## 利用可能な勤務パターン

| パターン名 | 時間 |
|-----------|------|
| 事務所勤務9-13 | 9:00-13:00 |
| 事務所勤務9-18 | 9:00-18:00 |
| 事務所勤務10-19 | 10:00-19:00 |
| 事務所勤務11-20 | 11:00-20:00 |
| 事務所勤務12-19 | 12:00-19:00 |
| 事務所勤務13-19 | 13:00-19:00 |
| 事務所勤務14-19 | 14:00-19:00 |
| 事務所勤務16-20 | 16:00-20:00 |

## 完了報告

入力完了後、以下の形式で報告:

| 日付 | パターン | 区分 |
|------|---------|------|
| 02/01（日） | 事務所勤務10-19 | 裏のみ |
| 02/02（月） | 事務所勤務13-19 | 裏+コメント |

## 5. 入力後の確認・修正

シフト入力後、タイムカード画面で不整合がないか確認する。

### 確認すべき不整合パターン

| 状態 | 表示例 | 問題 | 修正方法 |
|------|--------|------|----------|
| 公休日にパターンが残っている | 事務所勤務10-19(公休) | 公休なのにパターンがある | パターンを「--」に |
| 勤務日なのに公休になっている | --(公休) | 勤務日なのに公休設定 | パターン設定＋平日に変更 |

### 修正手順

不整合がある場合は **fix-holiday-pattern スキル** を使用して修正する。

1. タイムカード画面で問題のある日を特定
2. 鉛筆マーク（編集アイコン）をクリック
3. 「勤務データ編集」画面で修正
4. 保存

**重要:** スケジュール編集（一括編集）ではなく、タイムカードの個別編集を使用する

## 注意事項

- チェックボックスは非表示のため、直接クリックできない → JavaScript操作必須
- パターンを選択してからチェックボックスを操作すること
- 「平日」の勤務日種別も忘れずに選択
- 登録ボタンを押すまでは反映されない
- コメント確認には check-shift-comments スキルを使用可能
- 入力後は必ずタイムカード画面で不整合を確認し、fix-holiday-pattern スキルで修正する
